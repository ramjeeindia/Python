QString
SELECT * FROM ODRF T0 WHERE OBJTYPE=22 and Isnull(T0.U_LEVEL1,'N') = 'N' and Isnull(T0.U_LEVEL2,'N') = 'N' and Isnull(T0.U_LEVEL3,'N') = 'N' and DocStatus='O' and Isnull(T0.U_APPRVL,'N') = 'Y'
SELECT T2.Docnum,T2.DocDate,T2.NumAtCard  FROM OPDN T2  INNER JOIN PDN1 T3 ON T2.DocEntry=T3.DocEntry WHERE t2.DocDate =   convert(varchar(10),(GETDATE()-2),121) AND T3.LineStatus  ='O'
SELECT T0.DocDate AS PODate,T0.DocNum AS PONo,T0.DocDueDate AS DeliveryDate,T0.CardCode,T0.CardName,T1.ItemCode,T1.Dscription AS ItemName, SUM(ISNULL(T1.Quantity,0)) AS OrderQty ,SUM(ISNULL(GR.Quantity,0)) AS ReceivedQty , (SUM(ISNULL(T1.Quantity,0))-SUM(ISNULL(GR.Quantity,0))) AS PendingQty,SUM(ISNULL(T1.Price,0)) AS Rate,SUM(ISNULL(T1.LineTotal,0)) AS Amount FROM OPOR T0  INNER JOIN POR1 T1 ON T0.DocEntry=T1.DocEntry LEFT JOIN  ( SELECT T3.BaseEntry,T3.BaseType,SUM(ISNULL(T3.Quantity,0)) AS Quantity,T3.ItemCode FROM OPDN T2  INNER JOIN PDN1 T3 ON T2.DocEntry=T3.DocEntry GROUP BY T3.BaseEntry,T3.BaseType,T3.ItemCode         ) GR ON GR.BaseEntry=T0.DocEntry AND GR.BaseType=T1.ObjType AND GR.ItemCode=T1.ItemCode WHERE GR.Quantity>0 GROUP BY T0.DocDate,T0.DocNum ,T0.DocDueDate ,T0.CardCode,T0.CardName,T1.ItemCode ,T1.Dscription
SELECT * FROM OOAT T0 WHERE OBJTYPE=1250000025 and Isnull(T0.U_LEVEL1,'N') = 'N' and Isnull(T0.U_LEVEL2,'N') = 'N' and Status='D'
--AP Invoice - Pending Outgoing Payment---- SELECT DocEntry ,DocNum ,CardCode ,CardName ,DocTotal ,DocDate,UserSign,(SELECT U_NAME FROM OUSR T WHERE T.USERID = T0.UserSign) AS UserName   FROM OPCH T0  WHERE PaidToDate = 0.0
select distinct T0.DocEntry, T0.DocNum, T0.[U_UTL_ITCD] FROM [dbo].[@UTL_OQCST]  T0  INNER JOIN [dbo].[@UTL_QCST1] T1 ON T1.DocEntry=T0.DocEntry where T1.[U_UTL_QCAPVL]='N' AND T0.CreateDate=CAST(GETDATE() AS date)
SELECT ISNULL(T0.U_POTY,'') AS PoType , DocEntry, DocNum, CardCode, CardName, DocDate FROM ODRF T0 WHERE T0.ObjType ='22'  AND ISNULL(T0.U_APPRVL,'N') ='Y'  AND DocStatus='O' AND ISNULL(T0.U_LEVEL1,'N') = 'R' AND ( CASE WHEN ISNULL(T0.U_POTY,'') ='CLOSE' THEN  ISNULL(T0.U_LEVEL2,'N') ELSE 'N' END) = 'N'
SELECT ISNULL(T0.U_POTY,'') AS PoType , DocEntry, DocNum, CardCode, CardName, DocDate FROM ODRF T0 WHERE T0.ObjType ='22'  AND ISNULL(T0.U_APPRVL,'N') ='Y'  AND DocStatus='O' AND ISNULL(T0.U_LEVEL1,'N') = 'Y' AND ( CASE WHEN ISNULL(T0.U_POTY,'') ='CLOSE' THEN  ISNULL(T0.U_LEVEL2,'N') ELSE 'R' END) = 'R'
SELECT ISNULL(T0.U_POTY,'') AS PoType , DocEntry, DocNum, CardCode, CardName, DocDate,comments FROM ODRF T0  WHERE T0.ObjType ='22'  AND ISNULL(T0.U_APPRVL,'N') ='Y'  AND DocStatus='O' AND T0.DOCDATE >'20210101' AND ISNULL(T0.U_LEVEL1,'N') = 'N' AND ( CASE WHEN ISNULL(T0.U_POTY,'') ='CLOSE' THEN  ISNULL(T0.U_LEVEL2,'N') ELSE 'N' END) = 'N'
SELECT ISNULL(T0.U_POTY,'') AS PoType , DocEntry, DocNum, CardCode, CardName, DocDate FROM ODRF T0 WHERE T0.ObjType ='22'  AND ISNULL(T0.U_APPRVL,'N') ='Y'  AND DocStatus='O' AND ISNULL(T0.U_LEVEL1,'Y') = 'Y' AND ISNULL(T0.U_LEVEL2,'N') = 'Y' AND  ( CASE WHEN ISNULL(T0.U_POTY,'') ='CLOSE' THEN  ISNULL(T0.U_LEVEL2,'N') ELSE 'Y' END) = 'Y'
SELECT T0.DocNum AS 'ORDER NO.', T0.ItemCode AS 'REQ ITEM CODE', T0.ProdName AS 'REQ ITEM NAME',T0.[STATUS] FROM OWOR T0  WHERE T0.U_UTL_APPVL = 'N' AND T0.Project = 'Salvage' AND  T0.PostDate > '20230401'  AND  T0.[Status] NOT IN ( 'L','R','C') AND T0.CmpltQty = 0
SELECT  T0.AbsID, T0.Number, T0.BpCode ,T0.BpName, T0.StartDate ,T0.EndDate,T0.ObjType , T0.Status FROM OOAT T0  WHERE  (T0.Status ='D') AND ISNULL(T0.U_LEVEL1,'N') = 'N' AND ISNULL(T0.U_LEVEL2,'N') = 'N' AND T0.EndDate > GETDATE() AND T0.AbsID NOT IN (93)
SELECT  T0.AbsID, T0.Number, T0.BpCode ,T0.BpName, T0.StartDate ,T0.updtDate FROM OOAT T0 WHERE t0.cancelled <>'y' and (T0.Status ='D' OR T0.Status ='F')  AND ISNULL(T0.U_LEVEL1,'N') = 'Y' AND ISNULL(T0.U_LEVEL2,'N') = 'N'
SELECT  T0.AbsID, T0.Number, T0.BpCode ,T0.BpName, T0.StartDate ,T0.ObjType  FROM OOAT T0 WHERE  (T0.Status ='D' OR T0.Status ='F')  AND ISNULL(T0.U_LEVEL1,'N') = 'R' AND ISNULL(T0.U_LEVEL2,'N') = 'N'
SELECT  T0.AbsID, T0.Number, T0.BpCode ,T0.BpName, T0.StartDate ,T0.ObjType  FROM OOAT T0 WHERE  (T0.Status ='D' OR T0.Status ='F')   AND ISNULL(T0.U_LEVEL1,'N') = 'Y' AND ISNULL(T0.U_LEVEL2,'N') = 'R'
SELECT  T0.AbsID, T0.Number, T0.BpCode ,T0.BpName, T0.StartDate ,T0.ObjType  FROM OOAT T0 WHERE  T0.Status ='A'  AND ISNULL(T0.U_LEVEL1,'N') = 'Y' AND ISNULL(T0.U_LEVEL2,'N') = 'Y'
SELECT T0.DocNum, T0.DocDate as 'Requested Date', T1.ItemCode, T1.Dscription, T1.Quantity AS 'Requested Qty',  T1.Quantity - T1.OpenQty as 'Transfered Qty', T1.OpenQty as 'Open Qty', T1.FromWhsCod , T1.WhsCode as 'To Whs', T2.RefDocNum as 'Prod Order No.',T3.U_NAME as 'Requested By'--, T0.Comments FROM OWTQ T0 INNER JOIN  WTQ1 T1 ON T0.DocEntry = T1.DocEntry LEFT JOIN WTQ21 T2 ON T2.DocEntry = T1.DocEntry INNER JOIN OUSR T3 ON T3.USERID = T0.UserSign  WHERE t1.FromWhsCod='MST' AND T1.OpenQty <> '0' and T1.LineStatus <> 'C' AND  T0.Docdate >'20230401' --AND T0.DocDate <= CONVERT(DATE, GETDATE()-1) ORDER BY T0.DOCENTRY DESC
SELECT T0.[DocNum], T0.[DocDate], T1.[ItemCode], T1.[Dscription], T1.[Quantity] FROM OIGN T0   INNER JOIN IGN1 T1 ON T0.[DocEntry] = T1.[DocEntry] INNER JOIN OITM T2 ON T1.ITEMCODE = T2.ITEMCODE where T1.[BaseRef]!='' AND T2.ITMSGRPCOD = 112 and t0.docdate = convert(date, getDate())  ORDER BY T0.DOCDATE
SELECT T0.[U_UTL_MCHCD], T0.[U_UTL_MCHNM], t0.CreateDate,t0.U_UTL_RPTB,T0.[U_UTL_RMRK] FROM [dbo].[@UTL_OBDS]  T0  where T0.[U_UTL_STAT] = '1' and  T0.[U_UTL_MCHCD] is not null
SELECT ROW_NUMBER() OVER(ORDER BY T0.[DocNum] ) As 'SR.NO',T0.DocEntry as 'Doc Entry',T0.[DocNum] As 'MRR No', T0.[DocDate] as 'MRR Date', T0.[CardCode] as 'Vendor Code', T0.[CardName] as 'Vendor Name', T0.[NumAtCard] as 'Bill No', t0.taxdate as 'Bill Date', (T0.doctotal - T0.vatsum) as 'Taxable Total' ,  T0.vatsum as 'Tax Total', t0.doctotal as 'Bill Amount', datediff(day,t0.docdate,getdate()) as 'Due Days' FROM OPDN T0  where t0.docstatus = 'O' AND t0.docdate >='20210401'  order by t0.docnum
SELECT T0.[DocNum], T0.[DocDate], T1.[ItemCode], T1.[Dscription], T1.[Quantity] FROM OIGN T0   INNER JOIN IGN1 T1 ON T0.[DocEntry] = T1.[DocEntry] INNER JOIN OITM T2 ON T1.ITEMCODE = T2.ITEMCODE where T1.[BaseRef]!='' AND t0.docdate = convert(date, getDate()-1)   and t2.ItmsGrpCod in ('112','103') and t1.ItemCode not like '231%%'   --and t2.itmsgrpcod !=107 and t2.U_SubGroup in ('ELEMENT ASSY' , 'UNPAINTED DAMPER ASSY', 'CAB DAMPER','hcv','STRUT ASSY', 'STRUT DAMPER','DICKY LIFTER','STEERING DAMPER','AIR BELLOW','TOP MOUNTING BUSH KIT','BOTTOM MOUNTING BUSH KIT','COIL SPRING','LCV SHOX','SPARE PARTS','RAILWAY S.A.','MONO TUBE','Finished Goods SubAssy')   order by t1.ItemCode
SELECT DISTINCT T0.[DocNum] as 'GRPO No',  CONVERT (DATE,T0.[DocDate],103) as 'GRPO Date', T0.[CardCode] as 'Vendor Code',  T0.[CardName] as 'Vendor Name',  T1.[ItemCode], T1.[Dscription], T0.[NumAtCard] as 'Bill No',   CONVERT (DATE,T0.Taxdate,103) as 'Bill Date', T1.[Quantity] as 'Billed Qty.',  T1.[U_UTL_RCQT], T1.[Price]as 'Unit Price' , T1.BaseDocNum as 'PO No.', CONVERT (DATE,T2.DocDate,103) 'PO Date', T0.U_POTY as 'PO Type' FROM OPDN T0   INNER JOIN PDN1 T1 ON T0.[DocEntry] = T1.[DocEntry] INNER JOIN POR1 T2 ON T2.DocEntry = T1.BaseEntry AND T2.LineNum = T1.BaseLine INNER JOIN OPOR T3 ON T3.DOCENTRY = T2.DocEntry  WHERE T0.DocDate = CONVERT(DATE, GETDATE()-1) ORDER BY T0.DocNum
SELECT DISTINCT T0.DocEntry As 'DocEntry',T0.[DocNum] as 'MRR NO', T0.[DocDate] as 'MRR Date', T0.[CardCode] as 'Vendor Code', T0.[CardName] as 'Vendor Name',T1.[ItemCode], T1.[Dscription], T1.[Quantity], DATEDIFF(DD,T0.DOCDATE,GETDATE()) as 'Due From Day'FROM [dbo].[OPDN]  T0   INNER JOIN [dbo].[PDN1]  T1 ON T0.[DocEntry] = T1.[DocEntry] LEFT JOIN [dbo].[@UTL_OQCHK]  T2 ON T0.DOCNUM=T2.U_UTL_GRDN   WHERE T2.U_UTL_GRDN is null AND T1.[WhsCode]='IQC' and t0.docstatus != 'c'  ORDER BY T0.DOCnum
SELECT T0.DocNum,T0.DocDate, T1.ShipDate,T0.CardName, T0.CardCode,  t0.numatcard as 'Party PO No', T0.DocDueDate, T1.ItemCode, T1.Dscription, T1.Quantity, T1.Price, T1.OpenQty,  T1.DelivrdQty   FROM  ORDR T0 INNER JOIN RDR1 T1 ON T1.DOCENTRY = T0.DOCENTRY WHERE T1.LINESTATUS = 'O'
SELECT T0.[DocNum] as 'Inovice No',T0.[DocDate] as 'Invoice Date', T0.[CardName] as 'Customer Name', T1.[ItemCode], T1.[Dscription], T1.[Quantity], T1.[Price] as 'Unit Price', T1.[LineTotal] as 'Taxable Total'  FROM OINV T0  INNER JOIN INV1 T1 ON T0.[DocEntry] = T1.[DocEntry]   Where t0.docdate = convert(date, getDate()-1)
SELECT T0.[Code],T0.[CreateDate], T0.[UpdateDate], t2.u_name as 'Created By',t1.u_name as 'Updated By',T0.[U_BOM_APPROVAL] FROM OITT T0 left join OUSR t1 on t0.UserSign2 = t1.USERID left join OUSR t2 on t0.UserSign = t2.USERID WHERE T0.[U_BOM_APPROVAL] = 'N' AND T0.[CreateDate]>='20230401'
SELECT t0.AcctCode,t0.AcctName, t0.CurrTotal, GETDATE() as 'Current Date' FROM OACT T0  where fathernum='122000000' and t0.acctcode not in (122001004,122001005,122001006)
select t0.U_UTL_TOOLCD, t0.U_UTL_TOOLNM, t0.u_utl_barloc as 'Location',T1.U_UTL_EXPDT from [@UTL_OCAP] T0 inner join [@UTL_CAP1] T1 on T0.DocEntry=T1.DocEntry where T1.U_UTL_EXPDT = DATEADD(Day,-15,GETDATE())
SELECT T0.[DocNum], T0.[DocDate], T1.[ItemCode], T1.[Dscription], T1.[Quantity], T1.[FromWhsCod], T1.[WhsCode],T0.[Comments] FROM OWTR T0  INNER JOIN WTR1 T1 ON T0.[DocEntry] = T1.[DocEntry]  where T1.[WhsCode]='Rej1' and t0.docdate = convert(date,getdate()-1) and t1.fromwhscod <> 'iqc1'  order by t0.docdate
SELECT  distinct t0.DocEntry, t0.DocNum, t0.CardCode, t0.CardName, t0.DocDate,t0.Comments FROM ODRF1 T0 inner join drf1 t1 on t0.DocEntry=t1.DocEntry   WHERE T0.ObjType ='17'   AND (T1.U_U_Del) IS NULL
SELECT t0.ACCTCODE, T0.ACCTNAME, T0.CURRTOTAL , GETDATE() As 'Current Date' FROM OACT T0 WHERE T0.ACCTCODE = '122001007'
SELECT t0.ACCTCODE, T0.ACCTNAME, T0.CURRTOTAL , GETDATE() As 'Current Date' FROM OACT T0 WHERE T0.ACCTCODE = '122001009'
select t0.U_UTL_TOOLCD, t0.U_UTL_TOOLNM, t0.u_utl_barloc as 'Location',T1.U_UTL_EXPDT from [@UTL_OCAP] T0 inner join [@UTL_CAP1] T1 on T0.DocEntry=T1.DocEntry where T1.U_UTL_EXPDT < DATEADD(Day,-15,GETDATE())
SELECT T0.[DocNum] as 'QC Doc No', T0.[U_UTL_PODT],T0.[U_UTL_SPCD], T0.[U_UTL_SPNM],  T0.[U_UTL_ITCD], T0.[U_UTL_ITNM],T0.[U_UTL_REJQ], t0.[U_UTL_REJRSN]    FROM [dbo].[@UTL_OQCHK]  T0   where T0.[U_UTL_REJQ] >=1 and T0.[U_UTL_PODT]= convert(date,getdate()-1)
SELECT OITW.ItemCode, oitm.itemname, oitw.whscode, OITW.OnHand,    OITW.maxStock  FROM         OITW INNER JOIN  OITM ON OITW.ItemCode = OITM.ItemCode  WHERE   OITW.OnHand>oitw.maxStock and oitw.maxstock != '0'
SELECT T0.[DocNum]as 'Doc No.', T0.[DocDate] as 'Doc Date', T1.[ItemCode], T1.[Dscription], T1.[Quantity], T1.STOCKPRICE as 'Unit Price', (T1.[Quantity] * T1.STOCKPRICE) AS 'Toal Amount', t2.u_weight as Weight, (t2.u_weight*T1.[Quantity]* 19.09) As 'Scrap Value(if Iron)', (T1.[Quantity] * T1.STOCKPRICE) - (t2.u_weight*T1.[Quantity]* 19.09) as 'Loss Amount', T0.[Comments]   FROM OWTR T0   INNER JOIN WTR1 T1 ON T0.[DocEntry] = T1.[DocEntry] inner join OITM t2 on t1.itemcode = t2.itemcode     where T1.[WhsCode]='scp1' and t0.docdate = convert(date,getdate()-1)   order by t0.docdate
Declare @ASONDATE varchar(20) Declare @Warehouse varchar(Max)  Set @ASONDATE =(Select Top 1 Convert(Varchar(10),S4.DocDate,112) from dbo.OINM S4 where S4.DocDate= CONVERT(date,getdate()) ) Set @Warehouse =(Select Top 1 S3.WhsCode from dbo.OWHS S3 where S3.WhsCode='ASM')   Exec [INV_AGING_PROD] @ASONDATE,@Warehouse
Declare @ASONDATE varchar(20) Declare @Warehouse varchar(Max)  Set @ASONDATE =(Select Top 1 Convert(Varchar(10),S4.DocDate,112) from dbo.OINM S4 where S4.DocDate= CONVERT(date,getdate()) ) Set @Warehouse =(Select Top 1 S3.WhsCode from dbo.OWHS S3 where S3.WhsCode='PKG')   Exec [INV_AGING_PROD] @ASONDATE,@Warehouse
SELECT T2.DOCNUM, T2.DOCDATE, T2.CardCode,T2.CardName, (T2.DocTotal-T2.VatSum)AS 'SALE AMOUNT', t1.Account, t1.Credit, (T1.Credit/(T2.DocTotal-T2.VatSum))*100 AS 'RMC'   FROM JDT1 T1  INNER JOIN oJDT T0 on t0.TransId=t1.TransId INNER JOIN ODLN T2 ON T0.BaseRef = T2.DocNum AND T0.TransType=T2.ObjType inner join  OINV T3 on t2.DocEntry = t3.DocEntry   WHERE  T2.DOCDATE = CONVERT(date,getdate()-1) AND T0.TransType='15' and t1.Account = '131401004'
SELECT T0.PostDate as 'Date', t0.ItemCode,T1.ItemName , T0.PlannedQty as 'Planed Quantity', T0.CmpltQty , T0.PlannedQty-T0.CmpltQty as 'Balance Qty', CASE WHEN T0.UserSign='14' THEN 'PLANED' ELSE 'UNPLANED' END AS 'STATUS'  FROM OWOR T0  INNER JOIN OITM T1 ON T0.ITEMCODE = T1.ITEMCODE inner join OUSR T2 on T0.UserSign = T2.USERID   WHERE  T0.PostDate = CONVERT(date,GETDATE()-1) AND T0.Type = 'S' --and    --AND      -- T1.ItmsGrpCod in ('103','100','112')   ---t1.U_SubGroup in ('ELEMENT ASSY' , 'UNPAINTED DAMPER ASSY', 'CAB DAMPER','hcv','STRUT ASSY', 'STRUT DAMPER','DICKY LIFTER','STEERING DAMPER','AIR BELLOW','TOP MOUNTING BUSH KIT','BOTTOM MOUNTING BUSH KIT','COIL SPRING','LCV SHOX','SPARE PARTS','RAILWAY S.A.','MONO TUBE','Finished Goods SubAssy')   order by t0.ItemCode
select DISTINCT cardname, DocNum as 'Invoice No', T0.DocDate as 'Invoice Date', DocDueDate as 'Due Date',  DocTotal as 'Amount in INR',[PaidToDate] as 'Received Amount', (DocTotal -[PaidToDate]) as 'Balance Amount',   DATEDIFF(DD,DocDueDate,GETDATE()) as 'Due from Day'   from OINV T0 INNER JOIN INV1 T1 ON T0.DocEntry = T1.DocEntry where DocStatus= 'o' and DocDueDate < GETDATE() and  DATEDIFF(DD,DocDueDate,GETDATE()) <> '0' AND T1.AcctCode='411001001'  order by [Due From Day] DESC
select t0.docnum, t0.DocDate, t0.CardName, t1.ItemCode, t1.Dscription, t1.Quantity from ORPC t0  inner join rpc1 t1 on t0.DocEntry=t1.DocEntry  where t0.DocType = 'i' and t0.DocDate = CONVERT(date,GETDATE()-1) and series='298'
SELECT T0.[DocNum], T0.[DocDate], T1.[ItemCode], T1.[Dscription], T1.[Quantity], T1.[FromWhsCod] FROM OWTR T0  INNER JOIN WTR1 T1 ON T0.[DocEntry] = T1.[DocEntry] WHERE T1.[WhsCode] = 'MST' AND  t0.docdate = convert(date, getDate()-1)
SELECT T0.[DocNum], T0.[DocDate], T1.[ItemCode], T1.[Dscription], T1.[Quantity] ,T1.[StockPrice] as 'Unit Price', T1.[Quantity] * T1.[StockPrice] as 'Total Price' FROM OWTR T0  INNER JOIN WTR1 T1 ON T0.[DocEntry] = T1.[DocEntry]  where T0.cardcode='V000081' and t0.docdate = convert(date, getDate()-1)
SELECT T0.[DocNum], T0.[CardName], T0.[DocDate], T1.[ItemCode], T1.[Dscription], T1.[Quantity], T1.[Price] ,T1.[Quantity]* T1.[Price] as 'Total Price'  FROM OIGN T0  INNER JOIN IGN1 T1 ON T0.[DocEntry] = T1.[DocEntry] where t1.itemcode like '201%' and t1.baseref is null and t0.docdate = convert(date, getDate()-1)
SELECT DISTINCT T0.[U_INVN] as 'RGP No', T1.DOCENTRY as 'Job Work No', T1.U_ORDT, T1.U_VDNM, T0.[U_CHCD] as 'Item Code', T0.[U_CHNM] as 'Item Name', T0.[U_PLQT] AS 'Sent Qty', isnull(T0.[U_ISQT],0) as 'Received Qty', T0.[U_PLQT]-isnull(T0.[U_ISQT],0)as 'Balance Qty' FROM [dbo].[@JWDETCHILD] T0 INNER JOIN [dbo].[@JWHD] T1 ON T0.DOCENTRY=T1.DOCENTRY  WHERE T1.U_HSTUS='o' and t1.u_vdnm = 'HEMA ENGINEERING INDUSTRIES LTD' and T0.u_INVN != ''   order by t1.u_ordt
SELECT T0.DocNum AS 'ORDER NO.', T0.ItemCode AS 'REQ ITEM CODE', T0.ProdName AS 'REQ ITEM NAME',t0.status FROM OWOR T0     WHERE T0.u_utl_aprvlprdforbom = 'N'  AND T0.PostDate > '20200401'  and t0.status not in ( 'L' , 'R','C')
SELECT DISTINCT T0.[DocEntry] as 'SAPEntry', T0.[DocNum] as 'GR NO', T0.[DocDate] as 'GR Date',T0.U_JVCD,T0.U_JVNM, T1.[ItemCode], T1.[Dscription], T1.[Quantity],  DATEDIFF(DD,T0.DOCDATE,GETDATE()) as 'Due From Day'FROM [dbo].[OIGN]  T0   INNER JOIN [dbo].[IGN1]  T1 ON T0.[DocEntry] = T1.[DocEntry] LEFT JOIN [dbo].[@UTL_OQCHK]  T2 ON T0.DOCNUM=T2.U_UTL_GINM WHERE T2.U_UTL_GINM is null  AND T1.[WhsCode]='IQC' and t0.docstatus != 'c' AND T0.DOCdate>'20230701' AND T0.U_SHWQCCHK <> 'N' and len(itemcode) = '11' and itemcode not like '9%%' and T0.U_JVCD is not null   ORDER BY T0.DOCnum
SELECT WhsCode AS 'WAREHOUSE',T0.ItemCode AS 'ITEM CODE',T1.ITEMNAME AS 'ITEM NAME', MinStock AS 'MIN STOCK',  T0.OnHand AS 'IN STOCK', (MinStock- T0. OnHand)AS 'SHORTAGE' ,[PENDING PO] FROM OITW T0 INNER JOIN OITM T1 ON T1.ItemCode=T0.ITEMCODE LEFT JOIN ( SELECT ITEMCODE, SUM(OPENQTY) AS [PENDING PO] FROM POR1 GROUP BY ItemCode)T2 ON T2.ITEMCODE = T1.ItemCode WHERE  MinStock != '0' AND (MinStock-T0.OnHand)>= '1' AND WhsCode='MST'  UNION ALL  SELECT WhsCode AS 'WAREHOUSE',T0.ItemCode AS 'ITEM CODE',T1.ITEMNAME AS 'ITEM NAME', MinStock AS 'MIN STOCK',  T0.OnHand AS 'IN STOCK', (MinStock- T0. OnHand)AS 'SHORTAGE' ,0 FROM OITW T0 INNER JOIN OITM T1 ON T1.ItemCode=T0.ITEMCODE WHERE  MinStock != '0' AND (MinStock-T0.OnHand)>= '1' AND WhsCode='BHJWH001'  ORDER BY T0.ITEMCODE
SELECT T0.[DocNum], T0.[DocDate], T0.[CardCode], T0.[CardName] FROM OPOR T0 WHERE T0.[U_LEVEL1] = 'Y' and T0.[U_LEVEL2] ='N' AND T0.[U_POTY] ='CLOSE' and T0.Docdate> '20200401'
SELECT DISTINCT T0.[U_INVN] as 'RGP No', T1.DOCENTRY as 'Job Work No', T1.U_ORDT, T1.U_VDNM, T0.[U_CHCD] as 'Item Code', T0.[U_CHNM] as 'Item Name', T0.[U_PLQT] AS 'Sent Qty', isnull(T0.[U_ISQT],0) as 'Received Qty', T0.[U_PLQT]-isnull(T0.[U_ISQT],0)as 'Balance Qty', DATEDIFF(DD,T1.U_ORDT,GETDATE()) as 'Due from Day'    FROM [dbo].[@JWDETCHILD] T0 INNER JOIN [dbo].[@JWHD] T1 ON T0.DOCENTRY=T1.DOCENTRY  WHERE T1.U_HSTUS='o' and   t1.u_vdnm = 'KD INDUSTRIES PVT LTD.' and T0.u_INVN != '' and  (T0.[U_PLQT]-isnull(T0.[U_ISQT],0))<>'0'   order by t1.u_ordt
SELECT T0.[ReqName] AS 'REQUESTED BY',T0.[DocNum] as 'DOCUMENT NO' ,  T0.[DocDate] as 'POSTING DATE',  T0.[ReqDate] AS 'REQUIRMENT DATE' FROM OPRQ T0 WHERE T0.U_PRLEVEL0='N' and t0.CANCELED<>'Y' AND T0.DOCDATE >GETDATE()-7 AND T0.[DocNum]  <> '4000352' AND T0.[DocNum]  <> '23241004'  ----AND T0.comments<>'Origin: MRP'   ORDER BY T0.[DocNum]
SELECT U_POTY 'PO TYPE',DocNum 'DOCUMENT NO ',CardName 'VENDOR NAME', DocTotal 'TOTAL AMOUNT', DocDate 'POSTING DATE', OCTG.PymntGroup,Comments'REMARKS'  FROM OPOR INNER JOIN OCTG ON OPOR.GroupNum=OCTG.GroupNum  WHERE DocStatus='o' and U_LEVEL1 = 'N' AND DOCDATE >='20210921'
SELECT U_POTY 'PO TYPE',DocNum 'DOCUMENT NO',CardName 'VENDOR NAME', DocTotal 'TOTAL AMOUNT', DocDate 'POSTING DATE', OCTG.PymntGroup,Comments'REMARKS'  FROM OPOR INNER JOIN OCTG ON OPOR.GroupNum=OCTG.GroupNum  WHERE U_LEVEL1 = 'Y' AND U_LEVEL2='N' AND docDate >='20210421' AND U_POTY='CLOSE'   and CARDCODE NOT IN ('V000451','V000643','V000199')
SELECT T0.DocNum,T0.CardName,   t0.numatcard as 'Party PO No',    T1.ItemCode, T1.Dscription,T1.Quantity, T1.DelivrdQty ,T1.OpenQty,T1.ShipDate as 'Delivery Date'   FROM  ORDR T0 INNER JOIN RDR1 T1 ON T1.DOCENTRY = T0.DOCENTRY WHERE T1.LINESTATUS = 'O' and t1.shipdate <= CONVERT(date,getdate()-15) ORDER BY T1.ShipDate
select T0.DocEntry,T0.U_UTL_DocDate,T0.U_UTL_CardName,T0.U_UTL_BPREF,T1.U_UTL_ITCD,t1.U_UTL_ITEMDESC,T1.U_UTL_QTY, case when T0.U_UTL_STATS='c' then 'DONE' else 'PENDING' END 'GRPO STATUS' from dbo.[@UTL_GE_OGIN] T0  inner join dbo.[@UTL_GE_GIN1] T1 on T0.DocEntry=T1.DocEntry  where t1.U_UTL_ITCD is not null AND T0.U_UTL_STATS <> 'X' and T0.U_UTL_DocDate=CONVERT(date,getdate()-1)
Select Docnum as 'GR NO', Docdate AS 'GR DATE', (select U_jvnm from OIGE where oige.docentry = oign.u_gise) as 'Vendor Name',  ref2 as 'Bill No.', U_LDDT as 'Taxble Amount' from  OIGN  where docentry not in (select distinct isnull(U_GRDE,0) from PCH1) and docdate >='20220401' and u_jbno <>''  order by docnum desc
select DISTINCT  T2.DocNum as 'RGP No', t2.docdate as 'RGP Date',T2.u_jbno,  case   when  T2.CardName = 'MISC. SUPPLIER'    then (case when t2.ShipToCode='haryana' Then 'S K ENGINEERS' else t2.ShipToCode end) else t2.CardName end As 'Job Worker Name',  T3.ITEMCODE, T3.DSCRIPTION, (select ISNULL(sum(z.Quantity),0) from WTR1 z inner join OWTR x on z.DocEntry=x.DocEntry  WHERE  z.ItemCode=T3.ItemCode and x.U_JBNO=t2.U_JBNO and x.docdate<=getdate()) as 'Send Qty',  (select ISNULL(sum(A.Quantity),0) from IGE1 A inner join oige B on a.DocEntry=b.DocEntry WHERE b.u_jwtr <>'yes' and --A.LineNum=T1.LINENUM AND  A.ItemCode=T3.ItemCode and b.U_JBNO=t0.U_JBNO and b.docdate<=getdate()) as 'Receive QTY' ,  (select ISNULL(sum(z.Quantity),0) from WTR1 z inner join OWTR x on z.DocEntry=x.DocEntry  WHERE  z.ItemCode=T3.ItemCode and x.U_JBNO=t2.U_JBNO and x.docdate<=getdate())  - (select ISNULL(sum(A.Quantity),0)  from IGE1 A inner join oige B on a.DocEntry=b.DocEntry WHERE b.u_jwtr <>'yes' and --A.LineNum=T1.LINENUM AND  A.ItemCode=T3.ItemCode and b.U_JBNO=t0.U_JBNO and b.docdate<=getdate()) as 'Balance QTY',   datediff(day,t2.docdate,getdate()) as 'Due Days'   from OWTR T2  INNER JOIN WTR1 T3 ON T2.DocEntry=T3.DocEntry LEFT OUTER JOIN OIGE T0 ON T2.U_JBNO = T0.U_JBNO LEFT OUTER JOIN IGE1 T1 ON T0.DocEntry = T1.DocEntry   WHERE T2.DOCNUM<>'940023673' AND T2.U_JBNO <> '' and T2.DOCDATE >= '20220401' and T2.DocDate<= convert(date, getDate()) and  (select ISNULL(sum(z.Quantity),0) from WTR1 z inner join OWTR x on z.DocEntry=x.DocEntry  WHERE  z.ItemCode=T3.ItemCode and x.U_JBNO=t2.U_JBNO and  x.docdate<=getdate())  - (select ISNULL(sum(A.Quantity),0) from IGE1 A inner join oige B on a.DocEntry=b.DocEntry WHERE b.u_jwtr <>'yes' and  --A.LineNum=T1.LINENUM AND  A.ItemCode=T3.ItemCode and b.U_JBNO=t0.U_JBNO and b.docdate<=getdate()) >= '.09' and datediff(day,t2.docdate,getdate()) >'150'  order by t2.u_jbno
SELECT DocEntry,DocNum as 'IQC No.',CreateDate,U_UTL_MODE AS 'Base', U_UTL_ANDT as 'Analysis Comp. Date', U_UTL_SPCD as 'BP Code',U_UTL_SPNM as 'Vendor Name', U_UTL_ITCD as 'Item No.',U_UTL_ITNM as 'Item Name', U_UTL_WHS as 'From Whs',U_UTL_APPW as 'T0 Whs', U_UTL_RCQT as 'Recv Qty',U_UTL_APPQ as 'OK Qty' FROM [@UTL_OQCHK]  WHERE CreateDate=convert(date,getdate()) AND U_UTL_APPW ='MST' AND  U_UTL_MODE='GRPO'
SELECT T0.DocEntry,T0.DocNum,T0.CreateDate FROM OWTR T0 WHERE Convert(Varchar(50),T0.createdate,103) = CONVERT(VARCHAR(50),GETDATE(),103) AND T0.DocTime between left((Cast(replace (Convert (nvarchar(30), GetDate(), 108), ':', '') as INT) - '100'),4)  AND left(Cast(replace (Convert (nvarchar(30), GetDate(), 108), ':', '') as INT),4) AND Filler='IQC'and ToWhsCode='MST'
SELECT DISTINCT  T0.ItemCode,T0.ItemName, ISNULL(T0.SuppSerial, T0.BatchNum) as 'Batch Num', T0.WhsCode, CONVERT(DATE,T0.InDate,103) AS 'InDate', T0.Quantity , T1.LastPurPrc , CONVERT(NUMERIC(10,2),(T0.Quantity * T1.LastPurPrc)) AS 'Value' FROM OIBT T0  INNER JOIN OITM T1 ON T1.ItemCode = T0.ItemCode WHERE T0.Quantity>0 and GETDATE()>=DATEADD(DD,1095,T0.InDate) AND T0.WhsCode='MST'
SELECT DISTINCT T0.[DocEntry] AS 'QC Entry',T0.[DocNum] as 'QC No',T0.[CreateDate], [U_UTL_ITCD] as 'Item Code', [U_UTL_ITNM] as 'Item Name', [U_UTL_MODE] as 'Base Type', T3.DocEntry AS 'GRPO Entry',T3.DOCNUM  AS 'GRPO NO.', T5.DocNum  AS 'Receipt No',  [U_UTL_SPCD] as 'CardCode', [U_UTL_SPNM] as 'Vendor Name',T0.[U_UTL_RCQT] as 'Receipt Qty',[U_UTL_APPQ] as 'Approved Qty', ISNULL(T0.[U_UTL_APPW], T0.U_UTL_REJW) as 'ToWhs', [U_UTL_REJQ] as 'Rej Qty',  [U_UTL_AIEN] as 'Tfr Entry' ,[U_UTL_AINO] as 'Tfr No.',T1.ItemCode,T1.Dscription,T1.Quantity, CASE WHEN [U_UTL_ITCD]<>T1.ItemCode and T0.U_UTL_MODE = 'GRPO'THEN 'MISMATCH'  ELSE 'MATCH' END AS  [Remark]    FROM [dbo].[@UTL_OQCHK] T0 LEFT JOIN WTR1 T1 ON T1.DocEntry=T0.[U_UTL_AIEN]  LEFT JOIN OPDN T3 ON T3.DocEntry = T0.[U_UTL_GRDE] LEFT JOIN PDN1 T2 ON T2.DocEntry=T3.DocEntry LEFT JOIN IGN1 T4 ON T4.DocEntry = T0.U_UTL_GINE LEFT JOIN OIGN T5 ON T5.DocEntry = T4. DocEntry       WHERE T0.[U_UTL_ITCD]<>T1.ItemCode AND T0.U_UTL_MODE = 'GRPO' AND T0.[CreateDate]>=GETDATE()-90  ORDER BY T0.[CreateDate]
SELECT DISTINCT T0.docnum 'Doc',T0.PostDate,T0.SysCloseDt AS 'Close Dt.',T0.Type, T0.ItemCode,T0.ProdName,T0.Project, T0.PlannedQty 'Planned Qty.',T0.CmpltQty as 'CmpltQty',T0.RjctQty, T0.PlannedQty-(T0.CmpltQty + T0.RjctQty) as 'Var Qty', A.value [Reciept Value], B.value [Issue Value],(ISNULL(A.value,0) + ISNULL(B.value,0) + ISNULL(c.value,0)) AS 'Variance Amt',  Case When T0.Status='L' THEN 'Closed' When T0.Status='R' THEN 'Released'  ELSE 'Open' end as 'Prod Status', T7.U_NAME as 'Created By', T8.U_NAME as 'Updated By'  FROM OWOR T0 LEFT JOIN (SELECT AppObjAbs, SUM(transvalue) AS value FROM oinm WHERE applobj = '202' AND transtype = 59 GROUP BY AppObjAbs) A ON T0.DOCENTRY = A.AppObjAbs  LEFT JOIN (SELECT AppObjAbs, SUM(transvalue) AS value FROM oinm WHERE applobj = '202' AND transtype = 60 GROUP BY AppObjAbs) B ON T0.DOCENTRY = B.appobjabs  LEFT JOIN (SELECT createdby, SUM(transvalue) AS value FROM oinm WHERE transtype = 202 GROUP BY Createdby) c ON T0.DOCENTRY = c.Createdby  LEFT JOIN (SELECT Distinct TransId,BaseRef,TransType,Ref1 FROM OJDT WHERE TransType ='202')T5 ON  T5.BaseRef = T0.DocNum and T0.ObjType =T5.TransType  LEFT JOIN (SELECT DISTINCT TransId FROM JDT1 WHERE ACCOUNT='515001003' GROUP BY TransId )T6 ON T6.TransId = T5.TransId   LEFT JOIN OUSR T7 ON T7.USERID = T0.UserSign   LEFT JOIN OUSR T8 ON T8.USERID = T0.UserSign2  WHERE T0.PostDate >='20230401'  AND (T0.PlannedQty-T0.CmpltQty + T0.RjctQty)>0
SELECT DISTINCT T0.[DocNum] as 'QC No',T0.[CreateDate] as 'IQC Dt.',T3.DocEntry AS 'GRPO Entry',T3.DOCNUM  AS 'GRPO NO.',T3.DocDate as 'GRPO Date',T3.CardCode AS 'BP Code' ,T3.CardName as 'BP Name',T4.ItemCode, T4.ItemName,T0.[U_UTL_RCQT] as 'Receipt Qty',[U_UTL_APPQ] as 'Approved Qty',ISNULL(T0.[U_UTL_APPW], T0.U_UTL_REJW) as 'ToWhs',[U_UTL_REJQ] as 'Rej Qty',U_UTL_REJW as 'Rej Whs',T7.DocEntry as 'A/P Entry',T7.DocNum as 'A/P Invoice' ------,T9.DocEntry  AS 'CR_NT Entry', T9.DocNum AS 'CR_NT Num'  FROM [dbo].[@UTL_OQCHK] T0 LEFT JOIN OPDN T3 ON T3.DocEntry = T0.[U_UTL_GRDE] LEFT JOIN OITM T4 ON T4.ItemCode= T0.[U_UTL_ITCD] LEFT JOIN PDN1 T2 ON T2.DocEntry=T3.DocEntry  LEFT JOIN PCH1 T6 ON T6.BaseEntry = T2.DocEntry AND T2.LineNum = T6.BASELINE  AND T6.BaseType = T2.ObjType LEFT JOIN OPCH T7 ON T7.DocEntry = T6.DocEntry LEFT JOIN RPC1 T8 ON T8.BaseEntry = T6.DocEntry LEFT JOIN ORPC T9 ON T9.DocEntry = T8.DocEntry   WHERE T0.[CreateDate]>'20220401' AND T0.[CreateDate]<GETDATE()-7  AND T0.U_UTL_MODE = 'GRPO' AND [U_UTL_REJQ] >0  and T0.[DocEntry] not in (62631, 75030)    AND T3.CANCELED <>'Y' AND T7.DocEntry IS NOT NULL AND T9.DocEntry IS NULL AND T7.CANCELED <>'Y'    ORDER BY T0.[CreateDate] DESC
SELECT DISTINCT T0.DocEntry as 'Doc Entry',T0.[DocNum] as 'Goods Recv', T0.[DocDate] as 'Recv Dt.', T1.[ItemCode], T1.[Dscription], T1.[Quantity] as 'Recv Qty', T1.[Price],T1.WhsCode as 'Recv Whs',  T1.StockPrice as 'Item Cost', T1.AcctCode 'Recv G/L', T2. DocNum as 'Goods Issue',T3.AcctCode AS 'Issue G/L',T3.[Quantity] as 'Issue Qty',T3.Whscode as 'Issue Whs', T3.Price, CASE WHEN T1.AcctCode = T3.AcctCode THEN 'G/L Match' else 'Not Match' END as 'G/L Match' FROM OIGN T0   INNER JOIN IGN1 T1 ON T0.[DocEntry] = T1.[DocEntry]  LEFT JOIN OIGE T2 ON T2.DocNum =T0.U_GISN LEFT JOIN IGE1 T3 ON T3.DocEntry=T2.DocEntry WHERE T0.[DocDate] >= GETDATE()-7 AND T0.[CANCELED] = 'N' AND T0.U_GISN IS NOT NULL AND T1.AcctCode <> T3.AcctCode  ORDER BY T0.DocDate
SELECT DISTINCT T0.DocNum 'Doc',T0.PostDate,T0.SysCloseDt AS 'Close Dt.',  CASE WHEN T0.Type ='S' THEN 'Std' ELSE 'Special' END AS 'Prod Type', T0.ItemCode,T0.ProdName,T0.Project, T0.PlannedQty 'Planned Qty.',T0.CmpltQty AS 'CmpltQty',T0.RjctQty, T0.PlannedQty-(T0.CmpltQty + T0.RjctQty) AS 'Var Qty', A.value [Reciept Value], B.value [Issue Value],(ISNULL(A.value,0) + ISNULL(B.value,0) + ISNULL(c.value,0)) AS 'Variance Amt',  Case When T0.Status='L' THEN 'Closed' When T0.Status='R' THEN 'Released'  ELSE 'Open' end as 'Prod Status', T7.U_NAME as 'Created By', T8.U_NAME as 'Updated By'  FROM OWOR T0 LEFT JOIN (SELECT AppObjAbs, SUM(transvalue) AS value FROM oinm WHERE applobj = '202' AND transtype = 59 GROUP BY AppObjAbs) A ON T0.DOCENTRY = A.AppObjAbs LEFT JOIN (SELECT AppObjAbs, SUM(transvalue) AS value FROM oinm WHERE applobj = '202' AND transtype = 60 GROUP BY AppObjAbs) B ON T0.DOCENTRY = B.appobjabs LEFT JOIN (SELECT createdby, SUM(transvalue) AS value FROM oinm WHERE transtype = 202 GROUP BY Createdby) c ON T0.DOCENTRY = c.Createdby  LEFT JOIN (SELECT Distinct TransId,BaseRef,TransType,Ref1 FROM OJDT WHERE TransType ='202')T5 ON  T5.BaseRef = T0.DocNum and T0.ObjType =T5.TransType  LEFT JOIN (SELECT DISTINCT TransId FROM JDT1 WHERE ACCOUNT='515001003' GROUP BY TransId )T6 ON T6.TransId = T5.TransId   LEFT JOIN OUSR T7 ON T7.USERID = T0.UserSign   LEFT JOIN OUSR T8 ON T8.USERID = T0.UserSign2  WHERE T0.PostDate >= '20230401'     AND T0.Status in ('L','R') AND  (ISNULL(A.value,0) + ISNULL(B.value,0) + ISNULL(c.value,0)) <> 0  AND T0.Type ='S' and T0.DocNum not in ('232402921','232403845','232404392')
SELECT DISTINCT T0.[DocNum] as 'MRR/GR NO', 'GRPO' as 'Document Type',T0.[DocDate] as 'MRR/GR Date', T0.[CardCode] as 'Vendor Code', T0.[CardName] as 'Vendor Name',T1.[ItemCode], T1.[Dscription], T1.[Quantity], DATEDIFF(DD,T0.DOCDATE,GETDATE()) as 'Due From Day'FROM [dbo].[OPDN]  T0   INNER JOIN [dbo].[PDN1]  T1 ON T0.[DocEntry] = T1.[DocEntry] LEFT JOIN [dbo].[@UTL_OQCHK]  T2 ON T0.DOCNUM=T2.U_UTL_GRDN   WHERE T2.U_UTL_GRDN IS NULL AND T1.[WhsCode]='IQC' and t0.docstatus != 'C'  UNION ALL  SELECT DISTINCT T0.[DocNum] as 'GR NO','Job Work', T0.[DocDate] as 'GR Date',T0.U_JVCD,T0.U_JVNM, T1.[ItemCode], T1.[Dscription], T1.[Quantity],  DATEDIFF(DD,T0.DOCDATE,GETDATE()) as 'Due From Day'FROM [dbo].[OIGN]  T0   INNER JOIN [dbo].[IGN1]  T1 ON T0.[DocEntry] = T1.[DocEntry] LEFT JOIN [dbo].[@UTL_OQCHK]  T2 ON T0.DOCNUM=T2.U_UTL_GINM WHERE T2.U_UTL_GINM is null  AND T1.[WhsCode]='IQC' and t0.docstatus != 'c' AND T0.DOCdate>'20230701' AND T0.U_SHWQCCHK <> 'N' and len(itemcode) = '11' and itemcode not like '9%%' and T0.U_JVCD is not null  UNION ALL  SELECT H1.DocNum as 'Recpt No.', 'Production Receipt', CONVERT (Date,T0.DocDate,103) AS 'Recpt Date' ,T0.[ItemCode],T0.[Dscription],T0.WhsCode, CONCAT('PROD ORDER - ',T0.BaseRef) as 'Prod Order No', T0.[Quantity],DATEDIFF(DD,T0.DOCDATE,GETDATE()) as 'Due From Day'              FROM [IGN1] T0   INNER JOIN OIGN H1 ON H1.DocEntry= T0.DocEntry   INNER JOIN OITW T1 ON T1.WhsCode=T0.WhsCode AND T1.ItemCode=T0.ItemCode   WHERE T0.BaseType='202' AND T1.OnHand >=T0.[Quantity] and T0.[ItemCode]    not in ('99900010000') and T0.DocDate >= getdate()-5    ORDER BY T0.[DocDate] desc
SELECT T0.[DocNum] ,T0.[DocDate] , T1.BaseRef ,T1.[ItemCode], T1.[Dscription],  T1.[Quantity] AS 'Qty/Value',T1.WhsCode, T7.U_NAME as 'Created By', T8.U_NAME as 'Updated By' ,'Goods Issuance' as 'Doc Type'  FROM OIGE T0   INNER JOIN IGE1 T1 ON T0.[DocEntry] = T1.[DocEntry]  LEFT JOIN OUSR T7 ON T7.USERID = T0.UserSign LEFT JOIN OUSR T8 ON T8.USERID = T0.UserSign2 WHERE T0.[DocDate] >='20230401' AND T0.[CANCELED] = 'N' AND T1.BaseType='202' AND T1.itemcode not IN ( 'P100100','P100200','P100300','P100400','P100500','P100600','P100700','P100800','P100900','P101000', 'P101100','P101200','P101300','P101400','P101500','P101600','P101700','P101800','P101900','P102000', 'P102100','P102200','P102300','P102400','P102500','P102600','SI0002') AND T1.WhsCode IN ('IQC','MST','SCP','REJ') AND T0.UserSign NOT IN (1)   UNION ALL  SELECT DISTINCT T0.DocNum 'Doc',T0.PostDate, CASE WHEN T0.Type ='S' THEN 'Std' ELSE 'Special' END AS 'Prod Type', T0.ItemCode,T0.ProdName, (ISNULL(A.value,0) + ISNULL(B.value,0) + ISNULL(c.value,0)) AS 'Variance Amt',  Case When T0.Status='L' THEN 'Closed' When T0.Status='R' THEN 'Released'  ELSE 'Open' end as 'Prod Status', T7.U_NAME as 'Created By', T8.U_NAME as 'Updated By','Production Variance' as 'Doc Type' FROM OWOR T0 LEFT JOIN (SELECT AppObjAbs, SUM(transvalue) AS value FROM oinm WHERE applobj = '202' AND transtype = 59 GROUP BY AppObjAbs) A ON T0.DOCENTRY = A.AppObjAbs LEFT JOIN (SELECT AppObjAbs, SUM(transvalue) AS value FROM oinm WHERE applobj = '202' AND transtype = 60 GROUP BY AppObjAbs) B ON T0.DOCENTRY = B.appobjabs LEFT JOIN (SELECT createdby, SUM(transvalue) AS value FROM oinm WHERE transtype = 202 GROUP BY Createdby) c ON T0.DOCENTRY = c.Createdby LEFT JOIN (SELECT Distinct TransId,BaseRef,TransType,Ref1 FROM OJDT WHERE TransType ='202')T5 ON  T5.BaseRef = T0.DocNum and T0.ObjType =T5.TransType LEFT JOIN (SELECT DISTINCT TransId FROM JDT1 WHERE ACCOUNT='515001003' GROUP BY TransId )T6 ON T6.TransId = T5.TransId  LEFT JOIN OUSR T7 ON T7.USERID = T0.UserSign LEFT JOIN OUSR T8 ON T8.USERID = T0.UserSign2 WHERE T0.PostDate >= '20230401'     AND T0.Status in ('L','R') AND  (ISNULL(A.value,0) + ISNULL(B.value,0) + ISNULL(c.value,0)) <> 0  AND T0.Type ='S'
SELECT DISTINCT P1.DocNum,P1.ItemCode, P1.ProdName, T0.PlannedQty,T0.PostDate,T0.Status,T0.Project, T7.U_NAME as 'Created By', T8.U_NAME as 'Updated By',T0.U_UTL_APPVL  FROM AWOR T0 INNER JOIN OWOR P1 ON P1.DocEntry = T0.DocEntry LEFT JOIN OUSR T7 ON T7.USERID = T0.UserSign LEFT JOIN OUSR T8 ON T8.USERID = T0.UserSign2 WHERE T0.CreateDate>='20230401' AND T0.Type='P' AND T0.UserSign NOT IN (1,80,34)   ORDER BY P1.DocNum DESC
SELECT T0.DocEntry,T0.DocNum,T0.DocDate,T0.U_UTL_QCNO,QC.DocNum, T1.ItemCode,T1.Dscription, T1.Quantity,U1.U_NAME         FROM OWTR T0          INNER JOIN WTR1 T1 ON T1.DocEntry = T0.DocEntry         LEFT JOIN [@UTL_OQCHK] QC ON QC.DocEntry = T0.U_UTL_QCNO   INNER JOIN OUSR U1 ON U1.USERID = T0.UserSign         WHERE T0.DocDate> = '20230816'         AND T0.UserSign IN (70, 67, 65)   ORDER BY T0.DocEntry desc
SELECT T0.ItemCode,T0.ItemName, T2.ItmsGrpNam,T2.ItmsGrpCod, ISNULL(T0.SuppSerial, T0.BatchNum) as 'Batch Num', T0.WhsCode, T0.InDate, T0.Quantity ,  DATEDIFF(DAY,T0.InDate,GETDATE()) as 'Inward Days' FROM OIBT T0  INNER JOIN OITM T1 ON T1.ItemCode = T0.ItemCode INNER JOIN OITB T2 ON T2.ItmsGrpCod = T1.ItmsGrpCod WHERE T0.Quantity>0 and GETDATE()>=DATEADD(DD,61,T0.InDate) and T0.WhsCode in ('ASM','PWH','FGW','PKG')  AND T2.ItmsGrpCod IN (100,112,138,103)  ORDER BY T0.WhsCode , T0.ItemCode
SELECT distinct T0.DocNum as 'PO No.',T0.U_POTY, T0.[DocDate],T0.DocDueDate as 'Delivery Dt.', YEAR(T0.DocDueDate) as 'Year', CASE WHEN DATEDIFF(DAY,T1.ShipDate,GETDATE())>0 THEN 'Delv Failed' ELSE 'Balance Delv' end as 'Delivery Status', T1.ShipDate,T0.[CardName], T1.[ItemCode] ,  T1.[Dscription], T6.ItmsGrpNam, T1.[Quantity], (T1.[Quantity] -  T1.[OpenQty]) as 'Received Qty', T1.[OpenQty], T1.[Quantity] * t1.Price as 'PO Value',T1.[OpenQty] * t1.Price as 'Bal PO Value'  FROM OPOR T0    LEFT JOIN POR1 T1 ON T0.DocEntry = T1.DocEntry    LEFT JOIN OWDD T2 ON T0.DocEntry = T2.DocEntry   LEFT JOIN WDD1 T3 ON T2.WddCode = T3.WddCode  INNER JOIN OCRD T4 ON T4.CardCode = T0.CardCode LEFT JOIN ( SELECT [GroupNum],PymntGroup FROM OCTG)T9 ON T0.GroupNum = T9.[GroupNum]  LEFT JOIN OITM T5 ON T5.ItemCode = T1.ItemCode LEFT JOIN OITB T6 ON T6.ItmsGrpCod = T5.ItmsGrpCod  WHERE T0.Docstatus = 'O' AND T0.Canceled <> 'Y'  and T1.LineStatus='O'  and T0.DocType <> 'S'        AND DATEDIFF(DAY,T1.ShipDate,GETDATE())>0 ORDER BY T0.[DocDate]
SELECT DISTINCT T0.[DocNum] as 'PR No.', T0.[DocDate] as 'PR Date',  T1.[ItemCode], T1.[Dscription],T1.[OpenQty], T1.[PQTReqDate] as 'Req Date',   T0.ReqName as 'Requested By', Case When T0.U_PRLEVEL0='Y' THEN 'OK' When T0.U_PRLEVEL0='R' THEN 'Rej' ELSE 'Pending' END AS 'Checked By MD', DATEDIFF(DAY,T0.DocDate,GETDATE()) as 'Pending Days', T1.LineVendor, T1.FreeTxt as 'Line Remarks' FROM OPRQ T0   INNER JOIN PRQ1 T1 ON T0.[DocEntry] = T1.[DocEntry]  INNER JOIN OUSR T2 ON T0.[UserSign] = T2.[USERID]  LEFT JOIN OITW T3 ON T3.ItemCode = T1.ItemCode LEFT JOIN OITM T4 ON T4.ItemCode= T1.ItemCode WHERE T1.[LineStatus] ='O' AND T0.U_PRLEVEL0='Y' AND T0.UserSign IN (1) AND DocNum NOT IN (23241153)  ORDER BY T0.[DocDate]
SELECT T0.DocEntry,T0.DocNum,T0.DocDate, T1.ItemCode, T1.Dscription, T1.Quantity, T1.PQTReqDate as 'Req Date' FROM OPRQ T0 INNER JOIN PRQ1 T1 ON T1.DocEntry = T0.DocEntry WHERE T0.U_PRLEVEL0 IN ('Y','R') AND T0.UserSign IN (1) AND        CONVERT(VARCHAR(50),T0.UpdateDate,103) = CONVERT(VARCHAR(50),GETDATE(),103)        AND T0.DocTime BETWEEN LEFT((CAST(REPLACE (CONVERT (NVARCHAR(30), GETDATE(), 108), ':', '') as INT)-'100'),4)      AND LEFT(CAST(REPLACE (CONVERT (NVARCHAR(30), GETDATE(), 108), ':', '') as INT),4)
SELECT T0.DocEntry,T0.DocNum,T0.DocDate, T1.ItemCode, T1.Dscription, T1.Quantity, T1.PQTReqDate as 'Req Date' FROM OPRQ T0 INNER JOIN PRQ1 T1 ON T1.DocEntry = T0.DocEntry WHERE T0.U_PRLEVEL0 IN ('Y','R') AND T0.UserSign IN (28,29,78) AND        CONVERT(VARCHAR(50),T0.UpdateDate,103) = CONVERT(VARCHAR(50),GETDATE(),103)        AND T0.DocTime BETWEEN LEFT((CAST(REPLACE (CONVERT (NVARCHAR(30), GETDATE(), 108), ':', '') as INT)-'100'),4)      AND LEFT(CAST(REPLACE (CONVERT (NVARCHAR(30), GETDATE(), 108), ':', '') as INT),4)
SELECT T0.DocEntry,T0.DocNum,T0.DocDate, T1.ItemCode, T1.Dscription, T1.Quantity, T1.PQTReqDate as 'Req Date' FROM OPRQ T0 INNER JOIN PRQ1 T1 ON T1.DocEntry = T0.DocEntry WHERE T0.U_PRLEVEL0 IN ('Y','R') AND T0.UserSign IN (12,19,60,68,73) AND        CONVERT(VARCHAR(50),T0.UpdateDate,103) = CONVERT(VARCHAR(50),GETDATE(),103)        AND T0.DocTime BETWEEN LEFT((CAST(REPLACE (CONVERT (NVARCHAR(30), GETDATE(), 108), ':', '') as INT)-'100'),4)      AND LEFT(CAST(REPLACE (CONVERT (NVARCHAR(30), GETDATE(), 108), ':', '') as INT),4)
SELECT T0.DocEntry,T0.DocNum,T0.DocDate, T1.ItemCode, T1.Dscription, T1.Quantity, T1.PQTReqDate as 'Req Date' FROM OPRQ T0 INNER JOIN PRQ1 T1 ON T1.DocEntry = T0.DocEntry WHERE T0.U_PRLEVEL0 IN ('Y','R') AND T0.UserSign IN (11) AND        CONVERT(VARCHAR(50),T0.UpdateDate,103) = CONVERT(VARCHAR(50),GETDATE(),103)        AND T0.DocTime BETWEEN LEFT((CAST(REPLACE (CONVERT (NVARCHAR(30), GETDATE(), 108), ':', '') as INT)-'100'),4)      AND LEFT(CAST(REPLACE (CONVERT (NVARCHAR(30), GETDATE(), 108), ':', '') as INT),4)
SELECT T0.DocEntry,T0.DocNum,T0.DocDate, T1.ItemCode, T1.Dscription, T1.Quantity, T1.PQTReqDate as 'Req Date' FROM OPRQ T0 INNER JOIN PRQ1 T1 ON T1.DocEntry = T0.DocEntry WHERE T0.U_PRLEVEL0 IN ('Y','R') AND T0.UserSign IN (23,32,39) AND        CONVERT(VARCHAR(50),T0.UpdateDate,103) = CONVERT(VARCHAR(50),GETDATE(),103)        AND T0.DocTime BETWEEN LEFT((CAST(REPLACE (CONVERT (NVARCHAR(30), GETDATE(), 108), ':', '') as INT)-'100'),4)      AND LEFT(CAST(REPLACE (CONVERT (NVARCHAR(30), GETDATE(), 108), ':', '') as INT),4)
SELECT T0.DocEntry,T0.DocNum,T0.DocDate, T1.ItemCode, T1.Dscription, T1.Quantity, T1.PQTReqDate as 'Req Date' FROM OPRQ T0 INNER JOIN PRQ1 T1 ON T1.DocEntry = T0.DocEntry WHERE T0.U_PRLEVEL0 IN ('Y','R') AND T0.UserSign IN (71,72,80) AND        CONVERT(VARCHAR(50),T0.UpdateDate,103) = CONVERT(VARCHAR(50),GETDATE(),103)        AND T0.DocTime BETWEEN LEFT((CAST(REPLACE (CONVERT (NVARCHAR(30), GETDATE(), 108), ':', '') as INT)-'100'),4)      AND LEFT(CAST(REPLACE (CONVERT (NVARCHAR(30), GETDATE(), 108), ':', '') as INT),4)
SELECT DISTINCT T0.[DocNum] as 'PR No.', T0.[DocDate] as 'PR Date',  T1.[ItemCode], T1.[Dscription],T1.[OpenQty], T1.[PQTReqDate] as 'Req Date',   T0.ReqName as 'Requested By', Case When T0.U_PRLEVEL0='Y' THEN 'OK' When T0.U_PRLEVEL0='R' THEN 'Rej' ELSE 'Pending' END AS 'Checked By MD', DATEDIFF(DAY,T0.DocDate,GETDATE()) as 'Pending Days', T1.LineVendor, T1.FreeTxt as 'Line Remarks' FROM OPRQ T0   INNER JOIN PRQ1 T1 ON T0.[DocEntry] = T1.[DocEntry]  INNER JOIN OUSR T2 ON T0.[UserSign] = T2.[USERID]  LEFT JOIN OITW T3 ON T3.ItemCode = T1.ItemCode LEFT JOIN OITM T4 ON T4.ItemCode= T1.ItemCode WHERE T1.[LineStatus] ='O' AND T0.U_PRLEVEL0='Y' AND T0.UserSign IN (12,28,29,70) AND DocNum NOT IN (23241153)  ORDER BY T0.[DocDate]
SELECT DISTINCT T0.[DocNum] as 'PR No.', T0.[DocDate] as 'PR Date',  T1.[ItemCode], T1.[Dscription],T1.[OpenQty], T0.ReqName as 'Requested By', Case When T0.U_PRLEVEL0='Y' THEN 'OK' When T0.U_PRLEVEL0='R' THEN 'Rej' ELSE 'Pending' END AS 'Checked By MD',T1.PQTReqDate, DATEDIFF(DAY,T1.PQTReqDate,GETDATE()) as 'Pending Days', T1.LineVendor, T1.FreeTxt as 'Line Remarks' FROM OPRQ T0   INNER JOIN PRQ1 T1 ON T0.[DocEntry] = T1.[DocEntry]  INNER JOIN OUSR T2 ON T0.[UserSign] = T2.[USERID]  LEFT JOIN OITW T3 ON T3.ItemCode = T1.ItemCode LEFT JOIN OITM T4 ON T4.ItemCode= T1.ItemCode  WHERE T1.[LineStatus] ='O' AND T0.U_PRLEVEL0='Y' AND T0.UserSign IN (19,60,68)  and DATEDIFF(DAY,T1.PQTReqDate,GETDATE()) > 0  ORDER BY DATEDIFF(DAY,T1.PQTReqDate,GETDATE()) DESC
SELECT DISTINCT T0.[DocNum] as 'PR No.', T0.[DocDate] as 'PR Date',  T1.[ItemCode], T1.[Dscription],T1.[OpenQty], T1.[PQTReqDate] as 'Req Date',   T0.ReqName as 'Requested By', Case When T0.U_PRLEVEL0='Y' THEN 'OK' When T0.U_PRLEVEL0='R' THEN 'Rej' ELSE 'Pending' END AS 'Checked By MD', DATEDIFF(DAY,T0.DocDate,GETDATE()) as 'Pending Days', T1.LineVendor, T1.FreeTxt as 'Line Remarks' FROM OPRQ T0   INNER JOIN PRQ1 T1 ON T0.[DocEntry] = T1.[DocEntry]  INNER JOIN OUSR T2 ON T0.[UserSign] = T2.[USERID]  LEFT JOIN OITW T3 ON T3.ItemCode = T1.ItemCode LEFT JOIN OITM T4 ON T4.ItemCode= T1.ItemCode WHERE T1.[LineStatus] ='O' AND T0.U_PRLEVEL0='Y' AND T0.UserSign IN (71,72,80) AND DocNum NOT IN (23241153)  ORDER BY T0.[DocDate]
SELECT DISTINCT T0.[DocNum] as 'PR No.', T0.[DocDate] as 'PR Date',  T1.[ItemCode], T1.[Dscription],T1.[OpenQty], T1.[PQTReqDate] as 'Req Date',   T0.ReqName as 'Requested By', Case When T0.U_PRLEVEL0='Y' THEN 'OK' When T0.U_PRLEVEL0='R' THEN 'Rej' ELSE 'Pending' END AS 'Checked By MD', DATEDIFF(DAY,T0.DocDate,GETDATE()) as 'Pending Days', T1.LineVendor, T1.FreeTxt as 'Line Remarks' FROM OPRQ T0   INNER JOIN PRQ1 T1 ON T0.[DocEntry] = T1.[DocEntry]  INNER JOIN OUSR T2 ON T0.[UserSign] = T2.[USERID]  LEFT JOIN OITW T3 ON T3.ItemCode = T1.ItemCode LEFT JOIN OITM T4 ON T4.ItemCode= T1.ItemCode WHERE T1.[LineStatus] ='O' AND T0.U_PRLEVEL0='Y' AND T0.UserSign IN (23,32,39) AND DocNum NOT IN (23241153)  ORDER BY T0.[DocDate]
SELECT DISTINCT T0.[DocNum] as 'PR No.', T0.[DocDate] as 'PR Date',  T1.[ItemCode], T1.[Dscription],T1.[OpenQty], T1.[PQTReqDate] as 'Req Date',   T0.ReqName as 'Requested By', Case When T0.U_PRLEVEL0='Y' THEN 'OK' When T0.U_PRLEVEL0='R' THEN 'Rej' ELSE 'Pending' END AS 'Checked By MD', DATEDIFF(DAY,T0.DocDate,GETDATE()) as 'Pending Days', T1.LineVendor, T1.FreeTxt as 'Line Remarks' FROM OPRQ T0   INNER JOIN PRQ1 T1 ON T0.[DocEntry] = T1.[DocEntry]  INNER JOIN OUSR T2 ON T0.[UserSign] = T2.[USERID]  LEFT JOIN OITW T3 ON T3.ItemCode = T1.ItemCode LEFT JOIN OITM T4 ON T4.ItemCode= T1.ItemCode WHERE T1.[LineStatus] ='O' AND T0.U_PRLEVEL0='Y' AND T0.UserSign IN (11,73)   ORDER BY T0.[DocDate]
SELECT DISTINCT T0.DocEntry AS 'RecpEntry',T0.DocNum as 'Receipt No.',T0.DocDate,  T1.ItemCode, T1.Dscription, T1.Quantity, T1.BaseRef AS 'Prod Entry No.', T0.Comments FROM OIGN T0 INNER JOIN IGN1 T1 ON T1.DocEntry = T0.DocEntry WHERE T1.BaseType='202' AND T0.UserSign NOT IN (1) AND T1.ItemCode NOT IN ('99900010000') AND T1.WhsCode = 'IPQA'        AND CONVERT(VARCHAR(50),T0.CreateDate,103) = CONVERT(VARCHAR(50),GETDATE(),103)        AND T0.DocTime BETWEEN LEFT((CAST(REPLACE (CONVERT (NVARCHAR(30), GETDATE(), 108), ':', '') as INT)-'100'),4)      AND LEFT(CAST(REPLACE (CONVERT (NVARCHAR(30), GETDATE(), 108), ':', '') as INT),4) ORDER BY T0.DocEntry DESC
SELECT T0.BatchNum, T0.ItemCode,T0.ItemName,T0.InDate, T0.Quantity FROM OIBT T0  INNER JOIN OITM T1 ON T1.ItemCode = T0.ItemCode WHERE Quantity>0 AND T1.ItmsGrpCod =103
SELECT H1.DocNum as 'Recpt No.', CONVERT (Date,T0.DocDate,103) AS 'Recpt Date' ,T0.[ItemCode],T0.[Dscription],T0.WhsCode, T0.BaseRef as 'Prod Order No', T0.[Quantity],DATEDIFF(DD,T0.DOCDATE,GETDATE()) as 'Due From Day'              FROM [IGN1] T0   INNER JOIN OIGN H1 ON H1.DocEntry= T0.DocEntry   INNER JOIN OITW T1 ON T1.WhsCode=T0.WhsCode AND T1.ItemCode=T0.ItemCode   WHERE T0.BaseType='202' AND T1.OnHand >=T0.[Quantity] and T0.[ItemCode]    not in ('99900010000') and T0.WhsCode ='[%0]' AND T0.DocDate >= GETDATE() - 30    ORDER BY T0.[DocDate] desc
DECLARE @FROMDATE DateTime DECLARE @TODATE  DateTime  SET @FROMDATE=(SELECT MIN(S0.RefDate) FROM DBO.OJDT S0 WHERE S0.RefDate >=[%0]) SET @TODATE=(SELECT MAX(S1.RefDate) FROM DBO.OJDT S1 WHERE S1.RefDate <=[%1])   SELECT T0.[DocNum], T0.[DocDate], T0.[CardCode], T0.[CardName], T0.[NumAtCard] as 'Invoice No', T0.[TaxDate] as 'Invoice Date',   CASE WHEN T0.DOCTYPE='I' THEN 'ITEM' ELSE 'SERVICE' END As 'Types of Goods ',   (t0.DocTotal-t0.VatSum+t0.WTSum)as 'Taxable' ,t0.vatsum as 'GST Amount', T0.[DocTotal],T0.[BaseAmnt] as 'TDS Base Amount',T0.[WTSum] as 'TDS amount',  T2.[OffclCode] as 'Section',  T1.[Rate],  Isnull((Select Top 1 TaxId0 From CRD7 Where T0.CardCode=CRD7.CardCode And Isnull(TaxId0,'')<>''),'') As 'PAN No' FROM OPCH T0   left JOIN PCH5 T1 ON T0.[DocEntry] = T1.[AbsEntry] left join owht t2 on t1.wtcode=t2.wtcode Where T0.DocDate Between @Fromdate And @ToDate and t0.Canceled<>'y' and t0.canceled<>'c'
Declare @FromDT Varchar(20) Declare @ToDT Varchar(20) Select @FromDT = T0.DocDate from oPCH T0 where T0.DocDate = '[%0]' Select @ToDT =  T0.DocDate from oPCH T0 where T0.DocDate = '[%1]'       SELECT T0.[DocNum] As 'A/P Invoice No', T0.[DocDate] as 'A/P Invoice Date', Case When T0.Doctype='I'  THEN  T1.BaseDocNum ELSE ' '  END  'MRR NO' ,OPDN.DocDate As 'MRR Date', T0.NUMATCARD as 'Bill No',  case when t1.visorder=0 then   T0.[BaseAmnt] else 0 end 'TDS Base Amount', case when t1.visorder=0 then   T0.wtsum else 0 end 'TDS Amount', case when t1.visorder=0 then   PCH5.RATE else 0 end 'TDS Rate', case when t1.visorder=0 then   OWHT.OffclCode else 'null' end 'Section', t1.WtLiable, T0.TAXDATE AS 'Bill Date', T0.[CardCode], T0.[CardName], T12.BPGSTN AS 'GSTIN No.',T1.[ItemCode], T1.[Dscription], Case When T0.Doctype='I' Then OCHP.Dscription else OSAC.ServCode END 'HSN/SAC',T1.unitMsr As 'UOM', T1.[Quantity], (T1.[Price])  AS         [UNIT PRICE],  T1.[LineTotal] As 'Taxable Value', ISNULL((SELECT TOP 1 ISNULL(TAXRATE,0) FROM PCH4 WHERE  PCH4.DOCENTRY = T1.DocEntry         AND PCH4.STATYPE   IN ('-100') AND PCH4.RELATETYPE = 1 and PCH4.LINENUM=T1.LineNum) ,0) AS CGSTRATE,  ISNULL((SELECT CASE WHEN SUM(PCH4.RvsChrgPrc)!=0                             THEN ((Case When T0.DocCur = 'INR' Then  SUM(PCH4.TaxSum) Else Sum(PCH4.TaxSumFrgn) End) - (Case When T0.DocCur = 'INR' Then SUM(PCH4.RvsChrgTax) Else Sum(PCH4.RvsChrgFC) End))                                   ELSE (Case When T0.DocCur ='INR' Then  SUM(PCH4.TaxSum) Else Sum(PCH4.TaxSumFrgn) End) END  FROM PCH4 WHERE PCH4.DOCENTRY = T1.DOCENTRY AND   PCH4.STATYPE = '-110' AND PCH4.LINENUM=T1.LINENUM AND PCH4.RELATETYPE = 1),0)   AS CGSTAMNT, ISNULL((SELECT TOP 1 ISNULL(TAXRATE,0) FROM PCH4 WHERE  PCH4.DOCENTRY =  t1.DOCENTRY AND PCH4.STATYPE   IN ('-110','-150') AND PCH4.RELATETYPE = 1 and PCH4.LINENUM=T1.LINENUM) ,0) AS SGSTRATE,   ISNULL((SELECT CASE WHEN SUM(PCH4.RvsChrgPrc)!=0                             THEN ((Case When T0.DocCur = 'INR' Then  SUM(PCH4.TaxSum) Else Sum(PCH4.TaxSumFrgn) End) - (Case When T0.DocCur = 'INR' Then SUM(PCH4.RvsChrgTax) Else Sum(PCH4.RvsChrgFC) End))                                   ELSE (Case When T0.DocCur ='INR' Then  SUM(PCH4.TaxSum) Else Sum(PCH4.TaxSumFrgn) End) END  FROM PCH4 WHERE PCH4.DOCENTRY = T1.DOCENTRY AND   PCH4.STATYPE IN ('-110','-150') AND PCH4.LINENUM=T1.LINENUM AND PCH4.RELATETYPE = 1),0)   AS SGSTAMNT, ISNULL((SELECT TOP 1 ISNULL(TAXRATE,0) FROM PCH4 WHERE  PCH4.DOCENTRY =  T1.DOCENTRY AND PCH4.STATYPE   IN ('-120') AND PCH4.RELATETYPE = 1 AND PCH4.LineNum = T1.LineNum) ,0) AS IGSTRATE,    ISNULL((SELECT CASE WHEN SUM(PCH4.RvsChrgPrc)!=0 THEN         ((Case When T0.DocCur = 'INR' Then  SUM(PCH4.TaxSum) Else Sum(PCH4.TaxSumFrgn) End) - (Case When T0.DocCur = 'INR' Then SUM(PCH4.RvsChrgTax) Else Sum(PCH4.RvsChrgFC) End)) ELSE (Case When T0.DocCur = 'INR' Then  SUM(PCH4.TaxSum) Else Sum(PCH4.TaxSumFrgn) End) END            FROM PCH4 WHERE PCH4.DOCENTRY = T1.DOCENTRY AND   PCH4.STATYPE = '-120'AND PCH4.LINENUM=T1.LINENUM AND  PCH4.RELATETYPE = 1),0) AS IGSTAMNT,T1.[LineTotal]+T1.VatSum As 'Line Total',T3.GROUPNAME ,Case When T0.Doctype='I' Then 'Item' else 'Service' END 'Document Type' , CASE WHEN T0.DOCTYPE='I' THEN OITM.U_ITTYPE ELSE 'SERVICE' END As 'Types of Goods ',T5.acctname AS 'ACCOUNT NAME' , OITM.[ItmsGrpCod], OITB.[ItmsGrpNam]                          FROM oPCH T0   left JOIN PCH5 ON T0.[DocEntry] = PCH5.[AbsEntry] left join owht  on pch5.wtcode=OWHT.wtcode INNER JOIN PCH1 T1 ON T0.[DocEntry] = T1.[DocEntry] INNER JOIN PCH12 T12 ON T0.[DocEntry] = T12.[DocEntry] inner join ocrd t2 on t0.cardcode = t2.cardcode INNER JOIN OCRG T3 ON T2.GROUPCODE=T3.GROUPCODE inner join oact t5 on t1.acctcode = t5.acctcode Left join opdn on  opdn.Docnum=T1.BaseDocNum LEFT join OITM on T1.itemcode=OITM.ITEMcode  LEFT JOIN OITB ON OITM.[ItmsGrpCod] = OITB.[ItmsGrpCod]  LEFT join OSAC on OSAC.AbsEntry=t1.SacEntry LEFT join OCHP on OCHP.AbsEntry=T1.HsnEntry LEFT JOIN PCH4  D_IGST ON T1.DocEntry = D_IGST.DocEntry AND T1.LineNum = D_IGST.LineNum AND D_IGST.staType = -120 AND D_IGST.RelateType = 1          LEFT JOIN PCH4  D_CGST ON T1.DocEntry = D_CGST.DocEntry AND T1.LineNum = D_CGST.LineNum AND D_CGST.staType = -100 AND D_CGST.RelateType = 1          LEFT JOIN PCH4  D_SGST ON T1.DocEntry = D_SGST.DocEntry AND T1.LineNum = D_SGST.LineNum AND D_SGST.staType = -110 AND D_SGST.RelateType = 1   WHERE  T0.CANCELED <> 'Y'  AND T0.CANCELED <> 'C' AND T0.DOCDATE   Between '[%0]' and '[%1]'
select   '1.01' as Version,      'GST' as TaxSch,      case when T12.ImpORExp = 'N' or T12.ImpORExp is null then  'B2B'       else case T12.ExportType when 'D' then 'DEXP'                                   when 'E' then case when TInPayment.DocNum is null and TOutPayment.DocNum is null then 'EXPWOP' else 'EXPWP' end           else case when TInPayment.DocNum is null and TOutPayment.DocNum is null then 'SEZWOP' else 'SEZWP' end                    end     end as SubType,      case T0.GSTTranTyp when 'GA' then 'INV' when 'GD' then 'DBN' else 'N/A' end as Typ,   case when T0.DocNum is null or T0.DocNum = '' then 'N/A' else T0.DocNum end as No,   CONVERT(VARCHAR(10), T0.TaxDate, 103) as DocDate,   case when T12.LocGSTN is null or T12.LocGSTN = '' then 'N/A' else T12.LocGSTN end as SellerGSTIN,   (select (case when OADM.CompnyName is null or OADM.CompnyName = '' then 'N/A' else OADM.CompnyName end) from OADM) as SellerLglNm,   (select (case when OADM.CompnyAddr is null or OADM.CompnyAddr = '' then 'N/A' else left(replace(replace(OADM.CompnyAddr, char(10),' '), char(13), ' '), 100) end) from OADM) as SellerAddr1,   case when TSellerLoc.Location is null then 'N/A' else left(TSellerLoc.Location, 50) end as SellerLoc,   case when TSellerLoc.ZipCode is null or TSellerLoc.ZipCode = '' then 'N/A' else TSellerLoc.ZipCode end as SellerPin,   case when T12.LocStatCod is null or T12.LocStatCod = '' or TSellerLoc.Country is null or TSellerLoc.Country = '' then 'N/A'          else (select (case when Name is null or Name = '' then 'N/A' else left(Name, 50) end) from OCST where Code = T12.LocStatCod and Country = TSellerLoc.Country)     end as SellerState,      case when T12.ImpORExp = 'Y' then 'URP'          else case when T12.BPGSTN is null or T12.BPGSTN = '' then 'N/A' else T12.BPGSTN end      end as BuyerGSTIN,      case when T0.CardName is null or T0.CardName = '' then 'N/A' else T0.CardName end as BuyerLglNm,      case when T12.ImpORExp = 'Y' then '96'           else case when T12.BPStatGSTN is null or T12.BPStatGSTN = '' then 'N/A' else T12.BPStatGSTN end     end as BuyerPos,      case when T0.Address2 is null or T0.Address2 = '' then 'N/A' else left(replace(replace(T0.Address2, char(10),' '), char(13), ' '), 100)     end as BuyerAddr1,        case when T12.CityS is null or T12.CityS = '' then 'N/A' else T12.CityS     end as BuyerLoc,   case when T12.ImpORExp = 'Y' then null                 else case when T12.ZipCodeS is null or T12.ZipCodeS = '' then 'N/A' else T12.ZipCodeS end     end as BuyerPin,   case when T12.ImpORExp = 'Y' then null       else case when T12.BpStateCod is null or T12.BpStateCod = '' or T12.BpCountry is null or T12.BpCountry = '' then 'N/A'                    else (select (case when Name is null or Name = '' then 'N/A' else left(Name, 50) end) from OCST where Code = T12.BpStateCod and Country = T12.BpCountry)               end  end as BuyerState,      case when T1.DocAssVal is null then 0          else T1.DocAssVal     end as AssVal,      case when TC.TCTaxSum is null then 0 else TC.TCTaxSum end as CgstVal,      case when TS.TSTaxSum is null then 0 else TS.TSTaxSum end as SgstVal,      case when TI.TITaxSum is null then 0 else TI.TITaxSum end as IgstVal,      case when TCES.TCESTaxSum is null then 0 else TCES.TCESTaxSum end as CesVal,      case when T1.DocAssVal is null then 0 else T1.DocAssVal end     + case when TC.TCTaxSum is null then 0 else TC.TCTaxSum end  + case when TS.TSTaxSum is null then 0 else TS.TSTaxSum end  + case when TI.TITaxSum is null then 0 else TI.TITaxSum end  + case when TCES.TCESTaxSum is null then 0 else TCES.TCESTaxSum end     as TotInvVal  from OINV T0 join INV12 T12 on T0.DocEntry = T12.DocEntry                     join (select DocEntry, sum(LineTotal) as DocAssVal from INV1 group by DocEntry) T1 on T0.DocEntry = T1.DocEntry        left join (select top 1 DocNum, DocEntry from RCT2 where InvType = 13 and DocEntry in (select max(DocEntry) from OINV)) TInPayment on TInPayment.DocEntry = T0.DocEntry        left join (select top 1 DocNum, DocEntry from VPM2 where InvType = 13 and DocEntry in (select max(DocEntry) from OINV)) TOutPayment on TOutPayment.DocEntry = T0.DocEntry        left join (select DocEntry, sum(TaxSum) as TCTaxSum from INV4 where INV4.staType = -100 group by INV4.DocEntry, INV4.staType) TC on T0.DocEntry = TC.DocEntry         left join (select DocEntry, sum(TaxSum) as TSTaxSum from INV4 where INV4.staType = -110 group by INV4.DocEntry, INV4.staType) TS on T0.DocEntry = TS.DocEntry            left join (select DocEntry, sum(TaxSum) as TITaxSum from INV4 where INV4.staType = -120 group by INV4.DocEntry, INV4.staType) TI on T0.DocEntry = TI.DocEntry            left join (select DocEntry, sum(TaxSum) as TCESTaxSum from INV4 where INV4.staType = -130 group by INV4.DocEntry, INV4.staType) TCES on T0.DocEntry = TCES.DocEntry         left join (select DocEntry, LocCode from INV1 group by DocEntry, LocCode) TSellerLocCode on TSellerLocCode.DocEntry = T0.DocEntry        left join (select code, location, ZipCode, Country from OLCT) TSellerLoc on  TSellerLoc.Code = TSellerLocCode.LocCode WHERE T0.DocEntry in (select max(DocEntry) from OINV)
select  Row_Number()over(order by T1.VisOrder asc) as SlNo,   case T0.DocType when 'I' then 'N' else 'Y' end as IsServc,   case T0.DocType when 'I' then    (select CONCAT(Chapter, Heading, SubHeading) from OCHP where OCHP.AbsEntry = T1.HsnEntry)               else    (select ServCode from OSAC where OSAC.AbsEntry = T1.SacEntry)     end as HsnCode,      case T0.DocType when 'I' then T1.Quantity else '1' end as Qty,    case T0.DocType when 'I' then (case T1.UomEntry when -1 then (case when T1.unitMsr is null or T1.unitMsr = '' then 'N/A' else T1.unitMsr end) else (select case when OUOM.EwbUnit is null then 'N/A' else OEUT.UnitCode end from OUOM left join OEUT on OEUT.AbsEntry = OUOM.EwbUnit where OUOM.UomEntry = T1.UomEntry) end) else null end as Unit,    case when T1.Price is null then 0 else T1.Price end as UnitPrice,      case when T1.LineTotal is null then 0 else T1.LineTotal end as TotAmt,      case when T1.LineTotal is null then 0 else T1.LineTotal end as AssAmt,       CAST((case when T12.isIntraState = 'Y' then      (case when TC.CgstRate is null then 0 else TC.CgstRate end)       + (case when TS.SgstRate is null then 0 else TS.SgstRate end)      + (case when TU.UgstRate is null then 0 else TU.UgstRate end)    else (case when TI.IgstRate is null then 0 else TI.IgstRate end)     end)      as decimal (6, 2)) as GstRt,      CAST((case when T12.isIntraState = 'Y' then 0 else (case when TI.IgstAmt is null then 0 else TI.IgstAmt end) end) as decimal (16, 2)) as IgstAmt,    CAST((case when T12.isIntraState = 'N' then 0 else (case when TC.CgstAmt is null then 0 else TC.CgstAmt end) end) as decimal (16, 2)) as CgstAmt,      CAST((case when T12.isIntraState = 'N' then 0 else (case when TS.SgstAmt is null then 0 else TS.SgstAmt end) end) as decimal (16, 2)) as SgstAmt,      CAST((case when TCES.CesAmt is null then 0 else TCES.CesAmt end) as decimal (16, 2)) as CesAmt,   CAST(((case when T1.LineTotal is null then 0 else T1.LineTotal end)    + (case when TI.IgstAmt is null then 0 else TI.IgstAmt end)    + (case when TC.CgstAmt is null then 0 else TC.CgstAmt end)    + (case when TS.SgstAmt is null then 0 else TS.SgstAmt end)    + (case when TCES.CesAmt is null then 0 else TCES.CesAmt end)    + (case when TU.UgstAmt is null then 0 else TU.UgstAmt end)) as decimal(16, 2)) as TotItemVal  from INV1 T1 join (select DocEntry, DocType from OINV) T0 on T0.DocEntry = T1.DocEntry     join (select INV12.DocEntry,       case when INV12.ImpORExp = 'Y' then 'N'            when OINV.DocType = 'I' then case when left(isnull(BpGSTN, ''), 2) = left(isnull(LocGSTN, ''), 2) then 'Y' else 'N' end            else case when left(isnull(LocGSTN, ''), 2) = left(isnull(BpStateCod, ''), 2) then 'Y' else 'N' end       end as isIntraState         from INV12 join OINV on INV12.DocEntry = OINV.DocEntry) T12 on T12.DocEntry = T1.DocEntry     left join (select DocEntry, LineNum, case when TaxRate is null then 0 else TaxRate end as CgstRate, case when TaxSum is null then 0 else TaxSum end as CgstAmt from INV4 where staType = -100) TC on T1.DocEntry = TC.DocEntry and T1.LineNum = TC.LineNum              left join (select DocEntry, LineNum, case when TaxRate is null then 0 else TaxRate end as SgstRate, case when TaxSum is null then 0 else TaxSum end as SgstAmt from INV4 where staType = -110) TS on T1.DocEntry = TS.DocEntry and T1.LineNum = TS.LineNum     left join (select DocEntry, LineNum, case when TaxRate is null then 0 else TaxRate end as IgstRate, case when TaxSum is null then 0 else TaxSum end as IgstAmt from INV4 where staType = -120) TI on T1.DocEntry = TI.DocEntry and T1.LineNum = TI.LineNum     left join (select DocEntry, LineNum, case when TaxRate is null then 0 else TaxRate end as CesRate, case when TaxSum is null then 0 else TaxSum end as CesAmt from INV4 where staType = -130) TCES on T1.DocEntry = TCES.DocEntry and T1.LineNum = TCES.LineNum     left join (select DocEntry, LineNum, case when TaxRate is null then 0 else TaxRate end as UgstRate, case when TaxSum is null then 0 else TaxSum end as UgstAmt from INV4 where staType = -150) TU on T1.DocEntry = TU.DocEntry and T1.LineNum = TU.LineNum where T1.DocEntry = (select MAX(DocEntry) from OINV)
select   '1.01' as Version,      'GST' as TaxSch,      case when T12.ImpORExp = 'N' or T12.ImpORExp is null then  'B2B'       else case T12.ExportType when 'D' then 'DEXP'                                   when 'E' then case when TInPayment.DocNum is null and TOutPayment.DocNum is null then 'EXPWOP' else 'EXPWP' end           else case when TInPayment.DocNum is null and TOutPayment.DocNum is null then 'SEZWOP' else 'SEZWP' end                    end     end as SubType,   case T0.GSTTranTyp when 'GA' then 'CRN' else 'N/A' end as Typ,      case when T0.DocNum is null or T0.DocNum = '' then 'N/A' else T0.DocNum end as No,      CONVERT(VARCHAR(10), T0.TaxDate, 103) as DocDate,      case when T12.LocGSTN is null or T12.LocGSTN = '' then 'N/A' else T12.LocGSTN end as SellerGSTIN,      (select (case when OADM.CompnyName is null or OADM.CompnyName = '' then 'N/A' else OADM.CompnyName end) from OADM) as SellerLglNm,   (select (case when OADM.CompnyAddr is null or OADM.CompnyAddr = '' then 'N/A' else left(replace(replace(OADM.CompnyAddr, char(10),' '), char(13), ' '), 100) end) from OADM) as SellerAddr1,      case when TSellerLoc.Location is null then 'N/A' else left(TSellerLoc.Location, 50) end as SellerLoc,      case when TSellerLoc.ZipCode is null or TSellerLoc.ZipCode = '' then 'N/A' else TSellerLoc.ZipCode end as SellerPin,   case when T12.LocStatCod is null or T12.LocStatCod = '' or TSellerLoc.Country is null or TSellerLoc.Country = '' then 'N/A'          else (select (case when Name is null or Name = '' then 'N/A' else left(Name, 50) end) from OCST where Code = T12.LocStatCod and Country = TSellerLoc.Country)     end as SellerState,      case when T12.ImpORExp = 'Y' then 'URP'          else case when T12.BPGSTN is null or T12.BPGSTN = '' then 'N/A' else T12.BPGSTN end      end as BuyerGSTIN,      case when T0.CardName is null or T0.CardName = '' then 'N/A' else T0.CardName end as BuyerLglNm,   case when T12.ImpORExp = 'Y' then '96'           else case when T12.BPStatGSTN is null or T12.BPStatGSTN = '' then 'N/A' else T12.BPStatGSTN end     end as BuyerPos,     case when T0.Address2 is null or T0.Address2 = '' then 'N/A' else left(replace(replace(T0.Address2, char(10),' '), char(13), ' '), 100)     end as BuyerAddr1,     case when T12.CityS is null or T12.CityS = '' then 'N/A' else T12.CityS     end as BuyerLoc,      case when T12.ImpORExp = 'Y' then null                 else case when T12.ZipCodeS is null or T12.ZipCodeS = '' then 'N/A' else T12.ZipCodeS end     end as BuyerPin,   case when T12.ImpORExp = 'Y' then null       else case when T12.BpStateCod is null or T12.BpStateCod = '' or T12.BpCountry is null or T12.BpCountry = '' then 'N/A'                    else (select (case when Name is null or Name = '' then 'N/A' else left(Name, 50) end) from OCST where Code = T12.BpStateCod and Country = T12.BpCountry)               end  end as BuyerState,      case when T1.DocAssVal is null then 0          else T1.DocAssVal     end as AssVal,      case when TC.TCTaxSum is null then 0 else TC.TCTaxSum end as CgstVal,      case when TS.TSTaxSum is null then 0 else TS.TSTaxSum end as SgstVal,      case when TI.TITaxSum is null then 0 else TI.TITaxSum end as IgstVal,      case when TCES.TCESTaxSum is null then 0 else TCES.TCESTaxSum end as CesVal,      case when T1.DocAssVal is null then 0 else T1.DocAssVal end     + case when TC.TCTaxSum is null then 0 else TC.TCTaxSum end  + case when TS.TSTaxSum is null then 0 else TS.TSTaxSum end  + case when TI.TITaxSum is null then 0 else TI.TITaxSum end  + case when TCES.TCESTaxSum is null then 0 else TCES.TCESTaxSum end     as TotInvVal  from ORIN T0 join RIN12 T12 on T0.DocEntry = T12.DocEntry                     join (select DocEntry, sum(LineTotal) as DocAssVal from RIN1 group by DocEntry) T1 on T0.DocEntry = T1.DocEntry        left join (select top 1 DocNum, DocEntry from RCT2 where InvType = 13 and DocEntry in (select max(DocEntry) from ORIN)) TInPayment on TInPayment.DocEntry = T0.DocEntry        left join (select top 1 DocNum, DocEntry from VPM2 where InvType = 13 and DocEntry in (select max(DocEntry) from ORIN)) TOutPayment on TOutPayment.DocEntry = T0.DocEntry        left join (select DocEntry, sum(TaxSum) as TCTaxSum from RIN4 where RIN4.staType = -100 group by RIN4.DocEntry, RIN4.staType) TC on T0.DocEntry = TC.DocEntry         left join (select DocEntry, sum(TaxSum) as TSTaxSum from RIN4 where RIN4.staType = -110 group by RIN4.DocEntry, RIN4.staType) TS on T0.DocEntry = TS.DocEntry            left join (select DocEntry, sum(TaxSum) as TITaxSum from RIN4 where RIN4.staType = -120 group by RIN4.DocEntry, RIN4.staType) TI on T0.DocEntry = TI.DocEntry            left join (select DocEntry, sum(TaxSum) as TCESTaxSum from RIN4 where RIN4.staType = -130 group by RIN4.DocEntry, RIN4.staType) TCES on T0.DocEntry = TCES.DocEntry         left join (select DocEntry, LocCode from RIN1 group by DocEntry, LocCode) TSellerLocCode on TSellerLocCode.DocEntry = T0.DocEntry        left join (select code, location, ZipCode, Country from OLCT) TSellerLoc on  TSellerLoc.Code = TSellerLocCode.LocCode WHERE T0.DocEntry in (select max(DocEntry) from ORIN)
select       Row_Number()over(order by T1.VisOrder asc) as SlNo,      case T0.DocType when 'I' then 'N' else 'Y' end as IsServc,      case T0.DocType when 'I' then    (select CONCAT(Chapter, Heading, SubHeading) from OCHP where OCHP.AbsEntry = T1.HsnEntry)               else    (select ServCode from OSAC where OSAC.AbsEntry = T1.SacEntry)     end as HsnCode,      case T0.DocType when 'I' then T1.Quantity else '1' end as Qty,      case T0.DocType when 'I' then (case T1.UomEntry when -1 then (case when T1.unitMsr is null or T1.unitMsr = '' then 'N/A' else T1.unitMsr end) else (select case when OUOM.EwbUnit is null then 'N/A' else OEUT.UnitCode end from OUOM left join OEUT on OEUT.AbsEntry = OUOM.EwbUnit where OUOM.UomEntry = T1.UomEntry) end) else null end as Unit,          case when T1.Price is null then 0 else T1.Price end as UnitPrice,      case when T1.LineTotal is null then 0 else T1.LineTotal end as TotAmt,      case when T1.LineTotal is null then 0 else T1.LineTotal end as AssAmt,       CAST((case when T12.isIntraState = 'Y' then      (case when TC.CgstRate is null then 0 else TC.CgstRate end)       + (case when TS.SgstRate is null then 0 else TS.SgstRate end)      + (case when TU.UgstRate is null then 0 else TU.UgstRate end)    else (case when TI.IgstRate is null then 0 else TI.IgstRate end)     end)      as decimal (6, 2)) as GstRt,   CAST((case when T12.isIntraState = 'Y' then 0 else (case when TI.IgstAmt is null then 0 else TI.IgstAmt end) end) as decimal (16, 2)) as IgstAmt,       CAST((case when T12.isIntraState = 'N' then 0 else (case when TC.CgstAmt is null then 0 else TC.CgstAmt end) end) as decimal (16, 2)) as CgstAmt,      CAST((case when T12.isIntraState = 'N' then 0 else (case when TS.SgstAmt is null then 0 else TS.SgstAmt end) end) as decimal (16, 2)) as SgstAmt,      CAST((case when TCES.CesAmt is null then 0 else TCES.CesAmt end) as decimal (16, 2)) as CesAmt,      CAST(((case when T1.LineTotal is null then 0 else T1.LineTotal end)    + (case when TI.IgstAmt is null then 0 else TI.IgstAmt end)    + (case when TC.CgstAmt is null then 0 else TC.CgstAmt end)    + (case when TS.SgstAmt is null then 0 else TS.SgstAmt end)    + (case when TCES.CesAmt is null then 0 else TCES.CesAmt end)    + (case when TU.UgstAmt is null then 0 else TU.UgstAmt end)) as decimal(16, 2)) as TotItemVal  from RIN1 T1 join (select DocEntry, DocType from ORIN) T0 on T0.DocEntry = T1.DocEntry     join (select RIN12.DocEntry,       case when RIN12.ImpORExp = 'Y' then 'N'            when ORIN.DocType = 'I' then case when left(isnull(BpGSTN, ''), 2) = left(isnull(LocGSTN, ''), 2) then 'Y' else 'N' end            else case when left(isnull(LocGSTN, ''), 2) = left(isnull(BpStateCod, ''), 2) then 'Y' else 'N' end       end as isIntraState         from RIN12 join ORIN on RIN12.DocEntry = ORIN.DocEntry) T12 on T12.DocEntry = T1.DocEntry     left join (select DocEntry, LineNum, case when TaxRate is null then 0 else TaxRate end as CgstRate, case when TaxSum is null then 0 else TaxSum end as CgstAmt from RIN4 where staType = -100) TC on T1.DocEntry = TC.DocEntry and T1.LineNum = TC.LineNum              left join (select DocEntry, LineNum, case when TaxRate is null then 0 else TaxRate end as SgstRate, case when TaxSum is null then 0 else TaxSum end as SgstAmt from RIN4 where staType = -110) TS on T1.DocEntry = TS.DocEntry and T1.LineNum = TS.LineNum     left join (select DocEntry, LineNum, case when TaxRate is null then 0 else TaxRate end as IgstRate, case when TaxSum is null then 0 else TaxSum end as IgstAmt from RIN4 where staType = -120) TI on T1.DocEntry = TI.DocEntry and T1.LineNum = TI.LineNum     left join (select DocEntry, LineNum, case when TaxRate is null then 0 else TaxRate end as CesRate, case when TaxSum is null then 0 else TaxSum end as CesAmt from RIN4 where staType = -130) TCES on T1.DocEntry = TCES.DocEntry and T1.LineNum = TCES.LineNum     left join (select DocEntry, LineNum, case when TaxRate is null then 0 else TaxRate end as UgstRate, case when TaxSum is null then 0 else TaxSum end as UgstAmt from RIN4 where staType = -150) TU on T1.DocEntry = TU.DocEntry and T1.LineNum = TU.LineNum where T1.DocEntry = (select MAX(DocEntry) from ORIN)
SELECT Distinct 'True'  FROM OPOR T0 WHERE $[OPOR.U_POTY]='CLOSE'
SELECT Distinct 'True'  FROM OPOR T0 WHERE $[OPOR.U_POTY]='SCHEDULE'
SELECT T1.Dscription  FROM OITM T0  INNER JOIN OCHP T1 ON T1.AbsEntry = T0.ChapterID WHERE T0.ItemCode = $[OAT1.ItemCode]
SELECT MAX(T0.U_DNUM)+1 FROM ORPC T0
select TOP 1 Numatcard  from opdn where  OPDN.CardCode=$[$4.0.1] order by DocNum desc
SELECT  distinct t0.DocEntry, t0.DocNum, t0.CardCode, t0.CardName, t0.DocDate,t0.Comments FROM ODRF1 T0 inner join drf1 t1 on t0.DocEntry=t1.DocEntry   WHERE T0.ObjType ='17'   AND (T1.U_U_Del) IS NULL
Select getdate()-7300
Declare @AP_Value numeric(19,3) set @AP_Value=(Select isnull(sum(aa.tt),0) From ( (select isnull((select sum(a.vv)tt from (Select (isnull((Select (Case when DocCur='INR' then sum(PCH1.Linetotal) else sum(PCH1.TotalFrgn) END )  From PCH1,OITM   where PCH1.DocEntry=OPCH.DocEntry and OITM.ItemCode=PCH1.ItemCode and OITM.InvntItem='Y'  ) ,0) +        isnull((Select sum(PCH4.TaxSum) From PCH4 where OPCH.DocEntry=PCH4.docentry ),0.0) +        isnull((Select sum(PCH3.LineTotal) From PCH3 where OPCH.DocEntry=PCH3.docentry),0.0) -        isnull((Case when DocCur='INR' then OPCH.DiscSum else OPCH.DiscSumFC END ),0.0))'VV' From OPCH,OCRD,OITM where OPCH.DocType='I'  and OPCH.Docdate >'20210331' and OPCH.CardCode=$[OPCH.Cardcode] AND OCRD.CardCode=OPCH.CardCode    and OPCH.DocCur='INR' and OPCH.Canceled='N' --and OPCH.DocEntry<>@list_of_cols_val_tab_del group by DocCur,DiscSum,DiscSumFC,OPCH.DocEntry)a),0)tt) union all (Select isnull(-sum(b.vv),0)tt From(Select (isnull((Select (Case when DocCur='INR' then sum(RPC1.Linetotal) else sum(RPC1.TotalFrgn) END )  From RPC1,OITM   where RPC1.DocEntry=ORPC.DocEntry and OITM.ItemCode=RPC1.ItemCode and OITM.InvntItem='Y'   ) ,0) +        isnull((Select sum(RPC4.TaxSum) From RPC4 where ORPC.DocEntry=RPC4.docentry ),0.0) +        isnull((Select sum(RPC3.LineTotal) From RPC3 where ORPC.DocEntry=RPC3.docentry),0.0) -        isnull((Case when DocCur='INR' then ORPC.DiscSum else ORPC.DiscSumFC END ),0.0))'VV' From ORPC,OCRD where ORPC.DocType='I' and ORPC.Docdate >'20210331' and ORPC.CardCode=$[OPCH.Cardcode] AND OCRD.CardCode=ORPC.CardCode    and ORPC.DocCur='INR' and ORPC.Canceled='N'  group by DocCur,DiscSum,DiscSumFC,ORPC.DocEntry)b) )AA)  Select @AP_Value
SELECT DISTINCT CONCAT ('MRR',T2.NextNumber) FROM OPDN T0 INNER JOIN NNM1 T2 ON T0.Series=T2.Series  WHERE T0.DOCDATE > '20230401'
SELECT DISTINCT 'True' FROM OPRQ T0 WHERE ($[OPRQ.U_JB] ='Y' )
------TATA QR CODE LOGIC >>> PO_NO, 10, INV_QTY, INV_NO, INV_DT, GROSS_RATE, NET_RATE, VENDOR_CODE, PART_NO, CGST, SGST, IGST, UGST, CGST%, SGST%, IGST%, UGST%, CESS, TOT_INV_VAL,HSN  SELECT CASE WHEN T0.CardCode IN ('C000055','C000056','C000057','C000194','C000058','C000177','C000179','C000059', 'C000060','C000061','C000179','C000062','C000063')  THEN CONCAT (REPLACE(T0.NumatCard,'.','') ,',',10,',',CONVERT (NUMERIC(10,0),T1.Quantity),',',T0.DocNum ,',', CONVERT (VARCHAR,t0.DocDate,104) ,',', CONVERT (NUMERIC (10,2),T1.PriceBefDi),',', CONVERT (NUMERIC (10,2),T1.price) ,',',ISNULL(T14.AliasName,'SHAPL') ,',',ISNULL(T1.SubCatNum, T1.ItemCode) ,',', ISNULL((Select CONVERT (NUMERIC (10,2),(case when  sum(x.RvsChrgTax)<=0  then sum(x.TaxSum)/t0.DocRate else 0 end))  From INV4 x Where x.DocEntry = t0.DocEntry and x.staType = -100 and x.LineNum = t1.LineNum and x.RelateType = 1),0) ,',', ISNULL((SELECT CONVERT (NUMERIC (10,2), (case when sum(x.RvsChrgTax)<=0  then sum(x.TaxSum)/t0.DocRate else 0 end)) From INV4 x Where x.DocEntry = t0.DocEntry and x.staType = -110 and x.LineNum = t1.LineNum and x.RelateType = 1),0) ,',', ISNULL((SELECT CONVERT (NUMERIC (10,2),(case when sum(x.RvsChrgTax)<=0  then sum(x.TaxSum)/t0.DocRate else 0 end)) From INV4 x Where x.DocEntry = t0.DocEntry and x.staType = -120 and x.LineNum = t1.LineNum and x.RelateType = 1),0) ,',', ISNULL((SELECT CONVERT (NUMERIC (10,2),(case when sum(x.RvsChrgTax)<=0  then sum(x.TaxSum)/t0.DocRate else 0 end)) From INV4 x Where x.DocEntry = t0.DocEntry and x.staType = -150 and x.LineNum = t1.LineNum and x.RelateType = 1),0) ,',', ISNULL((SELECT DISTINCT (CONVERT (NUMERIC (10,2),case when sum(x.RvsChrgTax)<=0  then  x.TaxRate else 0 end )) From INV4 x Where x.DocEntry = t0.DocEntry and x.staType = -100 and x.LineNum = t1.LineNum and x.RelateType = 1 group by X.TaxRate),0) , ',', ISNULL((SELECT DISTINCT (CONVERT (NUMERIC (10,2),case when sum(x.RvsChrgTax)<=0  then x.TaxRate else 0 end )) From INV4 x Where x.DocEntry = t0.DocEntry and x.staType = -110 and x.LineNum = t1.LineNum and x.RelateType = 1 group by X.TaxRate),0) ,',', ISNULL((SELECT DISTINCT (CONVERT (NUMERIC (10,2),case when sum(x.RvsChrgTax)<=0  then x.TaxRate else 0 end )) From INV4 x Where x.DocEntry = t0.DocEntry and x.staType = -120 and x.LineNum = t1.LineNum and x.RelateType = 1 group by X.TaxRate),0) ,',', ISNULL((SELECT DISTINCT (CONVERT (NUMERIC (10,2),case when sum(x.RvsChrgTax)<=0  then x.TaxRate else 0 end )) From INV4 x Where x.DocEntry = t0.DocEntry and x.staType = -150 and x.LineNum = t1.LineNum and x.RelateType = 1 group by X.TaxRate),0) ,',',      0.00,',',CONVERT(NUMERIC(10,2),T0.DocTotal),',',LEFT(T7.CHAPTERID,8))   -----RAILWAY QR CODE >>> MANUNAME,PONO,PODATE,BATCHNO,DATEOF_MFG,DELIVERY CHALLAN_NO,DELIVERY_CHALLAN_DATE  WHEN T0.CardCode   IN ('C000044','C000265','C000266','C000261','C000263','C000264','C000270','C000287', 'C000280','C000279','C000181','C000100','C000257','C000262','C000260','C000274','C000223','C000220', 'C000291','C000185','C000248','C000199','C000277','C000288','C000208','C000190','C000282','C000205', 'C000189','C000210','C000222','C000273','C000276','C000306','C000292','C000218','C000289','C000294', 'C000186','C000198','C000290','C000197','C000246','C000216','C000245','C000207','C000206','C000204', 'C000202','C000247','C000184','C000209','C000188','C000203','C000258','C000295','C000183','C000275', 'C000215','C000267','C000213','C000196','C000259','C000300','C000281','C000172','C000296','C000293', 'C000283','C000305','C000302','C000161','C000195','C000285','C000284','C000242','C000239','C000255', 'C000233','C000313','C000268','C000234','C000251','C000173','C000254','C000232','C000236','C000235', 'C000272','C000311','C000237','C000240','C000278','C000250','C000249')  THEN CONCAT ('SHAPL',',',t0.numatcard ,',',CONVERT (VARCHAR,t0.DocDate,104),',', R1.BatchNum,',',CONVERT(VARCHAR,R2.InDate,104),',',T0.DocNum ,',',CONVERT (VARCHAR,t0.DocDate,104) )  ---ASHOK QR CODE >>> SUPPLIER$PARTNUMBER$SERIALNUMBER$MFGDT$BATCHCODE$HEATCODE$MATERIAL CODE$DRAWINGLVL$PARTDESC$TIER1SUPP  WHEN T0.CardCode IN ('C000074','C000003','C000004','C000324') THEN  CONCAT ('7202406','$',ISNULL(T50.Substitute, T1.ItemCode),'$','xxx','$',CONVERT (VARCHAR,t0.DocDate,105),'$', R1.BatchNum,'$','xxx','$',T1.ItemCode,'$',T1.Dscription,'$','SHAPL')  ----DICV QR CODE SUPPLIERNAME, PARTNUMBER, 'BATCH_MMYY','SH','BATCHNO WHEN T0.CardCode IN ('C000011') THEN  CONCAT (REPLACE(T50.Substitute,'-ZGS',''), SUBSTRING(CONVERT(nvarchar(6),R2.InDate, 112),5,2), SUBSTRING(CONVERT(nvarchar(6),R2.InDate, 112),3,2), 'SH',RIGHT(R1.BatchNum,7))  ELSE  CONCAT (T0.CardCode,',', ISNULL(T50.Substitute,T1.ItemCode),',', T0.DocNum,',',CONVERT (VARCHAR,T0.DocDate,104),',', CONVERT (NUMERIC (10,2),T1.Quantity)) END AS 'QR Code',  T0.DocNum as 'Inv No.',CONVERT (VARCHAR,t0.DocDate,104) as 'Inv Date', T0.CardName, R1.BatchNum FROM OINV t0  INNER JOIN ADP1 dd on dd.objtype=t0.ObjType  INNER JOIN INV1 t1 on t1.DocEntry=t0.DocEntry LEFT JOIN DLN1 c on c.DocEntry = t1.BaseEntry and c.LineNum = t1.BaseLine LEFT JOIN ODLN d on d.DocEntry = c.DocEntry LEFT JOIN RDR1 e on e.DocEntry = c.BaseEntry and e.LineNum = c.BaseLine LEFT JOIN ORDR f on f.DocEntry = e.DocEntry LEFT OUTER JOIN OWHS t2 on t2.WhsCode=t1.WhsCode  LEFT OUTER JOIN OLCT t3 on t3.Code=t2.Location LEFT OUTER JOIN OBPL Bt1 on  Bt1.BPLId =t0.BPLId LEFT OUTER JOIN OWHS Bt2 on  Bt2.WhsCode =Bt1.DflWhs LEFT OUTER JOIN OLCT Bt3 on  Bt3.Code =Bt2.Location LEFT OUTER JOIN OCRY BT5 on  Bt5.Code =Bt3.Country LEFT OUTER JOIN OCST BT4 on  Bt4.Code =Bt3.State and bt4.Country=Bt5.Code LEFT OUTER JOIN OCRY T5 ON T5.code=t3.Country LEFT OUTER JOIN OCST T4 ON T4.code=t3.State  AND T4.Country=t5.Code LEFT OUTER JOIN OITM T8 ON T8.ItemCode=t1.ItemCode LEFT OUTER JOIN OCHP T7 ON T7.AbsEntry=t1.HsnEntry LEFT OUTER JOIN OCTG T9 ON T9.GroupNum=t0.GroupNum LEFT OUTER JOIN NNM1 T10 ON T10.Series=t0.Series LEFT OUTER JOIN OCPR T13 ON T13.CntctCode=T0.CntctCode LEFT JOIN OCRD T14 ON T14.CardCode = T0.CardCode LEFT JOIN INV12 T15 ON T15.DocEntry = T0.DOCENTRY LEFT JOIN OSAC S1 ON S1.AbsEntry=T8.SACEntry LEFT JOIN OQRC T16 ON T16.SrcObjAbs = T0.DocEntry AND T16.SrcObjType =13 LEFT JOIN OSCN T50 ON T50.ItemCode = T1.ItemCode AND T50.CardCode = T0.CardCode LEFT JOIN IBT1 R1 ON R1.BaseEntry = d.DocEntry AND R1.CardCode = D.CardCode LEFT JOIN OIBT R2 ON R2.ItemCode = R1.ItemCode AND R1.BatchNum = R2.BatchNum   WHERE T0.DocDate >= GETDATE()-7   ORDER BY T0.DocEntry DESC
SELECT TOP 1 CASE  WHEN $[OINV.CardCode] IN ('C000055','C000056','C000057','C000194','C000058','C000177', 'C000179','C000059','C000060','C000061','C000179','C000062','C000063') THEN  CONCAT ($[OINV.NumAtCard] ,',',10,',',CONVERT (NUMERIC(10,0),$[INV1.Quantity]),',', $[OINV.DocNum] , ',', CONVERT (VARCHAR,GETDATE(),104) ,',', ISNULL(TRY_CAST(REPLACE($[$38.14.0],'INR','')as numeric(10,2)),0.00),',', ISNULL(TRY_CAST(REPLACE($[$38.17.0],'INR','')as numeric(10,2)),0.00)  ,',', (SELECT OCRD.AliasName FROM OCRD WHERE OCRD.CardCode = $[OINV.CardCode]),',',$[INV1.SubCatNum] ,',',  CASE  WHEN LEFT($[INV1.TaxCode],2)='IG' THEN '0.00'+','+'0.00'+','+REPLACE($[$38.82.0],'INR','') +','+'0.00'  WHEN LEFT($[INV1.TaxCode],2)='CS' THEN  CONCAT(TRY_CAST(TRY_CAST(REPLACE($[$38.82.0],'INR','')AS NUMERIC(10,2))/2 AS NUMERIC(10,2)),',', TRY_CAST(TRY_CAST(REPLACE($[$38.82.0],'INR','')AS NUMERIC(10,2))/2 AS NUMERIC(10,2)),',','0.00',',','0.00') END,',',0.00,',', CONVERT(NUMERIC(10,2),$[OINV.DocTotal]),',',(SELECT LEFT (OCHP.CHAPTERID,8) FROM OCHP  WHERE OCHP.AbsEntry=$[INV1.HsnEntry])) ELSE  CONCAT ($[OINV.CardCode],',',  $[INV1.SubCatNum] , ',',$[OINV.DocNum],',', CONVERT (VARCHAR,GETDATE(),104),',', CONVERT (NUMERIC (10,2),$[INV1.Quantity])) END AS 'QR Code'  FROM OINV  INNER JOIN INV1  ON INV1.DocEntry=OINV.DocEntry
SELECT cardcode, cardname ,CARDTYPE from ocrd where cardcode not in ('satya','V000272' ,'V000311','V000395') order by cardname
Select t0.[AltItem] from OALI T0 Where T0.[OrigItem] = $[$37.4.1]
SELECT T0. ItemCode,T0.ItemName, T1.ItmsGrpNam, T0.ItmsGrpCod  FROM OITM T0 INNER JOIN OITB T1 ON T1.ItmsGrpCod = T0.ItmsGrpCod  ORDER BY T0.ItmsGrpCod
SELECT T0.ItemName, T0. ItemCode,T1.ItmsGrpNam, T0.ItmsGrpCod  FROM OITM T0 INNER JOIN OITB T1 ON T1.ItmsGrpCod = T0.ItmsGrpCod WHERE T0.ItemCode in ('7050001','7050002','7050003','7050004','7050005','7050006','7050007','7050008','7050010','7050011','7050012','7050013','7050014','7050015', '7050016','7050017','7050018','7050019','7050020','7050021','7050022','7050023','7050024','7050025','7050026','7050027','7050028','7050029', '7050030','7050031','7050032','7050033','7050034','7050035','7050036','7050037','7050038','7050039','7050040','7050042','7050043','7050044', '7050045','7050046','7050047','7050048','7050049','7050050','7050051','7050052','7050053','7050054','7050055','7050056','7050057','7050058', '7050059','7050060','7050061','7050062','7050063','7050064','7050065','7050066','7050067','7050068','7050069','7050070','7050071','7050072', '7050073','7050074','7050075','7050076','7050077','7050078','7050079','7050080','7050081','7050082','7050083','7050084','7050085','7050086', '7050088','7050089','7050090','7050091','7050092','7050093','7050094','7050095','7050096','7050097','7050098','7050099','7050100','7050101', '7050102','7050103','7050104','7050105','7050106','7050107','7050108','7050109','7050110','7050111','7050112','7050113','7050114','7050115', '7050116','7050117','7050118','7050119','7050120','7050121','7050122','7050123','7050124','7050125','7050126','7050127','7050128','7050129', '7050130','7050131','7050132','7050133','7050134','7050135','7050136','7050137','7050138','7050139','7050140','7050141','7050142','7050143', '7050144','7050145','7050146','7050147','7050148','7050149','7050150','7050151','7050152','7050153','7050154','7050155','7050156','7050157','7050158')  ORDER BY T0.ItmsGrpCod
SELECT USERID,USER_CODE,U_NAME,E_Mail,OUDP.Remarks as 'Dept' FROM OUSR INNER JOIN OUDP ON OUDP.Code = OUSR.Department WHERE OUSR.Locked <> 'Y' AND OUSR.USERID NOT IN ( 2,3,4,5,7,10,25,34,42,44,45,46,49,50,51,52,57,58,61,64,66,74,75,78)
SELECT T0.ItemName, T0. ItemCode,T1.ItmsGrpNam, T0.ItmsGrpCod  FROM OITM T0 INNER JOIN OITB T1 ON T1.ItmsGrpCod = T0.ItmsGrpCod  ORDER BY T0.ItmsGrpCod
SELECT DISTINCT T1.[Quantity] ,T0.[DocNum] as 'MRR NO', T1.[ItemCode] FROM [dbo].[OIGN]  T0  INNER JOIN [dbo].[IGN1]  T1 ON T0.[DocEntry] = T1.[DocEntry] LEFT JOIN [dbo].[@UTL_OQCHK]  T2 ON T0.DOCNUM=T2.U_UTL_GINM WHERE T0.[DocNum]='[%0]'
select DistNumber from obtn where itemcode=$[$38.1.0]
SELECT DISTINCT CONCAT ('MRR',T2.NextNumber) as 'Batch No.', 'GRPO Batch No.' as 'Document Type' FROM OPDN T0 INNER JOIN NNM1 T2 ON T0.Series=T2.Series  WHERE T0.DOCDATE > '20230401'  UNION ALL  SELECT DISTINCT CONCAT ('PDN',T2.NextNumber) as 'Document Type','Production Goods Receipt'FROM OIGN T0 INNER JOIN NNM1 T2 ON T0.Series=T2.Series  WHERE T0.DOCDATE > '20230401'  UNION ALL  SELECT DISTINCT CONCAT ('JWN',T2.NextNumber) as 'Document Type','Job Work'FROM OIGN T0 INNER JOIN NNM1 T2 ON T0.Series=T2.Series  WHERE T0.DOCDATE > '20230401'
declare @batch as nvarchar(100) declare @txt nvarchar(max)  set @txt = ''  declare P cursor for SELECT T0.[BatchNum] + space(1)    + cast(cast(T1.[Quantity] as decimal(19,2)) as nvarchar)    + space(1) ----+ case when T0.[ExpDate] is null then '' else convert(nvarchar,T0.[ExpDate],102) end   FROM OIBT T0 INNER JOIN IBT1 T1 ON T0.ItemCode = T1.ItemCode and T0.WhsCode = T1.WhsCode    and T0.BatchNUm = T1.BatchNum    WHERE T1.[BaseEntry] =N'2655' and T1.[BaseLinNum] =N'0'  open P  fetch next from P into @batch  while @@fetch_status = 0  begin  set @txt = @txt +' '+@batch +','  fetch next from P into @batch  end  close P  deallocate P       select @txt
SELECT T0.[U_UTL_QCCHK] FROM OITM T0 WHERE T0.ItemCode = $[$38.1.1]
select ItemCode,ItemName into #TT from OITM select #TT.ItemCode,#TT.ItemName into #aa from #TT   select Distinct t2.ItemCode,(t2.Price) as 'MAX Price' ,t4.DocDate,row_number() OVER (PARTItion BY t2.itemcode ORDER BY T2.Price DESC) 'DS' --,DENSE_RANK() OVER (PARTItion BY t2.itemcode ORDER BY T4.docdate DESC) 'DS1'  into #T from OPOR t1 inner join por1 t2 on t2.DocEntry=t1.DocEntry LEFT JOIN PDN1 T3 ON T3.BaseEntry=T2.DocEntry AND T3.BaseLine=T2.LineNum --AND T3.VisOrder=0 INNER JOIN  OPDN T4 ON T4.DOCENTRY=T3.DOCENTRY where t1.DocDate between '[%0]' and '[%1]' and  t1.DocType='I'  AND T3.Price=T2.Price  --group by t2.itemcode,t2.Price   ,t4.DocDate order by T2.itemcode DESC  SELECT #t.ItemCode,#T.[MAX Price],#T.DocDate INTO #A FROM #t WHERE DS=1 --AND DS1=1  select Distinct t2.ItemCode,(t2.Price) as 'MIN Price' ,t4.DocDate,row_number() OVER (PARTItion BY t2.itemcode ORDER BY T2.Price asc) 'DS'--,DENSE_RANK() OVER (PARTItion BY t2.itemcode ORDER BY T4.docdate ASC) 'DS1'  into #T1 from OPOR t1 inner join por1 t2 on t2.DocEntry=t1.DocEntry LEFT JOIN PDN1 T3 ON T3.BaseEntry=T2.DocEntry AND T3.BaseLine=T2.LineNum --AND T3.VisOrder=0 INNER JOIN  OPDN T4 ON T4.DOCENTRY=T3.DOCENTRY where t1.DocDate between '[%0]' and '[%1]' and t1.DocType='I'  AND T3.Price=T2.Price  --group by t2.itemcode,t2.Price   ,t4.DocDate order by T2.itemcode DESC  SELECT #t1.ItemCode,#T1.[MIN Price],#T1.DocDate INTO #b FROM #t1 WHERE DS=1 --AND DS1=1  select t1.ItemCode,max(UnitPrice) as 'Blanket max price',min(UnitPrice) as 'Blanket min price' into #T2   from ooat t0 inner join OAT1 t1 on t1.AgrNo=t0.AbsID  where  t0.StartDate between '[%0]' and '[%1]'  and T1.LineStatus='O'  --t1.ItemCode='30100010000' group by t1.ItemCode SELECT #t2.ItemCode,#T2.[Blanket max price],#t2.[Blanket min price] INTO #c FROM #t2 --WHERE DS=1  select Distinct #aa.ItemCode,#aa.ItemName,    #c.[Blanket max price] as 'Max Open PO Price', #A.[MAX Price] as 'Max Po Price', #A.DocDate as 'Last Inward date Max', #c.[Blanket min price] as 'Min Open PO Price', #B.[MIN Price] as 'Min PO Price', #b.DocDate as 'Last Inward date Min' from #aa left join #b on #b.ItemCode=#aa.ItemCode left join #a on #a.ItemCode=#b.ItemCode left join #c on #c.ItemCode=#aa.ItemCode where ( #A.[MAX Price]<>0 or #B.[MIN Price]<>0 or #c.[Blanket max price]<>0 or #c.[Blanket min price]<>0)   ---where #a.ItemCode='30100020000'  DROP Table #TT DROP Table #aa DROP Table #t DROP Table #t1 DROP Table #T2 DROP Table #a DROP Table #b DROP Table #c
SELECT T0.ItemCode, MAX(T0.DocDate) 'Latest', (SELECT top 1 Price*DocRate FROM PCH1 Inner Join OPCH on PCH1.DocEntry=OPCH.DocEntry WHERE pch1.ItemCode=T0.ItemCode and opch.GSTTranTyp<> 'GD' order by pch1.DocDate desc) 'Last Purchase Price' FROM PCH1 T0 Inner Join OPCH T1 on T0.DocEntry=T1.DocEntry Group By T0.ItemCode Order by T0.ItemCode
SELECT T0.DocEntry as 'SAPEntry',T0.DocNum as 'Inv No.',CONVERT (VARCHAR,t0.DocDate,104) as 'Inv Date', UPPER (T0.numatcard) as VendRefNo,CONVERT (VARCHAR,t0.DocDate,104) as 'Doc Ref Dt.', T0.CardCode,ISNULL(T14.AliasName,'SHAPL') AS 'Vendor Code',UPPER (T0.CardName) AS 'CardName', CONCAT(COALESCE (' '+(SELECT UPPER(CRD1.ADDRESS2) FROM CRD1 WHERE CRD1.CardCode=T0.CardCode AND CRD1.AdresType='B' AND CRD1.Address=t0.PayToCode), '') , COALESCE (' '+(SELECT UPPER(CRD1.ADDRESS3) FROM CRD1 WHERE CRD1.CardCode=T0.CardCode AND CRD1.AdresType='B' AND CRD1.Address=t0.PayToCode),''), COALESCE (' '+(SELECT UPPER (CRD1.Street) FROM CRD1 WHERE CRD1.CardCode=T0.CardCode AND CRD1.AdresType='B' AND CRD1.Address=t0.PayToCode),''), COALESCE (' '+(SELECT UPPER(CRD1.Block) FROM CRD1 WHERE CRD1.CardCode=T0.CardCode AND CRD1.AdresType='B' AND CRD1.Address=t0.PayToCode),''), COALESCE (' '+(SELECT UPPER (CRD1.City) FROM CRD1 WHERE CRD1.CardCode=t0.CardCode AND CRD1.AdresType='B' AND CRD1.Address=t0.PayToCode),''), CONCAT (', '+(SELECT UPPER(OCST.Name) FROM CRD1 LEFT OUTER JOIN OCRY ON OCRY.Code=CRD1.Country LEFT OUTER JOIN OCST ON OCST.Code=CRD1.State AND OCRY.Code=ocst.Country  WHERE CRD1.CardCode=t0.CardCode AND CRD1.AdresType='B' AND CRD1.Address=t0.PayToCode), ''),  CONCAT('-'+(SELECT CRD1.ZipCode FROM CRD1 WHERE CRD1.CardCode=t0.CardCode AND CRD1.AdresType='B' AND CRD1.Address=t0.PayToCode), COALESCE (', '+(SELECT UPPER (OCRY.Name) FROM CRD1 LEFT OUTER JOIN OCRY ON OCRY.Code=CRD1.Country WHERE CRD1.CardCode=t0.CardCode AND CRD1.AdresType='B' and  CRD1.Address=t0.PayToCode),''))) as 'Billed To Address', (SELECT CRD1.GSTRegnNo FROM CRD1 WHERE CRD1.CardCode=t0.CardCode AND CRD1.AdresType='B' and crd1.Address=t0.PayToCode) as 'ConsgLocGSTNno', CASE WHEN LEN(T0.ShipToCode)>LEN(T0.CardName) THEN T0.ShipToCode ELSE T0.CardName END AS 'SHIP TO CODE', CONCAT(COALESCE (' '+(SELECT UPPER(CRD1.ADDRESS2) FROM CRD1 WHERE CRD1.CardCode=t0.CardCode and crd1.AdresType='S' and crd1.Address=t0.ShipToCode),' '), COALESCE (' '+(SELECT UPPER(CRD1.ADDRESS3) FROM CRD1 WHERE CRD1.CardCode=t0.CardCode and crd1.AdresType='S' and crd1.Address=t0.ShipToCode), ' '), COALESCE (' '+(SELECT UPPER (CRD1.Street) from crd1 where crd1.CardCode=t0.CardCode and crd1.AdresType='S' and crd1.Address=t0.ShipToCode),' '), COALESCE (' '+(SELECT UPPER(CRD1.Block) from crd1 where crd1.CardCode=t0.CardCode and crd1.AdresType='S' and crd1.Address=t0.ShipToCode), ' '), COALESCE (' '+(SELECT UPPER (CRD1.City) from crd1 where crd1.CardCode=t0.CardCode and crd1.AdresType='S' and crd1.Address=t0.ShipToCode), ' '), CONCAT (', '+(select UPPER(OCST.Name) from crd1 left outer join OCRY on OCRY.Code=crd1.Country left outer join ocst on ocst.Code=crd1.State and ocry.Code=ocst.Country  WHERE CRD1.CARDCODE=t0.CardCode and crd1.AdresType='S' and crd1.Address=t0.ShipToCode), ' ', COALESCE ('-'+(select crd1.ZipCode from crd1 where crd1.CardCode=t0.CardCode and crd1.AdresType='S' and crd1.Address=t0.ShipToCode), ' '), CONCAT(','+(select UPPER (OCRY.Name) from crd1 left outer join OCRY on OCRY.Code=crd1.Country where crd1.CardCode=t0.CardCode and crd1.AdresType='S' and  crd1.Address=t0.ShipToCode),''))) as 'Ship To Address', (SELECT CRD1.GSTRegnNo FROM CRD1 WHERE CRD1.CardCode=t0.CardCode AND CRD1.AdresType='S' and crd1.Address=t0.ShipToCode) as 'ShipGSTNno', T1.ItemCode ,T1.Dscription,ISNULL(T50.Substitute, T1.ItemCode) AS 'Cust Part No.',T1.Quantity,T1.UnitMsr, T1.Price as Rate, T1.LineTotal,T0.TotalExpns, T0.DocTotal,T1.LineNum,T1.PackQty,T1.U_UTL_BOX as 'BOX',  LEFT(T7.ChapterID,8) as 'HSNcode', ISNULL((SELECT (CASE WHEN SUM(x.RvsChrgTax)<=0  then sum(x.TaxSum)/t0.DocRate ELSE 0 END) FROM INV4 x Where x.DocEntry = t0.DocEntry and x.staType = -100 and x.LineNum = t1.LineNum and x.RelateType = 1),0) [CGSTAmt],  ISNULL((SELECT (CASE WHEN SUM(x.RvsChrgTax)<=0  then sum(x.TaxSum)/t0.DocRate ELSE 0 END) FROM INV4 x Where x.DocEntry = t0.DocEntry and x.staType = -110 and x.LineNum = t1.LineNum and x.RelateType = 1),0) [SGSTAmt], ISNULL((SELECT (CASE WHEN SUM(x.RvsChrgTax)<=0  then sum(x.TaxSum)/t0.DocRate ELSE 0 END) FROM INV4 x Where x.DocEntry = t0.DocEntry and x.staType = -120 and x.LineNum = t1.LineNum and x.RelateType = 1),0) [IGSTAmt], ISNULL((SELECT (CASE WHEN SUM(x.RvsChrgTax)<=0  then sum(x.TaxSum)/t0.DocRate ELSE 0 END) FROM INV4 x Where x.DocEntry = t0.DocEntry and x.staType = -150 and x.LineNum = t1.LineNum and x.RelateType = 1),0) [UTGSTAmt], ISNULL((SELECT DISTINCT (CASE WHEN SUM(x.RvsChrgTax)<=0  THEN  x.TaxRate ELSE 0 END ) FROM INV4 x Where x.DocEntry = t0.DocEntry and x.staType = -100 and x.LineNum = t1.LineNum and x.RelateType = 1 group by X.TaxRate),0) [CGSTRate],  ISNULL((SELECT DISTINCT (CASE WHEN SUM(x.RvsChrgTax)<=0  then x.TaxRate ELSE 0 END ) FROM INV4 x Where x.DocEntry = t0.DocEntry and x.staType = -110 and x.LineNum = t1.LineNum and x.RelateType = 1 group by X.TaxRate),0) [SGSTRate], ISNULL((SELECT DISTINCT (CASE WHEN SUM(x.RvsChrgTax)<=0  then x.TaxRate ELSE 0 END ) FROM INV4 x Where x.DocEntry = t0.DocEntry and x.staType = -120 and x.LineNum = t1.LineNum and x.RelateType = 1 group by X.TaxRate),0) [IGSTRate], ISNULL((SELECT DISTINCT (CASE WHEN SUM(x.RvsChrgTax)<=0  then x.TaxRate ELSE 0 END ) FROM INV4 x Where x.DocEntry = t0.DocEntry and x.staType = -150 and x.LineNum = t1.LineNum and x.RelateType = 1 group by X.TaxRate),0) [UTGSTRate],  CASE WHEN T0.CardCode IN ('C000055','C000056','C000057','C000194','C000058','C000177','C000179','C000059','C000060','C000061', 'C000179','C000062','C000063')  THEN CONCAT (t0.numatcard ,',',10,',',CONVERT (NUMERIC(10,0),T1.Quantity),',',T0.DocNum ,',', CONVERT (VARCHAR,t0.DocDate,104) ,',', CONVERT (NUMERIC (10,2),T1.PriceBefDi),',', CONVERT (NUMERIC (10,2),T1.price) ,',',ISNULL(T14.AliasName,'SHAPL') ,',',ISNULL(T1.SubCatNum, T1.ItemCode) ,',', ISNULL((Select CONVERT (NUMERIC (10,2),(case when  sum(x.RvsChrgTax)<=0  then sum(x.TaxSum)/t0.DocRate else 0 end))  From INV4 x Where x.DocEntry = t0.DocEntry and x.staType = -100 and x.LineNum = t1.LineNum and x.RelateType = 1),0) ,',', ISNULL((SELECT CONVERT (NUMERIC (10,2), (case when sum(x.RvsChrgTax)<=0  then sum(x.TaxSum)/t0.DocRate else 0 end)) From INV4 x Where x.DocEntry = t0.DocEntry and x.staType = -110 and x.LineNum = t1.LineNum and x.RelateType = 1),0) ,',', ISNULL((SELECT CONVERT (NUMERIC (10,2),(case when sum(x.RvsChrgTax)<=0  then sum(x.TaxSum)/t0.DocRate else 0 end)) From INV4 x Where x.DocEntry = t0.DocEntry and x.staType = -120 and x.LineNum = t1.LineNum and x.RelateType = 1),0) ,',', ISNULL((SELECT CONVERT (NUMERIC (10,2),(case when sum(x.RvsChrgTax)<=0  then sum(x.TaxSum)/t0.DocRate else 0 end)) From INV4 x Where x.DocEntry = t0.DocEntry and x.staType = -150 and x.LineNum = t1.LineNum and x.RelateType = 1),0) ,',', ISNULL((SELECT DISTINCT (CONVERT (NUMERIC (10,2),case when sum(x.RvsChrgTax)<=0  then  x.TaxRate else 0 end )) From INV4 x Where x.DocEntry = t0.DocEntry and x.staType = -100 and x.LineNum = t1.LineNum and x.RelateType = 1 group by X.TaxRate),0) , ',', ISNULL((SELECT DISTINCT (CONVERT (NUMERIC (10,2),case when sum(x.RvsChrgTax)<=0  then x.TaxRate else 0 end )) From INV4 x Where x.DocEntry = t0.DocEntry and x.staType = -110 and x.LineNum = t1.LineNum and x.RelateType = 1 group by X.TaxRate),0) ,',', ISNULL((SELECT DISTINCT (CONVERT (NUMERIC (10,2),case when sum(x.RvsChrgTax)<=0  then x.TaxRate else 0 end )) From INV4 x Where x.DocEntry = t0.DocEntry and x.staType = -120 and x.LineNum = t1.LineNum and x.RelateType = 1 group by X.TaxRate),0) ,',', ISNULL((SELECT DISTINCT (CONVERT (NUMERIC (10,2),case when sum(x.RvsChrgTax)<=0  then x.TaxRate else 0 end )) From INV4 x Where x.DocEntry = t0.DocEntry and x.staType = -150 and x.LineNum = t1.LineNum and x.RelateType = 1 group by X.TaxRate),0) ,',',      0.00,',',CONVERT(NUMERIC(10,2),T0.DocTotal),',',LEFT (T7.CHAPTERID,8))     WHEN T0.CardCode IN ('C000044','C000265','C000266','C000261','C000263','C000264','C000270','C000287','C000280','C000279', 'C000181','C000100','C000257','C000262','C000260','C000274','C000223','C000220','C000291','C000185','C000248','C000199','C000277', 'C000288','C000208','C000190','C000282','C000205','C000189','C000210','C000222','C000273','C000276','C000306','C000292','C000218', 'C000289','C000294','C000186','C000198','C000290','C000197','C000246','C000216','C000245','C000207','C000206','C000204','C000202', 'C000247','C000184','C000209','C000188','C000203','C000258','C000295','C000183','C000275','C000215','C000267','C000213','C000196', 'C000259','C000300','C000281','C000172','C000296','C000293','C000283','C000305','C000302','C000161','C000195','C000285','C000284', 'C000242','C000239','C000255','C000233','C000313','C000268','C000234','C000251','C000173','C000254','C000232','C000236','C000235', 'C000272','C000311','C000237','C000240','C000278','C000250','C000249')  THEN CONCAT ('SABO HEMA',',',t0.numatcard ,',',CONVERT (VARCHAR,t0.DocDate,104),',', 'RAIL',CONVERT (VARCHAR,t0.DocDate,105),',',CONVERT(VARCHAR,t0.DocDate,104),',',T0.DocNum ,',',CONVERT (VARCHAR,t0.DocDate,104) )  WHEN T0.CardCode IN ('C000074','C000003','C000004') THEN  CONCAT ('7202406','$',ISNULL(T50.Substitute, T1.ItemCode),'$','1','$',CONVERT (VARCHAR,t0.DocDate,105),'$', 'ASHK',CONVERT (VARCHAR,t0.DocDate,105),'$','40','$',T1.ItemCode,'$',T8.U_DrawingNo,'$',T1.Dscription,'$', 'SABO HEMA')  ELSE  CONCAT (T0.CardCode,',', ISNULL(T50.Substitute,T1.ItemCode),',', T0.DocNum,',',CONVERT (VARCHAR,T0.DocDate,104),',', CONVERT (NUMERIC (10,2),T1.Quantity)) END AS 'QR Code',   CASE WHEN T0.CardCode IN ('C000055','C000056','C000057','C000194','C000058','C000177','C000179','C000059','C000060','C000061', 'C000179','C000062','C000063')  THEN CONCAT ('(',t0.numatcard ,',',10,',',CONVERT (NUMERIC(10,0),T1.Quantity),',',T0.DocNum ,',', CONVERT (VARCHAR,t0.DocDate,104) ,',', CONVERT (NUMERIC (10,2),T1.PriceBefDi),',', CONVERT (NUMERIC (10,2),T1.price) ,',',ISNULL(T14.AliasName,'SHAPL') ,',',ISNULL(T1.SubCatNum, T1.ItemCode) ,',', ISNULL((SELECT CONVERT (NUMERIC (10,2),(case when  sum(x.RvsChrgTax)<=0  then sum(x.TaxSum)/t0.DocRate else 0 end))  FROM INV4 x Where x.DocEntry = t0.DocEntry and x.staType = -100 and x.LineNum = t1.LineNum and x.RelateType = 1),0) ,',', ISNULL((SELECT CONVERT (NUMERIC (10,2), (CASE WHEN SUM(x.RvsChrgTax)<=0  then sum(x.TaxSum)/t0.DocRate else 0 end)) From INV4 x Where x.DocEntry = t0.DocEntry and x.staType = -110 and x.LineNum = t1.LineNum and x.RelateType = 1),0) ,',', ISNULL((SELECT CONVERT (NUMERIC (10,2),(CASE WHEN SUM(x.RvsChrgTax)<=0  then sum(x.TaxSum)/t0.DocRate else 0 end)) From INV4 x Where x.DocEntry = t0.DocEntry and x.staType = -120 and x.LineNum = t1.LineNum and x.RelateType = 1),0) ,',', ISNULL((SELECT CONVERT (NUMERIC (10,2),(CASE WHEN SUM(x.RvsChrgTax)<=0  then sum(x.TaxSum)/t0.DocRate else 0 end)) From INV4 x Where x.DocEntry = t0.DocEntry and x.staType = -150 and x.LineNum = t1.LineNum and x.RelateType = 1),0) ,',', ISNULL((SELECT DISTINCT (CONVERT (NUMERIC (10,2),CASE WHEN SUM(x.RvsChrgTax)<=0  then  x.TaxRate else 0 end )) From INV4 x Where x.DocEntry = t0.DocEntry and x.staType = -100 and x.LineNum = t1.LineNum and x.RelateType = 1 group by X.TaxRate),0) , ',', ISNULL((SELECT DISTINCT (CONVERT (NUMERIC (10,2),CASE WHEN SUM(x.RvsChrgTax)<=0  then x.TaxRate else 0 end )) From INV4 x Where x.DocEntry = t0.DocEntry and x.staType = -110 and x.LineNum = t1.LineNum and x.RelateType = 1 group by X.TaxRate),0) ,',', ISNULL((SELECT DISTINCT (CONVERT (NUMERIC (10,2),CASE WHEN SUM(x.RvsChrgTax)<=0  then x.TaxRate else 0 end )) From INV4 x Where x.DocEntry = t0.DocEntry and x.staType = -120 and x.LineNum = t1.LineNum and x.RelateType = 1 group by X.TaxRate),0) ,',', ISNULL((SELECT DISTINCT (CONVERT (NUMERIC (10,2),CASE WHEN SUM(x.RvsChrgTax)<=0  then x.TaxRate else 0 end )) From INV4 x Where x.DocEntry = t0.DocEntry and x.staType = -150 and x.LineNum = t1.LineNum and x.RelateType = 1 group by X.TaxRate),0) ,',',      0.00,',',CONVERT(NUMERIC(10,2),T0.DocTotal),',',LEFT (T7.CHAPTERID,8),')')     WHEN T0.CardCode IN ('C000044','C000265','C000266','C000261','C000263','C000264','C000270','C000287','C000280','C000279', 'C000181','C000100','C000257','C000262','C000260','C000274','C000223','C000220','C000291','C000185','C000248','C000199','C000277', 'C000288','C000208','C000190','C000282','C000205','C000189','C000210','C000222','C000273','C000276','C000306','C000292','C000218', 'C000289','C000294','C000186','C000198','C000290','C000197','C000246','C000216','C000245','C000207','C000206','C000204','C000202', 'C000247','C000184','C000209','C000188','C000203','C000258','C000295','C000183','C000275','C000215','C000267','C000213','C000196', 'C000259','C000300','C000281','C000172','C000296','C000293','C000283','C000305','C000302','C000161','C000195','C000285','C000284', 'C000242','C000239','C000255','C000233','C000313','C000268','C000234','C000251','C000173','C000254','C000232','C000236','C000235', 'C000272','C000311','C000237','C000240','C000278','C000250','C000249')  THEN CONCAT ('(','SABO HEMA',',',t0.numatcard ,',',CONVERT (VARCHAR,t0.DocDate,104),',', 'RAIL',CONVERT (VARCHAR,t0.DocDate,105),',',CONVERT(VARCHAR,t0.DocDate,104),',',T0.DocNum ,',',CONVERT (VARCHAR,t0.DocDate,104),')' )  WHEN T0.CardCode IN ('C000074','C000003','C000004') THEN  CONCAT ('(','7202406','$',ISNULL(T50.Substitute, T1.ItemCode),'$','1','$',CONVERT (VARCHAR,t0.DocDate,105),'$', 'ASHK',CONVERT (VARCHAR,t0.DocDate,105),'$','40','$',T1.ItemCode,'$',T8.U_DrawingNo,'$',T1.Dscription,'$', 'SABO HEMA',')')  ELSE  CONCAT ('(',T0.CardCode,',', ISNULL(T50.Substitute,T1.ItemCode),',', T0.DocNum,',',CONVERT (VARCHAR,T0.DocDate,104),',', CONVERT (NUMERIC (10,2),T1.Quantity),')') END AS 'BAR Code',T16.FileContnt  from OINV t0  INNER JOIN ADP1 dd on dd.objtype=t0.ObjType  INNER JOIN INV1 t1 on t1.DocEntry=t0.DocEntry LEFT JOIN DLN1 c on c.DocEntry = t1.BaseEntry and c.LineNum = t1.BaseLine LEFT JOIN ODLN d on d.DocEntry = c.DocEntry LEFT JOIN RDR1 e on e.DocEntry = c.BaseEntry and e.LineNum = c.BaseLine LEFT JOIN ORDR f on f.DocEntry = e.DocEntry LEFT OUTER JOIN OWHS t2 on t2.WhsCode=t1.WhsCode  LEFT OUTER JOIN OLCT t3 on t3.Code=t2.Location LEFT OUTER JOIN OBPL Bt1 on  Bt1.BPLId =t0.BPLId LEFT OUTER JOIN OWHS Bt2 on  Bt2.WhsCode =Bt1.DflWhs LEFT OUTER JOIN OLCT Bt3 on  Bt3.Code =Bt2.Location LEFT OUTER JOIN OCRY BT5 on  Bt5.Code =Bt3.Country LEFT OUTER JOIN OCST BT4 on  Bt4.Code =Bt3.State and bt4.Country=Bt5.Code LEFT OUTER JOIN OCRY T5 ON T5.code=t3.Country LEFT OUTER JOIN OCST T4 ON T4.code=t3.State  AND T4.Country=t5.Code LEFT OUTER JOIN OITM T8 ON T8.ItemCode=t1.ItemCode LEFT OUTER JOIN OCHP T7 ON T7.AbsEntry=t1.HsnEntry LEFT OUTER JOIN OCTG T9 ON T9.GroupNum=t0.GroupNum LEFT OUTER JOIN NNM1 T10 ON T10.Series=t0.Series LEFT OUTER JOIN OCPR T13 ON T13.CntctCode=T0.CntctCode LEFT JOIN OCRD T14 ON T14.CardCode = T0.CardCode LEFT JOIN INV12 T15 ON T15.DocEntry = T0.DOCENTRY LEFT JOIN OSAC S1 ON S1.AbsEntry=T8.SACEntry LEFT JOIN OQRC T16 ON T16.SrcObjAbs = T0.DocEntry AND T16.SrcObjType =13 LEFT JOIN OSCN T50 ON T50.ItemCode = T1.ItemCode AND T50.CardCode = T0.CardCode   ORDER BY T0.DocEntry DESC
declare @fromdate DATE, @todate DATE , @itemcode NVARCHAR(40), @cardcode NVARCHAR(200) , @whscode NVARCHAR(20)  ,  @ItmGrp nvarchar(200) , @username nvarchar(100), @PRstatus nvarchar(20) set @fromdate =(select min(T0.docdate) from OPDN T0 where T0.docdate >='[%0]') set  @todate = (select max(T1.docdate) from OPDN T1 where T1.docdate <='[%1]') set  @itemcode =(select max(T2.itemcode) from oitm T2 where T2.itemcode='[%2]') set  @ItmGrp =(select max(T5.ItmsgrpNam) from OITB T5 where T5.ItmsgrpNam='[%5]') set  @username=(select max(T6.ReqName) from Oprq T6 where T6.ReqName='[%6]') if(@fromdate ='' or @fromdate='')    set @fromdate =null if( @todate ='' or @TOdate='')    set @todate =null if (@itemcode ='ALL' or @itemcode = '')            set @itemcode = null if (@cardcode ='ALL' or @cardcode = '')            set @cardcode = null if (@whscode ='ALL' or @whscode = '')            set @whscode = null if (@ItmGrp ='ALL' or @ItmGrp = '')            set @ItmGrp = null if (@username ='ALL' or @username = '')            set @username = null  SELECT O.DOCNUM'PR NO.', O.DOCDATE 'PR DATE', O.REQNAME 'REQUESTED BY', P.ITEMCODE 'ITEM CODE', P.DSCRIPTION 'ITEM DESC.',  P.QUANTITY , p.OpenQty, P.PQTReqDate 'REQ. DATE',  P.docentry, P.LineNum, P.LineStatus as 'PRstatus', convert(nvarchar(200),'')   [Item Group], CONVERT(nvarchar(200),'')   [PO No], CONVERT(nvarchar(200),'')   [PO DocEntry],  CONVERT(nvarchar(200),'')   [PO LineNum], CONVERT(date,Null)          [PO Date], CONVERT(nvarchar(200),'')   [PO Party Code],  CONVERT(nvarchar(200),'')   [PO Party Name], CONVERT(nvarchar(200),'')   [PO Item Code],  CONVERT(nvarchar(200),'')   [PO Item Name], CONVERT(numeric(19,2),0)    [PO Quantity],  CONVERT(numeric(19,2),0)    [PO Open Qty], CONVERT(numeric(19,2),0)    [PO Price], CONVERT(numeric(19,2),0)    [PO VatSum],  CONVERT(numeric(19,2),0)    [PO Total], CONVERT(nvarchar(400),'')   [PO Vendor Ref No.],  CONVERT(nvarchar(400),'')   [PO Remark], convert(nvarchar(200),'')   [GRPO DOCENTRY], convert(nvarchar(200),'')   [GRPO No], CONVERT(nvarchar(200),'')   [GRPO LineNum], convert(DAte,Null)          [GRPO Date],  convert(nvarchar(200),'')   [GRPO CardCode], convert(nvarchar(300),'')   [GRPO CARDNAME],  convert(nvarchar(200),'')   [GRPO ITEM CODE], convert(nvarchar(200),'')   [GRPO Item Name],  CONVERT(numeric(19,2),0)    [GRPO QUANTITY], CONVERT(numeric(19,2),0)    [GRPO Price],  CONVERT(numeric(19,2),0)    [GRPO VatSum], CONVERT(numeric(19,2),0)    [GRPO Total],  CONVERT(Nvarchar(400),'')   [GRPO Vendor Ref No.], CONVERT(Nvarchar(400),'')   [GRPO Remarks],  convert(nvarchar(200),'')   [AP DocENTRY], convert(nvarchar(200),'')   [AP No], convert(DAte,Null)          [AP Date],  convert(nvarchar(200),'')   [AP CARDCODE], convert(nvarchar(200),'')   [AP CARDNAME],  convert(nvarchar(200),'')   [AP ITEM CODE], convert(nvarchar(200),'')   [AP Item Name],  CONVERT(numeric(19,2),0)    [AP QUANTITY], CONVERT(numeric(19,2),0)    [AP Price], CONVERT(numeric(19,2),0)    [AP VatSum],  CONVERT(numeric(19,2),0)    [AP Total], CONVERT(Nvarchar(400),'')   [AP Vendor Ref No.],  CONVERT(Nvarchar(400),'')   [AP Remarks] into  #Temp from OPRQ O , PRQ1 P where  O.DocEntry=P.DocEntry and O.DocDate between isnull(@fromdate,O.DocDate) and Isnull(@todate,o.docdate)  AND p.ITEMCODE = isnull(@itemcode,p.ITEMCODE) and P.WhsCode = ISNULL(@whscode ,P.WhsCode) and O.ReqName=ISNULL(@username, O.ReqName) update  t   set                [PO Quantity] = A.Quantity  ,       [PO Open Qty] = A.OpenQty    ,      [PO No]  =h.docnum              from #Temp t , OPOR H, (select SUM(B.Quantity) Quantity, SUM(B.OpenQty) OpenQty, B.BaseEntry, B.BaseLine, B.DocEntry     from POR1 B     group by B.BaseEntry,B.BaseLine,B.DocEntry) A   where  t.docentry=A.BaseEntry   and t.LineNum =A.BaseLine and H.DocEntry = A.DocEntry and H.canceled='N' update  t   set                [GRPO QUANTITY] = A.Quantity                       from #Temp t , OPDN H, POR1 D ,  (select SUM(B.Quantity) Quantity, B.BaseEntry, B.BaseLine, B.DocEntry     from PDN1 B     group by B.BaseEntry,B.BaseLine,B.DocEntry) A   where  D.docentry=A.BaseEntry and D.LineNum =A.BaseLine   and H.DocEntry = A.DocEntry and t.docentry=D.BaseEntry and t.LineNum =D.BaseLine and H.canceled='N'   and H.CardName = ISNULl( @cardcode,H.CardName ) Update  t   set     [Item Group]=B.ItmsGrpNam   from #Temp t , OITM A, OITB B   where   t.[ITEM CODE] = A.ItemCode  and A.ItmsGrpCod = B.ItmsGrpCod and B.ItmsGrpNam = isnull(@ItmGrp,B.ItmsGrpNam) update  t   set                [AP QUANTITY] = A.Quantity                       from #Temp t , OPCH H, POR1 D , PDN1 E,  (select SUM(B.Quantity) Quantity, B.BaseEntry, B.BaseLine, B.DocEntry     from PCH1 B     group by B.BaseEntry,B.BaseLine,B.DocEntry) A     where  E.docentry=A.BaseEntry and E.LineNum =A.BaseLine and H.DocEntry = A.DocEntry   and D.docentry=e.BaseEntry and D.LineNum =E.BaseLine and t.DocEntry=D.BaseEntry and t.LineNum=D.BaseLine and H.canceled='N' select [PR NO.], DocEntry, [PR Date], [REQUESTED BY], [Item Code], [Item Desc.], [Item Group], Quantity, OpenQty, [REQ. DATE],  [PO No], [PO Quantity], [PO Open Qty], [GRPO QUANTITY], [AP QUANTITY], [PRStatus] from #temp order by [pr no.]
SELECT  T0.[ItmsGrpCod]        ,T0.[ItmsGrpNam]        ,T0.[BalInvntAc]        ,T1.AcctName  AS [Inventory Account Name]        ,T0.[SaleCostAc]        ,T2.AcctName  AS [Cost of Goods Sold Account Name]        ,T0.[TransferAc]        ,T3.AcctName  AS [Allocation Account Name]        ,T0.[RevenuesAc]        ,T4.AcctName  AS [Revenue Account Name]        ,T0.[VarianceAc]        ,T5.AcctName  AS [Variance Account Name]        ,T0.[DecreasAc]        ,T6.AcctName  AS [Inventory Offset - Decrease Account Name]        ,T0.[IncreasAc]        ,T7.AcctName  AS [Inventory Offset - Increase Account Name]        ,T0.[ReturnAc]        ,T8.AcctName  AS [Sales Returns Account Name]        ,T0.[ExpensesAc]        ,T9.AcctName  AS [Expense Account Name]        ,T0.[EURevenuAc]        ,T10.AcctName AS [Revenue Account - EU Name]        ,T0.[EUExpensAc]        ,T11.AcctName AS [Expense Account - EU Name]        ,T0.[FrRevenuAc]        ,T12.AcctName AS [Revenue Account - Foreign Name]        ,T0.[FrExpensAc]        ,T13.AcctName AS [Expense Account - Foreign Name]        ,T0.[ExmptIncom]        ,T14.AcctName AS [Exempt Revenue Account Name]        ,T0.[PriceDifAc]        ,T15.AcctName AS [Price Difference Account Name]        ,T0.[ExchangeAc]        ,T16.AcctName AS [Exchange Rate Differences Account Name]        ,T0.[BalanceAcc]        ,T17.AcctName AS [Goods Clearing Account Name]        ,T0.[PurchaseAc]        ,T18.AcctName AS [Purchase Account Name]        ,T0.[PAReturnAc]        ,T19.AcctName AS [Purchase Return Account Name]        ,T0.[PurchOfsAc]        ,T20.AcctName AS [Purchase Offset Account Name]        ,T0.[ShpdGdsAct]        ,T21.AcctName AS [Shipped Goods Account Name]        ,T0.[VatRevAct]        ,T22.AcctName AS [VAT IN Revenue Account Name]        ,T0.[DecresGlAc]        ,T23.AcctName AS [G/L Decrease Account Name]        ,T0.[IncresGlAc]        ,T24.AcctName AS [G/L Increase Account Name]        ,T0.[StokRvlAct]        ,T25.AcctName AS [Inventory Revaluation Account Name]        ,T0.[StkOffsAct]        ,T26.AcctName AS [Inventory Revaluation Offset Account Name]        ,T0.[WipAcct]        ,T27.AcctName AS [WIP Inventory Account Name]        ,T0.[WipVarAcct]        ,T28.AcctName AS [WIP Inventory Variance Account Name]        ,T0.[CostRvlAct]        ,T29.AcctName AS [COGS Revaluation Account Name]        ,T0.[CstOffsAct]        ,T30.AcctName AS [COGS Revaluation Offset Acct Name]        ,T0.[ExpClrAct]        ,T31.AcctName AS [Expense Clearing Account Name]        ,T0.[ExpOfstAct]        ,T32.AcctName AS [Expense Offset Account Name]        ,T0.[ARCMAct]        ,T33.AcctName AS [Sales Credit Account Name]        ,T0.[ARCMFrnAct]        ,T34.AcctName AS [Sales Credit Account - Foreign Name]        ,T0.[ARCMEUAct]        ,T35.AcctName AS [Sales Credit Account - EU Name]        ,T0.[ARCMExpAct]        ,T36.AcctName AS [Tax Exempt Credit Account Name]        ,T0.[APCMAct]        ,T37.AcctName AS [Purchase Credit Account Name]        ,T0.[APCMFrnAct]        ,T38.AcctName AS [Purchase Credit Account - Foreign Name]        ,T0.[APCMEUAct]        ,T39.AcctName AS [Purchase Credit Account - EU Name]        ,T0.[RevRetAct]        ,T40.AcctName AS [Revenue Returns Account Name]        ,T0.[NegStckAct]        ,T41.AcctName AS [Negative Inventory Adjustment Acct Name]        ,T0.[StkInTnAct]        ,T42.AcctName AS [Stock IN Transit Account Name]        ,T0.[PurBalAct]        ,T43.AcctName AS [Purchase Balance Account Name]        ,T0.[WhICenAct]        ,T44.AcctName AS [Incoming CENVAT Account (WH) Name]        ,T0.[WhOCenAct]        ,T45.AcctName AS [Outgoing CENVAT Account (WH) Name]        ,T0.[WipOffset]        ,T46.AcctName AS [WIP Offset P&L Account Name]        ,T0.[StockOffst]        ,T47.AcctName AS [Inventory Offset P&L Account Name] FROM [OITB] T0 LEFT JOIN OACT T1 ON T1.AcctCode = T0.[BalInvntAc] LEFT JOIN OACT T2 ON T2.AcctCode = T0.[SaleCostAc] LEFT JOIN OACT T3 ON T3.AcctCode = T0.[TransferAc] LEFT JOIN OACT T4 ON T4.AcctCode = T0.[RevenuesAc] LEFT JOIN OACT T5 ON T5.AcctCode = T0.[VarianceAc] LEFT JOIN OACT T6 ON T6.AcctCode = T0.[DecreasAc] LEFT JOIN OACT T7 ON T7.AcctCode = T0.[IncreasAc] LEFT JOIN OACT T8 ON T8.AcctCode = T0.[ReturnAc] LEFT JOIN OACT T9 ON T9.AcctCode = T0.[ExpensesAc] LEFT JOIN OACT T10 ON T10.AcctCode = T0.[EURevenuAc] LEFT JOIN OACT T11 ON T11.AcctCode = T0.[EUExpensAc] LEFT JOIN OACT T12 ON T12.AcctCode = T0.[FrRevenuAc] LEFT JOIN OACT T13 ON T13.AcctCode = T0.[FrExpensAc] LEFT JOIN OACT T14 ON T14.AcctCode = T0.[ExmptIncom] LEFT JOIN OACT T15 ON T15.AcctCode = T0.[PriceDifAc] LEFT JOIN OACT T16 ON T16.AcctCode = T0.[ExchangeAc] LEFT JOIN OACT T17 ON T17.AcctCode = T0.[BalanceAcc] LEFT JOIN OACT T18 ON T18.AcctCode = T0.[PurchaseAc] LEFT JOIN OACT T19 ON T19.AcctCode = T0.[PAReturnAc] LEFT JOIN OACT T20 ON T20.AcctCode = T0.[PurchOfsAc] LEFT JOIN OACT T21 ON T21.AcctCode = T0.[ShpdGdsAct] LEFT JOIN OACT T22 ON T22.AcctCode = T0.[VatRevAct] LEFT JOIN OACT T23 ON T23.AcctCode = T0.[DecresGlAc] LEFT JOIN OACT T24 ON T24.AcctCode = T0.[IncresGlAc] LEFT JOIN OACT T25 ON T25.AcctCode = T0.[StokRvlAct] LEFT JOIN OACT T26 ON T26.AcctCode = T0.[StkOffsAct] LEFT JOIN OACT T27 ON T27.AcctCode = T0.[WipAcct] LEFT JOIN OACT T28 ON T28.AcctCode = T0.[WipVarAcct] LEFT JOIN OACT T29 ON T29.AcctCode = T0.[CostRvlAct] LEFT JOIN OACT T30 ON T30.AcctCode = T0.[CstOffsAct] LEFT JOIN OACT T31 ON T31.AcctCode = T0.[ExpClrAct] LEFT JOIN OACT T32 ON T32.AcctCode = T0.[ExpOfstAct] LEFT JOIN OACT T33 ON T33.AcctCode = T0.[ARCMAct] LEFT JOIN OACT T34 ON T34.AcctCode = T0.[ARCMFrnAct] LEFT JOIN OACT T35 ON T35.AcctCode = T0.[ARCMEUAct] LEFT JOIN OACT T36 ON T36.AcctCode = T0.[ARCMExpAct] LEFT JOIN OACT T37 ON T37.AcctCode = T0.[APCMAct] LEFT JOIN OACT T38 ON T38.AcctCode = T0.[APCMFrnAct] LEFT JOIN OACT T39 ON T39.AcctCode = T0.[APCMEUAct] LEFT JOIN OACT T40 ON T40.AcctCode = T0.[RevRetAct] LEFT JOIN OACT T41 ON T41.AcctCode = T0.[NegStckAct] LEFT JOIN OACT T42 ON T42.AcctCode = T0.[StkInTnAct] LEFT JOIN OACT T43 ON T43.AcctCode = T0.[PurBalAct] LEFT JOIN OACT T44 ON T44.AcctCode = T0.[WhICenAct] LEFT JOIN OACT T45 ON T45.AcctCode = T0.[WhOCenAct] LEFT JOIN OACT T46 ON T46.AcctCode = T0.[WipOffset] LEFT JOIN OACT T47 ON T47.AcctCode = T0.[StockOffst]
SELECT  T0.DOCNUM,ISNULL(CD.GSTRegnNo,'') AS GSTIN, CONVERT(VARCHAR,ST.eCode) +'-'+IsNull(ST.Name,'') AS [State of Job Worker],Cast(T0.Docnum As Nvarchar(50)) AS 'RGP NO',  CONVERT( VARCHAR(20),T0.DocDate ,105) AS [RGP Date], T1.ItemCode AS [Item Code],T1.Dscription AS [Description of Goods], ISNULL(T2.[InvntryUom],'') AS UoMName , T1.Quantity , Case when T1.Stockprice <=0 Then  (T1.Price*T1.Quantity) ELSE (T1.StockPrice*T1.Quantity)  END  AS [Taxable Value] ,T2.U_ITTYPE AS [Type of Goods], ISNULL((CASE WHEN ST.Code ='HR' THEN ISNULL(CONVERT (NUMERIC (10,2),TM.U_RATE) / 2,0) END),0) AS [CGST %] , ISNULL((CASE WHEN ST.Code ='HR' THEN ISNULL(CONVERT (NUMERIC (10,2),TM.U_RATE) /2,0) END) ,0) AS [SGST %] , ISNULL((CASE WHEN ST.Code !='HR' THEN ISNULL(CONVERT (NUMERIC (10,2),TM.U_RATE),0) END),0) AS [IGST %] , ISNULL((CASE WHEN ST.Code !='HR' THEN ISNULL(CONVERT (NUMERIC (10,2),TM.U_RATE),0) END),0) AS [Cess %] ,  T0.[CANCELED] --ISNULL(T0.U_JVCD,'') AS VendorCode,Isnull(T0.CardCode,'') CardCode ,Isnull(ST.Code,'') Code,Isnull(ST.eCode,0)eCode ,ISnull(ST.Name,'') Name FROM OWTR T0  INNER JOIN WTR1 T1 ON T0.DocEntry =T1.DocEntry   INNER JOIN OITM T2 ON T1.ITEMCODE = T2.ITEMCODE  LEFT JOIN CRD1 CD ON CD.CardCode =  T0.U_JVCD  AND  CD.Address = T0.ShipToCode AND CD.AdresType='S' LEFT JOIN OCRY C ON C.Code = CD.Country  LEFT JOIN OCST ST ON ST.Code = CD.State AND ST.Country = C.Code  INNER JOIN OITM TM ON  TM.ItemCode = T1.ItemCode  WHERE  ISNULL(T0.U_JBNO,'') !='' AND T0.DOCDATE>=[%0] AND T0.DOCDATE<=[%1] and t0.series != 226   order by t0.docnum
select DISTINCT  T2.DocNum as 'RGP No', t2.docdate as 'RGP Date' ,T2.u_jbno, T2.CardName , T3.ITEMCODE, T3.DSCRIPTION,T2.U_U_CLREMARK,  (select ISNULL(sum(z.Quantity),0) from WTR1 z inner join OWTR x on z.DocEntry=x.DocEntry  WHERE  z.ItemCode=T3.ItemCode and x.U_JBNO=t2.U_JBNO and x.docdate<=[%2]) as 'Send Qty',  (select ISNULL(sum(A.Quantity),0) from IGE1 A inner join oige B on a.DocEntry=b.DocEntry WHERE b.u_jwtr <>'yes' and  --A.LineNum=T1.LINENUM AND  A.ItemCode=T3.ItemCode and b.U_JBNO=t0.U_JBNO and b.docdate<=[%2]) as 'Receive QTY' ,(select ISNULL(sum(z.Quantity),0) from WTR1 z inner join OWTR x on z.DocEntry=x.DocEntry  WHERE  z.ItemCode=T3.ItemCode and x.U_JBNO=t2.U_JBNO and x.docdate<=[%2])  - (select ISNULL(sum(A.Quantity),0) from IGE1 A inner join oige B on a.DocEntry=b.DocEntry WHERE b.u_jwtr <>'yes' and  --A.LineNum=T1.LINENUM AND  A.ItemCode=T3.ItemCode and b.U_JBNO=t0.U_JBNO and b.docdate<=[%2]) as 'Balance QTY'   from OWTR T2  INNER JOIN WTR1 T3 ON T2.DocEntry=T3.DocEntry LEFT OUTER JOIN OIGE T0 ON T2.U_JBNO = T0.U_JBNO LEFT OUTER JOIN IGE1 T1 ON T0.DocEntry = T1.DocEntry     WHERE T2.U_JBNO <> '' and T2.DOCDATE >= [%0] and T2.DocDate<=[%1]   order by t2.u_jbno
SELECT  DISTINCT CD.GSTRegnNo AS GSTIN  ,T2.DocNum As 'GOODS' ,CONVERT(VARCHAR,ST.eCode) +'-'+ST.Name AS [State of Job Worker] ,T2.U_CHNO AS [Challan Number of Job Worker under which goods have been recd back], CONVERT (VARCHAR ,T2.U_CHDT,105) AS [Date of Challan issued by Job Worker under which goods have been recd back] ,T9.U_POIT AS [Item Code] ,T9.U_ITNM AS [Description of Goods], IsNull(T6.unitMsr,'') AS UQC,  T6.Quantity AS Qty , T4.InvntryUom, (T6.Quantity*WTR1.StockPrice) AS 'TOTAL'  , Cast(T6.U_INVN As Nvarchar(50)) AS [Original Challan No] ,CONVERT(VARCHAR(20),T7.DocDate,105) AS [Original Challan Date], '' AS [Nature of Job Work done by Job Worker], 'GOODS REcived Back from JW' AS [Nature of Transaction] FROM [@DR_FGSELECTION] T9 -- OIGN T0  --INNER JOIN IGN1 T1 ON T0.DocEntry = T1.DocEntry  ---and T0.U_Jbno is not null and T0.U_Jbno<>''   LEFT join OIGE T5 on  T9.DocEntry=T5.U_FGEN INNER join IGE1 T6 on t6.docentry=t5.docentry and t9.LineId=t6.U_FGLNO  LEFT join OIGN T2 on t2.DocNum=t5.U_RFPN LEFT join OWTR T7 on T7.DOCENTRY=T6.U_INVE  Inner join oitm T4 on T6.ItemCode=T4.ItemCode  ----LEFT join [@DR_FGSELECTION] T8 on T8.DocEntry=T5.U_FGEN and  T8.LineId=T6.U_FGLNO and U_CHK='Y' LEFT join wtr1 on  wtr1.docentry=T7.docentry LEFT JOIN CRD1 CD ON CD.CardCode = T5.U_JVCD  AND CD.AdresType ='S' --AND CD.Address = T0.ShipToCode LEFT JOIN OCRY C ON C.Code = CD.Country  LEFT JOIN OCST ST ON ST.Code = CD.State AND ST.Country = C.Code  WHERE ISNULL(T5.U_RFPN,'') !=''   and t2.DocDate >= [%0] and T2.docdate <=[%1]  Union    SELECT DISTINCT  CD.GSTRegnNo AS GSTIN  ,T0.DocNum As 'GOODS' ,CONVERT(VARCHAR,ST.eCode) +'-'+ST.Name AS [State of Job Worker] ,T0.U_CHNO AS [Challan Number of Job Worker under which goods have been recd back] ,CONVERT (VARCHAR,T0.U_CHDT,105) AS [Date of Challan issued by Job Worker under which goods have been recd back] ,T1.ItemCode AS [Item Code] ,T1.Dscription AS [Description of Goods], IsNull(T1.unitMsr,'') AS UQC ,T1.Quantity AS Qty ,'' , case when t6.StockPrice != 0 then (t6.StockPrice*T1.quantity) else (WTR1.Price*T1.quantity) END  AS 'TOTAL'  ,Cast(T6.U_INVN As Nvarchar(50)) AS [Original Challan No] ,CONVERT(VARCHAR(20),T7.DocDate,105) AS [Original Challan Date], '' AS [Nature of Job Work done by Job Worker], 'GOODS REcived Back from JW' AS [Nature of Transaction] FROM OIGN T0 INNER JOIN  IGN1 T1 ON T0.DocEntry = T1.DocEntry  LEFT JOIN OIGE T2 ON T2.U_JBNO = T0.U_JBNO  LEFT join ige1 t6 on t6.DocEntry = t2.DocEntry And t6.ItemCode = t1.itemcode And t6.U_CHLN= t1.U_CHLN  LEFT join OWTR T7 on T7.DOCENTRY=T6.U_INVE   LEFT join wtr1 on  wtr1.docentry=T7.docentry and wtr1.itemcode=t1.itemcode LEFT JOIN CRD1 CD ON CD.CardCode = T2.U_JVCD  AND CD.AdresType ='S' --AND CD.Address = T0.ShipToCode LEFT JOIN OCRY C ON C.Code = CD.Country  LEFT JOIN OCST ST ON ST.Code = CD.State AND ST.Country = C.Code  WHERE ISNULL(T2.U_RFPN,'') !=''  and T2.U_JWISSTYP='F' and t2.DocDate >= [%0] and T2.docdate <=[%1]   UNION  SELECT  DISTINCT CD.GSTRegnNo AS GSTIN  ,T2.DocNum As 'GOODS' ,CONVERT(VARCHAR,ST.eCode) +'-'+ST.Name AS [State of Job Worker] ,T2.U_CHNO AS [Challan Number of Job Worker under which goods have been recd back], CONVERT (VARCHAR ,T2.U_CHDT,105) AS [Date of Challan issued by Job Worker under which goods have been recd back] ,T9.U_JBIT AS [Item Code] ,T9.U_JBITNM AS [Description of Goods], IsNull(T6.unitMsr,'') AS UQC,  T6.Quantity AS Qty , T4.InvntryUom, (T6.Quantity*WTR1.StockPrice) AS 'TOTAL'  , Cast(T6.U_INVN As Nvarchar(50)) AS [Original Challan No] ,CONVERT(VARCHAR(20),T7.DocDate,105) AS [Original Challan Date], '' AS [Nature of Job Work done by Job Worker], 'GOODS REcived Back from JW' AS [Nature of Transaction] FROM [@DR_SCPSELECTION] T9 -- OIGN T0  --INNER JOIN IGN1 T1 ON T0.DocEntry = T1.DocEntry  ---and T0.U_Jbno is not null and T0.U_Jbno<>''   LEFT join OIGE T5 on  T9.DocEntry=T5.U_SCPEN INNER join IGE1 T6 on t6.docentry=t5.docentry and t9.LineId=t6.U_FGLNO  LEFT join OIGN T2 on t2.DocNum=t5.U_RFPN LEFT join OWTR T7 on T7.DOCENTRY=T6.U_INVE  Inner join oitm T4 on T6.ItemCode=T4.ItemCode  ----LEFT join [@DR_FGSELECTION] T8 on T8.DocEntry=T5.U_FGEN and  T8.LineId=T6.U_FGLNO and U_CHK='Y' LEFT join wtr1 on  wtr1.docentry=T7.docentry LEFT JOIN CRD1 CD ON CD.CardCode = T5.U_JVCD  AND CD.AdresType ='S' --AND CD.Address = T0.ShipToCode LEFT JOIN OCRY C ON C.Code = CD.Country  LEFT JOIN OCST ST ON ST.Code = CD.State AND ST.Country = C.Code  WHERE ISNULL(T5.U_RFPN,'') !=''   and t2.DocDate >= [%0] and T2.docdate <=[%1]  UNION  SELECT  DISTINCT CD.GSTRegnNo AS GSTIN  ,T2.DocNum As 'GOODS' ,CONVERT(VARCHAR,ST.eCode) +'-'+ST.Name AS [State of Job Worker] ,T2.U_CHNO AS [Challan Number of Job Worker under which goods have been recd back], CONVERT (VARCHAR ,T2.U_CHDT,105) AS [Date of Challan issued by Job Worker under which goods have been recd back] ,T9.U_RMIT AS [Item Code] ,T9.U_RMITNM AS [Description of Goods], IsNull(T6.unitMsr,'') AS UQC,  T6.Quantity AS Qty , T4.InvntryUom, (T6.Quantity*WTR1.StockPrice) AS 'TOTAL'  , Cast(T6.U_INVN As Nvarchar(50)) AS [Original Challan No] ,CONVERT(VARCHAR(20),T7.DocDate,105) AS [Original Challan Date], '' AS [Nature of Job Work done by Job Worker], 'GOODS REcived Back from JW' AS [Nature of Transaction] FROM [@DR_RMSELECTION] T9 -- OIGN T0  --INNER JOIN IGN1 T1 ON T0.DocEntry = T1.DocEntry  ---and T0.U_Jbno is not null and T0.U_Jbno<>''   LEFT join OIGE T5 on  T9.DocEntry=T5.U_RMEN INNER join IGE1 T6 on t6.docentry=t5.docentry and t9.LineId=t6.U_FGLNO  LEFT join OIGN T2 on t2.DocNum=t5.U_RFPN LEFT join OWTR T7 on T7.DOCENTRY=T6.U_INVE  Inner join oitm T4 on T6.ItemCode=T4.ItemCode  ----LEFT join [@DR_FGSELECTION] T8 on T8.DocEntry=T5.U_FGEN and  T8.LineId=T6.U_FGLNO and U_CHK='Y' LEFT join wtr1 on  wtr1.docentry=T7.docentry LEFT JOIN CRD1 CD ON CD.CardCode = T5.U_JVCD  AND CD.AdresType ='S' --AND CD.Address = T0.ShipToCode LEFT JOIN OCRY C ON C.Code = CD.Country  LEFT JOIN OCST ST ON ST.Code = CD.State AND ST.Country = C.Code  WHERE ISNULL(T5.U_RFPN,'') !=''   and t2.DocDate >= [%0] and T2.docdate <=[%1]
select DISTINCT cardname, DocNum as 'AP NO', T0.DocDate as 'AP Date', NumAtCard as 'Bill No', taxdate as 'Bill Date',  DocTotal as 'Amount in INR',[PaidToDate] as 'Received Amount', (DocTotal -[PaidToDate]) as 'Balance Amount',   DATEDIFF(DD,taxdate,GETDATE()) as 'Due From Day'   from Opch T0 INNER JOIN pch1 T1 ON T0.DocEntry = T1.DocEntry where DocStatus= 'o' and T0.docDate > '20190401'  and  DATEDIFF(DD,taxdate,GETDATE()) > '120'   order by [Due From Day] DESC
Declare @FromDT Varchar(20) Declare @ToDT Varchar(20) Select @FromDT = T0.DocDate from OINV T0 where T0.DocDate = '[%0]' Select @ToDT =  T0.DocDate from OINV T0 where T0.DocDate = '[%1]'   Select A.DocNum,A.DocDate,A.Cardcode,A.CardName,A.BpGSTN,A.GROUPNAME, A.RevRefNo as 'Ref. Invoice No.',A.RevRefDate AS 'Ref. Invoice date', SUM(A.[Quantity])[Quantity], SUM(A.Total) Total,A.DiscSum DiscSum, Sum(A.CGSTAMNT) CGSTAMNT, SUM(A.SGSTAMNT)SGSTAMNT, SUM(A.IGSTAMNT) IGSTAMNT, SUM(A.TCSAMNT) TCSAMNT, Sum(A.TotalExpns) As 'Freight',A.[Total Value] 'Total Value'   From ( SELECT T0.[DocNum], T0.[DocDate], T0.[CardCode], T0.[CardName],INV.BpGSTN, T3.GROUPNAME,  --T0.[RevRefNo],T0.[RevRefDate], T1.[Quantity], T1.[LineTotal] As 'Total',T0.DiscSum [DiscSum], ISNULL((SELECT CASE WHEN SUM(RIN4.RvsChrgPrc)!=0 THEN ((Case When T0.DocCur = 'INR' Then  SUM(RIN4.TaxSum) Else Sum(RIN4.TaxSumFrgn) End) - (Case When T0.DocCur = 'INR' Then SUM(RIN4.RvsChrgTax) Else Sum(RIN4.RvsChrgFC) End)) ELSE (Case When T0.DocCur ='INR' Then  SUM(RIN4.TaxSum) Else Sum(RIN4.TaxSumFrgn) End) END  FROM RIN4 WHERE RIN4.DOCENTRY = T1.DOCENTRY AND   RIN4.STATYPE = '-110' AND RIN4.LINENUM=T1.LINENUM AND RIN4.RELATETYPE = 1),0) + ISNULL((SELECT CASE WHEN SUM(RIN4.RvsChrgPrc)!=0 THEN ((Case When T0.DocCur = 'INR' Then  SUM(RIN4.TaxSum) Else Sum(RIN4.TaxSumFrgn) End) - (Case When T0.DocCur = 'INR' Then SUM(RIN4.RvsChrgTax) Else Sum(RIN4.RvsChrgFC) End)) ELSE (Case When T0.DocCur ='INR' Then  SUM(RIN4.TaxSum) Else Sum(RIN4.TaxSumFrgn) End) END  FROM RIN4 WHERE RIN4.DOCENTRY = T1.DOCENTRY AND   RIN4.STATYPE = '-110' AND RIN4.LINENUM=T6.LINENUM AND RIN4.RELATETYPE = 3),0) AS CGSTAMNT,  ISNULL((SELECT CASE WHEN SUM(RIN4.RvsChrgPrc)!=0 THEN ((Case When T0.DocCur = 'INR' Then  SUM(RIN4.TaxSum) Else Sum(RIN4.TaxSumFrgn) End) - (Case When T0.DocCur = 'INR' Then SUM(RIN4.RvsChrgTax) Else Sum(RIN4.RvsChrgFC) End)) ELSE (Case When T0.DocCur ='INR' Then  SUM(RIN4.TaxSum) Else Sum(RIN4.TaxSumFrgn) End) END  FROM RIN4 WHERE RIN4.DOCENTRY = T1.DOCENTRY AND   RIN4.STATYPE IN ('-110','-150') AND RIN4.LINENUM=T1.LINENUM AND RIN4.RELATETYPE = 1),0) +  ISNULL((SELECT CASE WHEN SUM(RIN4.RvsChrgPrc)!=0 THEN ((Case When T0.DocCur = 'INR' Then  SUM(RIN4.TaxSum) Else Sum(RIN4.TaxSumFrgn) End) - (Case When T0.DocCur = 'INR' Then SUM(RIN4.RvsChrgTax) Else Sum(RIN4.RvsChrgFC) End)) ELSE (Case When T0.DocCur ='INR' Then  SUM(RIN4.TaxSum) Else Sum(RIN4.TaxSumFrgn) End) END  FROM RIN4 WHERE RIN4.DOCENTRY = T1.DOCENTRY AND   RIN4.STATYPE IN ('-110','-150') AND RIN4.LINENUM=T6.LINENUM AND RIN4.RELATETYPE = 3),0) AS SGSTAMNT,   --------------------------  ISNULL((SELECT CASE WHEN SUM(RIN4.RvsChrgPrc)!=0 THEN ((Case When T0.DocCur = 'INR' Then  SUM(RIN4.TaxSum) Else Sum(RIN4.TaxSumFrgn) End) -  (Case When T0.DocCur = 'INR' Then SUM(RIN4.RvsChrgTax) Else Sum(RIN4.RvsChrgFC) End))  ELSE (Case When T0.DocCur = 'INR' Then  SUM(RIN4.TaxSum) Else Sum(RIN4.TaxSum) End) END FROM RIN4 WHERE RIN4.DOCENTRY = T1.DOCENTRY AND   RIN4.STATYPE = '-120'AND RIN4.LINENUM=T1.LINENUM AND RIN4.RELATETYPE = 1),0)+  ISNULL((SELECT CASE WHEN SUM(RIN4.RvsChrgPrc)!=0 THEN ((Case When T0.DocCur = 'INR' Then  SUM(RIN4.TaxSum) Else Sum(RIN4.TaxSumFrgn) End) - (Case When T0.DocCur = 'INR' Then SUM(RIN4.RvsChrgTax) Else Sum(RIN4.RvsChrgFC) End)) ELSE (Case When T0.DocCur = 'INR' Then  SUM(RIN4.TaxSum) Else Sum(RIN4.TaxSum) End) END FROM RIN4 WHERE RIN4.DOCENTRY = T1.DOCENTRY AND    RIN4.STATYPE = '-120' AND RIN4.RELATETYPE = 3),0) AS IGSTAMNT,  --------------------  ISNULL((SELECT CASE WHEN SUM(RIN4.RvsChrgPrc)!=0 THEN ((Case When T0.DocCur = 'INR' Then  SUM(RIN4.TaxSum) Else Sum(RIN4.TaxSumFrgn) End) - (Case When T0.DocCur = 'INR' Then SUM(RIN4.RvsChrgTax) Else Sum(RIN4.RvsChrgFC) End)) ELSE (Case When T0.DocCur ='INR' Then  SUM(RIN4.TaxSum) Else Sum(RIN4.TaxSumFrgn) End) END  FROM RIN4 WHERE RIN4.DOCENTRY = T1.DOCENTRY AND RIN4.LINENUM=T1.LINENUM AND    RIN4.STATYPE = '8' AND RIN4.RELATETYPE = 1),0) --+  --ISNULL((SELECT CASE WHEN SUM(RIN4.RvsChrgPrc)!=0 --THEN ((Case When T0.DocCur = 'INR' Then  SUM(RIN4.TaxSum) Else Sum(RIN4.TaxSumFrgn) End) - (Case When T0.DocCur = 'INR' Then SUM(RIN4.RvsChrgTax) Else Sum(RIN4.RvsChrgFC) End)) --ELSE (Case When T0.DocCur ='INR' Then  SUM(RIN4.TaxSum) Else Sum(RIN4.TaxSumFrgn) End) END  FROM RIN4 --WHERE RIN4.DOCENTRY = T1.DOCENTRY AND RIN4.LINENUM=T1.LINENUM AND    RIN4.STATYPE = '8' AND RIN4.RELATETYPE = 1),0)  AS TCSAMNT, T0.TotalExpns,T0.DocTotal As 'Total Value', T0.RevRefNo, T0.RevRefDate FROM ORIN T0  INNER JOIN RIN1 T1 ON T0.[DocEntry] = T1.[DocEntry] LEFT JOIN RIN3 T6 ON T0.DocEntry=T6.DocEntry LEFT join RIN12 INV on inv.docentry=T1.DocEntry LEFT join OCHp OC on OC.AbsEntry=T1.HsnEntry LEFT join OITM OI on OI.itemcode=T1.itemcode inner join ocrd t2 on t0.cardcode = t2.cardcode INNER JOIN OCRG T3 ON T2.GROUPCODE=T3.GROUPCODE inner join oact t5 on t1.acctcode = t5.acctcode  WHERE T0.canceled <> 'Y' AND T0.CANCELED <> 'C' AND T0.DOCDATE   Between '[%0]' and '[%1]') A GROUP BY A.DocNum,A.DocDate,A.Cardcode,A.CardName,A.BpGSTN,A.GROUPNAME,A.DiscSum,A.[Total Value],A.RevRefNo,A.RevRefDate
SELECT T0.[DocNum], T0.[DocDate], T0.[CardCode], T0.[CardName], T0.[NumAtCard], T0.[TaxDate], T1.[ItemCode], T1.[Dscription], T1.[Quantity], T1.[PriceBefDi], T1.[LineTotal], T1.[VatPrcnt], T1.[VatGroup], T1.[TaxStatus], T1.[VatSum] , T1.[Taxcode] FROM ORPC T0  INNER JOIN RPC1 T1 ON T0.[DocEntry] = T1.[DocEntry]  where t0.docdate >=[%0] and t0.docdate<=[%1] and t0.Canceled ='N' 
SELECT T0.[CardCode], T0.[CardName], T0.[DocDate], T0.[DocNum], T0.[CheckSum], T0.[TrsfrSum] FROM OVPM T0  where T0.cardname<>'' and t0.[canceled]='N'
SELECT  T0.DOCNUM,ISNULL(CD.GSTRegnNo,'') AS GSTIN, CONVERT(VARCHAR,ST.eCode) +'-'+IsNull(ST.Name,'') AS [State of Job Worker],Cast(T0.Docnum As Nvarchar(50)) AS 'RGP NO',  CONVERT( VARCHAR(20),T0.DocDate ,105) AS [RGP Date], T1.ItemCode AS [Item Code],T1.Dscription AS [Description of Goods], ISNULL(T2.[InvntryUom],'') AS UoMName , T1.Quantity , Case when T1.Stockprice <=0 Then  (T1.Price*T1.Quantity) ELSE (T1.StockPrice*T1.Quantity)  END  AS [Taxable Value] ,T2.U_ITTYPE AS [Type of Goods], ISNULL((CASE WHEN ST.Code ='RJ' THEN ISNULL(CONVERT (NUMERIC (10,2),TM.U_RATE) / 2,0) END),0) AS [CGST %] , ISNULL((CASE WHEN ST.Code ='RJ' THEN ISNULL(CONVERT (NUMERIC (10,2),TM.U_RATE) /2,0) END) ,0) AS [SGST %] , ISNULL((CASE WHEN ST.Code !='RJ' THEN ISNULL(CONVERT (NUMERIC (10,2),TM.U_RATE),0) END),0) AS [IGST %] , ISNULL((CASE WHEN ST.Code !='RJ' THEN ISNULL(CONVERT (NUMERIC (10,2),TM.U_RATE),0) END),0) AS [Cess %] ,  T0.[CANCELED] --ISNULL(T0.U_JVCD,'') AS VendorCode,Isnull(T0.CardCode,'') CardCode ,Isnull(ST.Code,'') Code,Isnull(ST.eCode,0)eCode ,ISnull(ST.Name,'') Name FROM OWTR T0  INNER JOIN WTR1 T1 ON T0.DocEntry =T1.DocEntry   INNER JOIN OITM T2 ON T1.ITEMCODE = T2.ITEMCODE  LEFT JOIN CRD1 CD ON CD.CardCode =  T0.U_JVCD  AND  CD.Address = T0.ShipToCode AND CD.AdresType='S' LEFT JOIN OCRY C ON C.Code = CD.Country  LEFT JOIN OCST ST ON ST.Code = CD.State AND ST.Country = C.Code  INNER JOIN OITM TM ON  TM.ItemCode = T1.ItemCode  WHERE  ISNULL(T0.U_JBNO,'') !='' AND T0.DOCDATE>=[%0] AND T0.DOCDATE<=[%1] and t0.series != 226   order by t0.docnum
Declare @S Date  Declare @E Date  Declare @location int  Set @S = (Select min(T0.Refdate) from OJDT T0 where T0.refdate >=[%0])  Set @E = (Select max(T1.Refdate) from OJDT T1 where T1.refdate <=[%1])  Set @location = (Select code from OLCT T2 where T2.location ='[%2]')   EXEC utl_standard_cdn_v3 @S, @E,@location
Declare @S Date  Declare @E Date  Declare @location int  Set @S = (Select min(T0.Refdate) from OJDT T0 where T0.refdate >=[%0])  Set @E = (Select max(T1.Refdate) from OJDT T1 where T1.refdate <=[%1])  Set @location = (Select code from OLCT T2 where T2.location ='[%2]')   EXEC utl_standard_sales_v3 @S, @E,@location
Declare @S Date  Declare @E Date  Declare @location int  Set @S = (Select min(T0.Refdate) from OJDT T0 where T0.refdate >=[%0])  Set @E = (Select max(T1.Refdate) from OJDT T1 where T1.refdate <=[%1])  Set @location = (Select code from OLCT T2 where T2.location ='[%2]')   EXEC utl_standard_purchase_cdn_v3 @S, @E,@location
Declare @S Date  Declare @E Date  Declare @location int  Set @S = (Select min(T0.Refdate) from OJDT T0 where T0.refdate >=[%0])  Set @E = (Select max(T1.Refdate) from OJDT T1 where T1.refdate <=[%1])  Set @location = (Select code from OLCT T2 where T2.location ='[%2]')   EXEC utl_standard_purchase_v3 @S, @E,@location
Declare @S Date  Declare @E Date  Declare @location int  Set @S = (Select min(T0.Refdate) from OJDT T0 where T0.refdate >=[%0])  Set @E = (Select max(T1.Refdate) from OJDT T1 where T1.refdate <=[%1])  Set @location = (Select code from OLCT T2 where T2.location ='[%2]')   EXEC GST3B 0, @S, @E,@location
Declare @S Date  Declare @E Date  Declare @location int  Set @S = (Select min(T0.Refdate) from OJDT T0 where T0.refdate >=[%0])  Set @E = (Select max(T1.Refdate) from OJDT T1 where T1.refdate <=[%1])  Set @location = (Select code from OLCT T2 where T2.location ='[%2]')   EXEC GST3B 3, @S, @E,@location
Declare @S Date  Declare @E Date  Declare @location int  Set @S = (Select min(T0.Refdate) from OJDT T0 where T0.refdate >=[%0])  Set @E = (Select max(T1.Refdate) from OJDT T1 where T1.refdate <=[%1])  Set @location = (Select code from OLCT T2 where T2.location ='[%2]')   EXEC GST3B 2, @S, @E,@location
Declare @S Date  Declare @E Date  Declare @location int  Set @S = (Select min(T0.Refdate) from OJDT T0 where T0.refdate >=[%0])  Set @E = (Select max(T1.Refdate) from OJDT T1 where T1.refdate <=[%1])  Set @location = (Select code from OLCT T2 where T2.location ='[%2]')   EXEC GST3B 1, @S, @E,@location
SELECT DISTINCT T1.[DocEntry] AS 'SAP Entry', T0.[DocNum] as 'PR No.', T0.[DocDate] as 'PR Date',  T1.[ItemCode], T1.[Dscription], T1.[Quantity] as 'PR Qty', T1.[OpenQty] as 'Pending PO' , T3.OnHand as 'MST Stock', T4.LastPurDat,T0.U_PRLEVEL0, T2.[U_NAME] as 'User ID' FROM OPRQ T0   INNER JOIN PRQ1 T1 ON T0.[DocEntry] = T1.[DocEntry]  INNER JOIN OUSR T2 ON T0.[UserSign] = T2.[USERID]  LEFT JOIN OITW T3 ON T3.ItemCode = T1.ItemCode LEFT JOIN OITM T4 ON T4.ItemCode= T1.ItemCode WHERE  T0.[DocDate] >getdate()-60 AND T3.WhsCode='MST' and T2.[U_NAME] ='SAP Admin'
SELECT DISTINCT T0.DocEntry, T0.DocNum,T0.DocDate,  T1.ItemCode, T1.Dscription, T1.Quantity, T2.U_NAME AS 'Requested By',  --CASE WHEN T3.BFType='A' THEN 'Added' WHEN T3.BFType='U' THEN 'Modified' END AS 'Doc Log',  CASE WHEN T3.ProcesStat = 'A' THEN 'Generated by Authorizer'       WHEN T3.ProcesStat = 'P' THEN 'Generated' END AS 'PR Added By', CASE WHEN T3.[Status]='Y' THEN 'Approved' WHEN T3.[Status]='W' THEN 'Pending' WHEN T3.[Status]='N' THEN 'Rejected' END AS 'PR STATUS', T3.CreateTime, T5.U_NAME AS 'Approved By',  T4.UpdateDate as 'Approved Dt.',T4.UpdateTime as 'Approved Time', DATEDIFF(Day,T0.DocDate,T4.UpdateDate) AS DateDifference  FROM ODRF T0 INNER JOIN DRF1 T1 ON T0.DocEntry=T1.DocEntry LEFT JOIN OUSR T2 ON T2.USERID=T0.UserSign LEFT JOIN OWDD T3 ON T3.DraftEntry=T0.DocEntry AND T0.ObjType=T3.ObjType LEFT JOIN WDD1 T4 ON T4.WddCode = T3.WddCode LEFT JOIN OUSR T5 ON T4.USERID = T5.USERID  WHERE T0.DOCDATE> GETDATE()-30 AND T0.ObjType='1470000113' and T0.CANCELED<>'Y' and T0.UserSign=1
SELECT T0.[DocNum], T0.[DocDate], T0.[CardCode], T0.[CardName], T1.[ItemCode], T1.[Dscription], T0.[NumAtCard], T1.[Quantity], T1.[U_UTL_RCQT], T1.[Price], T1.acctcode, T3.ItmsGrpCod   FROM OPDN T0    INNER JOIN PDN1 T1 ON T0.[DocEntry] = T1.[DocEntry] inner join OITM T3 ON T1.ItemCode = T3.ItemCode ---Inner join oact t2 on t1.acctcode = t2.acctcode  where T0.DocDate >= [%0] and T0.DocDate <= [%1]
SELECT T0.[DocNum], T0.[DocDate], t0.numatcard as 'Bill No', t0.taxdate as 'Bill Date', T0.[CardCode], T0.[CardName], T1.[ItemCode], T1.[Dscription], T0.[NumAtCard], T1.[Quantity], T1.[U_UTL_RCQT], T1.[Price] FROM OPDN T0  INNER JOIN PDN1 T1 ON T0.[DocEntry] = T1.[DocEntry] where T1.ItemCode = [%0] and T0.DocDate >= [%1] and T0.DocDate <= [%2]  order by t0.docdate
SELECT T0.[DocNum], T0.[DocDate], T0.[CardCode], T0.[CardName], T1.[ItemCode], T1.[Dscription], T0.[NumAtCard] as 'Bill No', t0.TAXDATE AS'Bill Date' , T1.[Quantity], T1.[U_UTL_RCQT], T1.[Price] FROM OPDN T0  INNER JOIN PDN1 T1 ON T0.[DocEntry] = T1.[DocEntry] where T0.CardName = [%0] and T0.DocDate >= [%1] and T0.DocDate <= [%2]
select T0.DocEntry,T0.U_UTL_DocDate,T0.U_UTL_CardName,T0.U_UTL_BPREF,T1.U_UTL_ITCD,t1.U_UTL_ITEMDESC,T1.U_UTL_QTY, case when T0.U_UTL_STATS='c' then 'DONE' else 'PENDING' END 'GRPO STATUS' from dbo.[@UTL_GE_OGIN] T0  inner join dbo.[@UTL_GE_GIN1] T1 on T0.DocEntry=T1.DocEntry  where t1.U_UTL_ITCD is not null AND T0.U_UTL_STATS <> 'X' and T0.U_UTL_DocDate>=[%0] and T0.U_UTL_DocDate<=[%1]
Declare @ASONDATE varchar(20) Declare @Warehouse varchar(Max)  Set @ASONDATE =(Select Top 1 Convert(Varchar(10),S4.DocDate,112) from dbo.OINM S4 where S4.DocDate='[%0]') Set @Warehouse =(Select Top 1 S3.WhsCode from dbo.OWHS S3 where S3.WhsCode='[%1]')   Exec [INV_AGING] @ASONDATE,@Warehouse
Declare @FromDate Datetime Declare @ToDate Datetime Declare @Whse nvarchar(10)  select @FromDate = min(S0.Docdate) from dbo.OINM S0 where S0.Docdate >='[%0]'  select @ToDate = max(S1.Docdate) from dbo.OINM s1 where S1.Docdate <='[%1]'  select @Whse = Max(s2.Warehouse) from dbo.OINM S2 Where S2.Warehouse = '[%2]'  Select @Whse as 'Warehouse', a.Itemcode, max(a.Dscription) as ItemName, sum(a.OpeningBalance) as OpeningBalance, sum(a.INq) as 'IN', sum(a.OUT) as OUT, ((sum(a.OpeningBalance) + sum(a.INq)) - Sum(a.OUT)) as Closing , (Select i.InvntryUom from OITM i where i.ItemCode=a.Itemcode) as UOM ,b.Avgprice from ( Select N1.Warehouse, N1.Itemcode, N1.Dscription, (sum(N1.inqty)-sum(n1.outqty)) as OpeningBalance, 0 as INq, 0 as OUT From dbo.OINM N1 Where N1.DocDate < @FromDate and N1.Warehouse = @Whse  Group By N1.Warehouse,N1.ItemCode,N1.Dscription  Union All   select N1.Warehouse, N1.Itemcode, N1.Dscription, 0 as OpeningBalance, sum(N1.inqty) , 0 as OUT From dbo.OINM N1  Where N1.DocDate >= @FromDate and N1.DocDate <= @ToDate and N1.Inqty >0 and N1.Warehouse = @Whse  Group By N1.Warehouse,N1.ItemCode,N1.Dscription  Union All   select N1.Warehouse, N1.Itemcode, N1.Dscription, 0 as OpeningBalance, 0 , sum(N1.outqty) as OUT From dbo.OINM N1 Where N1.DocDate >= @FromDate and N1.DocDate <=@ToDate and N1.OutQty > 0 and N1.Warehouse = @Whse Group By N1.Warehouse,N1.ItemCode,N1.Dscription) a inner join dbo.OITM I1 on a.ItemCode=I1.ItemCode inner join  (Select ItemCode,(Sum(TransValue)/Sum(InQty)) Avgprice From OINM Where InQty<>0.00 Group By ItemCode) b on a.ItemCode=b.ItemCode Group By a.Itemcode,B.Avgprice Having sum(a.OpeningBalance) + sum(a.INq) + sum(a.OUT) > 0 Order By a.Itemcode
select DISTINCT T4.U_NAME, T0.DocNum, T0.DocDate, T1.ItemCode,T1.Dscription, T1.Quantity, T1.WhsCode from OWTR T0  INNER JOIN WTR1 T1 ON T0.DOCENTRY = T1.DocEntry LEFT JOIN WTQ1 T2 ON T1.BASEENTRY = T2.DocEntry LEFT JOIN OWTQ T3 ON T2.DOCENTRY = T3.DOCENTRY LEFT JOIN OUSR T4 ON T3.UserSign = T4.USERID  WHERE T1.WhsCode = 'CONS' AND T0.DOCDATE >=[%0] AND T0.DOCDATE<=[%1]  ORDER BY T0.DocDate
SELECT t1.fromwhscod as 'From Warehouse', T0.[DocNum], T0.DocDate, T1.[ItemCode], T1.[Dscription], T1.[Quantity], T1.[WhsCode] as 'To WareHouse' FROM OWTR T0  INNER JOIN WTR1 T1 ON T0.[DocEntry] = T1.[DocEntry]   where  t0.docdate>= [%0] and t0.docdate <=[%1] and t1.fromwhscod='mst'  order by T0.docdate
SELECT T0.[DocNum], T0.[DocDate], T0.U_JVCD, T0.U_JVNM, T1.[ItemCode], T1.[Dscription], T1.[Quantity] FROM OIGE T0  INNER JOIN IGE1 T1 ON T0.[DocEntry] = T1.[DocEntry]   WHERE T0.[U_JBNO] <>''   AND  T0.DOCDATE>=[%0] AND T0.DOCDATE<=[%1] and  T0.U_JVNM = [%2]
SELECT T0.[DocNum], T0.[DocDate], T0.cardname, t0.numatcard, T0.[DocDueDate], T1.[ItemCode], T1.[Dscription], T1.[ShipDate], T1.[Quantity] as 'Order Qty', t1.delivrdqty as 'Delivered Qty' FROM ORDR T0  INNER JOIN RDR1 T1 ON T0.[DocEntry] = T1.[DocEntry] WHERE T1.[shipdate] >= [%0] and T1.[shipdate] <= [%1] Order by T0.[DocDate]
select a.DocEntry ,a.DocNum ,a.U_JVNM, a.U_JVCD, a.docdate, a.u_jbno, b.ItemCode, b.Dscription ,b.Quantity from OIGN A  inner join IGN1 B on a.DocEntry=b.DocEntry  where a.U_JBNO<>'' and a.U_JVNM = [%0] and a.DocDate>=[%1] and a.DocDate<=[%2]  order by a.DocDate
Declare @ASONDATE varchar(20) Declare @Warehouse varchar(Max)  Set @ASONDATE =(Select Top 1 Convert(Varchar(10),S4.DocDate,112) from dbo.OINM S4 where S4.DocDate='[%0]') Set @Warehouse =(Select Top 1 S3.WhsCode from dbo.OWHS S3 where S3.WhsCode='[%1]')   Exec [INV_nonmoving] @ASONDATE,@Warehouse
select T2.U_VDNM,t3.U_CHCD ,T0.DocNum,T0.DocDate,t0.U_JBNO,t1.ItemCode,t1.Dscription,t1.Quantity from OIGN T0  inner join IGN1 T1 on T0.docentry=t1.DocEntry inner join [@JWHD] T2 on T0.U_JBNO=t2.docentry Inner join [@JWDETCHILD] T3 on T2.DocEntry=t3.DocEntry  where t3.U_CHCD = [%0] and t3.U_CHCD <>''
select t0.docnum, t0.cardname, t1.ItemCode, t1.Dscription,t1.Quantity, t1.OpenQty from OPOR T0  inner join POR1 T1 on T0.DocEntry=T1.DocEntry   where t0.U_POTY = 'close' and U_LEVEL2='y' and DocStatus= 'O' and DocType='i' and t1.itemcode=[%0]
select t0.docnum, T0.CARDNAME, t1.ItemCode, t1.Dscription,t1.Quantity, t1.OpenQty from OPOR T0  inner join POR1 T1 on T0.DocEntry=T1.DocEntry   where t0.U_POTY = 'SCHEDULE' and U_LEVEL1='Y' and DocStatus= 'O' and DocType='i' and t1.itemcode=[%0] AND T1.OPENQTY != '0'
select T0.itemcode, max(T0.price)as 'Maxprice', min(t0.price) as 'Minprice' from pdn1 T0  where  T0.DocDate >=[%0] and T0.DocDate <= [%1] group by t0.ItemCode
SELECT T0.[DocEntry], T0.[DocNum], T0.[DocDate], T0.[CardCode], T0.[CardName], T0.[TaxDate], T0.[NumAtCard], T1.U_ITCD, T1.U_ITNM,  T1.U_QTY, T1.U_UPRC, T0.[U_JB], T0.[U_PONO] FROM OPCH T0  INNER JOIN PCH1 T1 ON T0.[DocEntry] = T1.[DocEntry]  WHERE U_JB='Y' AND T0.U_PONO<>''  AND T0.CARDNAME = [%0] AND T0.DOCDATE>=[%1] AND T0.DOCDATE<=[%2]
SELECT T0.[ItemCode], T0.[ItemName],T0.OnHand,T0.validFor, T0.validFrom ,T0.validTo FROM OITM T0  WHERE t0.validFor='Y' AND t0.validFrom<>''  union all  SELECT T0.[ItemCode], T0.[ItemName],T0.OnHand,T0.validFor, T0.validFrom ,T0.validTo FROM OITM T0  WHERE t0.validFor<>'Y'
SELECT distinct T0.[DocNum], T0.[DocDate], T0.[CardCode], T0.[CardName], T1.[ItemCode], T1.[Dscription], T1.[Quantity] 'PO Quantity',SUM(T2.[Quantity]) 'Receipt Quantity',  T0.DocStatus FROM OPOR T0   INNER JOIN POR1 T1 ON T0.[DocEntry] = T1.[DocEntry]  LEFT JOIN PDN1 T2 ON T1.LineNum=T2.BaseLine and T2.BaseEntry=T1.DOcentry WHERE T0.[DocDate] >= [%0] AND  T0.[DocDate] <= [%1] AND T0.CANCELED='N' AND DocType='I' Group By T0.[DocNum], T0.[DocDate], T0.[CardCode], T0.[CardName],  T1.[ItemCode], T1.[Dscription],T0.DocStatus,T1.Quantity
select t0.docnum,t0.docdate, T0.CARDNAME, t1.ItemCode, t1.Dscription,t1.Quantity, t1.OpenQty from OPOR T0  inner join POR1 T1 on T0.DocEntry=T1.DocEntry   where t0.U_POTY = 'SCHEDULE' and U_LEVEL1='Y' and DocStatus= 'O' and DocType='i' and t0.docdate>=[%0] and t0.docdate<=[%1]
SELECT DISTINCT T0.DocEntry as 'Tfr Entry', QC.U_UTL_MODE, T0.DocNum 'Tfr No.', T1.ItemCode, T1.Dscription,  T1.Quantity  as 'Tfr Qty', T1.WhsCode as 'To Whs' , QC.DocNum as 'IQC No.', QC.U_UTL_SPNM as 'Vendor Name', QC.U_UTL_RCQT as 'QC Recv Qty',QC.U_UTL_APPQ as 'QC OK Qty', T3.DocEntry as 'MRR Entry',T3.DocNum AS 'MRR No.',  T7.DocNum AS ' Receipt No.',  CASE WHEN QC.U_UTL_DCCMB = 'GR' THEN T7.DocDate WHEN  QC.U_UTL_DCCMB = 'G'  THEN T3.DocDate ELSE T7.DocDate END AS 'MRR Dt.',  CASE WHEN QC.U_UTL_DCCMB = 'GR' THEN CONCAT(T8.SeriesName,JW.DocEntry) WHEN  QC.U_UTL_DCCMB = 'G' THEN CONCAT ('MRR',T3.DocNum) END As 'Batch No.'   FROM OWTR T0  INNER JOIN WTR1 T1 ON T1.DocEntry = T0.DocEntry LEFT JOIN [@UTL_OQCHK] QC ON QC.U_UTL_AINO = T0.DocNum LEFT JOIN OPDN T3 ON T3.DocNum = QC.U_UTL_GRDN LEFT JOIN PDN1 T4 ON T4.DocEntry = T3.DocEntry LEFT JOIN NNM1 T5 ON T5.Series = T3.Series LEFT JOIN OQRC QR ON QR.SrcObjAbs = T3.DocEntry AND QR.SrcObjType = T3.ObjType LEFT JOIN OITM T6 ON T6.ItemCode = T1.ItemCode LEFT JOIN OIGN T7 ON T7.DOCNUM = QC.U_UTL_GINM LEFT JOIN [@JWHD] JW ON JW.DOCENTRY=T7.U_JBNO LEFT JOIN NNM1 T8 ON T8.Series = JW.Series  WHERE T0.Docdate > = '[%0]' AND T0.DocDate <= '[%1]' and QC.U_UTL_DCCMB in ( 'GR','G') and T1.FromWhsCod='IQC' and T1.WhsCode in ('MST','REJ')
SELECT DISTINCT T0.[ItemCode], T0.[ItemName],T0. Itmsgrpcod,T1.[ItmsGrpNam], T0.TreeType, CASE WHEN B1.Code = T0.ItemCode THEN 'BOM Item' WHEN B1.Father = T0.ItemCode THEN 'BOM Item'  else 'Non-BOM ' end as 'BOM Item', T0.ManBtchNum AS 'BatchWise',T0.OnHand, T0.InvntryUom,T0.BuyUnitMsr,T0.SalUnitMsr,T0.ChapterID,  ISNULL ((T2.[Chapter]+''+ T2.[Heading]+''+ T2.[SubHeading]),S1.ServCode) as 'HSN/SAC', T0.U_UTL_SLIF, T0.frozenFor AS 'Inactive',  CASE WHEN T0.GLMethod='C' THEN 'Group Wise'WHEN T0.GLMethod='L' THEN 'Item Wise' end as 'GL Method',  CASE WHEN T0.EvalSystem = 'A' THEN 'Moving Average'       WHEN T0.EvalSystem = 'S' THEN 'Standard'  END AS 'Valuation',CASE WHEN T0.MatType=1 THEN 'Raw Material'     WHEN T0.MatType=2 THEN 'Capital Goods'  WHEN T0.MatType=3 THEN 'Finished Goods' END AS 'Material Type', T0.CreateDate  as [Create Date]  , T0.LastPurPrc, T0.LastPurDat  FROM OITM T0   LEFT JOIN OITB T1 ON T0.[ItmsGrpCod] = T1.[ItmsGrpCod]   LEFT JOIN OCHP T2 ON T0.[ChapterID] = T2.[AbsEntry]  LEFT JOIN OSAC S1 ON S1.AbsEntry=T0.SACEntry LEFT JOIN ITT1 B1 ON B1.Code = T0.ItemCode
SELECT T0.WhsCode, T4.[Location] as 'Whs Location',T0.ItemCode, T1.ItemName,T2.ItmsGrpNam ,SUM(T0.OnHand) AS 'Total Qty',  SUM(CASE WHEN Datediff(day, T1.LASTPURDAT, GETDATE()) <= 30 THEN T0.ONHAND END) AS '<=30 Days',  SUM(CASE WHEN Datediff(day, T1.LASTPURDAT, GETDATE()) BETWEEN 31 AND 60 THEN T0.ONHAND END) AS '>31 <=60 days',  SUM(CASE WHEN Datediff(day, T1.LASTPURDAT, GETDATE()) BETWEEN 61 AND 90 THEN T0.ONHAND END) AS '>61 <=90 days',  SUM(CASE WHEN Datediff(day, T1.LASTPURDAT, GETDATE()) BETWEEN 91 AND 180 THEN T0.ONHAND END) AS '>91 <=180 days',  SUM(CASE WHEN Datediff(day, T1.LASTPURDAT, GETDATE()) BETWEEN 181 AND 270 THEN T0.ONHAND END) AS '>181 <=270 days',  SUM(CASE WHEN Datediff(day, T1.LASTPURDAT, GETDATE()) BETWEEN 271 AND 365 THEN T0.ONHAND END) AS '>271 days <= 365 days',  SUM(CASE WHEN Datediff(day, T1.LASTPURDAT, GETDATE()) > 366 THEN T0.ONHAND END) AS '>365 Days' FROM OITW T0  INNER JOIN OITM T1 ON T0.ItemCode = T1.ItemCode  INNER JOIN OITB T2 ON T1.ItmsGrpCod = T2.ItmsGrpCod LEFT JOIN OWHS T3 ON T3.WhsCode = T0.WhsCode LEFT JOIN OLCT T4 ON T4.Code = T3.Location  WHERE(T0.OnHand > 0) GROUP BY T0.WhsCode,T0.ITEMCODE,T1.ItemName ,T4.[Location],T2.ItmsGrpNam ORDER BY T0.WhsCode,T0.ITEMCODE
Declare @FromDate Datetime Declare @ToDate Datetime Set @FromDate = (Select min(S0.Docdate) from dbo.OINM S0 where S0.Docdate >='[%0]') Set @ToDate = (Select max(S1.Docdate) from dbo.OINM s1 where S1.Docdate <='[%1]') Select a.Itemcode, I1.[ItemName] as 'Item Name', (select OI.itmsgrpnam  from oitb OI inner join oitm on OI.ItmsGrpCod = oitm.itmsgrpcod  where oitm.itemcode = a.itemcode)as 'Item Group', (Select i.InvntryUom  from OITM i  where i.ItemCode=a.Itemcode) as UOM, sum(a.OpeningBalance) as 'Opening', sum(a.INq)  as 'Inward', sum(a.OUT) as 'Outward', ((sum(a.OpeningBalance) + sum(a.INq)) - Sum(a.OUT)) as 'Closing' from (    Select N1.Warehouse, N1.Itemcode, N1.Dscription, (sum(N1.inqty)-sum(n1.outqty)) as OpeningBalance, 0 as INq, 0 as OUT   From dbo.OINM N1   Where N1.DocDate < @FromDate   Group By N1.Warehouse,N1.ItemCode,N1.Dscription  Union All   select N1.Warehouse, N1.Itemcode, N1.Dscription, 0 as OpeningBalance, sum(N1.inqty) , 0 as OUT   From dbo.OINM N1   Where N1.DocDate >= @FromDate and N1.DocDate <=  @ToDate and N1.Inqty >0   Group By N1.Warehouse,N1.ItemCode,N1.Dscription  Union All   select N1.Warehouse, N1.Itemcode, N1.Dscription, 0 as OpeningBalance, 0 , sum(N1.outqty) as OUT   From dbo.OINM N1   Where N1.DocDate >= @FromDate and N1.DocDate <= @ToDate and N1.OutQty > 0   Group By N1.Warehouse,N1.ItemCode,N1.Dscription ) a, dbo.OITM I1 where a.ItemCode=I1.ItemCode Group By a.Itemcode,I1.[ItemName] Having sum(a.OpeningBalance) + sum(a.INq) + sum(a.OUT) > 0 Order By a.Itemcode
SELECT T0.[ItemCode],T1.ItemName,T2.ItmsGrpNam,T0.[WhsCode] ,T0.[OnHand] AS 'WhsSTK',T0.[MinStock] AS 'WhsMinSTK', T0.[MaxStock] AS 'WhsMaxSTK',T0.[AvgPrice],T1.LastPurPrc   FROM [OITM] T1    LEFT JOIN OITW T0 ON T1.ItemCode = T0.ItemCode   LEFT JOIN OITB T2 ON T2.ItmsGrpCod = T1.ItmsGrpCod    WHERE T0.WhsCode  IN ('MST')  --AND T0.WhsCode  IN ('BHJWH001')
SELECT DISTINCT T0.[ItemCode], T0.[ItemName], T0.[BatchNum], T0.[WhsCode], T0.[InDate],  T0.[Quantity],ISNULL (T0.CardCode,T3.U_JVCD) as CardCode, ISNULL(T0.[CardName], T3.U_JVNM) AS CardName, DATEDIFF(day, T0.PrdDate, ISNULL(T0.ExpDate,T0.InDate)) AS 'Shelf Life Day', T0.[BaseType], T0.[BaseEntry], T0.[BaseNum]  FROM OIBT T0  LEFT JOIN OBTN T1 ON T1.ITEMCODE= T0.ItemCode LEFT JOIN IGN1 T2 ON T2.ITEMCODE=T0.ITEMCODE AND T2.ObjType=T0.BaseType AND T2.DocEntry=T0.BaseEntry LEFT JOIN OIGN T3 ON T3.DocEntry=T2.DocEntry LEFT JOIN OWTR T4 ON T4.DOCENTRY=T0.BaseEntry LEFT JOIN OPDN T5 ON T5.DocEntry = T0.[BaseEntry] LEFT JOIN PDN1 T6 ON T5.DocEntry = T6.DocEntry LEFT JOIN OIBQ T7 ON T7.ItemCode = T0.ItemCode LEFT JOIN OBIN T8 ON T7.BinAbs = T8.AbsEntry  LEFT JOIN OITM T9 ON T9.ItemCode = T0.ItemCode  WHERE T0.[BatchNum]='[%0]'
SELECT T0.[DocNum] as 'QC Doc No', T0.[U_UTL_PODT],T0.[U_UTL_SPCD], T0.[U_UTL_SPNM],  T0.[U_UTL_ITCD], T0.[U_UTL_ITNM],T0.[U_UTL_REJQ], t0.[U_UTL_REJRSN]    FROM [dbo].[@UTL_OQCHK]  T0   where T0.[U_UTL_REJQ] >=1 and T0.[U_UTL_PODT] >= [%0]
SELECT T0.ItemCode,T2.ItemName,T3.[ItmsGrpNam] as "Item Group Name",T0.WhsCode,T1.AbsEntry , T1.BinCode,T2.InvntryUom,T0.OnHandQty  AS 'BIN Total', T4.OnHand as 'Whs Total', CONVERT(VARCHAR,T2.LastPurDat,112) AS LastPurDat ,  T2.onhand as 'All Total'  from OIBQ T0     INNER JOIN OITM T2 ON T0.ItemCode = T2.ItemCode  LEFT  JOIN OBIN T1 ON T0.BinAbs = T1.AbsEntry  LEFT JOIN OITB T3 ON T2.ItmsGrpCod = T3.ItmsGrpCod  LEFT JOIN OITW T4 ON T4.ItemCode=T0.ItemCode AND T0.WhsCode=T4.WhsCode WHERE T0.OnHandQty > 0  AND T2.ItmsGrpCod IN (100,103,105,106,112,114,115,116,138,139)  ORDER BY T2.ItemCode
SELECT distinct T0.DocEntry as 'Doc Entry',T0.DocNum as 'SAP DocNum', CASE WHEN T0.DocType = 'S' THEN 'Service' ELSE 'ITEM' END AS 'Document Type',  T0.[DocNum], T0.[DocDate],T0.[CardCode], T0.[CardName],  CASE WHEN T1.[ItemCode] IS NULL  THEN 'Service Item' ELSE  T1.[ItemCode] END AS 'ItemCode' ,  T1.[Dscription], T1.[Quantity], (T1.[Quantity] -  T1.[OpenQty]) as 'Received Qty', T1.[OpenQty], T1.[PriceBefDi], T1.[TaxCode],T1.[LineTotal], T1.[VatSum], T0.[Comments] FROM OPOR T0    LEFT JOIN POR1 T1 ON T0.DocEntry = T1.DocEntry    LEFT JOIN OWDD T2 ON T0.DocEntry = T2.DocEntry   LEFT JOIN WDD1 T3 ON T2.WddCode = T3.WddCode   LEFT JOIN ( select [GroupNum],PymntGroup from OCTG)T9 ON T0.GroupNum = T9.[GroupNum]   WHERE   T0.Docstatus = 'O' AND T0.Canceled <> 'Y'  and T1.LineStatus='O' ORDER BY T0.[DocDate]
SELECT ItemCode,ItemName, BatchNum, WhsCode, InDate, Quantity,BaseType,BaseNum,CardCode, CardName  FROM OIBT T0 where Quantity>0
SELECT DISTINCT CASE WHEN T0.TransType ='20' THEN CONCAT('MRR',T0.BASE_REF) WHEN T0.TransType ='59' THEN  CONCAT('GR',T0.BASE_REF)   ELSE CONCAT('ST',T0.BASE_REF,REPLACE(CONVERT(CHAR(10),T0.DocDate, 103),'/','')) END AS [BatchNumber],T0.DocDate, SUM(T0.InQty) OVER (PARTITION BY T0.BASE_REF) AS 'Batch No.', T0.ItemCode,  CONVERT(varchar(8), T0.DocDate, 112) AS [AdmissionDate], CONVERT(varchar(8), T0.DocDate, 112) AS [ManufacturingDate], CONVERT(varchar(8),DATEADD(MONTH, 36, T0.DocDate), 112) AS [ExpiryDate], T0.TransType   FROM OINM T0 INNER JOIN OITM T1 ON T1.ItemCode =T0.ItemCode WHERE T0.TransType IN ('20','59') AND  T0.ItemCode ='[%0]' AND T0.DocDate <'20230715'   ORDER BY T0.DocDate DESC
SELECT  DISTINCT T0.[ItemCode],T0.[ItemName], T0.[DocType], T0.[DocNum], T0.[CardName],       T0.[DocDate], T2.[DistNumber] ,T0.[DocQty], T0.[LocCode]  FROM OITL T0   INNER JOIN ITL1 T1 ON T0.[LogEntry] = T1.[LogEntry] INNER JOIN OBTN T2 ON T0.[ItemCode] = T2.[ItemCode]  LEFT JOIN OIBT T3 ON T2.[AbsEntry] = T3.[SysNumber] LEFT JOIN OBTQ T4 ON T2.[AbsEntry] = T4.[SysNumber] WHERE T0.[ItemCode] ='[%0]'
SELECT  ItemCode,ItemName, ISNULL(SuppSerial, BatchNum) as 'Batch Num',SuppSerial, WhsCode, InDate,  DATEADD(DAY,1095, InDate) AS DateAfter30Mths, Quantity  --DATEDIFF(DAY, InDate, GETDATE()) AS DateDifferenceInDays,  FROM OIBT T0 where Quantity>0 and GETDATE()>=DATEADD(DD,912,InDate) and GETDATE()<=DATEADD(DD,1095,InDate) and WhsCode='MST'  order by InDate asc
SELECT DISTINCT T0.DocNum as 'Issued Doc', CONVERT ( DATE ,T0.DocDate, 103) AS 'Issued Dt.',  P1.DocNum as 'Production Order',P1.ItemCode as 'Product Code',P1.ProdName ,P1.PlannedQty as 'Plan Qty',P1.PostDate, T1.ItemCode,T1.Dscription, --T1.Quantity as 'Total Issued' , T2.BatchNum, T2.Quantity 'Batch Qty'--, CONVERT (DATE,ISNULL (T3.InDate,T3.PrdDate)) AS 'Batch Dt.'  FROM OIGE T0 INNER JOIN  IGE1 T1 ON T1.DOCENTRY=T0.DOCENTRY INNER JOIN OWOR P1 ON P1.Docentry= T1.BaseEntry INNER JOIN WOR1 P2 ON P2.DocEntry=P1.DocEntry INNER JOIN IBT1 T2 ON T1.ItemCode = T2.ITEMCODE AND T1.LineNum = T2.BaseLinNum and T1.DocEntry = T2.BaseEntry INNER JOIN OIBT T3 ON T3.ItemCode = T2.ItemCode  WHERE T1.BaseRef ='[%0]'
SELECT T0.WhsCode, T4.[Location] as 'Whs Location',T0.ItemCode, T1.ItemName,T2.ItmsGrpNam ,SUM(T0.OnHand) AS 'Total Qty',  SUM(CASE WHEN Datediff(day, T1.LASTPURDAT, GETDATE()) <= 30 THEN T0.ONHAND END) AS '<=30 Days',  SUM(CASE WHEN Datediff(day, T1.LASTPURDAT, GETDATE()) BETWEEN 31 AND 60 THEN T0.ONHAND END) AS '>31 <=60 days',  SUM(CASE WHEN Datediff(day, T1.LASTPURDAT, GETDATE()) BETWEEN 61 AND 90 THEN T0.ONHAND END) AS '>61 <=90 days',  SUM(CASE WHEN Datediff(day, T1.LASTPURDAT, GETDATE()) BETWEEN 91 AND 180 THEN T0.ONHAND END) AS '>91 <=180 days',  SUM(CASE WHEN Datediff(day, T1.LASTPURDAT, GETDATE()) BETWEEN 181 AND 270 THEN T0.ONHAND END) AS '>181 <=270 days',  SUM(CASE WHEN Datediff(day, T1.LASTPURDAT, GETDATE()) BETWEEN 271 AND 365 THEN T0.ONHAND END) AS '>271 days <= 365 days',  SUM(CASE WHEN Datediff(day, T1.LASTPURDAT, GETDATE()) > 366 THEN T0.ONHAND END) AS '>365 Days' FROM OITW T0  INNER JOIN OITM T1 ON T0.ItemCode = T1.ItemCode  INNER JOIN OITB T2 ON T1.ItmsGrpCod = T2.ItmsGrpCod LEFT JOIN OWHS T3 ON T3.WhsCode = T0.WhsCode LEFT JOIN OLCT T4 ON T4.Code = T3.Location  WHERE(T0.OnHand > 0) GROUP BY T0.WhsCode,T0.ITEMCODE,T1.ItemName ,T4.[Location],T2.ItmsGrpNam ORDER BY T0.WhsCode,T0.ITEMCODE
Declare @FromDate  Datetime Declare @ToDate  Datetime Declare @Whse nvarchar(10)     Set @FromDate = (Select min(S0.Docdate) from dbo.OINM S0 where S0.Docdate >='[%0]')  Set @ToDate = (Select max(S1.Docdate) from dbo.OINM s1 where S1.Docdate <='[%1]')  Set @Whse = (Select Max(s2.Warehouse) from dbo.OINM S2 Where S2.Warehouse = '[%2]')      Select  @Whse as 'Warehouse', a.Itemcode, I1.[ItemName] as ItemName,  sum(a.OpeningBalance) as OpeningBalance,  sum(a.INq)  as 'IN', sum(a.OUT) as OUT, ((sum(a.OpeningBalance) + sum(a.INq)) - Sum(a.OUT)) as Closing,  (select OI.itmsgrpnam from oitb OI inner join oitm on OI.ItmsGrpCod = oitm.itmsgrpcod  where oitm.itemcode = a.itemcode)as 'Item Group',   (Select  i.InvntryUom from OITM i  where i.ItemCode=a.Itemcode) as UOM from ( Select N1.Warehouse, N1.Itemcode, N1.Dscription,  (sum(N1.inqty)-sum(n1.outqty)) as OpeningBalance, 0 as INq, 0 as OUT   From dbo.OINM N1  Where N1.DocDate < @FromDate and N1.Warehouse = @Whse Group By N1.Warehouse,N1.ItemCode,N1.Dscription    Union All  select N1.Warehouse, N1.Itemcode, N1.Dscription, 0 as OpeningBalance, sum(N1.inqty) , 0 as OUT     From dbo.OINM N1 Where N1.DocDate >= @FromDate and N1.DocDate <= @ToDate and N1.Inqty >0  and N1.Warehouse = @Whse Group By N1.Warehouse,N1.ItemCode,N1.Dscription    Union All  select N1.Warehouse, N1.Itemcode, N1.Dscription, 0 as OpeningBalance, 0 ,  sum(N1.outqty) as OUT   From dbo.OINM N1 Where N1.DocDate >= @FromDate and N1.DocDate <=@ToDate  and N1.OutQty > 0 and N1.Warehouse = @Whse Group By N1.Warehouse,N1.ItemCode,N1.Dscription ) a,  dbo.OITM I1  where a.ItemCode=I1.ItemCode   Group By a.Itemcode,I1.[ItemName]  Having sum(a.OpeningBalance) + sum(a.INq) + sum(a.OUT) > 0  Order By a.Itemcode
SELECT DISTINCT T0.DocEntry as 'Doc Entry',T0.[DocNum] as 'Goods Recv', T0.[DocDate] as 'Recv Dt.', T1.[ItemCode], T1.[Dscription], T1.[Quantity] as 'Recv Qty', T1.[Price],T1.WhsCode as 'Recv Whs',  T1.StockPrice as 'Item Cost', T1.AcctCode 'Recv G/L', T2. DocNum as 'Goods Issue',T3.AcctCode AS 'Issue G/L',T3.[Quantity] as 'Issue Qty',T3.Whscode as 'Issue Whs', T3.Price, CASE WHEN T1.AcctCode = T3.AcctCode THEN 'G/L Match' else 'Not Match' END as 'G/L Match' FROM OIGN T0   INNER JOIN IGN1 T1 ON T0.[DocEntry] = T1.[DocEntry]  LEFT JOIN OIGE T2 ON T2.DocNum =T0.U_GISN LEFT JOIN IGE1 T3 ON T3.DocEntry=T2.DocEntry WHERE T0.[DocDate] >= [%0] AND  T0.[DocDate] <= [%1] AND T0.[CANCELED] = 'N' AND T0.U_GISN IS NOT NULL ORDER BY T0.DocDate
SELECT T0.DocEntry,T0.[DocNum] as 'Issue Doc' ,CONVERT (DATE,T0.[DocDate],103) as 'Issue Dt.', T1.BaseRef as 'Prod Ord', T1.[ItemCode],  T1.[Dscription],T3.ItmsGrpNam, T1.[Quantity],T1.WhsCode, T1.[Price],T1.[StockPrice] as 'Item Cost', T0.Comments FROM OIGE T0   INNER JOIN IGE1 T1 ON T0.[DocEntry] = T1.[DocEntry]  INNER JOIN OITM T2 ON T2.ItemCode = T1.ItemCode INNER JOIN OITB T3 ON T3.ItmsGrpCod = T2.ItmsGrpCod WHERE T0.[DocDate] >=[%0] AND  T0.[DocDate] <= [%1] AND T0.[CANCELED] = 'N' AND T1.BaseType='202' AND  T1.ItemCode not IN ( 'P100100','P100200','P100300','P100400','P100500','P100600','P100700','P100800','P100900','P101000', 'P101100','P101200','P101300','P101400','P101500','P101600','P101700','P101800','P101900','P102000', 'P102100','P102200','P102300','P102400','P102500','P102600','99900100000','SI0002','SI0003') ORDER BY T0.DocDate
Declare @FromDate Datetime  Declare @ToDate Datetime      Set @FromDate = (Select min(S0.Docdate) from dbo.OINM S0 where S0.Docdate >='[%0]')  Set @ToDate = (Select max(S1.Docdate) from dbo.OINM s1 where S1.Docdate <='[%1]')       Select  a.Itemcode, I1.[ItemName] as 'Item Name',  (select OI.itmsgrpnam from oitb OI  inner join oitm on OI.ItmsGrpCod = oitm.itmsgrpcod where oitm.itemcode = a.itemcode)as 'Item Group',    (Select  i.InvntryUom from OITM i where i.ItemCode=a.Itemcode) as UOM,  sum(a.OpeningBalance) as 'Opening', sum(a.INq)  as 'Inward', sum(a.OUT) as 'Outward',  ((sum(a.OpeningBalance) + sum(a.INq)) - Sum(a.OUT)) as 'Closing'   from ( Select N1.Warehouse, N1.Itemcode, N1.Dscription, (sum(N1.inqty)-sum(n1.outqty)) as OpeningBalance, 0 as INq, 0 as OUT   From dbo.OINM N1  Where N1.DocDate < @FromDate   Group By N1.Warehouse,N1.ItemCode,N1.Dscription    Union All  select N1.Warehouse, N1.Itemcode, N1.Dscription, 0 as OpeningBalance, sum(N1.inqty) , 0 as OUT     From dbo.OINM N1  Where N1.DocDate >= @FromDate  and N1.DocDate <=  @ToDate and N1.Inqty >0   Group By N1.Warehouse,N1.ItemCode,N1.Dscription    Union All  select N1.Warehouse, N1.Itemcode, N1.Dscription, 0 as OpeningBalance, 0 , sum(N1.outqty) as OUT    From dbo.OINM N1  Where N1.DocDate >= @FromDate  and N1.DocDate <= @ToDate and N1.OutQty > 0   Group By N1.Warehouse,N1.ItemCode,N1.Dscription ) a, dbo.OITM I1  where a.ItemCode=I1.ItemCode   Group By a.Itemcode,I1.[ItemName] Having sum(a.OpeningBalance) + sum(a.INq) + sum(a.OUT) > 0  Order By a.Itemcode
SELECT DISTINCT T0.[ItemCode], T0.[ItemName],T0. Itmsgrpcod,T1.[ItmsGrpNam], T0.TreeType,t0.mattype, CASE WHEN B1.Code = T0.ItemCode THEN 'BOM Item' WHEN B1.Father = T0.ItemCode THEN 'BOM Item'  else 'Non-BOM ' end as 'BOM Item', T0.ManBtchNum AS 'BatchWise',T0.OnHand, T0.InvntryUom,T0.BuyUnitMsr,T0.SalUnitMsr,T0.ChapterID,  ISNULL ((T2.[Chapter]+''+ T2.[Heading]+''+ T2.[SubHeading]),S1.ServCode) as 'HSN/SAC', T0.U_UTL_SLIF, T0.frozenFor AS 'Inactive',  CASE WHEN T0.GLMethod='C' THEN 'Group Wise'WHEN T0.GLMethod='L' THEN 'Item Wise' end as 'GL Method',  CASE WHEN T0.EvalSystem = 'A' THEN 'Moving Average'       WHEN T0.EvalSystem = 'S' THEN 'Standard'  END AS 'Valuation',CASE WHEN T0.MatType=1 THEN 'Raw Material'     WHEN T0.MatType=2 THEN 'Capital Goods'  WHEN T0.MatType=3 THEN 'Finished Goods' END AS 'Material Type', T0.CreateDate  as [Create Date]  , T0.LastPurPrc, T0.LastPurDat  FROM OITM T0   LEFT JOIN OITB T1 ON T0.[ItmsGrpCod] = T1.[ItmsGrpCod]   LEFT JOIN OCHP T2 ON T0.[ChapterID] = T2.[AbsEntry]  LEFT JOIN OSAC S1 ON S1.AbsEntry=T0.SACEntry LEFT JOIN ITT1 B1 ON B1.Code = T0.ItemCode ORDER BY T0.CreateDate  DESC
SELECT T0.DOCENTRY , T0.DOCNUM, convert (date, T0.DocDate,103) AS 'Doc Date',T1.ITEMCODE ,t1.U_UTL_ST_TAXCD,T0.CARDCODE, T0.CARDNAME, CASE WHEN T0.U_ISTY=2 THEN 'RGP' WHEN T0.U_ISTY=3 THEN 'JOB WORK' END AS 'DOC TYPE' FROM OWTR T0  INNER JOIN WTR1 T1 ON T1.DOCENTRY = T0.DOCENTRY  WHERE T0.U_ISTY IN (2,3)  AND  T0.DocDate > '20220401' and T0.CARDCODE IS NOT NULL order by T0.DOCENTRY desc
SELECT T0.[Name] AS 'Alert Name',T0.[Type],T0.[Priority],T0.[Active],T0.[FrqncyType], T0.[FrqncyIntr],T0.[ExecDaY],T2.U_NAME,T1.[SendIntrnl],T1.[SendEMail],T1.[SendSMS],T1.[SendFax], T3.QName, T3.QString FROM [dbo].[OALT] T0 INNER JOIN ALT1 T1 ON T1.CODE= T0.Code LEFT JOIN OUSR T2 ON T2.USERID = T1.UserSign LEFT JOIN OUQR T3 ON T3.IntrnalKey = T0.QueryId
SELECT T0.DocEntry ,T0.DocNum ,T0.CardCode,T0.CardName,CONVERT (VARCHAR,t0.DocDate,104) AS 'Inv Date' , T0.NumAtCard AS 'Cust PO No.',CONVERT (VARCHAR ,T0.TaxDate,104) as 'Ref Date',T1.LineNum, T1.ItemCode,T1.SubCatNum,CONVERT (NUMERIC (10,2),T1.PriceBefDi)*T0.DocRate as 'PriceBefDi', CONVERT (NUMERIC(10,0),T1.Quantity) AS 'Total Quantity' , CONVERT (NUMERIC (10,2),T1.price)*T0.DocRate AS 'Rate',T14.AliasName, CONVERT(NUMERIC(10,2),T0.DocTotal) as 'Invoice Total',LEFT (T10.CHAPTERID,8) AS 'HSN_Code',   UPPER (ISNULL(C1.Address2,'')+' '+ISNULL(C1.Address3,'')+' '+ISNULL(C1.STREET,'')+' '+ISNULL(C1.BLOCK,'')+ ' '+ISNULL(C1.CITY,'')+'-'+ISNULL(C1.ZipCode,'')) AS 'BILL TO'  ,  ISNULL((SELECT TOP 1 OCST.NAME FROM OCST WHERE OCST.CODE = t14.STATE1 AND OCST.COUNTRY = 'IN'),'') 'Bill To State',  UPPER (ISNULL(CRD1.Address2,'')+' '+ISNULL(CRD1.Address3,'')+' '+ISNULL(CRD1.STREET,'')+' '+ISNULL(CRD1.BLOCK,'')+ ' '+ISNULL(CRD1.CITY,'')+'-'+ISNULL(CRD1.ZipCode,'')) AS 'SHIP TO' ,  CASE  WHEN T0.CardCode IN ('C000055','C000056','C000057','C000194','C000058','C000177','C000179','C000059','C000060', 'C000061','C000179','C000062','C000063') THEN  CONCAT (t0.numatcard ,',',10,',',CONVERT (NUMERIC(10,0),t1.Quantity),',',T0.DocNum ,',', CONVERT (VARCHAR,t0.DocDate,104) ,',', CONVERT (NUMERIC (10,2),t1.PriceBefDi),',',CONVERT (NUMERIC (10,2),T1.price) ,',',T14.AliasName ,',',t1.SubCatNum ,',',  ------------------TaxInformation CONVERT (NUMERIC (10,2),ISNULL((Select (case when  sum(x.RvsChrgTax)<=0  then sum(x.TaxSum)/t0.DocRate else 0 end) From INV4 x Where x.DocEntry = t0.DocEntry and x.staType = -100 and x.LineNum = t1.LineNum and x.RelateType = 1),0)) , ',', CONVERT (NUMERIC (10,2),ISNULL((Select (case when  sum(x.RvsChrgTax)<=0  then sum(x.TaxSum)/t0.DocRate else 0 end) From INV4 x Where x.DocEntry = t0.DocEntry and x.staType = -110 and x.LineNum = t1.LineNum and x.RelateType = 1),0)) ,',', CONVERT (NUMERIC (10,2),ISNULL((Select (case when  sum(x.RvsChrgTax)<=0  then sum(x.TaxSum)/t0.DocRate else 0 end) From INV4 x Where x.DocEntry = t0.DocEntry and x.staType = -120 and x.LineNum = t1.LineNum and x.RelateType = 1),0)) ,',', CONVERT (NUMERIC (10,2),ISNULL((Select (case when  sum(x.RvsChrgTax)<=0  then sum(x.TaxSum)/t0.DocRate else 0 end) From INV4 x Where x.DocEntry = t0.DocEntry and x.staType = -150 and x.LineNum = t1.LineNum and x.RelateType = 1),0)),',',   CONVERT (NUMERIC (10,2),ISNULL((Select distinct (case when  sum(x.RvsChrgTax)<=0  then  x.TaxRate else 0 end ) From INV4 x Where x.DocEntry = t0.DocEntry and x.staType = -100 and x.LineNum = t1.LineNum and x.RelateType = 1 group by X.TaxRate),0)) , ',', CONVERT (NUMERIC (10,2),ISNULL((Select distinct (case when  sum(x.RvsChrgTax)<=0  then x.TaxRate else 0 end ) From INV4 x Where x.DocEntry = t0.DocEntry and x.staType = -110 and x.LineNum = t1.LineNum and x.RelateType = 1 group by X.TaxRate),0)) ,',', CONVERT (NUMERIC (10,2),ISNULL((Select distinct (case when  sum(x.RvsChrgTax)<=0  then x.TaxRate else 0 end ) From INV4 x Where x.DocEntry = t0.DocEntry and x.staType = -120 and x.LineNum = t1.LineNum and x.RelateType = 1 group by X.TaxRate),0)) ,',', CONVERT (NUMERIC (10,2),ISNULL((Select distinct (case when  sum(x.RvsChrgTax)<=0  then x.TaxRate else 0 end ) From INV4 x Where x.DocEntry = t0.DocEntry and x.staType = -150 and x.LineNum = t1.LineNum and x.RelateType = 1 group by X.TaxRate),0)) ,',',  0.00,',', CONVERT(NUMERIC(10,2),t0.DocTotal),',',left (T10.CHAPTERID,8))    ELSE CONCAT (T0.CardCode,',', ISNULL(T1.SubCatNum,T1.ItemCode),',',T0.DocNum,',',CONVERT (VARCHAR,T0.DocDate,104),',', CONVERT (NUMERIC (10,2),T1.Quantity))   END AS 'QR Code'  FROM OINV T0 INNER JOIN INV1 T1 ON T1.DocEntry=t0.DocEntry LEFT JOIN OWHS T2 ON T2.WhsCode=t1.WhsCode  LEFT JOIN OLCT T3 ON T3.Code=t2.Location LEFT JOIN OCHP T10 ON T10.AbsEntry=t1.HsnEntry LEFT JOIN OCRD T14 ON T14.CardCode = T0.CardCode LEFT OUTER JOIN CRD1 ON T0.CARDCODE= CRD1.CARDCODE AND CRD1.AdresType='S' AND CRD1.Address=T0.ShipToCode LEFT OUTER JOIN CRD1 C1 ON T0.CARDCODE= C1.CARDCODE AND C1.AdresType='B' and C1.Address=T0.PayToCode     WHERE  T0.DOCENTRY >2900
Declare @Itemcode NVARCHAR(100) SET @Itemcode = (SELECT TOP 1(T1.ItemCode) FROM OWOR  T1  WHERE T1.ItemCode = '[%0]')  SELECT T0.ItemCode,OITM.ItemName, T.CardName, CONVERT (NUMERIC (10,2),T0.Price) AS 'Rate', CONVERT (DATE, T.DocDate ,103) AS 'DocDate'  FROM OINV T   INNER JOIN INV1 T0 ON T0.DocEntry = T.DocEntry  INNER JOIN OITM on OITM.ItemCode=T0.ItemCode   WHERE(@ItemCode='' OR T0.ItemCode=@Itemcode OR @ItemCode IS NULL)  ORDER BY T0.DocDate DESC
SELECT T0.[ItemCode], T0.[ItemName], T1.[ItmsGrpNam],T0.frozenFor AS 'Inactive', T0.ONHAND,  T0.TreeType, T0.CreateDate  as [Create Date] , CASE WHEN T0.TREETYPE='N' THEN 'NO' WHEN T0.TREETYPE<>'N' THEN 'YES' END  AS 'HAS BOM' , CASE WHEN T0.ITEMCODE IN (SELECT DISTINCT T1.ITEMCODE FROM POR1 T1) THEN 'Y' END AS 'PO',  CASE WHEN T0.ITEMCODE IN (SELECT DISTINCT T13.ITEMCODE FROM PCH1 T13) THEN 'Y' END AS 'A/P',  CASE WHEN T0.ITEMCODE IN (SELECT DISTINCT T2.ITEMCODE FROM PDN1 T2) THEN 'Y' END AS 'GRPO',  CASE WHEN T0.ITEMCODE IN (SELECT DISTINCT T9.ITEMCODE FROM IGE1 T9) THEN 'Y' END AS 'GOODS ISSUE',  CASE WHEN T0.ITEMCODE IN (SELECT DISTINCT T10.ITEMCODE FROM IGN1 T10) THEN 'Y' END AS 'GOODS RECEIPT', CASE WHEN T0.ITEMCODE IN (SELECT DISTINCT T12.ITEMCODE FROM WTR1 T12) THEN 'Y' END AS 'INV TFR',  CASE WHEN T0.ITEMCODE IN (SELECT DISTINCT T15.ITEMCODE FROM RPC1 T15) THEN 'Y' END AS 'A/P CR NT',  CASE WHEN T0.ITEMCODE IN (SELECT DISTINCT T3.ITEMCODE FROM RDR1 T3) THEN 'Y' END AS 'SO',  CASE WHEN T0.ITEMCODE IN (SELECT DISTINCT T4.ITEMCODE FROM PDN1 T4) THEN 'Y' END AS 'DELV',  CASE WHEN T0.ITEMCODE IN (SELECT DISTINCT T11.ITEMCODE FROM INV1 T11) THEN 'Y' END AS 'A/R',  CASE WHEN T0.ITEMCODE IN (SELECT DISTINCT T14.ITEMCODE FROM RIN1 T14) THEN 'Y' END AS 'A/R CR NT' , CASE WHEN T0.ITEMCODE IN (SELECT DISTINCT T15.ITEMCODE FROM PRQ1 T15) THEN 'Y' END AS 'Pur Req' , CASE WHEN T0.ITEMCODE IN (SELECT DISTINCT T16.ITEMCODE FROM DRF1 T16) THEN 'Y' END AS 'DRAFT'  FROM OITM T0   LEFT JOIN OITB T1 ON T0.[ItmsGrpCod] = T1.[ItmsGrpCod]
SELECT  T0.DocEntry AS 'Inv Entry',T0.DocNum  AS 'Inv No.'        ,T0.[DocDate] AS 'Inv Dt.',D3.DocEntry  AS 'Dlv Entry'        ,D3.DocNum  AS 'Dlv No.',D3.DocDate AS 'Dlv Dt.'        ,ISNULL (D4.DocEntry,T1.BaseEntry) AS 'SO Entry'        ,ISNULL(D5.DocNum,T1.BaseRef)   AS [SO No]        ,ISNULL(D5.DocDate,T0.DocDate)  AS [SO Date] ,CASE WHEN T0.DocDate >= '2019-04-01' AND T0.DocDate <= '2020-03-31' THEN 'FY 2019-20'       WHEN T0.DocDate >= '2020-04-01' AND T0.DocDate <= '2021-03-31' THEN 'FY 2020-21'       WHEN T0.DocDate >= '2021-04-01' AND T0.DocDate <= '2022-03-31' THEN 'FY 2021-22'       WHEN T0.DocDate >= '2022-04-01' AND T0.DocDate <= '2023-03-31' THEN 'FY 2022-23'        WHEN T0.DocDate >= '2023-04-01' AND T0.DocDate <= '2024-03-31' THEN 'FY 2023-24' END                       AS 'FINANCIAL YEAR'         ,UPPER(T4.GroupName)                              AS "CUSTOMER TYPE"        ,CASE                                      WHEN T0.Series IN ('159','210','343','407','607','806','151','4','863')  THEN 'BILL OF SUPPLY'             WHEN T0.Series IN ('557','539','242','371','5','155','354','865') THEN 'EXPORT INVOICE'    WHEN T0.Series IN ('523','536','652','692','693','558','653','163','209','864') THEN 'TAX INVOICE'    WHEN T0.Series IN ('6','211','373','556','679','695','867') THEN  'DEBIT NOTE' ELSE 'TAX INVOICE' END AS 'INVOICE SERIES'            ,UPPER (DATENAME(month,T0.DocDate))                                              AS "MONTH"        ,DATEPART(YEAR,T0.DocDate)                            AS "YEAR"        ,T0.[CardCode],UPPER (T0.[CardName]) AS 'CUSTOMER NAME'        ,T1.[ItemCode],UPPER (T1.[Dscription]) AS 'Item Name' ,T14. [ItmsGrpNam] ,T1.[TreeType] ,T1.[Quantity]        ,T1. [Price] * T0.DocRate AS "Unit Price after Discount",T1.[LineTotal] AS "Row Total",T1.[DedVatSum] AS "Tax"        ,(T1.[LineTotal]+T1. [DedVatSum])                                                                                AS "Total after tax", T0.ExepAmnt AS 'Withholding Tax',      T0.TotalExpns AS 'Doc Freight', CASE WHEN T0.TotalExpns <> 0 THEN TRY_CONVERT(NUMERIC (10,2) ,ABS(T0.TotalExpns)/T1.Quantity) ELSE 0 END AS 'ItemWiseFreight', CASE WHEN ExpnsName IS NULL THEN 'SALE' ELSE UPPER(ExpnsName) END AS 'EXPENSES TYPE', acct.AcctName AS "Account Name",T1.GrssProfit, CASE WHEN ISNULL(T1.LineTotal, 0) = 0 THEN 0 ELSE TRY_CONVERT (NUMERIC (10,2) ,(ISNULL(T1.GrssProfit, 0)/ ISNULL(T1.LineTotal, 0)* 100)) END 'Gross Profit %' , CONVERT(NUMERIC (10,0),D4.[OPENQTY]) AS 'Remaining Qty',CONVERT(NUMERIC (10,0),(D4.OpenQty * D4.Price)) AS 'Remaining Value' ,CONVERT(NUMERIC (10,0),(D4.[QUANTITY]-D4.[OPENQTY] )) AS 'Delivered Qty'        ,CASE WHEN D4.LineStatus = 'C' THEN 'Closed'  ELSE 'Open'END                                                     AS 'SO Line Status'        ,CASE WHEN T3.Balance <= 0 THEN 0  ELSE T3.Balance END                                                           AS 'Total Dues',ROUND (T0.DocTotal,0) AS 'DocTotal',T3.Balance,T3.OrdersBal        ,T1.[WhsCode]as"Warehouse",UPPER (T3.[City]) AS 'City'        ,CASE WHEN st_name.name IS NULL THEN UPPER(st_name1.name)  ELSE UPPER (st_name.name) END AS "Ship to State"        ,UPPER(st_name1.name)                                                                                                    AS "Bill to State",UPPER (country_name.name) AS 'Ship to Country'              FROM OINV T0 LEFT JOIN(SELECT  docentry,[BaseRef],[ItemCode],[Dscription],[Quantity],[PriceBefDi],ShipToDesc,[AcctCode],[Price]       ,[DedVatSum],[LineTotal],[WhsCode],[PickIdNo],[TaxCode],GrssProfit,[TreeType],BaseEntry,BaseLine,BaseType FROM INV1)T1 ON T0.DocEntry = T1.DocEntry LEFT JOIN DLN1 D2 ON T1.BaseEntry = D2.DocEntry AND T1.BaseLine = D2.LineNum AND T1.BaseType = D2.ObjType LEFT JOIN ODLN D3 ON D2.DocEntry = D3.DocEntry LEFT JOIN RDR1 D4 ON D2.BaseEntry = D4.DocEntry AND D2.BaseLine = D4.LineNum AND D2.BaseType = D4.ObjType LEFT JOIN ORDR D5 ON D5.DocEntry = D4.DocEntry LEFT JOIN (SELECT [AcctCode],AcctName FROM OACT)acct ON T1.[AcctCode] = acct.AcctCode LEFT JOIN (SELECT Docentry,[TaxId0] FROM INV12)T5 ON T0.DocEntry = T5.DocEntry LEFT JOIN (SELECT CardCode,GroupCode,city,SlpCode,Balance,OrdersBal FROM OCRD)T3 ON T0.CardCode = T3.CardCode LEFT JOIN (SELECT DocEntry,[StateS],StateB,CountryS,CountryB FROM INV12)T12 ON T0.DocEntry = T12.DocEntry LEFT JOIN (SELECT GroupCode,GroupName FROM OCRG)T4 ON T3.GroupCode = T4.GroupCode LEFT JOIN (SELECT Itemcode,ItmsGrpCod,ChapterID FROM OITM)T13 ON T1.[ItemCode] = T13.[ItemCode] LEFT JOIN (SELECT ItmsGrpCod,ItmsGrpNam FROM OITB)T14 ON T13.[ItmsGrpCod] = T14. [ItmsGrpCod] LEFT JOIN (SELECT Absentry,ChapterID FROM OCHP)T15 ON T13. [ChapterID] = T15.AbsEntry LEFT JOIN (SELECT Series,SeriesName,BeginStr,EndStr FROM NNM1)T6 ON T0.Series = T6.Series LEFT JOIN (SELECT Code,name,Country FROM OCST)st_name1 ON T12.StateB = st_name1.code AND T12.CountryB = st_name1.country LEFT JOIN (SELECT Code,name,Country FROM OCST)st_name ON T12.StateS = st_name.code AND T12.CountryS = st_name.country LEFT JOIN (SELECT [ItemCode],[ItemName],[FrgnName] FROM OITM)frng_name ON T1.itemcode = frng_name.itemcode LEFT JOIN (SELECT code,name FROM OCRY)country_name ON T12.CountryS = country_name.code LEFT JOIN (SELECT DISTINCT U_UTL_BaseEntry,U_UTL_IRN,U_UTL_IST from [@UTL_MDEXTH] where U_UTL_IST ='S'            AND  Isnull(U_UTL_QRPT,'')<>'' )IRN ON T0.DocEntry = IRN.U_UTL_BaseEntry LEFT JOIN (SELECT DISTINCT DocEntry ,ExpnsName, LineTotal ,ABS(LineTotal) 'ABSExpVal'  FROM INV3             INNER JOIN OEXD ON OEXD.ExpnsCode = INV3.ExpnsCode)F1 ON F1.DocEntry = T0.DocEntry  WHERE T0.[DOCDate] >=[%0] AND T0.[DOCDate] <=  [%1] AND T0.CANCELED = 'N'  ORDER BY T0.DocDate, T0.DocEntry
DECLARE @Father VARCHAR(max), @Father_Name VARCHAR(max),@Child VARCHAR(50),@Child_Name VARCHAR(max),@BOMType VARCHAR(50), @LEVEL INT,@Quantity as Float,@UOM as varchar(max),@LastPurPrice NUMERIC(10,3),@Cost NUMERIC(10,3),@MaxPrc NUMERIC(10,3),@MinPrc NUMERIC(10,3), @Child1 VARCHAR(50),@Child_Name1 VARCHAR(max),@BOMType1 VARCHAR(50),@LEVEL1 INT,@Quantity1 as Float,@UOM1 as varchar(max),@LastPurPrice1 NUMERIC(10,3),@Cost1 NUMERIC(10,3),@MaxPrc1 NUMERIC(10,3),@MinPrc1 NUMERIC(10,3), @Child2 VARCHAR(50),@Child_Name2 VARCHAR(max),@BOMType2 VARCHAR(50),@LEVEL2 INT,@Quantity2 as Float,@UOM2 as varchar(max),@LastPurPrice2 NUMERIC(10,3),@Cost2 NUMERIC(10,3),@MaxPrc2 NUMERIC(10,3),@MinPrc2 NUMERIC(10,3), @Child3 VARCHAR(50),@Child_Name3 VARCHAR(max),@BOMType3 VARCHAR(50),@LEVEL3 INT,@Quantity3 as Float,@UOM3 as varchar(max),@LastPurPrice3 NUMERIC(10,3),@Cost3 NUMERIC(10,3),@MaxPrc3 NUMERIC(10,3),@MinPrc3 NUMERIC(10,3), @Child4 VARCHAR(50),@Child_Name4 VARCHAR(max),@BOMType4 VARCHAR(50),@LEVEL4 INT,@Quantity4 as Float,@UOM4 as varchar(max),@LastPurPrice4 NUMERIC(10,3),@Cost4 NUMERIC(10,3),@MaxPrc4 NUMERIC(10,3),@MinPrc4 NUMERIC(10,3), @Child5 VARCHAR(50),@Child_Name5 VARCHAR(max),@BOMType5 VARCHAR(50),@LEVEL5 INT,@Quantity5 as Float,@UOM5 as varchar(max),@LastPurPrice5 NUMERIC(10,3),@Cost5 NUMERIC(10,3),@MaxPrc5 NUMERIC(10,3),@MinPrc5 NUMERIC(10,3), @Child6 VARCHAR(50),@Child_Name6 VARCHAR(max),@BOMType6 VARCHAR(50),@LEVEL6 INT,@Quantity6 as Float,@UOM6 as varchar(max),@LastPurPrice6 NUMERIC(10,3),@Cost6 NUMERIC(10,3),@MaxPrc6 NUMERIC(10,3),@MinPrc6 NUMERIC(10,3), @Child7 VARCHAR(50),@Child_Name7 VARCHAR(max),@BOMType7 VARCHAR(50),@LEVEL7 INT,@Quantity7 as Float,@UOM7 as varchar(max),@LastPurPrice7 NUMERIC(10,3),@Cost7 NUMERIC(10,3),@MaxPrc7 NUMERIC(10,3),@MinPrc7 NUMERIC(10,3), @Child8 VARCHAR(50),@Child_Name8 VARCHAR(max),@BOMType8 VARCHAR(50),@LEVEL8 INT,@Quantity8 as Float,@UOM8 as varchar(max),@LastPurPrice8 NUMERIC(10,3),@Cost8 NUMERIC(10,3),@MaxPrc8 NUMERIC(10,3),@MinPrc8 NUMERIC(10,3), @Child9 VARCHAR(50),@Child_Name9 VARCHAR(max),@BOMType9 VARCHAR(50),@LEVEL9 INT,@Quantity9 as Float,@UOM9 as varchar(max),@LastPurPrice9 NUMERIC(10,3),@Cost9 NUMERIC(10,3),@MaxPrc9 NUMERIC(10,3),@MinPrc9 NUMERIC(10,3), @Child10 VARCHAR(50),@Child_Name10 VARCHAR(max),@BOMType10 VARCHAR(50),@LEVEL10 INT,@Quantity10 as Float,@UOM10 as varchar(max),@LastPurPrice10 NUMERIC(10,3),@Cost10 NUMERIC(10,3),@MaxPrc10 NUMERIC(10,3),@MinPrc10 NUMERIC(10,3)   CREATE TABLE #BOMTable  ( Father VARCHAR(max) , FatherName VARCHAR(max),Child VARCHAR(max),ChildName VARCHAR(max),BomType VARCHAR(max),LEVELX int,Quantity float, UOM varchar(max), LastPurPrc NUMERIC(10,3),Cost NUMERIC(10,3),MaxPrc NUMERIC(10,3),MinPrc NUMERIC(10,3) )   DECLARE LEVEL0 CURSOR  FOR SELECT T0.Code as 'Father',T2.ItemName as 'Father Name ',t1.Code as 'Child',T3.ItemName as 'Child Name',t3.TreeType as 'BOM Type', 2 AS 'LEVEL',t1.Quantity,t3.InvntryUom, T3.LastPurPrc,  CASE WHEN T3.TreeType = 'N' THEN (t1.Quantity * T3.LastPurPrc) ELSE '0' END AS 'Cost', CASE WHEN T3.TreeType = 'N' THEN OAT1.MaxPrc  END AS 'MaxPrc', CASE WHEN T3.TreeType = 'N' THEN B2.MinPrc  END AS 'MinPrc' FROM OITT T0  LEFT JOIN ITT1 T1 on T0.Code=T1.Father INNER join OITM T2 on T0.Code = T2.ItemCode INNER join OITM T3 on T1.Code = T3.ItemCode LEFT JOIN (Select ItemCode,max (unitprice) AS [MaxPrc] from OAT1  where OAT1.LineStatus<> 'c' Group by ItemCode ) OAT1 ON OAT1.ItemCode=T2.ItemCode  LEFT JOIN (Select ItemCode,MIN (UnitPrice) AS [MinPrc] from OAT1  where OAT1.LineStatus<> 'c' Group by ItemCode ) B2 ON B2.ItemCode=T2.ItemCode  WHERE T0.Code='10101530000' ORDER by t1.VisOrder    OPEN LEVEL0 FETCH NEXT FROM LEVEL0 INTO @Father,@Father_Name,@Child,@Child_Name,@BOMType,@LEVEL,@Quantity,@UOM,@LastPurPrice,@Cost,@MaxPrc,@MinPrc WHILE @@FETCH_STATUS = 0 BEGIN INSERT INTO #BOMTable values(@Father,@Father_Name,@Child,@Child_Name,@BOMType,@LEVEL,@Quantity,@UOM,@LastPurPrice,@Cost,@MaxPrc,@MinPrc) ------------------Level 1----------------------------- IF @BOMType = 'P'  BEGIN DECLARE LEVEL1 CURSOR FOR SELECT L1.Code,L2.ItemName,L2.TreeType,L1.Quantity,L2.InvntryUom, L2.LastPurPrc, CASE WHEN L2.TreeType = 'N' THEN (L1.Quantity * L2.LastPurPrc) ELSE '0' END AS 'Cost', CASE WHEN L2.TreeType = 'N' THEN OAT1.MaxPrc ELSE '0' END AS 'MaxPrc', CASE WHEN L2.TreeType = 'N' THEN B2.MinPrc ELSE '0' END AS 'MinPrc' FROM ITT1 L1  LEFT JOIN OITM L2 on L1.Code=L2.ItemCode  LEFT JOIN (Select ItemCode,MAX (unitprice) AS [MaxPrc] from OAT1  WHERE OAT1.LineStatus<> 'C' GROUP BY ItemCode ) OAT1 ON OAT1.ItemCode=L2.ItemCode  LEFT JOIN (Select ItemCode,MIN (UnitPrice) AS [MinPrc] from OAT1  where OAT1.LineStatus<> 'c' Group by ItemCode) B2 ON B2.ItemCode=L2.ItemCode  WHERE L1.Father=@Child order by L1.VisOrder  OPEN LEVEL1 FETCH NEXT FROM LEVEL1 INTO @Child1,@Child_Name1,@BOMType1,@Quantity1,@UOM1,@LastPurPrice1,@Cost1,@MaxPrc1,@MinPrc1 WHILE @@FETCH_STATUS=0 BEGIN INSERT INTO #BOMTable values(@Father,@Father_Name,@Child1,@Child_Name1,@BOMType1,3,@Quantity1,@UOM1,@LastPurPrice1, @Cost1,@MaxPrc1,@MinPrc1) ------------------Level 2----------------------------- IF @BOMType1 = 'P'  BEGIN DECLARE LEVEL2 CURSOR FOR SELECT L1.Code,L2.ItemName,L2.TreeType,L1.Quantity,L2.InvntryUom , L2.LastPurPrc, CASE WHEN L2.TreeType = 'N' THEN (L1.Quantity * L2.LastPurPrc) ELSE '0' END AS 'Cost', CASE WHEN L2.TreeType = 'N' THEN OAT1.MaxPrc ELSE '0' END AS 'MaxPrc', CASE WHEN L2.TreeType = 'N' THEN B2.MinPrc ELSE '0' END AS 'MinPrc' FROM ITT1 L1  LEFT JOIN OITM L2 on L1.Code=L2.ItemCode  LEFT JOIN (Select ItemCode,max (unitprice) AS [MaxPrc] from OAT1  where OAT1.LineStatus<> 'c'Group by ItemCode ) OAT1 ON OAT1.ItemCode=L2.ItemCode   LEFT JOIN (Select ItemCode,MIN (UnitPrice) AS [MinPrc] from OAT1  where OAT1.LineStatus<> 'c' Group by ItemCode) B2 ON B2.ItemCode=L2.ItemCode  WHERE L1.Father=@Child1 order by L1.VisOrder OPEN LEVEL2 FETCH NEXT FROM LEVEL2 INTO @Child2,@Child_Name2,@BOMType2,@Quantity2,@UOM2,@LastPurPrice2,@Cost2,@MaxPrc2,@MinPrc2 WHILE @@FETCH_STATUS=0 BEGIN INSERT INTO #BOMTable values(@Father,@Father_Name,@Child2,@Child_Name2,@BOMType2,4,@Quantity2,@UOM2,@LastPurPrice2,@Cost2,@MaxPrc2,@MinPrc2)   ------------------Level 3----------------------------- IF @BOMType2 = 'P'  BEGIN DECLARE LEVEL3 CURSOR FOR SELECT L1.Code,L2.ItemName,L2.TreeType,L1.Quantity,L2.InvntryUom , L2.LastPurPrc, CASE WHEN L2.TreeType = 'N' THEN (L1.Quantity * L2.LastPurPrc) ELSE '0' END AS 'Cost', CASE WHEN L2.TreeType = 'N' THEN OAT1.MaxPrc ELSE '0' END AS 'MaxPrc', CASE WHEN L2.TreeType = 'N' THEN B2.MinPrc ELSE '0' END AS 'MinPrc' FROM ITT1 L1  LEFT JOIN OITM L2 on L1.Code=L2.ItemCode  LEFT JOIN (Select ItemCode,max (unitprice) AS [MaxPrc] from OAT1 where OAT1.LineStatus<> 'c'  Group by ItemCode) OAT1 ON OAT1.ItemCode=L2.ItemCode  LEFT JOIN (Select ItemCode,MIN (UnitPrice) AS [MinPrc] from OAT1  where OAT1.LineStatus<> 'c' Group by ItemCode) B2 ON B2.ItemCode=L2.ItemCode  WHERE L1.Father=@Child2 order by L1.VisOrder  OPEN LEVEL3 FETCH NEXT FROM LEVEL3 INTO @Child3,@Child_Name3,@BOMType3,@Quantity3,@UOM3,@LastPurPrice3,@Cost3,@MaxPrc3,@MinPrc3 WHILE @@FETCH_STATUS=0 BEGIN INSERT INTO #BOMTable values(@Father,@Father_Name,@Child3,@Child_Name3,@BOMType3,5,@Quantity3,@UOM3,@LastPurPrice3,@Cost3,@MaxPrc3,@MinPrc3) ------------------Level 4----------------------------- IF @BOMType3 = 'P'  BEGIN DECLARE LEVEL4 CURSOR FOR SELECT L1.Code,L2.ItemName,L2.TreeType,L1.Quantity,L2.InvntryUom , L2.LastPurPrc, CASE WHEN L2.TreeType = 'N' THEN (L1.Quantity * L2.LastPurPrc) ELSE '0' END AS 'Cost', CASE WHEN L2.TreeType = 'N' THEN OAT1.MaxPrc ELSE '0' END AS 'MaxPrc', CASE WHEN L2.TreeType = 'N' THEN b2.MinPrc ELSE '0' END AS 'MinPrc' FROM ITT1 L1  LEFT JOIN OITM L2 on L1.Code=L2.ItemCode  LEFT JOIN (Select ItemCode,max (unitprice) AS [MaxPrc] from OAT1 where OAT1.LineStatus<> 'c'  Group by ItemCode) OAT1 ON OAT1.ItemCode=L2.ItemCode  LEFT JOIN (Select ItemCode,MIN (UnitPrice) AS [MinPrc] from OAT1  where OAT1.LineStatus<> 'c' Group by ItemCode) B2 ON B2.ItemCode=L2.ItemCode   WHERE L1.Father=@Child3 order by L1.VisOrder OPEN LEVEL4 FETCH NEXT FROM LEVEL4 INTO @Child4,@Child_Name4,@BOMType4,@Quantity4,@UOM4,@LastPurPrice4,@Cost4,@MaxPrc4,@MinPrc4 WHILE @@FETCH_STATUS=0 BEGIN INSERT INTO #BOMTable values(@Father,@Father_Name,@Child4,@Child_Name4,@BOMType4,6,@Quantity4,@UOM4,@LastPurPrice4,@Cost4,@MaxPrc4,@MinPrc4) ------------------Level 5----------------------------- IF @BOMType4 = 'P'  BEGIN DECLARE LEVEL5 CURSOR FOR SELECT L1.Code,L2.ItemName,L2.TreeType,L1.Quantity,L2.InvntryUom ,L2.LastPurPrc, CASE WHEN L2.TreeType = 'N' THEN (L1.Quantity * L2.LastPurPrc) ELSE '0' END AS 'Cost', CASE WHEN L2.TreeType = 'N' THEN OAT1.MaxPrc ELSE '0' END AS 'MaxPrc', CASE WHEN L2.TreeType = 'N' THEN B2.MinPrc ELSE '0' END AS 'MinPrc' FROM ITT1 L1  LEFT JOIN OITM L2 on L1.Code=L2.ItemCode  LEFT JOIN (Select ItemCode,max (unitprice) AS [MaxPrc]  from OAT1  where OAT1.LineStatus<> 'c' Group by ItemCode ) OAT1 ON OAT1.ItemCode=L2.ItemCode  LEFT JOIN (Select ItemCode,MIN (UnitPrice) AS [MinPrc] from OAT1  where OAT1.LineStatus<> 'c' Group by ItemCode) B2 ON B2.ItemCode=L2.ItemCode   WHERE L1.Father=@Child4 order by L1.VisOrder OPEN LEVEL5 FETCH NEXT FROM LEVEL5 INTO @Child5,@Child_Name5,@BOMType5,@Quantity5,@UOM5,@LastPurPrice5,@Cost5,@MaxPrc5,@MinPrc5 WHILE @@FETCH_STATUS=0 BEGIN INSERT INTO #BOMTable values(@Father,@Father_Name,@Child5,@Child_Name5,@BOMType5,7,@Quantity5,@UOM5,@LastPurPrice5,@Cost5,@MaxPrc5,@MinPrc5) ------------------Level 6----------------------------- IF @BOMType5 = 'P'  BEGIN DECLARE LEVEL6 CURSOR FOR SELECT L1.Code,L2.ItemName,L2.TreeType,L1.Quantity,L2.InvntryUom , L2.LastPurPrc, CASE WHEN L2.TreeType = 'N' THEN (L1.Quantity * L2.LastPurPrc) ELSE '0' END AS 'Cost', CASE WHEN L2.TreeType = 'N' THEN OAT1.MaxPrc ELSE '0' END AS 'MaxPrc', CASE WHEN L2.TreeType = 'N' THEN B2.MinPrc ELSE '0' END AS 'MinPrc' FROM ITT1 L1  LEFT JOIN OITM L2 on L1.Code=L2.ItemCode  LEFT JOIN (Select ItemCode,max (unitprice) AS [MaxPrc] from OAT1 where OAT1.LineStatus<> 'C' Group by ItemCode ) OAT1 ON OAT1.ItemCode=L2.ItemCode  LEFT JOIN (Select ItemCode,MIN (UnitPrice) AS [MinPrc] from OAT1  where OAT1.LineStatus<> 'c' Group by ItemCode) B2 ON B2.ItemCode=L2.ItemCode  WHERE L1.Father=@Child5 order by L1.VisOrder OPEN LEVEL6 FETCH NEXT FROM LEVEL6 INTO @Child6,@Child_Name6,@BOMType6,@Quantity6,@UOM6,@LastPurPrice6,@Cost6,@MaxPrc6,@MinPrc6 WHILE @@FETCH_STATUS=0 BEGIN INSERT INTO #BOMTable values(@Father,@Father_Name,@Child6,@Child_Name6,@BOMType6,8,@Quantity6,@UOM6,@LastPurPrice6,@Cost6,@MaxPrc6,@MinPrc6) ------------------Level 7----------------------------- IF @BOMType6 = 'P'  BEGIN DECLARE LEVEL7 CURSOR FOR SELECT L1.Code,L2.ItemName,L2.TreeType,L1.Quantity,L2.InvntryUom , L2.LastPurPrc, CASE WHEN L2.TreeType = 'N' THEN (L1.Quantity * L2.LastPurPrc) ELSE '0' END AS 'Cost', CASE WHEN L2.TreeType = 'N' THEN OAT1.MaxPrc ELSE '0' END AS 'MaxPrc', CASE WHEN L2.TreeType = 'N' THEN B2.MinPrc ELSE '0' END AS 'MinPrc' FROM ITT1 L1  LEFT JOIN OITM L2 on L1.Code=L2.ItemCode  LEFT JOIN (Select ItemCode,max (unitprice) AS [MaxPrc] from OAT1  where OAT1.LineStatus<> 'c' Group by ItemCode) OAT1 ON OAT1.ItemCode=L2.ItemCode  LEFT JOIN (Select ItemCode,MIN (UnitPrice) AS [MinPrc] from OAT1  where OAT1.LineStatus<> 'c' Group by ItemCode) B2 ON B2.ItemCode=L2.ItemCode  WHERE L1.Father=@Child6 order by L1.VisOrder OPEN LEVEL7 FETCH NEXT FROM LEVEL7 INTO @Child7,@Child_Name7,@BOMType7,@Quantity7,@UOM7,@LastPurPrice7,@Cost7,@MaxPrc7,@MinPrc7 WHILE @@FETCH_STATUS=0 BEGIN INSERT INTO #BOMTable values(@Father,@Father_Name,@Child7,@Child_Name7,@BOMType7,9,@Quantity7,@UOM7,@LastPurPrice7,@Cost7,@MaxPrc7,@MinPrc7) ------------------Level 7----------------------------- IF @BOMType7 = 'P'  BEGIN DECLARE LEVEL8 CURSOR FOR SELECT L1.Code,L2.ItemName,L2.TreeType,L1.Quantity,L2.InvntryUom , L2.LastPurPrc, CASE WHEN L2.TreeType = 'N' THEN (L1.Quantity * L2.LastPurPrc) ELSE '0' END AS 'Cost', CASE WHEN L2.TreeType = 'N' THEN OAT1.MaxPrc ELSE '0' END AS 'MaxPrc', CASE WHEN L2.TreeType = 'N' THEN B2.MinPrc ELSE '0' END AS 'MinPrc' FROM ITT1 L1  LEFT JOIN OITM L2 on L1.Code=L2.ItemCode  LEFT JOIN (Select ItemCode,max (unitprice) AS [MaxPrc] from OAT1  where OAT1.LineStatus<> 'c'Group by ItemCode ) OAT1 ON OAT1.ItemCode=L2.ItemCode  LEFT JOIN (Select ItemCode,MIN (UnitPrice) AS [MinPrc] from OAT1  where OAT1.LineStatus<> 'c' Group by ItemCode) B2 ON B2.ItemCode=L2.ItemCode  WHERE L1.Father=@Child7 order by L1.VisOrder OPEN LEVEL8 FETCH NEXT FROM LEVEL8 INTO @Child8,@Child_Name8,@BOMType8,@Quantity8,@UOM8,@LastPurPrice8,@Cost8,@MaxPrc8,@MinPrc8 WHILE @@FETCH_STATUS=0 BEGIN INSERT INTO #BOMTable values(@Father,@Father_Name,@Child8,@Child_Name8,@BOMType8,10,@Quantity8,@UOM8,@LastPurPrice8,@Cost8,@MaxPrc8,@MinPrc8) FETCH NEXT FROM LEVEL8 INTO @Child8,@Child_Name8,@BOMType8,@Quantity8,@UOM8,@LastPurPrice8,@Cost8,@MaxPrc8,@MinPrc8 END CLOSE LEVEL8 DEALLOCATE LEVEL8 END ------------------Level 7----------------------------- FETCH NEXT FROM LEVEL7 INTO @Child7,@Child_Name7,@BOMType7,@Quantity7,@UOM7,@LastPurPrice7,@Cost7,@MaxPrc7,@MinPrc7 END CLOSE LEVEL7 DEALLOCATE LEVEL7 END ------------------Level 6-----------------------------                                                                                                                                                                                                                  FETCH NEXT FROM LEVEL6 INTO @Child6,@Child_Name6,@BOMType6,@Quantity6,@UOM6,@LastPurPrice6,@Cost6,@MaxPrc6,@MinPrc6 END CLOSE LEVEL6 DEALLOCATE LEVEL6 END ------------------Level 5----------------------------- FETCH NEXT FROM LEVEL5 INTO @Child5,@Child_Name5,@BOMType5,@Quantity5,@UOM5,@LastPurPrice5,@Cost5,@MaxPrc5,@MinPrc5 END CLOSE LEVEL5 DEALLOCATE LEVEL5 END ------------------Level 4----------------------------- FETCH NEXT FROM LEVEL4 INTO @Child4,@Child_Name4,@BOMType4,@Quantity4,@UOM4,@LastPurPrice4,@Cost4,@MaxPrc4,@MinPrc4 END CLOSE LEVEL4 DEALLOCATE LEVEL4 END ------------------Level 3----------------------------- FETCH NEXT FROM LEVEL3 INTO @Child3,@Child_Name3,@BOMType3,@Quantity3,@UOM3,@LastPurPrice3,@Cost3,@MaxPrc3,@MinPrc3 END CLOSE LEVEL3 DEALLOCATE LEVEL3 END ------------------Level 2----------------------------- FETCH NEXT FROM LEVEL2 INTO @Child2,@Child_Name2,@BOMType2,@Quantity2,@UOM2,@LastPurPrice2,@Cost2,@MaxPrc2,@MinPrc2 END CLOSE LEVEL2 DEALLOCATE LEVEL2 END ------------------Level 1----------------------------- FETCH NEXT FROM LEVEL1 INTO @Child1,@Child_Name1,@BOMType1,@Quantity1,@UOM1,@LastPurPrice1,@Cost1,@MaxPrc1,@MinPrc1 END CLOSE LEVEL1 DEALLOCATE LEVEL1 END ------------------Level 0----------------------------- FETCH NEXT FROM LEVEL0 INTO  @Father,@Father_Name,@Child,@Child_Name,@BOMType,@LEVEL,@Quantity,@UOM,@LastPurPrice,@Cost,@MaxPrc,@MinPrc END SELECT * FROM #BOMTable T0 order by T0.Father DROP TABLE #BOMTable CLOSE LEVEL0 DEALLOCATE LEVEL0
SELECT T0.DocEntry,T0.DocNum as DocNum,T0.DocDate as 'Inv Date',UPPER (T0.numatcard) as VendRefNo,CONVERT (DATE ,T0.TaxDate,103) as 'Doc Ref Dt.', T0.CardCode,T14.AliasName AS 'Vendor Code',UPPER (T0.CardName) AS 'CardName',--T0.Address as CustBillToAddress,  CONCAT(COALESCE (' '+(SELECT UPPER(CRD1.ADDRESS2) FROM CRD1 WHERE CRD1.CardCode=t0.CardCode and crd1.AdresType='B' and crd1.Address=t0.PayToCode), '') ,   COALESCE (' '+(SELECT UPPER(CRD1.ADDRESS3) FROM CRD1 WHERE CRD1.CardCode=t0.CardCode and crd1.AdresType='B' and crd1.Address=t0.PayToCode),''),   COALESCE (' '+(SELECT UPPER (CRD1.Street) from crd1 where crd1.CardCode=t0.CardCode and crd1.AdresType='B' and crd1.Address=t0.PayToCode),''),   COALESCE (' '+(SELECT UPPER(CRD1.Block) from crd1 where crd1.CardCode=t0.CardCode and crd1.AdresType='B' and crd1.Address=t0.PayToCode),''),   COALESCE (' '+(SELECT UPPER (CRD1.City) from crd1 where crd1.CardCode=t0.CardCode and crd1.AdresType='B' and crd1.Address=t0.PayToCode),''),   Concat (', '+(SELECT UPPER(OCST.Name) from crd1 left outer join OCRY on OCRY.Code=crd1.Country left outer join ocst on ocst.Code=crd1.State and ocry.Code=ocst.Country     WHERE CRD1.CardCode=t0.CardCode and crd1.AdresType='B' and crd1.Address=t0.PayToCode), ''),   CONCAT('-'+(SELECT CRD1.ZipCode from crd1 where crd1.CardCode=t0.CardCode and crd1.AdresType='B' and crd1.Address=t0.PayToCode),   COALESCE (', '+(SELECT UPPER (OCRY.Name) from crd1 left outer join OCRY on OCRY.Code=crd1.Country where crd1.CardCode=t0.CardCode and crd1.AdresType='B' and     CRD1.Address=t0.PayToCode),''))) as 'Billed To Address',   (SELECT CRD1.GSTRegnNo FROM CRD1 WHERE CRD1.CardCode=t0.CardCode AND CRD1.AdresType='B' and crd1.Address=t0.PayToCode) as 'ConsgLocGSTNno',   CASE WHEN LEN(T0.ShipToCode)>LEN(T0.CardName) THEN T0.ShipToCode ELSE T0.CardName END AS 'SHIP TO CODE',    CONCAT(COALESCE (' '+(SELECT UPPER(CRD1.ADDRESS2) FROM CRD1 WHERE CRD1.CardCode=t0.CardCode and crd1.AdresType='S' and crd1.Address=t0.ShipToCode),' '),  COALESCE (' '+(SELECT UPPER(CRD1.ADDRESS3) FROM CRD1 WHERE CRD1.CardCode=t0.CardCode and crd1.AdresType='S' and crd1.Address=t0.ShipToCode), ' '),  COALESCE (' '+(SELECT UPPER (CRD1.Street) from crd1 where crd1.CardCode=t0.CardCode and crd1.AdresType='S' and crd1.Address=t0.ShipToCode),' '),  COALESCE (' '+(SELECT UPPER(CRD1.Block) from crd1 where crd1.CardCode=t0.CardCode and crd1.AdresType='S' and crd1.Address=t0.ShipToCode), ' '),  COALESCE (' '+(SELECT UPPER (CRD1.City) from crd1 where crd1.CardCode=t0.CardCode and crd1.AdresType='S' and crd1.Address=t0.ShipToCode), ' '),  COncat (', '+(select UPPER(OCST.Name) from crd1 left outer join OCRY on OCRY.Code=crd1.Country left outer join ocst on ocst.Code=crd1.State and ocry.Code=ocst.Country  where crd1.CardCode=t0.CardCode and crd1.AdresType='S' and crd1.Address=t0.ShipToCode), ' ',  COALESCE ('-'+(select crd1.ZipCode from crd1 where crd1.CardCode=t0.CardCode and crd1.AdresType='S' and crd1.Address=t0.ShipToCode), ' '),   CONCAT(','+(select UPPER (OCRY.Name) from crd1 left outer join OCRY on OCRY.Code=crd1.Country where crd1.CardCode=t0.CardCode and crd1.AdresType='S' and  crd1.Address=t0.ShipToCode),''))) as 'Ship To Address', (SELECT CRD1.GSTRegnNo FROM CRD1 WHERE CRD1.CardCode=t0.CardCode AND CRD1.AdresType='S' and crd1.Address=t0.PayToCode) as 'ShipGSTNno',  -------------Row Detail and Calculation  T1.ItemCode ,T1.Dscription,T50.Substitute AS 'Cust Part No.',T1.Quantity,T1.UnitMsr,T1.Price as Rate,  T1.LineTotal,T0.TotalExpns,T0.DocTotal,T1.LineNum,T1.PackQty,T1.U_UTL_BOX as 'BOX', LEFT(T7.ChapterID,8) as 'HSNcode',  ------------------TaxInformation ISNULL((Select (case when  sum(x.RvsChrgTax)<=0  then sum(x.TaxSum)/t0.DocRate else 0 end) From INV4 x Where x.DocEntry = t0.DocEntry and x.staType = -100 and x.LineNum = t1.LineNum and x.RelateType = 1),0) [CGSTAmt],  ISNULL((Select (case when  sum(x.RvsChrgTax)<=0  then sum(x.TaxSum)/t0.DocRate else 0 end) From INV4 x Where x.DocEntry = t0.DocEntry and x.staType = -110 and x.LineNum = t1.LineNum and x.RelateType = 1),0) [SGSTAmt], ISNULL((Select (case when  sum(x.RvsChrgTax)<=0  then sum(x.TaxSum)/t0.DocRate else 0 end) From INV4 x Where x.DocEntry = t0.DocEntry and x.staType = -120 and x.LineNum = t1.LineNum and x.RelateType = 1),0) [IGSTAmt], ISNULL((Select (case when  sum(x.RvsChrgTax)<=0  then sum(x.TaxSum)/t0.DocRate else 0 end) From INV4 x Where x.DocEntry = t0.DocEntry and x.staType = -150 and x.LineNum = t1.LineNum and x.RelateType = 1),0) [UTGSTAmt], ISNULL((Select distinct (case when  sum(x.RvsChrgTax)<=0  then  x.TaxRate else 0 end ) From INV4 x Where x.DocEntry = t0.DocEntry and x.staType = -100 and x.LineNum = t1.LineNum and x.RelateType = 1 group by X.TaxRate),0) [CGSTRate],  ISNULL((Select distinct (case when  sum(x.RvsChrgTax)<=0  then x.TaxRate else 0 end ) From INV4 x Where x.DocEntry = t0.DocEntry and x.staType = -110 and x.LineNum = t1.LineNum and x.RelateType = 1 group by X.TaxRate),0) [SGSTRate], ISNULL((Select distinct (case when  sum(x.RvsChrgTax)<=0  then x.TaxRate else 0 end ) From INV4 x Where x.DocEntry = t0.DocEntry and x.staType = -120 and x.LineNum = t1.LineNum and x.RelateType = 1 group by X.TaxRate),0) [IGSTRate], ISNULL((Select distinct (case when  sum(x.RvsChrgTax)<=0  then x.TaxRate else 0 end ) From INV4 x Where x.DocEntry = t0.DocEntry and x.staType = -150 and x.LineNum = t1.LineNum and x.RelateType = 1 group by X.TaxRate),0) [UTGSTRate],      CASE WHEN T0.CardCode IN ('C000055','C000056','C000057','C000194','C000058','C000177','C000179','C000059','C000060','C000061','C000179','C000062','C000063')  THEN CONCAT ('(',t0.numatcard ,',',10,',',CONVERT (NUMERIC(10,0),T1.Quantity),',',T0.DocNum ,',', CONVERT (VARCHAR,t0.DocDate,104) ,',', CONVERT (NUMERIC (10,2),T1.PriceBefDi),',', CONVERT (NUMERIC (10,2),T1.price) ,',',T14.AliasName ,',',T1.SubCatNum ,',',  ------------------TaxInformation CONVERT (NUMERIC (10,2),ISNULL((Select (case when  sum(x.RvsChrgTax)<=0  then sum(x.TaxSum)/t0.DocRate else 0 end) From INV4 x Where x.DocEntry = t0.DocEntry and x.staType = -100 and x.LineNum = t1.LineNum and x.RelateType = 1),0)) , ',', CONVERT (NUMERIC (10,2),ISNULL((Select (case when  sum(x.RvsChrgTax)<=0  then sum(x.TaxSum)/t0.DocRate else 0 end) From INV4 x Where x.DocEntry = t0.DocEntry and x.staType = -110 and x.LineNum = t1.LineNum and x.RelateType = 1),0)) ,',', CONVERT (NUMERIC (10,2),ISNULL((Select (case when  sum(x.RvsChrgTax)<=0  then sum(x.TaxSum)/t0.DocRate else 0 end) From INV4 x Where x.DocEntry = t0.DocEntry and x.staType = -120 and x.LineNum = t1.LineNum and x.RelateType = 1),0)) ,',', CONVERT (NUMERIC (10,2),ISNULL((Select (case when  sum(x.RvsChrgTax)<=0  then sum(x.TaxSum)/t0.DocRate else 0 end) From INV4 x Where x.DocEntry = t0.DocEntry and x.staType = -150 and x.LineNum = t1.LineNum and x.RelateType = 1),0)),',',   CONVERT (NUMERIC (10,2),ISNULL((Select distinct (case when  sum(x.RvsChrgTax)<=0  then  x.TaxRate else 0 end ) From INV4 x Where x.DocEntry = t0.DocEntry and x.staType = -100 and x.LineNum = t1.LineNum and x.RelateType = 1 group by X.TaxRate),0)) , ',', CONVERT (NUMERIC (10,2),ISNULL((Select distinct (case when  sum(x.RvsChrgTax)<=0  then x.TaxRate else 0 end ) From INV4 x Where x.DocEntry = t0.DocEntry and x.staType = -110 and x.LineNum = t1.LineNum and x.RelateType = 1 group by X.TaxRate),0)) ,',', CONVERT (NUMERIC (10,2),ISNULL((Select distinct (case when  sum(x.RvsChrgTax)<=0  then x.TaxRate else 0 end ) From INV4 x Where x.DocEntry = t0.DocEntry and x.staType = -120 and x.LineNum = t1.LineNum and x.RelateType = 1 group by X.TaxRate),0)) ,',', CONVERT (NUMERIC (10,2),ISNULL((Select distinct (case when  sum(x.RvsChrgTax)<=0  then x.TaxRate else 0 end ) From INV4 x Where x.DocEntry = t0.DocEntry and x.staType = -150 and x.LineNum = t1.LineNum and x.RelateType = 1 group by X.TaxRate),0)) ,',',  0.00,',',CONVERT(NUMERIC(10,2),T0.DocTotal),',',LEFT (T7.CHAPTERID,8))    ELSE  CONCAT (T0.CardCode,',', ISNULL(T50.Substitute,T1.ItemCode),',', T0.DocNum,',',CONVERT (VARCHAR,T0.DocDate,104),',',CONVERT (NUMERIC (10,2),T1.Quantity)) END AS 'QR Code'        from OINV t0 cross join oadm aa cross join adm1 bb cross join OADP cc inner join ADP1 dd on dd.objtype=t0.ObjType  inner join INV1 t1 on t1.DocEntry=t0.DocEntry --------Join of Base Dcoument left join DLN1 c on c.DocEntry = t1.BaseEntry and c.LineNum = t1.BaseLine left join ODLN d on d.DocEntry = c.DocEntry left join RDR1 e on e.DocEntry = c.BaseEntry and e.LineNum = c.BaseLine left join ORDR f on f.DocEntry = e.DocEntry -------------------- left outer join OWHS t2 on t2.WhsCode=t1.WhsCode  left outer join olct t3 on t3.Code=t2.Location ----------Join of Branch  left outer join OBPL Bt1 on  Bt1.BPLId =t0.BPLId left outer join OWHS Bt2 on  Bt2.WhsCode =Bt1.DflWhs left outer join OLCT Bt3 on  Bt3.Code =Bt2.Location LEFT OUTER JOIN OCRY BT5 on  Bt5.Code =Bt3.Country LEFT OUTER JOIN OCST BT4 on  Bt4.Code =Bt3.State and bt4.Country=Bt5.Code ----------------- LEFT OUTER JOIN OCRY T5 ON T5.code=t3.Country LEFT OUTER JOIN OCST T4 ON T4.code=t3.State  AND T4.Country=t5.Code LEFT OUTER JOIN OITM T8 ON T8.ItemCode=t1.ItemCode LEFT OUTER JOIN OCHP T7 ON T7.AbsEntry=t1.HsnEntry LEFT OUTER JOIN OCTG T9 ON T9.GroupNum=t0.GroupNum LEFT OUTER JOIN NNM1 T10 ON T10.Series=t0.Series LEFT OUTER JOIN OCPR T13 ON T13.CntctCode=T0.CntctCode LEFT JOIN OCRD T14 ON T14.CardCode = T0.CardCode LEFT JOIN INV12 T15 ON T15.DocEntry = T0.DOCENTRY LEFT JOIN OSAC S1 ON S1.AbsEntry=T8.SACEntry LEFT JOIN OQRC T16 ON T16.SrcObjAbs = T0.DocEntry AND T16.SrcObjType =13 LEFT JOIN OSCN T50 ON T50.ItemCode = T1.ItemCode AND T50.CardCode = T0.CardCode      WHERE  T0.DocDate > '20220401'
WITH BOM (Code, NAME, UOM, Level, TreeType, Quantity, Father, Fname, LastPrice, Currency, TotalValue, TotalCost) AS (     SELECT          T0.Code,          T2.ItemName,          T2.InvntryUom,          0 AS Level,          T2.TreeType,         T0.Qauntity,          T0.Code,         T2.ItemName,         T2.LastPurPrc,         T2.LastPurCur,         T0.Qauntity * T2.LastPurPrc AS TotalValue ,     CASE WHEN T2.TreeType like 'N' THEN T0.Qauntity * T2.LastPurPrc END AS TotalCost     FROM dbo.OITT T0      LEFT JOIN OITM T2 ON T0.Code = T2.ItemCode  WHERE T0.Code ='[%0]'     UNION ALL      SELECT           T1.Code,         T2.ItemName,          T2.InvntryUom,          Level + 1,          T2.TreeType,          T1.Quantity,          T1.Father,         T3.ItemName,         T2.LastPurPrc,         T2.LastPurCur,         T1.Quantity * T2.LastPurPrc AS TotalValue ,     CASE WHEN T2.TreeType ='N' THEN T1.Quantity * T2.LastPurPrc END AS TotalCost     FROM         dbo.ITT1 AS T1          INNER JOIN OITM T2 ON T1.Code = T2.ItemCode           INNER JOIN OITM T3 ON T1.Father = T3.ItemCode         JOIN BOM ON T1.Father = BOM.Code  )  SELECT      BOM.Code,      BOM.NAME,      BOM.UOM,      BOM.Level,      BOM.TreeType,      BOM.Quantity,      BOM.Father,      BOM.Fname,      BOM.LastPrice,      BOM.Currency,      BOM.TotalValue,      OINM.MinPrice * BOM.Quantity AS MinValue,     OINM.MaxPrice * BOM.Quantity AS MaxValue,     OINM.AvgPrice * BOM.Quantity AS AvgValue,     OITM.OnHand FROM      BOM     LEFT JOIN (         SELECT              ItemCode,             MIN(Price) AS MinPrice,             MAX(Price) AS MaxPrice,             AVG(Price) AS AvgPrice         FROM              OINM          WHERE              TransType IN (20, 59)         GROUP BY              ItemCode     ) AS OINM ON BOM.Code = OINM.ItemCode     LEFT JOIN OITM ON BOM.Code = OITM.ItemCode OPTION (MAXRECURSION 99);
SELECT DISTINCT T0.ItemCode,    (SELECT DISTINCT CASE WHEN OINM.Currency ='INR' THEN ISNULL(MAX(Price),0) ELSE     ISNULL(MAX(Price*Rate),0) END FROM OINM WHERE ItemCode=T0.ItemCode AND TransType IN (20,59)    GROUP BY OINM.Currency) AS 'Max Price',    (SELECT DISTINCT CASE WHEN OINM.Currency ='INR' THEN ISNULL(MIN(Price),0) ELSE    ISNULL(MIN(Price*Rate),0) END FROM OINM WHERE ItemCode=T0.ItemCode AND TransType IN (20,59)    GROUP BY OINM.Currency) AS 'Min Price',    (SELECT DISTINCT CASE WHEN OINM.Currency ='INR' THEN ISNULL(AVG(Price),0) ELSE    ISNULL(AVG(Price*Rate),0) END FROM OINM WHERE ItemCode=T0.ItemCode AND TransType IN (20,59)    GROUP BY OINM.Currency) AS 'AVG Price'    FROM OINM T0    WHERE TransType IN  (20,59)
Declare @FD DateTime,  @TD DateTime    set @FD = (Select MIN(T0.DocDate) From oinm T0 where T0.DocDate >='[%0]')  set @TD = (Select Max(T1.DocDate) From oinm T1 where T1.DocDate <='[%1]')     exec Stock_Ledger @FD,@TD
SELECT      T0.DocNum AS "Order No.",     T0.ItemCode,     T1.ItemName AS "Description",      T0.PostDate AS "Planned Date",     T0.DueDate,     CASE WHEN T0.Status LIKE 'L' THEN ISNULL(T0.CloseDate,T0.DueDate) END AS 'Completed Date',      CASE WHEN T0.[Status] LIKE 'L' THEN 'COMPLETED' ELSE 'PLAN' END AS 'Status',      T0.PlannedQty,     T0.CmpltQty AS "Completed Qty",      T0.RjctQty AS "Rejected Qty",     T0.PlannedQty - T0.CmpltQty - T0.RjctQty AS "Open Qty",      T4.ItmsGrpNam,      T2.U_NAME AS "User Name",     T3.CardName AS "Customer Name",     T0.OriginNum AS "Sales Order",CASE WHEN T0.Status LIKE 'L' THEN      DATEDIFF(day, T0.DueDate, ISNULL(T0.CloseDate,T0.DueDate))+1 ELSE 0 END AS "Days Overdue" FROM      OWOR T0      FULL OUTER JOIN OCRD T3 ON (T0.CardCode = T3.CardCode)     INNER JOIN OITM T1 ON T0.ItemCode = T1.ItemCode     LEFT JOIN OITB T4 ON T1.ItmsGrpCod = T4.ItmsGrpCod     INNER JOIN OUSR T2 ON T0.UserSign = T2.userId  WHERE T0.[Status] <>'C' AND T0.PostDate >= GETDATE()-45  ORDER BY  T0.PostDate DESC
SELECT  T1.Account, Isnull((SELECT SUM(T3.Debit - T3.Credit)  FROM  OJDT T2 INNER JOIN JDT1 T3  ON T2.TransId = T3.TransId  INNER JOIN OACT o  ON o.AcctCode = T3.Account  WHERE  DateDiff(dd,T2.RefDate,'20220401') > 0 AND T3.Account LIKE T1.Account  GROUP BY  T3.Account),0) 'Opening balance',  SUM(T1.Debit) 'Debit', SUM(T1.Credit) 'Credit',  SUM(T1.Debit - T1.Credit) AS 'Balance'  ,AcctName, GroupMask,Levels,  (  CASE GroupMask  WHEN 1 THEN 'Assets'  WHEN 2 THEN 'Liablities'  WHEN 3 THEN 'Capital and Reserves'  WHEN 4 THEN 'Revenue'  WHEN 5 THEN 'Expenditure'  WHEN 6 THEN 'Operating Costs'  WHEN 7 THEN 'Non-Operating Income and Expenditure'  ELSE 'NOT INCLUDED'  END) [GROUP]  ,  (CASE Levels  WHEN 1 THEN 'Level 1'  WHEN 2 THEN 'Level 2'  WHEN 3 THEN 'Level 3'  WHEN 4 THEN 'Level 4'  WHEN 5 THEN 'Level 5'  END) [LEVELS_No.]  FROM  OJDT T0 INNER JOIN JDT1 T1  ON T0.TransId = T1.TransId  INNER JOIN OACT T4  ON T4.AcctCode = T1.Account  WHERE  T0.RefDate BETWEEN '20220401' AND GETDATE()  GROUP BY  T1.Account,AcctName, GroupMask,Levels  Having  SUM(T1.Debit - T1.Credit) != 0  ORDER BY  T1.Account
SELECT CardCode,CardName, [FY] , [4] AS April,[5] AS May,     [6] AS June,[7] AS July,[8] AS August,[9] AS September,[10] AS October,[11] AS November,[12] AS December,  [1] AS January,[2] AS February,[3] AS March,     ISNULL([1], 0) + ISNULL([2], 0) + ISNULL([3], 0) + ISNULL([4], 0) +     ISNULL([5], 0) + ISNULL([6], 0) + ISNULL([7], 0) + ISNULL([8], 0) +     ISNULL([9], 0) + ISNULL([10], 0) + ISNULL([11], 0) + ISNULL([12], 0) AS Total FROM (SELECT T0.CardCode, T0.CardName, CASE WHEN T1.DocDate >= '2019-04-01' AND T1.DocDate <= '2020-03-31' THEN 'FY 2019-20'              WHEN T1.DocDate >= '2020-04-01' AND T1.DocDate <= '2021-03-31' THEN 'FY 2020-21'              WHEN T1.DocDate >= '2021-04-01' AND T1.DocDate <= '2022-03-31' THEN 'FY 2021-22'              WHEN T1.DocDate >= '2022-04-01' AND T1.DocDate <= '2023-03-31' THEN 'FY 2022-23' END AS [FY] ,MONTH(T1.DocDate) AS Month, T2.LineTotal AS BasicValue FROM OCRD T0      INNER JOIN OINV T1 ON T0.CardCode = T1.CardCode   LEFT JOIN INV1 T2 ON T2.DocEntry = T1.DocEntry  WHERE T1.DocDate >='20190401' AND T1.CANCELED <>'Y' ) AS PivotData PIVOT (SUM(BasicValue)      FOR Month IN ( [4], [5], [6], [7], [8], [9], [10], [11], [12],[1], [2], [3])) AS PivotTable  UNION ALL  SELECT CardCode = 'Total',CardName = '',[FY]=' ',[1] = SUM(ISNULL([1], 0)),[2] = SUM(ISNULL([2], 0)),[3] = SUM(ISNULL([3], 0)),     [4] = SUM(ISNULL([4], 0)),[5] = SUM(ISNULL([5], 0)),[6] = SUM(ISNULL([6], 0)),[7] = SUM(ISNULL([7], 0)),[8] = SUM(ISNULL([8], 0)),  [9] = SUM(ISNULL([9], 0)),[10] = SUM(ISNULL([10], 0)),[11] = SUM(ISNULL([11], 0)),[12] = SUM(ISNULL([12], 0)),     Total = SUM(ISNULL([1], 0) + ISNULL([2], 0) + ISNULL([3], 0) + ISNULL([4], 0) +         ISNULL([5], 0) + ISNULL([6], 0) + ISNULL([7], 0) + ISNULL([8], 0) +         ISNULL([9], 0) + ISNULL([10], 0) + ISNULL([11], 0) + ISNULL([12], 0)) FROM (SELECT T0.CardCode,T0.CardName, CASE WHEN T1.DocDate >= '2019-04-01' AND T1.DocDate <= '2020-03-31' THEN 'FY 2019-20'              WHEN T1.DocDate >= '2020-04-01' AND T1.DocDate <= '2021-03-31' THEN 'FY 2020-21'              WHEN T1.DocDate >= '2021-04-01' AND T1.DocDate <= '2022-03-31' THEN 'FY 2021-22'              WHEN T1.DocDate >= '2022-04-01' AND T1.DocDate <= '2023-03-31' THEN 'FY 2022-23' END AS [FY],  MONTH(T1.DocDate) AS Month,T2.LineTotal AS BasicValue      FROM OCRD T0      INNER JOIN OINV T1 ON T0.CardCode = T1.CardCode   LEFT JOIN INV1 T2 ON T2.DocEntry = T1.DocEntry  WHERE T1.DocDate >='20190401' AND T1.CANCELED <>'Y') AS PivotData PIVOT (SUM(BasicValue)         FOR Month IN ([4], [5], [6], [7], [8], [9], [10], [11], [12],[1], [2], [3])) AS PivotTable
SELECT DISTINCT OCRD.CardCode, OCRD.CardName, OCRD.CardType, OCRG.GroupName, OCRD.CntctPrsn, CRD1.GSTRegnNo,        UPPER(CONCAT(CRD1.[Address],',',+CRD1.[Street],' ',CRD1.[Block],' ',CRD1.[City])) As 'Full Address',      CRD1.ZipCode, UPPER(T8.[Name] )AS 'STATE',      UPPER (OCRY.[Name]) AS 'COUNTRY', O1.[FY1920 Sale], O2.[FY2021 Sale], O3.[FY2122 Sale], O4.[FY2223 Sale], CN_FY1920, CN_FY2021, CN_FY2122, CN_FY2223, O1.[FY1920 Sale]-CN_FY1920 AS 'Net Sale FY1920', O2.[FY2021 Sale]-CN_FY2021 AS 'Net Sale FY2021', O3.[FY2122 Sale]-CN_FY2122 AS 'Net Sale FY2122', O4.[FY2223 Sale]-CN_FY2223 AS 'Net Sale FY2223', OCRD.CreditLine, OCRD.Balance, CASE WHEN OCRD.Balance<=0 THEN 0 ELSE OCRD.Balance END AS 'Total Dues', CASE WHEN OCRD.Balance<0 THEN OCRD.Balance ELSE 0 END AS 'Cr Balance', OCRD.OrdersBal as 'Pending SO Value', OCRD.CntctPrsn, OCRD.Cellular, OCRD.E_Mail, OCRD.VALIDFOR as 'Active', OCRD.CreateDate,  OCTG.[PymntGroup] as 'Payment Term' FROM OCRD        LEFT JOIN (Select distinct Cardcode, [Address], street, [block], zipcode, city, country, [state], LineNum, AdresType, GSTRegnNo        FROM CRD1        WHERE [Address]=(select tt1.BillToDef               from OCRD tt1               where tt1.CardCode = CRD1.CardCode and tt1.BillToDef = crd1.Address ) and AdresType='B' ) CRD1 ON CRD1.CardCode= OCRD.CardCode LEFT JOIN OCRG ON OCRG.GroupCode= OCRD.GroupCode LEFT JOIN OACT ON OACT.AcctCode= OCRD.DebPayAcct LEFT JOIN OCTG ON OCRD.groupNum = OCTG.GroupNum LEFT JOIN (SELECT DISTINCT CODE, COUNTRY, [NAME]        FROM OCST) T8 ON T8.Code = CRD1.[State] AND CRD1.Country=T8.Country LEFT JOIN OCRY ON OCRY.Code=CRD1.Country LEFT JOIN OSLP ON OSLP.SlpCode=OCRD.SlpCode LEFT JOIN (SELECT DISTINCT CARDCODE, SUM(DOCTOTAL) AS 'FY1920 Sale'        FROM OINV        WHERE DocDate >='2019-04-01' AND DocDate <= '2020-03-31' AND CANCELED <> 'Y'         GROUP BY CARDCODE) O1 ON O1.CardCode=OCRD.CardCode LEFT JOIN (SELECT DISTINCT CARDCODE, SUM(DOCTOTAL) AS 'FY2021 Sale'        FROM OINV        WHERE DocDate >='2020-04-01' AND DocDate <= '2021-03-31' AND CANCELED <> 'Y'         GROUP BY CARDCODE) O2 ON O2.CardCode=OCRD.CardCode LEFT JOIN (SELECT DISTINCT CARDCODE, SUM(DOCTOTAL) AS 'FY2122 Sale'        FROM OINV        WHERE DocDate >='2021-04-01' AND DocDate <= '2022-03-31' AND CANCELED <> 'Y'         GROUP BY CARDCODE) O3 ON O3.CardCode=OCRD.CardCode LEFT JOIN (SELECT DISTINCT CARDCODE, SUM(DOCTOTAL) AS 'FY2223 Sale'        FROM OINV        WHERE DocDate >='2022-04-01' AND DocDate <= '2023-03-31' AND CANCELED <> 'Y'        GROUP BY CARDCODE) O4 ON O4.CardCode=OCRD.CardCode LEFT JOIN (SELECT DISTINCT CARDCODE, SUM(DOCTOTAL) AS 'CN_FY1920'        FROM ORIN        WHERE DocDate >='2019-04-01' AND DocDate <= '2020-03-31' AND CANCELED <> 'Y'         GROUP BY CARDCODE) CN1 ON CN1.CardCode=OCRD.CardCode LEFT JOIN (SELECT DISTINCT CARDCODE, SUM(DOCTOTAL) AS 'CN_FY2021'        FROM ORIN        WHERE DocDate >='2020-04-01' AND DocDate <= '2021-03-31' AND CANCELED <> 'Y'         GROUP BY CARDCODE) CN2 ON CN2.CardCode=OCRD.CardCode LEFT JOIN (SELECT DISTINCT CARDCODE, SUM(DOCTOTAL) AS 'CN_FY2122'        FROM ORIN        WHERE DocDate >='2021-04-01' AND DocDate <= '2022-03-31' AND CANCELED <> 'Y'         GROUP BY CARDCODE) CN3 ON CN3.CardCode=OCRD.CardCode LEFT JOIN (SELECT DISTINCT CARDCODE, SUM(DOCTOTAL) AS 'CN_FY2223'        FROM ORIN        WHERE DocDate >='2022-04-01' AND DocDate <= '2023-03-31' AND CANCELED <> 'Y'        GROUP BY CARDCODE) CN4 ON CN4.CardCode=OCRD.CardCode --WHERE OCRD.CardType='C'
SELECT T0.[ObjectCode],  CASE  WHEN OBJECTCODE='1' THEN 'G/L Accounts' WHEN OBJECTCODE='2' THEN 'Business Partner' WHEN OBJECTCODE='3' THEN 'Bank Codes' WHEN OBJECTCODE='4' THEN 'Items' WHEN OBJECTCODE='5' THEN 'Tax Definition' WHEN OBJECTCODE='6' THEN 'Price Lists' WHEN OBJECTCODE='7' THEN 'Special Prices' WHEN OBJECTCODE='8' THEN 'Item Properties' WHEN OBJECTCODE='9' THEN 'Rate Differences' WHEN OBJECTCODE='10' THEN 'Card Groups' WHEN OBJECTCODE='11' THEN 'Contact Persons' WHEN OBJECTCODE='12' THEN 'Users' WHEN OBJECTCODE='13' THEN 'A/R Invoice' WHEN OBJECTCODE='14' THEN 'A/R Credit Memo' WHEN OBJECTCODE='15' THEN 'Delivery' WHEN OBJECTCODE='16' THEN 'Returns' WHEN OBJECTCODE='17' THEN 'Sales Order' WHEN OBJECTCODE='18' THEN 'A/P Invoice' WHEN OBJECTCODE='19' THEN 'A/P Credit Memo' WHEN OBJECTCODE='20' THEN 'Goods Receipt PO' WHEN OBJECTCODE='21' THEN 'Goods Return' WHEN OBJECTCODE='22' THEN 'Purchase Order' WHEN OBJECTCODE='23' THEN 'Sales Quotation' WHEN OBJECTCODE='24' THEN 'Incoming Payment' WHEN OBJECTCODE='25' THEN 'Deposit' WHEN OBJECTCODE='26' THEN 'Reconciliation History' WHEN OBJECTCODE='27' THEN 'Check Register' WHEN OBJECTCODE='28' THEN 'Journal Voucher Entry' WHEN OBJECTCODE='29' THEN 'Journal Vouchers List' WHEN OBJECTCODE='30' THEN 'Journal Entry' WHEN OBJECTCODE='31' THEN 'Items – Warehouse' WHEN OBJECTCODE='32' THEN 'Print Preferences' WHEN OBJECTCODE='33' THEN 'Activities' WHEN OBJECTCODE='34' THEN 'Recurring Postings' WHEN OBJECTCODE='35' THEN 'Document Numbering' WHEN OBJECTCODE='36' THEN 'Credit Cards' WHEN OBJECTCODE='37' THEN 'Currency Codes' WHEN OBJECTCODE='38' THEN 'CPI Codes' WHEN OBJECTCODE='39' THEN 'Administration' WHEN OBJECTCODE='40' THEN 'Payment Terms' WHEN OBJECTCODE='41' THEN 'Preferences' WHEN OBJECTCODE='42' THEN 'External Bank Statement Received' WHEN OBJECTCODE='43' THEN 'Manufacturers' WHEN OBJECTCODE='44' THEN 'Card Properties' WHEN OBJECTCODE='45' THEN 'Journal Entry Codes' WHEN OBJECTCODE='46' THEN 'Outgoing Payments' WHEN OBJECTCODE='47' THEN 'Serial Numbers' WHEN OBJECTCODE='48' THEN 'Loading Expenses' WHEN OBJECTCODE='49' THEN 'Delivery Types' WHEN OBJECTCODE='50' THEN 'Length Units' WHEN OBJECTCODE='51' THEN 'Weight Units' WHEN OBJECTCODE='52' THEN 'Item Groups' WHEN OBJECTCODE='53' THEN 'Sales Employee' WHEN OBJECTCODE='54' THEN 'Report – Selection Criteria' WHEN OBJECTCODE='55' THEN 'Posting Templates' WHEN OBJECTCODE='56' THEN 'Customs Groups' WHEN OBJECTCODE='57' THEN 'Checks for Payment' WHEN OBJECTCODE='58' THEN 'Whse Journal' WHEN OBJECTCODE='59' THEN 'Goods Receipt' WHEN OBJECTCODE='60' THEN 'Goods Issue' WHEN OBJECTCODE='61' THEN 'Cost Center' WHEN OBJECTCODE='62' THEN 'Cost Rate' WHEN OBJECTCODE='63' THEN 'Project Codes' WHEN OBJECTCODE='64' THEN 'Warehouses' WHEN OBJECTCODE='65' THEN 'Commission Groups' WHEN OBJECTCODE='66' THEN 'Product Tree' WHEN OBJECTCODE='67' THEN 'Inventory Transfer' WHEN OBJECTCODE='68' THEN 'Production Instructions' WHEN OBJECTCODE='69' THEN 'Landed Costs' WHEN OBJECTCODE='70' THEN 'Payment Methods' WHEN OBJECTCODE='71' THEN 'Credit Card Payment' WHEN OBJECTCODE='72' THEN 'Credit Card Management' WHEN OBJECTCODE='73' THEN 'Customer/Vendor Cat. No.' WHEN OBJECTCODE='74' THEN 'Credit Payments' WHEN OBJECTCODE='75' THEN 'CPI and FC Rates' WHEN OBJECTCODE='76' THEN 'Postdated Deposit' WHEN OBJECTCODE='77' THEN 'Budget' WHEN OBJECTCODE='78' THEN 'Budget Cost Assess. Mthd' WHEN OBJECTCODE='79' THEN 'Retail Chains' WHEN OBJECTCODE='80' THEN 'Alerts Template' WHEN OBJECTCODE='81' THEN 'Alerts' WHEN OBJECTCODE='82' THEN 'Received Alerts' WHEN OBJECTCODE='83' THEN 'Message Sent' WHEN OBJECTCODE='84' THEN 'Activity Subjects' WHEN OBJECTCODE='85' THEN 'Special Prices for Groups' WHEN OBJECTCODE='86' THEN 'Application Start' WHEN OBJECTCODE='87' THEN 'Distribution List' WHEN OBJECTCODE='88' THEN 'Shipping Types' WHEN OBJECTCODE='89' THEN 'Outgoing' WHEN OBJECTCODE='90' THEN 'Transition' WHEN OBJECTCODE='91' THEN 'Budget Scenario' WHEN OBJECTCODE='92' THEN 'Interest Prices' WHEN OBJECTCODE='93' THEN 'User Defaults' WHEN OBJECTCODE='94' THEN 'Serial Numbers for Items' WHEN OBJECTCODE='95' THEN 'Financial Report Templates' WHEN OBJECTCODE='96' THEN 'Financial Report Categories' WHEN OBJECTCODE='97' THEN 'Opportunity' WHEN OBJECTCODE='98' THEN 'Interest' WHEN OBJECTCODE='99' THEN 'Interest Level' WHEN OBJECTCODE='100' THEN 'Information Source' WHEN OBJECTCODE='101' THEN 'Opportunity Stage' WHEN OBJECTCODE='102' THEN 'Defect Cause' WHEN OBJECTCODE='103' THEN 'Activity Types' WHEN OBJECTCODE='104' THEN 'Meetings Location' WHEN OBJECTCODE='105' THEN 'Service Calls' WHEN OBJECTCODE='106' THEN 'Batch No. for Item' WHEN OBJECTCODE='107' THEN 'Alternative Items 2' WHEN OBJECTCODE='108' THEN 'Partners' WHEN OBJECTCODE='109' THEN 'Competitors' WHEN OBJECTCODE='110' THEN 'User Validations' WHEN OBJECTCODE='111' THEN 'Posting Period' WHEN OBJECTCODE='112' THEN 'Drafts' WHEN OBJECTCODE='113' THEN 'Batches and Serial Numbers' WHEN OBJECTCODE='114' THEN 'User Display Cat.' WHEN OBJECTCODE='115' THEN 'Lender – Pelecard' WHEN OBJECTCODE='116' THEN 'Withholding Tax Deduction Hierarchy' WHEN OBJECTCODE='117' THEN 'Withholding Tax Deduction Groups' WHEN OBJECTCODE='118' THEN 'Branches' WHEN OBJECTCODE='119' THEN 'Departments' WHEN OBJECTCODE='120' THEN 'Confirmation Level' WHEN OBJECTCODE='121' THEN 'Approval Templates' WHEN OBJECTCODE='122' THEN 'Docs. for Confirmation' WHEN OBJECTCODE='123' THEN 'Checks for Payment Drafts' WHEN OBJECTCODE='124' THEN 'Company Info' WHEN OBJECTCODE='125' THEN 'Freight Setup' WHEN OBJECTCODE='126' THEN 'Sales Tax Authorities' WHEN OBJECTCODE='127' THEN 'Sales Tax Authorities Type' WHEN OBJECTCODE='128' THEN 'Sales Tax Codes' WHEN OBJECTCODE='129' THEN 'Countries' WHEN OBJECTCODE='130' THEN 'States' WHEN OBJECTCODE='131' THEN 'Address Formats' WHEN OBJECTCODE='132' THEN 'A/R Correction Invoice' WHEN OBJECTCODE='133' THEN 'Cash Discount' WHEN OBJECTCODE='134' THEN 'Query Catagories' WHEN OBJECTCODE='135' THEN 'Triangular Deal' WHEN OBJECTCODE='136' THEN 'Data Migration' WHEN OBJECTCODE='137' THEN 'Workstation ID' WHEN OBJECTCODE='138' THEN 'Indicator' WHEN OBJECTCODE='139' THEN 'Goods Shipment' WHEN OBJECTCODE='140' THEN 'Payment Draft' WHEN OBJECTCODE='141' THEN 'Query Wizard' WHEN OBJECTCODE='142' THEN 'Account Segmentation' WHEN OBJECTCODE='143' THEN 'Account Segmentation Categories' WHEN OBJECTCODE='144' THEN 'Location' WHEN OBJECTCODE='145' THEN '1099 Forms' WHEN OBJECTCODE='146' THEN 'Cycle' WHEN OBJECTCODE='147' THEN 'Payment Methods for Payment Wizard' WHEN OBJECTCODE='148' THEN '1099 Opening Balance' WHEN OBJECTCODE='149' THEN 'Dunning Interest Rate' WHEN OBJECTCODE='150' THEN 'BP Priorities' WHEN OBJECTCODE='151' THEN 'Dunning Letters' WHEN OBJECTCODE='152' THEN 'User Fields – Description' WHEN OBJECTCODE='153' THEN 'User Tables' WHEN OBJECTCODE='154' THEN 'My Menu Items' WHEN OBJECTCODE='155' THEN 'Payment Run' WHEN OBJECTCODE='156' THEN 'Pick List' WHEN OBJECTCODE='157' THEN 'Payment Wizard' WHEN OBJECTCODE='158' THEN 'Payment Results Table' WHEN OBJECTCODE='159' THEN 'Payment Block' WHEN OBJECTCODE='160' THEN 'Queries' WHEN OBJECTCODE='161' THEN 'Central Bank Ind.' WHEN OBJECTCODE='162' THEN 'Inventory Revaluation' WHEN OBJECTCODE='163' THEN 'A/P Correction Invoice' WHEN OBJECTCODE='164' THEN 'A/P Correction Invoice Reversal' WHEN OBJECTCODE='165' THEN 'A/R Correction Invoice' WHEN OBJECTCODE='166' THEN 'A/R Correction Invoice Reversal' WHEN OBJECTCODE='167' THEN 'Service Call Statuses' WHEN OBJECTCODE='168' THEN 'Service Call Types' WHEN OBJECTCODE='169' THEN 'Service Call Problem Types' WHEN OBJECTCODE='170' THEN 'Contract Template' WHEN OBJECTCODE='171' THEN 'Employees' WHEN OBJECTCODE='172' THEN 'Employee Types' WHEN OBJECTCODE='173' THEN 'Employee Status' WHEN OBJECTCODE='174' THEN 'Termination Reason' WHEN OBJECTCODE='175' THEN 'Education Types' WHEN OBJECTCODE='176' THEN 'Customer Equipment Card' WHEN OBJECTCODE='177' THEN 'Agent Name' WHEN OBJECTCODE='178' THEN 'Withholding Tax' WHEN OBJECTCODE='179' THEN 'Already Displayed 347, 349 and WTax Reports' WHEN OBJECTCODE='180' THEN 'Tax Report' WHEN OBJECTCODE='181' THEN 'Bill of Exchange for Payment' WHEN OBJECTCODE='182' THEN 'Bill Of Exchang Transaction' WHEN OBJECTCODE='183' THEN 'File Format' WHEN OBJECTCODE='184' THEN 'Period Indicator' WHEN OBJECTCODE='185' THEN 'Doubtful Debts' WHEN OBJECTCODE='186' THEN 'Holiday Table' WHEN OBJECTCODE='187' THEN 'BP – Bank Account' WHEN OBJECTCODE='188' THEN 'Service Call Solution Statuses' WHEN OBJECTCODE='189' THEN 'Service Call Solutions' WHEN OBJECTCODE='190' THEN 'Service Contracts' WHEN OBJECTCODE='191' THEN 'Service Calls' WHEN OBJECTCODE='192' THEN 'Service Call Origins' WHEN OBJECTCODE='193' THEN 'User Key Description' WHEN OBJECTCODE='194' THEN 'Queue' WHEN OBJECTCODE='195' THEN 'Inflation Wizard' WHEN OBJECTCODE='196' THEN 'Dunning Terms' WHEN OBJECTCODE='197' THEN 'Dunning Wizard' WHEN OBJECTCODE='198' THEN 'Sales Forecast' WHEN OBJECTCODE='199' THEN 'MRP Scenarios' WHEN OBJECTCODE='200' THEN 'Territories' WHEN OBJECTCODE='201' THEN 'Industries' WHEN OBJECTCODE='202' THEN 'Production Order' WHEN OBJECTCODE='203' THEN 'A/R Down Payment' WHEN OBJECTCODE='204' THEN 'A/P Down Payment' WHEN OBJECTCODE='205' THEN 'Package Types' WHEN OBJECTCODE='206' THEN 'User-Defined Object' WHEN OBJECTCODE='207' THEN 'Data Ownership – Objects' WHEN OBJECTCODE='208' THEN 'Data Ownership – Exceptions' WHEN OBJECTCODE='209' THEN '' WHEN OBJECTCODE='210' THEN 'Employee Position' WHEN OBJECTCODE='211' THEN 'Employee Teams' WHEN OBJECTCODE='212' THEN 'Relationships' WHEN OBJECTCODE='213' THEN 'Recommendation Data' WHEN OBJECTCODE='214' THEN 'User Autorization Tree' WHEN OBJECTCODE='215' THEN 'Predefined Text' WHEN OBJECTCODE='216' THEN 'Box Definition' WHEN OBJECTCODE='217' THEN 'Activity Status' WHEN OBJECTCODE='218' THEN '312' WHEN OBJECTCODE='219' THEN 'User-Defined Values' WHEN OBJECTCODE='220' THEN 'Periods Category' WHEN OBJECTCODE='221' THEN 'Attachments' WHEN OBJECTCODE='222' THEN 'Grid Filter' WHEN OBJECTCODE='223' THEN 'User Language Table' WHEN OBJECTCODE='224' THEN 'Multi-Language Translation' WHEN OBJECTCODE='225' THEN '' WHEN OBJECTCODE='226' THEN '' WHEN OBJECTCODE='227' THEN '' WHEN OBJECTCODE='229' THEN 'Dynamic Interface (Strings)' WHEN OBJECTCODE='230' THEN 'Saved Reconciliations' WHEN OBJECTCODE='231' THEN 'House Bank Accounts' WHEN OBJECTCODE='232' THEN 'Document' WHEN OBJECTCODE='233' THEN 'Document Generation Parameter Sets' WHEN OBJECTCODE='234' THEN '#740' WHEN OBJECTCODE='238' THEN 'Account Category' WHEN OBJECTCODE='239' THEN 'Bank Charges Allocation Codes' WHEN OBJECTCODE='241' THEN 'Cash Flow Transactions – Rows' WHEN OBJECTCODE='242' THEN 'Cash Flow Line Item' WHEN OBJECTCODE='247' THEN 'Business Place' WHEN OBJECTCODE='250' THEN 'Local Era Calendar' WHEN OBJECTCODE='251' THEN 'Cost Accounting Dimension' WHEN OBJECTCODE='254' THEN 'Service Code Table' WHEN OBJECTCODE='255' THEN 'Service Group for Brazil' WHEN OBJECTCODE='256' THEN 'Material Group' WHEN OBJECTCODE='257' THEN 'NCM Code' WHEN OBJECTCODE='258' THEN 'CFOP for Nota Fiscal' WHEN OBJECTCODE='259' THEN 'CST Code for Nota Fiscal' WHEN OBJECTCODE='260' THEN 'Usage of Nota Fiscal' WHEN OBJECTCODE='261' THEN 'Closing Date Procedure' WHEN OBJECTCODE='263' THEN 'Nota Fiscal Numbering' WHEN OBJECTCODE='264' THEN 'Nota Fiscal Tax Category (Brazil)' WHEN OBJECTCODE='265' THEN 'Counties' WHEN OBJECTCODE='266' THEN 'Tax Code Determination' WHEN OBJECTCODE='267' THEN 'BoE Document Type' WHEN OBJECTCODE='268' THEN 'BoE Portfolio' WHEN OBJECTCODE='269' THEN 'BoE Instruction' WHEN OBJECTCODE='271' THEN 'Tax Parameter' WHEN OBJECTCODE='275' THEN 'Tax Type Combination' WHEN OBJECTCODE='276' THEN 'Tax Formula Master Table' WHEN OBJECTCODE='278' THEN 'CNAE Code' WHEN OBJECTCODE='280' THEN 'Sales Tax Invoice' WHEN OBJECTCODE='281' THEN 'Purchase Tax Invoice' WHEN OBJECTCODE='283' THEN 'Cargo Customs Declaration Numbers' WHEN OBJECTCODE='290' THEN 'Resources' WHEN OBJECTCODE='291' THEN 'Resource Properties' WHEN OBJECTCODE='292' THEN 'ResGrpCod' WHEN OBJECTCODE='300' THEN 'RecordSet' WHEN OBJECTCODE='305' THEN 'Bridge' WHEN OBJECTCODE='321' THEN 'Internal Reconciliation' WHEN OBJECTCODE='541' THEN 'POS Master Data' WHEN OBJECTCODE='1179' THEN 'Stock Transfer Draft' WHEN OBJECTCODE='10000105' THEN 'Messaging Service Settings' WHEN OBJECTCODE='10000044' THEN 'Batch Numbers Master Data' WHEN OBJECTCODE='10000045' THEN 'Serial Numbers Master Data' WHEN OBJECTCODE='10000062' THEN 'IVL Vs OINM Keys' WHEN OBJECTCODE='10000071' THEN 'Inventory Posting' WHEN OBJECTCODE='10000073' THEN 'Financial Year Master' WHEN OBJECTCODE='10000074' THEN 'Sections' WHEN OBJECTCODE='10000075' THEN 'Certificate Series' WHEN OBJECTCODE='10000077' THEN 'Nature of Assessee' WHEN OBJECTCODE='10000196' THEN 'Document Type List' WHEN OBJECTCODE='10000197' THEN 'UoM Group' WHEN OBJECTCODE='10000199' THEN 'UoM Master Data' WHEN OBJECTCODE='10000203' THEN 'Bin Field Configuration' WHEN OBJECTCODE='10000204' THEN 'Bin Location Attribute' WHEN OBJECTCODE='10000205' THEN 'Warehouse Sublevel' WHEN OBJECTCODE='10000206' THEN 'Bin Location' WHEN OBJECTCODE='140000041' THEN 'DNF Code' WHEN OBJECTCODE='231000000' THEN 'Authorization Group' WHEN OBJECTCODE='234000004' THEN 'E-Mail Group' WHEN OBJECTCODE='243000001' THEN 'Government Payment Code' WHEN OBJECTCODE='310000001' THEN 'Inventory Opening Balance' WHEN OBJECTCODE='310000008' THEN 'Batch Attributes in Location' WHEN OBJECTCODE='410000005' THEN 'Legal List Format' WHEN OBJECTCODE='480000001' THEN 'Object: HR Employee Transfer' WHEN OBJECTCODE='540000005' THEN 'Tax Code Determination' WHEN OBJECTCODE='540000006' THEN 'Purchase Quotation' WHEN OBJECTCODE='540000040' THEN 'Recurring Transaction Template' WHEN OBJECTCODE='540000042' THEN 'Cost Center Type' WHEN OBJECTCODE='540000048' THEN 'Accrual Type' WHEN OBJECTCODE='540000056' THEN 'Nota Fiscal Model' WHEN OBJECTCODE='540000067' THEN 'Brazil Fuel Indexer' WHEN OBJECTCODE='540000068' THEN 'Brazil Beverage Indexer' WHEN OBJECTCODE='1210000000' THEN 'Cockpit Main Table' WHEN OBJECTCODE='1250000001' THEN 'Inventory Transfer Request' WHEN OBJECTCODE='1250000025' THEN 'Blanket Agreement' WHEN OBJECTCODE='1320000000' THEN 'Key Performance Indicator Package' WHEN OBJECTCODE='1320000002' THEN 'Target Group' WHEN OBJECTCODE='1320000012' THEN 'Campaign' WHEN OBJECTCODE='1320000028' THEN 'Retorno Operation Codes' WHEN OBJECTCODE='1320000039' THEN 'Product Source Code' WHEN OBJECTCODE='1470000000' THEN 'Fixed Assets Depreciation Types' WHEN OBJECTCODE='1470000002' THEN 'Fixed Assets Account Determination' WHEN OBJECTCODE='1470000003' THEN 'Fixed Asset Depreciation Areas' WHEN OBJECTCODE='1470000004' THEN 'Depreciation Type Pools' WHEN OBJECTCODE='1470000032' THEN 'Asset Classes' WHEN OBJECTCODE='1470000046' THEN 'Asset Groups' WHEN OBJECTCODE='1470000048' THEN 'G/L Account Determination Criteria – Inventory' WHEN OBJECTCODE='1470000049' THEN 'Capitalization' WHEN OBJECTCODE='1470000057' THEN 'G/L Account Advanced Rules' WHEN OBJECTCODE='1470000060' THEN 'Credit Memo' WHEN OBJECTCODE='1470000062' THEN 'Bar Code Master Data' WHEN OBJECTCODE='1470000065' THEN 'Inventory Counting' WHEN OBJECTCODE='1470000077' THEN 'Discount Groups' WHEN OBJECTCODE='1470000092' THEN 'Cycle Count Determination' WHEN OBJECTCODE='1470000113' THEN 'Purchase Request' WHEN OBJECTCODE='1620000000' THEN 'Workflow – Task Details'  ELSE 'Addons'  END AS 'Document Type', CASE  WHEN OBJECTCODE='1' THEN 'OACT' WHEN OBJECTCODE='2' THEN 'OCRD' WHEN OBJECTCODE='3' THEN 'ODSC' WHEN OBJECTCODE='4' THEN 'OITM' WHEN OBJECTCODE='5' THEN 'OVTG' WHEN OBJECTCODE='6' THEN 'OPLN' WHEN OBJECTCODE='7' THEN 'OSPP' WHEN OBJECTCODE='8' THEN 'OITG' WHEN OBJECTCODE='9' THEN 'ORTM' WHEN OBJECTCODE='10' THEN 'OCRG' WHEN OBJECTCODE='11' THEN 'OCPR' WHEN OBJECTCODE='12' THEN 'OUSR' WHEN OBJECTCODE='13' THEN 'OINV' WHEN OBJECTCODE='14' THEN 'ORIN' WHEN OBJECTCODE='15' THEN 'ODLN' WHEN OBJECTCODE='16' THEN 'ORDN' WHEN OBJECTCODE='17' THEN 'ORDR' WHEN OBJECTCODE='18' THEN 'OPCH' WHEN OBJECTCODE='19' THEN 'ORPC' WHEN OBJECTCODE='20' THEN 'OPDN' WHEN OBJECTCODE='21' THEN 'ORPD' WHEN OBJECTCODE='22' THEN 'OPOR' WHEN OBJECTCODE='23' THEN 'OQUT' WHEN OBJECTCODE='24' THEN 'ORCT' WHEN OBJECTCODE='25' THEN 'ODPS' WHEN OBJECTCODE='26' THEN 'OMTH' WHEN OBJECTCODE='27' THEN 'OCHH' WHEN OBJECTCODE='28' THEN 'OBTF' WHEN OBJECTCODE='29' THEN 'OBTD' WHEN OBJECTCODE='30' THEN 'OJDT' WHEN OBJECTCODE='31' THEN 'OITW' WHEN OBJECTCODE='32' THEN 'OADP' WHEN OBJECTCODE='33' THEN 'OCLG' WHEN OBJECTCODE='34' THEN 'ORCR' WHEN OBJECTCODE='35' THEN 'ONNM' WHEN OBJECTCODE='36' THEN 'OCRC' WHEN OBJECTCODE='37' THEN 'OCRN' WHEN OBJECTCODE='38' THEN 'OIDX' WHEN OBJECTCODE='39' THEN 'OADM' WHEN OBJECTCODE='40' THEN 'OCTG' WHEN OBJECTCODE='41' THEN 'OPRF' WHEN OBJECTCODE='42' THEN 'OBNK' WHEN OBJECTCODE='43' THEN 'OMRC' WHEN OBJECTCODE='44' THEN 'OCQG' WHEN OBJECTCODE='45' THEN 'OTRC' WHEN OBJECTCODE='46' THEN 'OVPM' WHEN OBJECTCODE='47' THEN 'OSRL' WHEN OBJECTCODE='48' THEN 'OALC' WHEN OBJECTCODE='49' THEN 'OSHP' WHEN OBJECTCODE='50' THEN 'OLGT' WHEN OBJECTCODE='51' THEN 'OWGT' WHEN OBJECTCODE='52' THEN 'OITB' WHEN OBJECTCODE='53' THEN 'OSLP' WHEN OBJECTCODE='54' THEN 'OFLT' WHEN OBJECTCODE='55' THEN 'OTRT' WHEN OBJECTCODE='56' THEN 'OARG' WHEN OBJECTCODE='57' THEN 'OCHO' WHEN OBJECTCODE='58' THEN 'OINM' WHEN OBJECTCODE='59' THEN 'OIGN' WHEN OBJECTCODE='60' THEN 'OIGE' WHEN OBJECTCODE='61' THEN 'OPRC' WHEN OBJECTCODE='62' THEN 'OOCR' WHEN OBJECTCODE='63' THEN 'OPRJ' WHEN OBJECTCODE='64' THEN 'OWHS' WHEN OBJECTCODE='65' THEN 'OCOG' WHEN OBJECTCODE='66' THEN 'OITT' WHEN OBJECTCODE='67' THEN 'OWTR' WHEN OBJECTCODE='68' THEN 'OWKO' WHEN OBJECTCODE='69' THEN 'OIPF' WHEN OBJECTCODE='70' THEN 'OCRP' WHEN OBJECTCODE='71' THEN 'OCDT' WHEN OBJECTCODE='72' THEN 'OCRH' WHEN OBJECTCODE='73' THEN 'OSCN' WHEN OBJECTCODE='74' THEN 'OCRV' WHEN OBJECTCODE='75' THEN 'ORTT' WHEN OBJECTCODE='76' THEN 'ODPT' WHEN OBJECTCODE='77' THEN 'OBGT' WHEN OBJECTCODE='78' THEN 'OBGD' WHEN OBJECTCODE='79' THEN 'ORCN' WHEN OBJECTCODE='80' THEN 'OALT' WHEN OBJECTCODE='81' THEN 'OALR' WHEN OBJECTCODE='82' THEN 'OAIB' WHEN OBJECTCODE='83' THEN 'OAOB' WHEN OBJECTCODE='84' THEN 'OCLS' WHEN OBJECTCODE='85' THEN 'OSPG' WHEN OBJECTCODE='86' THEN 'SPRG' WHEN OBJECTCODE='87' THEN 'OMLS' WHEN OBJECTCODE='88' THEN 'OENT' WHEN OBJECTCODE='89' THEN 'OSAL' WHEN OBJECTCODE='90' THEN 'OTRA' WHEN OBJECTCODE='91' THEN 'OBGS' WHEN OBJECTCODE='92' THEN 'OIRT' WHEN OBJECTCODE='93' THEN 'OUDG' WHEN OBJECTCODE='94' THEN 'OSRI' WHEN OBJECTCODE='95' THEN 'OFRT' WHEN OBJECTCODE='96' THEN 'OFRC' WHEN OBJECTCODE='97' THEN 'OOPR' WHEN OBJECTCODE='98' THEN 'OOIN' WHEN OBJECTCODE='99' THEN 'OOIR' WHEN OBJECTCODE='100' THEN 'OOSR' WHEN OBJECTCODE='101' THEN 'OOST' WHEN OBJECTCODE='102' THEN 'OOFR' WHEN OBJECTCODE='103' THEN 'OCLT' WHEN OBJECTCODE='104' THEN 'OCLO' WHEN OBJECTCODE='105' THEN 'OISR' WHEN OBJECTCODE='106' THEN 'OIBT' WHEN OBJECTCODE='107' THEN 'OALI' WHEN OBJECTCODE='108' THEN 'OPRT' WHEN OBJECTCODE='109' THEN 'OCMT' WHEN OBJECTCODE='110' THEN 'OUVV' WHEN OBJECTCODE='111' THEN 'OFPR' WHEN OBJECTCODE='112' THEN 'ODRF' WHEN OBJECTCODE='113' THEN 'OSRD' WHEN OBJECTCODE='114' THEN 'OUDC' WHEN OBJECTCODE='115' THEN 'OPVL' WHEN OBJECTCODE='116' THEN 'ODDT' WHEN OBJECTCODE='117' THEN 'ODDG' WHEN OBJECTCODE='118' THEN 'OUBR' WHEN OBJECTCODE='119' THEN 'OUDP' WHEN OBJECTCODE='120' THEN 'OWST' WHEN OBJECTCODE='121' THEN 'OWTM' WHEN OBJECTCODE='122' THEN 'OWDD' WHEN OBJECTCODE='123' THEN 'OCHD' WHEN OBJECTCODE='124' THEN 'CINF' WHEN OBJECTCODE='125' THEN 'OEXD' WHEN OBJECTCODE='126' THEN 'OSTA' WHEN OBJECTCODE='127' THEN 'OSTT' WHEN OBJECTCODE='128' THEN 'OSTC' WHEN OBJECTCODE='129' THEN 'OCRY' WHEN OBJECTCODE='130' THEN 'OCST' WHEN OBJECTCODE='131' THEN 'OADF' WHEN OBJECTCODE='132' THEN 'OCIN' WHEN OBJECTCODE='133' THEN 'OCDC' WHEN OBJECTCODE='134' THEN 'OQCN' WHEN OBJECTCODE='135' THEN 'OIND' WHEN OBJECTCODE='136' THEN 'ODMW' WHEN OBJECTCODE='137' THEN 'OCSTN' WHEN OBJECTCODE='138' THEN 'OIDC' WHEN OBJECTCODE='139' THEN 'OGSP' WHEN OBJECTCODE='140' THEN 'OPDF' WHEN OBJECTCODE='141' THEN 'OQWZ' WHEN OBJECTCODE='142' THEN 'OASG' WHEN OBJECTCODE='143' THEN 'OASC' WHEN OBJECTCODE='144' THEN 'OLCT' WHEN OBJECTCODE='145' THEN 'OTNN' WHEN OBJECTCODE='146' THEN 'OCYC' WHEN OBJECTCODE='147' THEN 'OPYM' WHEN OBJECTCODE='148' THEN 'OTOB' WHEN OBJECTCODE='149' THEN 'ORIT' WHEN OBJECTCODE='150' THEN 'OBPP' WHEN OBJECTCODE='151' THEN 'ODUN' WHEN OBJECTCODE='152' THEN 'CUFD' WHEN OBJECTCODE='153' THEN 'OUTB' WHEN OBJECTCODE='154' THEN 'OCUMI' WHEN OBJECTCODE='155' THEN 'OPYD' WHEN OBJECTCODE='156' THEN 'OPKL' WHEN OBJECTCODE='157' THEN 'OPWZ' WHEN OBJECTCODE='158' THEN 'OPEX' WHEN OBJECTCODE='159' THEN 'OPYB' WHEN OBJECTCODE='160' THEN 'OUQR' WHEN OBJECTCODE='161' THEN 'OCBI' WHEN OBJECTCODE='162' THEN 'OMRV' WHEN OBJECTCODE='163' THEN 'OCPI' WHEN OBJECTCODE='164' THEN 'OCPV' WHEN OBJECTCODE='165' THEN 'OCSI' WHEN OBJECTCODE='166' THEN 'OCSV' WHEN OBJECTCODE='167' THEN 'OSCS' WHEN OBJECTCODE='168' THEN 'OSCT' WHEN OBJECTCODE='169' THEN 'OSCP' WHEN OBJECTCODE='170' THEN 'OCTT' WHEN OBJECTCODE='171' THEN 'OHEM' WHEN OBJECTCODE='172' THEN 'OHTY' WHEN OBJECTCODE='173' THEN 'OHST' WHEN OBJECTCODE='174' THEN 'OHTR' WHEN OBJECTCODE='175' THEN 'OHED' WHEN OBJECTCODE='176' THEN 'OINS' WHEN OBJECTCODE='177' THEN 'OAGP' WHEN OBJECTCODE='178' THEN 'OWHT' WHEN OBJECTCODE='179' THEN 'ORFL' WHEN OBJECTCODE='180' THEN 'OVTR' WHEN OBJECTCODE='181' THEN 'OBOE' WHEN OBJECTCODE='182' THEN 'OBOT' WHEN OBJECTCODE='183' THEN 'OFRM' WHEN OBJECTCODE='184' THEN 'OPID' WHEN OBJECTCODE='185' THEN 'ODOR' WHEN OBJECTCODE='186' THEN 'OHLD' WHEN OBJECTCODE='187' THEN 'OCRB' WHEN OBJECTCODE='188' THEN 'OSST' WHEN OBJECTCODE='189' THEN 'OSLT' WHEN OBJECTCODE='190' THEN 'OCTR' WHEN OBJECTCODE='191' THEN 'OSCL' WHEN OBJECTCODE='192' THEN 'OSCO' WHEN OBJECTCODE='193' THEN 'OUKD' WHEN OBJECTCODE='194' THEN 'OQUE' WHEN OBJECTCODE='195' THEN 'OIWZ' WHEN OBJECTCODE='196' THEN 'ODUT' WHEN OBJECTCODE='197' THEN 'ODWZ' WHEN OBJECTCODE='198' THEN 'OFCT' WHEN OBJECTCODE='199' THEN 'OMSN' WHEN OBJECTCODE='200' THEN 'OTER' WHEN OBJECTCODE='201' THEN 'OOND' WHEN OBJECTCODE='202' THEN 'OWOR' WHEN OBJECTCODE='203' THEN 'ODPI' WHEN OBJECTCODE='204' THEN 'ODPO' WHEN OBJECTCODE='205' THEN 'OPKG' WHEN OBJECTCODE='206' THEN 'OUDO' WHEN OBJECTCODE='207' THEN 'ODOW' WHEN OBJECTCODE='208' THEN 'ODOX' WHEN OBJECTCODE='209' THEN '' WHEN OBJECTCODE='210' THEN 'OHPS' WHEN OBJECTCODE='211' THEN 'OHTM' WHEN OBJECTCODE='212' THEN 'OORL' WHEN OBJECTCODE='213' THEN 'ORCM' WHEN OBJECTCODE='214' THEN 'OUPT' WHEN OBJECTCODE='215' THEN 'OPDT' WHEN OBJECTCODE='216' THEN 'OBOX' WHEN OBJECTCODE='217' THEN 'OCLA' WHEN OBJECTCODE='218' THEN 'OCHF' WHEN OBJECTCODE='219' THEN 'OCSHS' WHEN OBJECTCODE='220' THEN 'OACP' WHEN OBJECTCODE='221' THEN 'OATC' WHEN OBJECTCODE='222' THEN 'OGFL' WHEN OBJECTCODE='223' THEN 'OLNG' WHEN OBJECTCODE='224' THEN 'OMLT' WHEN OBJECTCODE='225' THEN 'OAPA3' WHEN OBJECTCODE='226' THEN 'OAPA4' WHEN OBJECTCODE='227' THEN 'OAPA5' WHEN OBJECTCODE='229' THEN 'SDIS' WHEN OBJECTCODE='230' THEN 'OSVR' WHEN OBJECTCODE='231' THEN 'DSC1' WHEN OBJECTCODE='232' THEN 'RDOC' WHEN OBJECTCODE='233' THEN 'ODGP' WHEN OBJECTCODE='234' THEN 'OMHD' WHEN OBJECTCODE='238' THEN 'OACG' WHEN OBJECTCODE='239' THEN 'OBCA' WHEN OBJECTCODE='241' THEN 'OCFT' WHEN OBJECTCODE='242' THEN 'OCFW' WHEN OBJECTCODE='247' THEN 'OBPL' WHEN OBJECTCODE='250' THEN 'OJPE' WHEN OBJECTCODE='251' THEN 'ODIM' WHEN OBJECTCODE='254' THEN 'OSCD' WHEN OBJECTCODE='255' THEN 'OSGP' WHEN OBJECTCODE='256' THEN 'OMGP' WHEN OBJECTCODE='257' THEN 'ONCM' WHEN OBJECTCODE='258' THEN 'OCFP' WHEN OBJECTCODE='259' THEN 'OTSC' WHEN OBJECTCODE='260' THEN 'OUSG' WHEN OBJECTCODE='261' THEN 'OCDP' WHEN OBJECTCODE='263' THEN 'ONFN' WHEN OBJECTCODE='264' THEN 'ONFT' WHEN OBJECTCODE='265' THEN 'OCNT' WHEN OBJECTCODE='266' THEN 'OTCD' WHEN OBJECTCODE='267' THEN 'ODTY' WHEN OBJECTCODE='268' THEN 'OPTF' WHEN OBJECTCODE='269' THEN 'OIST' WHEN OBJECTCODE='271' THEN 'OTPS' WHEN OBJECTCODE='275' THEN 'OTFC' WHEN OBJECTCODE='276' THEN 'OFML' WHEN OBJECTCODE='278' THEN 'OCNA' WHEN OBJECTCODE='280' THEN 'OTSI' WHEN OBJECTCODE='281' THEN 'OTPI' WHEN OBJECTCODE='283' THEN 'OCCD' WHEN OBJECTCODE='290' THEN 'ORSC' WHEN OBJECTCODE='291' THEN 'ORSG' WHEN OBJECTCODE='292' THEN 'ORSB' WHEN OBJECTCODE='300' THEN '' WHEN OBJECTCODE='305' THEN '' WHEN OBJECTCODE='321' THEN 'OITR' WHEN OBJECTCODE='541' THEN 'OPOS' WHEN OBJECTCODE='1179' THEN 'ODRF' WHEN OBJECTCODE='10000105' THEN 'OMSG' WHEN OBJECTCODE='10000044' THEN 'OBTN' WHEN OBJECTCODE='10000045' THEN 'OSRN' WHEN OBJECTCODE='10000062' THEN 'OIVK' WHEN OBJECTCODE='10000071' THEN 'OIQR' WHEN OBJECTCODE='10000073' THEN 'OFYM' WHEN OBJECTCODE='10000074' THEN 'OSEC' WHEN OBJECTCODE='10000075' THEN 'OCSN' WHEN OBJECTCODE='10000077' THEN 'ONOA' WHEN OBJECTCODE='10000196' THEN 'RTYP' WHEN OBJECTCODE='10000197' THEN 'OUGP' WHEN OBJECTCODE='10000199' THEN 'OUOM' WHEN OBJECTCODE='10000203' THEN 'OBFC' WHEN OBJECTCODE='10000204' THEN 'OBAT' WHEN OBJECTCODE='10000205' THEN 'OBSL' WHEN OBJECTCODE='10000206' THEN 'OBIN' WHEN OBJECTCODE='140000041' THEN 'ODNF' WHEN OBJECTCODE='231000000' THEN 'OUGR' WHEN OBJECTCODE='234000004' THEN 'OEGP' WHEN OBJECTCODE='243000001' THEN 'OGPC' WHEN OBJECTCODE='310000001' THEN 'OIQI' WHEN OBJECTCODE='310000008' THEN 'OBTW' WHEN OBJECTCODE='410000005' THEN 'OLLF' WHEN OBJECTCODE='480000001' THEN 'OHET' WHEN OBJECTCODE='540000005' THEN 'OTCX' WHEN OBJECTCODE='540000006' THEN 'OPQT' WHEN OBJECTCODE='540000040' THEN 'ORCP' WHEN OBJECTCODE='540000042' THEN 'OCCT' WHEN OBJECTCODE='540000048' THEN 'OACR' WHEN OBJECTCODE='540000056' THEN 'ONFM' WHEN OBJECTCODE='540000067' THEN 'OBFI' WHEN OBJECTCODE='540000068' THEN 'OBBI' WHEN OBJECTCODE='1210000000' THEN 'OCPT' WHEN OBJECTCODE='1250000001' THEN 'OWTQ' WHEN OBJECTCODE='1250000025' THEN 'OOAT' WHEN OBJECTCODE='1320000000' THEN 'OKPI' WHEN OBJECTCODE='1320000002' THEN 'OTGG' WHEN OBJECTCODE='1320000012' THEN 'OCPN' WHEN OBJECTCODE='1320000028' THEN 'OROC' WHEN OBJECTCODE='1320000039' THEN 'OPSC' WHEN OBJECTCODE='1470000000' THEN 'ODTP' WHEN OBJECTCODE='1470000002' THEN 'OADT' WHEN OBJECTCODE='1470000003' THEN 'ODPA' WHEN OBJECTCODE='1470000004' THEN 'ODPP' WHEN OBJECTCODE='1470000032' THEN 'OACS' WHEN OBJECTCODE='1470000046' THEN 'OAGS' WHEN OBJECTCODE='1470000048' THEN 'ODMC' WHEN OBJECTCODE='1470000049' THEN 'OACQ' WHEN OBJECTCODE='1470000057' THEN 'OGAR' WHEN OBJECTCODE='1470000060' THEN 'OACD' WHEN OBJECTCODE='1470000062' THEN 'OBCD' WHEN OBJECTCODE='1470000065' THEN 'OINC' WHEN OBJECTCODE='1470000077' THEN 'OEDG' WHEN OBJECTCODE='1470000092' THEN 'OCCS' WHEN OBJECTCODE='1470000113' THEN 'OPRQ' WHEN OBJECTCODE='1620000000' THEN 'OWLS'  ELSE  'ADDONS' END AS 'TABLE',     T0.[Series], T0.[SeriesName], T0.[InitialNum], T0.[NextNumber], T0.[LastNum],  T0.[LastNum]-T0.[InitialNum] as 'Total NOS', T0.[NextNumber]-T0.[InitialNum] as 'Used NOS',  T0.[LastNum]- T0.[NextNumber] as 'Balance NOS', T0.[Remark],T0.Locked,T0.[Indicator], T0.DocSubType, CASE  WHEN T0.OBJECTCODE='1250000025' AND T0.DocSubType ='S' THEN 'Specific' WHEN T0.OBJECTCODE='1250000025' AND T0.DocSubType ='G' THEN 'General' WHEN T0.OBJECTCODE='1250000025' AND T0.DocSubType ='C' THEN 'Sales Blk' WHEN T0.OBJECTCODE IN ('13','14','18','19') AND T0.DocSubType ='GA' THEN 'GST Tax Invoice' WHEN T0.OBJECTCODE IN ('13','14','18','19') AND T0.DocSubType ='GD' THEN 'GST Debit Memo' WHEN T0.OBJECTCODE IN ('13','14','18','19') AND T0.DocSubType ='--' THEN 'Bill of Supply' WHEN T0.ObjectCode='2' and T0.DocSubType ='C' THEN 'Customer' WHEN T0.ObjectCode='2' and T0.DocSubType ='S' THEN 'Vendor' END AS [Document Sub-Type]   FROM NNM1 T0  WHERE T0.[Indicator]=[%0]
SELECT s.Name AS SchemaName, t.Name AS TableName,T5.NAME, p.rows AS RowCounts, CAST(ROUND((SUM(a.used_pages) / 128.00), 2) AS NUMERIC(36, 2)) AS Used_MB, CAST(ROUND((SUM(a.total_pages) - SUM(a.used_pages)) / 128.00, 2) AS NUMERIC(36, 2)) AS Unused_MB, CAST(ROUND((SUM(a.total_pages) / 128.00), 2) AS NUMERIC(36, 2)) AS Total_MB FROM sys.tables t INNER JOIN sys.indexes i ON t.OBJECT_ID = i.object_id INNER JOIN sys.partitions p ON i.object_id = p.OBJECT_ID AND i.index_id = p.index_id INNER JOIN sys.allocation_units a ON p.partition_id = a.container_id INNER JOIN sys.schemas s ON t.schema_id = s.schema_id LEFT JOIN RTYP T5 ON T5.CODE=t.Name  GROUP BY t.Name, s.Name, p.Rows,T5.NAME ORDER BY s.Name, t.Name
SELECT ITEMCODE, ITEMNAME, ONHAND, MANBTCHNUM,MANSERNUM,ISSUEPRIBY, ISSUEMTHD FROM OITM  ---UPDATE OWOR SET [Status]='L'  where docentry in ---SELECT ITEMCODE, ITEMNAME,ManBtchNum,OnHand FROM OITM WHERE ManBtchNum='Y' and ItmsGrpCod=103 and OnHand>0 ---UPDATE NNM1 SET Locked ='Y' WHERE Indicator IN ('18-19','19-20','20-21','21-22','23-24') AND Locked ='N' ---UPDATE [@UTL_OQCHK] SET [U_UTL_AIEN]=123283 ,[U_UTL_AINO] =222355161 WHERE DOCNUM =22014816 ---UPDATE OITM SET ManBtchNum='Y' where onhand=0 ---UPDATE OPRQ SET U_PRLEVEL0='Y' where DocEntry=1015 ---UPDATE OUSR SET Locked='Y' WHERE USER_CODE IN ( ---UPDATE OITM SET frozenFor='Y' WHERE ITEMCODE IN ( --SELECT DISTINCT  T0.DOCENTRY,T0.[DocNum] as 'QC No',T0.[CreateDate],[U_UTL_ITCD] as 'Item Code', [U_UTL_ITNM] as 'Item Name', --[U_UTL_MODE] as 'Base Type',T0.[U_UTL_RCQT] as 'Receipt Qty',[U_UTL_APPQ] as 'Approved Qty', --ISNULL(T0.[U_UTL_APPW], T0.U_UTL_REJW) as 'ToWhs',[U_UTL_REJQ] as 'Rej Qty',T0.[U_UTL_AIEN] AS 'Tfr Entry', --T0.[U_UTL_AINO] as 'Tfr Num' FROM [dbo].[@UTL_OQCHK] T0 --WHERE  T0.U_UTL_MODE = 'GRPO' AND T0.DOCNUM=232401359  --AND T0.[U_UTL_APPW] IS NULL   --UPDATE PRQ1 SET OpenCreQty=6096 ,OpenQty=6096,LineStatus='O'  WHERE DOCENTRY=1062 AND LineNum=2 -----AND T0.DOCNUM =232401690  ----SELECT *  FROM [dbo].[@UTL_QCHK1] WHERE DOCENTRY>78245 ----UPDATE [@UTL_OQCHK] SET T0.[U_UTL_APPW]='MST' WHERE DOCENTRY=78207  --SELECT TOP 1 T0.DocEntry,T1.DocNum,T0.DocDate,T0.ITEMCODE, T0.DSCRIPTION, T0.Quantity, T0.WhsCode,T0.FromWhsCod FROM WTR1 T0 --INNER JOIN OWTR T1 ON T1.DOCENTRY=T0.DOCENTRY WHERE T0.FromWhsCod = 'IQC' AND T0.ITEMCODE='32502090001' --ORDER BY T0.DocDate DESC   ----UPDATE [@UTL_OQCHK] SET [U_UTL_AIEN]='125680' ,[U_UTL_AINO] ='232411750' WHERE DOCNUM =232401359
SELECT T0.Number AS 'PO No', T0.SignDate as 'PO Date', '' as 'AmdNo', '' as 'EftDt',  T0.BpCode AS 'BPCODE', T0.BpName AS 'VendorName', T2.Building AS 'VendorBuild',  T2.ZipCode AS 'VendZp',T2.State as 'VendSt', t2.Country as 'VendCtry',  T2.GSTRegnNo as 'VendGstNo', T0.bpcurr AS 'CURRENCY', T1.ItemName AS 'ItemName', T1.ItemCode as 'ItemCode', T4.Dscription as 'HSNNo',  T1.InvntryUom as 'UoM',t3.buyunitmsr, 'OPEN' as 'Quantity',  T1.UnitPrice as 'Price', T0.AbsID, t5. Fax as 'CrtdBy', 'Rashid Khan' as 'ChekdBy',  'Extra As Applicable' as 'Tax', T6.PymntGroup as 'PaymentTerms',  T0.Remarks as 'Remarks', 'AT OUR SITE ONLY' as 'Insption', '' as 'PkgFwd',  CASE WHEN T2.State = 'RJ' THEN CONVERT(NUMERIC(10,2), T3.U_RATE)/2 ELSE 0 END AS 'CSGST',  CASE WHEN T2.State != 'RJ' THEN CONVERT(NUMERIC(10,2), T3.U_RATE) ELSE 0 END AS 'IGST',  T0.UserSign AS CreaterId, T5.FAX AS CreatorName,WD1.UserID AS ApprvalLevelId,  ISNULL(UA.Fax,'') AS ApprovedLevelName,   T0.UserSign2 AS AppId,ISNULL(UAF.FAX,'') AS ApprovedNAme, T0.ObjType ,t0.U_LEVEL1 as Checkdby , t0.U_LEVEL2 as Approvedby     FROM OOAT T0 INNER JOIN OAT1 T1 ON T0.AbsID = T1.AgrNo LEFT JOIN CRD1 T2 ON T2.CardCode = T0.BpCode AND T2.AdresType = 'S'  INNER JOIN OCRD T9 ON T9.CardCode=T2.CardCode AND T9.ShipToDef=T2.Address Left Join OITM t3 on T3.ItemCode = T1.ItemCode Left Join OCHP T4 on T4.AbsEntry = T3.ChapterID LEFT JOIN OUSR T5 ON T0.UserSign = t5.USERID LEFT JOIN OCTG T6 ON T6.GroupNum = T0.GroupNum LEFT JOIN OSHP T7 ON T7.TrnspCode = T0.TrnspCode LEFT JOIN  OWDD WD ON WD.DraftEntry = T0.AbsID  AND WD.OwnerID = T0.UserSign  AND WD.ObjType='1250000027'  AND WD.Status !='Y' LEFT JOIN WDD1 WD1 ON WD1.WddCode =WD.WddCode AND WD1.UserSign =WD.OwnerID AND WD1.Status ='Y' LEFT JOIN OUSR UA ON UA.USERID = WD1.UserID LEFT JOIN WDD1 WD11 ON WD11.WddCode =WD.WddCode AND WD11.StepCode =WD.CurrStep   AND WD11.Status ='Y' LEFT JOIN OUSR UAF ON UAF.USERID =  WD11.UserID   where T0.BpName=[%0] and  t1.LineStatus <> 'c'
SELECT T0.TransId,T0.RefDate,T0.Account,T1.AcctName,T0.Debit,T0.Credit, T0.ContraAct, T2.CardName,     CASE    WHEN T0.TransType = 13 THEN 'A/R Invoice'    WHEN T0.TransType = 13 THEN  'A/R Invoice'   WHEN T0.TransType = 14 THEN  'A/R Credit Memo'   WHEN T0.TransType = 15 THEN  'Delivery'   WHEN T0.TransType = 18 THEN  'A/P Invoice'   WHEN T0.TransType = 19 THEN  'A/P Credit Memo'   WHEN T0.TransType = 20 THEN  'Goods Receipt PO'   WHEN T0.TransType = 21 THEN  'Goods Return'   WHEN T0.TransType = 24 THEN  'Incoming Payment'   WHEN T0.TransType = 30 THEN  'Journal Entry'   WHEN T0.TransType = 46 THEN  'Outgoing Payments'   WHEN T0.TransType = 57 THEN  'Checks for Payment'   WHEN T0.TransType = 59 THEN  'Goods Receipt'   WHEN T0.TransType = 60 THEN  'Goods Issue'   WHEN T0.TransType = 67 THEN  'Inventory Transfer'   WHEN T0.TransType = 162 THEN  'Inventory Revaluation'   WHEN T0.TransType = 321 THEN  'Internal Reconciliation'  END AS 'Trans Type',   T0.BaseRef, T0.REF1, T0.REF2, T3.U_NAME as 'Created By', ---T0.IntrnMatch, T0.ExtrMatch,T0.MthDate AS 'Reco Date', T1.CurrTotal  from JDT1 T0  LEFT JOIN OACT T1 ON T1.AcctCode = T0.Account  LEFT JOIN OCRD T2 ON T2.CardCode = T0.ContraAct  LEFT JOIN OUSR T3 ON T3.USERID = T0.UserSign   WHERE T1.AcctName = [%0]  AND T0.RefDate>=[%1]     AND T0.RefDate<=[%2]  ---AND T0.ExtrMatch=0
SELECT T0.DocEntry, T0.DocNum,T0.ObjType, T0.DocDate, T0.JrnlMemo, T0.U_JVCD, T0.U_JVNM, T0.U_JBNO,T1.ItemCode, T1.Dscription,T1.Quantity,T1.WhsCode, T0.Comments, T1.BaseRef, T3.DocNum FROM OIGN T0  INNER JOIN IGN1 T1 ON T1.DocEntry=T0.DocEntry LEFT JOIN WOR1 T2 ON T2.DocEntry=T0.BaseEntry LEFT JOIN OWOR T3 ON T3.DocEntry = T2.DocEntry WHERE T0.DOCDATE>='20220401'
SELECT T0.DocEntry, T0.DocNum,T0.ObjType, T0.DocDate, T0.JrnlMemo, T0.U_JVCD, T0.U_JVNM, T0.U_JBNO,T1.ItemCode, T1.Dscription,T1.Quantity,T1.WhsCode, T0.Comments, T1.BaseRef, T3.DocNum FROM OIGE T0  INNER JOIN IGE1 T1 ON T1.DocEntry=T0.DocEntry LEFT JOIN WOR1 T2 ON T2.DocEntry=T0.BaseEntry LEFT JOIN OWOR T3 ON T3.DocEntry = T2.DocEntry WHERE T0.DOCDATE>='20220401'
SELECT T0.ItemCode,T1.ItemName,T2.ItmsGrpNam ,T0.WhsCode, T0.OnHand,T0.AvgPrice, T0.StockValue FROM OITW T0 INNER JOIN OITM T1 ON T1.ItemCode=T0.ItemCode LEFT JOIN OITB T2 ON T2.ItmsGrpCod=T1.ItmsGrpCod WHERE T0.ONHAND>0 AND T0.AvgPrice<=0
SELECT  DISTINCT T0.DocEntry,T0.[DocDate], T6.SeriesName,T0.[DocNum] AS 'AP Credit no',T1.[BaseRef], T0.RevRefNo  AS 'Original Ref No'        ,T0.RevRefDate AS 'Ref Date',T0.[NumAtCard] as 'Bill No.'                ,CASE WHEN T0.[DocType] = 'S' THEN 'SERVICE'  ELSE 'ITEM' END  AS 'Document type'        ,CASE WHEN T0.GSTTranTyp = '--' THEN 'Bill of Supply'        ELSE 'GST Transaction' END AS 'GST Transaction Type'        ,CASE WHEN T10.Name LIKE '%Reverse%' THEN 'YES'  ELSE 'NO' END AS 'Is Reverse Charge Applicable'        ,T0.[CardCode] ,T0.[CardName],T8.[BpGSTN] AS 'GST No',T8.[CityB] as 'City',AB.name AS 'State Name'        ,T0.ShipToCode AS 'Ship From'         ,T1.[ItemCode],T1.[Dscription] ,T1.[WhsCode] ,ISNULL (T5.ServCode ,T4.[ChapterID] ) AS 'HSN/SAC Code'        ,T1.[Quantity] , T1.[Price] 'Unit Price', T1.[TaxCode], T10.Name AS 'Tax Code Name',     T10.Rate as'GST Rate',      CASE WHEN T1.Taxcode LIKE '%IG%' THEN ((T10.Rate*T1.LineTotal)/100) ELSE '0' END AS 'IGST',      CASE WHEN T1.TaxCode LIKE '%SG%' OR T1.TaxCode LIKE '%S+%' THEN ((T12.Rate*T1.LineTotal)/100) ELSE '0' END AS 'SGST',      CASE WHEN T1.TaxCode LIKE '%SG%' OR T1.TaxCode LIKE '%S+%' THEN ((T12.Rate*T1.LineTotal)/100) ELSE '0' END AS 'CGST',      ((T1.LineTotal * T10.Rate)/100) AS 'Taxable Value', CASE WHEN T1.WtLiable = 'Y' THEN '10' ELSE '0' END AS 'TDS Rate',      T0.WTSum AS 'TDS Amount', T1.[LineTotal], T1.[AcctCode], T2.[AcctName],T9.U_Name AS 'SAP USername'     ,T0.[Comments]  FROM ORPC T0 LEFT JOIN RPC1 T1 ON T0.DocEntry = T1.DocEntry LEFT JOIN OACT T2 ON T1.[AcctCode] = T2.[AcctCode] LEFT JOIN OITM T3 ON T1.[ItemCode] = T3.[ItemCode] LEFT JOIN OCHP T4 ON T1.[HsnEntry] = T4.[AbsEntry] LEFT JOIN OSAC T5 ON T1.SacEntry = T5.AbsEntry LEFT JOIN NNM1 T6 ON T0.Series = T6.Series LEFT JOIN RPC12 T8 ON T0.DocEntry = T8.DocEntry LEFT JOIN OUSR T9 ON T0.[UserSign] = T9.[USERID] LEFT JOIN OSTC T10 ON T1.Taxcode = T10.Code LEFT JOIN STC1 T11 ON T10.[Code] = T11.[STCCode] LEFT JOIN OSTA T12 ON T11.[STACode] = T12.[Code] LEFT JOIN OCST AB ON T8.[StateB] = AB.Code AND T8.CountryB = AB.Country LEFT JOIN OCST A ON T8.[LocStatCod] = A.Code AND T8.CountryB = A.Country LEFT JOIN OCHP T41 ON T3.[ChapterID] = T41.[AbsEntry] LEFT JOIN OSAC T51 ON T3.[SACEntry] = T51.[ServCode]   WHERE T0.[DocDate] >=[%0] AND T0.[DocDate] <= [%1] AND T0.Canceled = 'N' ORDER BY T0.DocDate, T0.DocNum
--UPDATE OPOR SET U_LEVEL1='N' where DocEntry=4909 --UPDATE OPRQ SET U_PRLEVEL0='Y' where DocEntry=
SELECT T0.[DocDate], T0.[ItemCode], T0.[Dscription],  CASE  WHEN T0.TransType='1' THEN 'G/L Accounts' WHEN T0.TransType='2' THEN 'Business Partner' WHEN T0.TransType='3' THEN 'Bank Codes' WHEN T0.TransType='4' THEN 'Items' WHEN T0.TransType='5' THEN 'Tax Definition' WHEN T0.TransType='6' THEN 'Price Lists' WHEN T0.TransType='7' THEN 'Special Prices' WHEN T0.TransType='8' THEN 'Item Properties' WHEN T0.TransType='9' THEN 'Rate Differences' WHEN T0.TransType='10' THEN 'Card Groups' WHEN T0.TransType='11' THEN 'Contact Persons' WHEN T0.TransType='12' THEN 'Users' WHEN T0.TransType='13' THEN 'A/R Invoice' WHEN T0.TransType='14' THEN 'A/R Credit Memo' WHEN T0.TransType='15' THEN 'Delivery' WHEN T0.TransType='16' THEN 'Returns' WHEN T0.TransType='17' THEN 'Sales Order' WHEN T0.TransType='18' THEN 'A/P Invoice' WHEN T0.TransType='19' THEN 'A/P Credit Memo' WHEN T0.TransType='20' THEN 'Goods Receipt PO' WHEN T0.TransType='21' THEN 'Goods Return' WHEN T0.TransType='22' THEN 'Purchase Order' WHEN T0.TransType='23' THEN 'Sales Quotation' WHEN T0.TransType='24' THEN 'Incoming Payment' WHEN T0.TransType='25' THEN 'Deposit' WHEN T0.TransType='26' THEN 'Reconciliation History' WHEN T0.TransType='27' THEN 'Check Register' WHEN T0.TransType='28' THEN 'Journal Voucher Entry' WHEN T0.TransType='29' THEN 'Journal Vouchers List' WHEN T0.TransType='30' THEN 'Journal Entry' WHEN T0.TransType='31' THEN 'Items – Warehouse' WHEN T0.TransType='32' THEN 'Print Preferences' WHEN T0.TransType='33' THEN 'Activities' WHEN T0.TransType='34' THEN 'Recurring Postings' WHEN T0.TransType='35' THEN 'Document Numbering' WHEN T0.TransType='36' THEN 'Credit Cards' WHEN T0.TransType='37' THEN 'Currency Codes' WHEN T0.TransType='38' THEN 'CPI Codes' WHEN T0.TransType='39' THEN 'Administration' WHEN T0.TransType='40' THEN 'Payment Terms' WHEN T0.TransType='41' THEN 'Preferences' WHEN T0.TransType='42' THEN 'External Bank Statement Received' WHEN T0.TransType='43' THEN 'Manufacturers' WHEN T0.TransType='44' THEN 'Card Properties' WHEN T0.TransType='45' THEN 'Journal Entry Codes' WHEN T0.TransType='46' THEN 'Outgoing Payments' WHEN T0.TransType='47' THEN 'Serial Numbers' WHEN T0.TransType='48' THEN 'Loading Expenses' WHEN T0.TransType='49' THEN 'Delivery Types' WHEN T0.TransType='50' THEN 'Length Units' WHEN T0.TransType='51' THEN 'Weight Units' WHEN T0.TransType='52' THEN 'Item Groups' WHEN T0.TransType='53' THEN 'Sales Employee' WHEN T0.TransType='54' THEN 'Report – Selection Criteria' WHEN T0.TransType='55' THEN 'Posting Templates' WHEN T0.TransType='56' THEN 'Customs Groups' WHEN T0.TransType='57' THEN 'Checks for Payment' WHEN T0.TransType='58' THEN 'Whse Journal' WHEN T0.TransType='59' THEN 'Goods Receipt' WHEN T0.TransType='60' THEN 'Goods Issue' WHEN T0.TransType='61' THEN 'Cost Center' WHEN T0.TransType='62' THEN 'Cost Rate' WHEN T0.TransType='63' THEN 'Project Codes' WHEN T0.TransType='64' THEN 'Warehouses' WHEN T0.TransType='65' THEN 'Commission Groups' WHEN T0.TransType='66' THEN 'Product Tree' WHEN T0.TransType='67' THEN 'Inventory Transfer' WHEN T0.TransType='68' THEN 'Production Instructions' WHEN T0.TransType='69' THEN 'Landed Costs' WHEN T0.TransType='70' THEN 'Payment Methods' WHEN T0.TransType='71' THEN 'Credit Card Payment' WHEN T0.TransType='72' THEN 'Credit Card Management' WHEN T0.TransType='73' THEN 'Customer/Vendor Cat. No.' WHEN T0.TransType='74' THEN 'Credit Payments' WHEN T0.TransType='75' THEN 'CPI and FC Rates' WHEN T0.TransType='76' THEN 'Postdated Deposit' WHEN T0.TransType='77' THEN 'Budget' WHEN T0.TransType='78' THEN 'Budget Cost Assess. Mthd' WHEN T0.TransType='79' THEN 'Retail Chains' WHEN T0.TransType='80' THEN 'Alerts Template' WHEN T0.TransType='81' THEN 'Alerts' WHEN T0.TransType='82' THEN 'Received Alerts' WHEN T0.TransType='83' THEN 'Message Sent' WHEN T0.TransType='84' THEN 'Activity Subjects' WHEN T0.TransType='85' THEN 'Special Prices for Groups' WHEN T0.TransType='86' THEN 'Application Start' WHEN T0.TransType='87' THEN 'Distribution List' WHEN T0.TransType='88' THEN 'Shipping Types' WHEN T0.TransType='89' THEN 'Outgoing' WHEN T0.TransType='90' THEN 'Transition' WHEN T0.TransType='91' THEN 'Budget Scenario' WHEN T0.TransType='92' THEN 'Interest Prices' WHEN T0.TransType='93' THEN 'User Defaults' WHEN T0.TransType='94' THEN 'Serial Numbers for Items' WHEN T0.TransType='95' THEN 'Financial Report Templates' WHEN T0.TransType='96' THEN 'Financial Report Categories' WHEN T0.TransType='97' THEN 'Opportunity' WHEN T0.TransType='98' THEN 'Interest' WHEN T0.TransType='99' THEN 'Interest Level' WHEN T0.TransType='100' THEN 'Information Source' WHEN T0.TransType='101' THEN 'Opportunity Stage' WHEN T0.TransType='102' THEN 'Defect Cause' WHEN T0.TransType='103' THEN 'Activity Types' WHEN T0.TransType='104' THEN 'Meetings Location' WHEN T0.TransType='105' THEN 'Service Calls' WHEN T0.TransType='106' THEN 'Batch No. for Item' WHEN T0.TransType='107' THEN 'Alternative Items 2' WHEN T0.TransType='108' THEN 'Partners' WHEN T0.TransType='109' THEN 'Competitors' WHEN T0.TransType='110' THEN 'User Validations' WHEN T0.TransType='111' THEN 'Posting Period' WHEN T0.TransType='112' THEN 'Drafts' WHEN T0.TransType='113' THEN 'Batches and Serial Numbers' WHEN T0.TransType='114' THEN 'User Display Cat.' WHEN T0.TransType='115' THEN 'Lender – Pelecard' WHEN T0.TransType='116' THEN 'Withholding Tax Deduction Hierarchy' WHEN T0.TransType='117' THEN 'Withholding Tax Deduction Groups' WHEN T0.TransType='118' THEN 'Branches' WHEN T0.TransType='119' THEN 'Departments' WHEN T0.TransType='120' THEN 'Confirmation Level' WHEN T0.TransType='121' THEN 'Approval Templates' WHEN T0.TransType='122' THEN 'Docs. for Confirmation' WHEN T0.TransType='123' THEN 'Checks for Payment Drafts' WHEN T0.TransType='124' THEN 'Company Info' WHEN T0.TransType='125' THEN 'Freight Setup' WHEN T0.TransType='126' THEN 'Sales Tax Authorities' WHEN T0.TransType='127' THEN 'Sales Tax Authorities Type' WHEN T0.TransType='128' THEN 'Sales Tax Codes' WHEN T0.TransType='129' THEN 'Countries' WHEN T0.TransType='130' THEN 'States' WHEN T0.TransType='131' THEN 'Address Formats' WHEN T0.TransType='132' THEN 'A/R Correction Invoice' WHEN T0.TransType='133' THEN 'Cash Discount' WHEN T0.TransType='134' THEN 'Query Catagories' WHEN T0.TransType='135' THEN 'Triangular Deal' WHEN T0.TransType='136' THEN 'Data Migration' WHEN T0.TransType='137' THEN 'Workstation ID' WHEN T0.TransType='138' THEN 'Indicator' WHEN T0.TransType='139' THEN 'Goods Shipment' WHEN T0.TransType='140' THEN 'Payment Draft' WHEN T0.TransType='141' THEN 'Query Wizard' WHEN T0.TransType='142' THEN 'Account Segmentation' WHEN T0.TransType='143' THEN 'Account Segmentation Categories' WHEN T0.TransType='144' THEN 'Location' WHEN T0.TransType='145' THEN '1099 Forms' WHEN T0.TransType='146' THEN 'Cycle' WHEN T0.TransType='147' THEN 'Payment Methods for Payment Wizard' WHEN T0.TransType='148' THEN '1099 Opening Balance' WHEN T0.TransType='149' THEN 'Dunning Interest Rate' WHEN T0.TransType='150' THEN 'BP Priorities' WHEN T0.TransType='151' THEN 'Dunning Letters' WHEN T0.TransType='152' THEN 'User Fields – Description' WHEN T0.TransType='153' THEN 'User Tables' WHEN T0.TransType='154' THEN 'My Menu Items' WHEN T0.TransType='155' THEN 'Payment Run' WHEN T0.TransType='156' THEN 'Pick List' WHEN T0.TransType='157' THEN 'Payment Wizard' WHEN T0.TransType='158' THEN 'Payment Results Table' WHEN T0.TransType='159' THEN 'Payment Block' WHEN T0.TransType='160' THEN 'Queries' WHEN T0.TransType='161' THEN 'Central Bank Ind.' WHEN T0.TransType='162' THEN 'Inventory Revaluation' WHEN T0.TransType='163' THEN 'A/P Correction Invoice' WHEN T0.TransType='164' THEN 'A/P Correction Invoice Reversal' WHEN T0.TransType='165' THEN 'A/R Correction Invoice' WHEN T0.TransType='166' THEN 'A/R Correction Invoice Reversal' WHEN T0.TransType='167' THEN 'Service Call Statuses' WHEN T0.TransType='168' THEN 'Service Call Types' WHEN T0.TransType='169' THEN 'Service Call Problem Types' WHEN T0.TransType='170' THEN 'Contract Template' WHEN T0.TransType='171' THEN 'Employees' WHEN T0.TransType='172' THEN 'Employee Types' WHEN T0.TransType='173' THEN 'Employee Status' WHEN T0.TransType='174' THEN 'Termination Reason' WHEN T0.TransType='175' THEN 'Education Types' WHEN T0.TransType='176' THEN 'Customer Equipment Card' WHEN T0.TransType='177' THEN 'Agent Name' WHEN T0.TransType='178' THEN 'Withholding Tax' WHEN T0.TransType='179' THEN 'Already Displayed 347, 349 and WTax Reports' WHEN T0.TransType='180' THEN 'Tax Report' WHEN T0.TransType='181' THEN 'Bill of Exchange for Payment' WHEN T0.TransType='182' THEN 'Bill Of Exchang Transaction' WHEN T0.TransType='183' THEN 'File Format' WHEN T0.TransType='184' THEN 'Period Indicator' WHEN T0.TransType='185' THEN 'Doubtful Debts' WHEN T0.TransType='186' THEN 'Holiday Table' WHEN T0.TransType='187' THEN 'BP – Bank Account' WHEN T0.TransType='188' THEN 'Service Call Solution Statuses' WHEN T0.TransType='189' THEN 'Service Call Solutions' WHEN T0.TransType='190' THEN 'Service Contracts' WHEN T0.TransType='191' THEN 'Service Calls' WHEN T0.TransType='192' THEN 'Service Call Origins' WHEN T0.TransType='193' THEN 'User Key Description' WHEN T0.TransType='194' THEN 'Queue' WHEN T0.TransType='195' THEN 'Inflation Wizard' WHEN T0.TransType='196' THEN 'Dunning Terms' WHEN T0.TransType='197' THEN 'Dunning Wizard' WHEN T0.TransType='198' THEN 'Sales Forecast' WHEN T0.TransType='199' THEN 'MRP Scenarios' WHEN T0.TransType='200' THEN 'Territories' WHEN T0.TransType='201' THEN 'Industries' WHEN T0.TransType='202' THEN 'Production Order' WHEN T0.TransType='203' THEN 'A/R Down Payment' WHEN T0.TransType='204' THEN 'A/P Down Payment' WHEN T0.TransType='205' THEN 'Package Types' WHEN T0.TransType='206' THEN 'User-Defined Object' WHEN T0.TransType='207' THEN 'Data Ownership – Objects' WHEN T0.TransType='208' THEN 'Data Ownership – Exceptions' WHEN T0.TransType='209' THEN '' WHEN T0.TransType='210' THEN 'Employee Position' WHEN T0.TransType='211' THEN 'Employee Teams' WHEN T0.TransType='212' THEN 'Relationships' WHEN T0.TransType='213' THEN 'Recommendation Data' WHEN T0.TransType='214' THEN 'User Autorization Tree' WHEN T0.TransType='215' THEN 'Predefined Text' WHEN T0.TransType='216' THEN 'Box Definition' WHEN T0.TransType='217' THEN 'Activity Status' WHEN T0.TransType='218' THEN '312' WHEN T0.TransType='219' THEN 'User-Defined Values' WHEN T0.TransType='220' THEN 'Periods Category' WHEN T0.TransType='221' THEN 'Attachments' WHEN T0.TransType='222' THEN 'Grid Filter' WHEN T0.TransType='223' THEN 'User Language Table' WHEN T0.TransType='224' THEN 'Multi-Language Translation' WHEN T0.TransType='225' THEN '' WHEN T0.TransType='226' THEN '' WHEN T0.TransType='227' THEN '' WHEN T0.TransType='229' THEN 'Dynamic Interface (Strings)' WHEN T0.TransType='230' THEN 'Saved Reconciliations' WHEN T0.TransType='231' THEN 'House Bank Accounts' WHEN T0.TransType='232' THEN 'Document' WHEN T0.TransType='233' THEN 'Document Generation Parameter Sets' WHEN T0.TransType='234' THEN '#740' WHEN T0.TransType='238' THEN 'Account Category' WHEN T0.TransType='239' THEN 'Bank Charges Allocation Codes' WHEN T0.TransType='241' THEN 'Cash Flow Transactions – Rows' WHEN T0.TransType='242' THEN 'Cash Flow Line Item' WHEN T0.TransType='247' THEN 'Business Place' WHEN T0.TransType='250' THEN 'Local Era Calendar' WHEN T0.TransType='251' THEN 'Cost Accounting Dimension' WHEN T0.TransType='254' THEN 'Service Code Table' WHEN T0.TransType='255' THEN 'Service Group for Brazil' WHEN T0.TransType='256' THEN 'Material Group' WHEN T0.TransType='257' THEN 'NCM Code' WHEN T0.TransType='258' THEN 'CFOP for Nota Fiscal' WHEN T0.TransType='259' THEN 'CST Code for Nota Fiscal' WHEN T0.TransType='260' THEN 'Usage of Nota Fiscal' WHEN T0.TransType='261' THEN 'Closing Date Procedure' WHEN T0.TransType='263' THEN 'Nota Fiscal Numbering' WHEN T0.TransType='264' THEN 'Nota Fiscal Tax Category (Brazil)' WHEN T0.TransType='265' THEN 'Counties' WHEN T0.TransType='266' THEN 'Tax Code Determination' WHEN T0.TransType='267' THEN 'BoE Document Type' WHEN T0.TransType='268' THEN 'BoE Portfolio' WHEN T0.TransType='269' THEN 'BoE Instruction' WHEN T0.TransType='271' THEN 'Tax Parameter' WHEN T0.TransType='275' THEN 'Tax Type Combination' WHEN T0.TransType='276' THEN 'Tax Formula Master Table' WHEN T0.TransType='278' THEN 'CNAE Code' WHEN T0.TransType='280' THEN 'Sales Tax Invoice' WHEN T0.TransType='281' THEN 'Purchase Tax Invoice' WHEN T0.TransType='283' THEN 'Cargo Customs Declaration Numbers' WHEN T0.TransType='290' THEN 'Resources' WHEN T0.TransType='291' THEN 'Resource Properties' WHEN T0.TransType='292' THEN 'ResGrpCod' WHEN T0.TransType='300' THEN 'RecordSet' WHEN T0.TransType='305' THEN 'Bridge' WHEN T0.TransType='321' THEN 'Internal Reconciliation' WHEN T0.TransType='541' THEN 'POS Master Data' WHEN T0.TransType='1179' THEN 'Stock Transfer Draft' WHEN T0.TransType='10000105' THEN 'Messaging Service Settings' WHEN T0.TransType='10000044' THEN 'Batch Numbers Master Data' WHEN T0.TransType='10000045' THEN 'Serial Numbers Master Data' WHEN T0.TransType='10000062' THEN 'IVL Vs OINM Keys' WHEN T0.TransType='10000071' THEN 'Inventory Posting' WHEN T0.TransType='10000073' THEN 'Financial Year Master' WHEN T0.TransType='10000074' THEN 'Sections' WHEN T0.TransType='10000075' THEN 'Certificate Series' WHEN T0.TransType='10000077' THEN 'Nature of Assessee' WHEN T0.TransType='10000196' THEN 'Document Type List' WHEN T0.TransType='10000197' THEN 'UoM Group' WHEN T0.TransType='10000199' THEN 'UoM Master Data' WHEN T0.TransType='10000203' THEN 'Bin Field Configuration' WHEN T0.TransType='10000204' THEN 'Bin Location Attribute' WHEN T0.TransType='10000205' THEN 'Warehouse Sublevel' WHEN T0.TransType='10000206' THEN 'Bin Location' WHEN T0.TransType='140000041' THEN 'DNF Code' WHEN T0.TransType='231000000' THEN 'Authorization Group' WHEN T0.TransType='234000004' THEN 'E-Mail Group' WHEN T0.TransType='243000001' THEN 'Government Payment Code' WHEN T0.TransType='310000001' THEN 'Inventory Opening Balance' WHEN T0.TransType='310000008' THEN 'Batch Attributes in Location' WHEN T0.TransType='410000005' THEN 'Legal List Format' WHEN T0.TransType='480000001' THEN 'Object: HR Employee Transfer' WHEN T0.TransType='540000005' THEN 'Tax Code Determination' WHEN T0.TransType='540000006' THEN 'Purchase Quotation' WHEN T0.TransType='540000040' THEN 'Recurring Transaction Template' WHEN T0.TransType='540000042' THEN 'Cost Center Type' WHEN T0.TransType='540000048' THEN 'Accrual Type' WHEN T0.TransType='540000056' THEN 'Nota Fiscal Model' WHEN T0.TransType='540000067' THEN 'Brazil Fuel Indexer' WHEN T0.TransType='540000068' THEN 'Brazil Beverage Indexer' WHEN T0.TransType='1210000000' THEN 'Cockpit Main Table' WHEN T0.TransType='1250000001' THEN 'Inventory Transfer Request' WHEN T0.TransType='1250000025' THEN 'Blanket Agreement' WHEN T0.TransType='1320000000' THEN 'Key Performance Indicator Package' WHEN T0.TransType='1320000002' THEN 'Target Group' WHEN T0.TransType='1320000012' THEN 'Campaign' WHEN T0.TransType='1320000028' THEN 'Retorno Operation Codes' WHEN T0.TransType='1320000039' THEN 'Product Source Code' WHEN T0.TransType='1470000000' THEN 'Fixed Assets Depreciation Types' WHEN T0.TransType='1470000002' THEN 'Fixed Assets Account Determination' WHEN T0.TransType='1470000003' THEN 'Fixed Asset Depreciation Areas' WHEN T0.TransType='1470000004' THEN 'Depreciation Type Pools' WHEN T0.TransType='1470000032' THEN 'Asset Classes' WHEN T0.TransType='1470000046' THEN 'Asset Groups' WHEN T0.TransType='1470000048' THEN 'G/L Account Determination Criteria – Inventory' WHEN T0.TransType='1470000049' THEN 'Capitalization' WHEN T0.TransType='1470000057' THEN 'G/L Account Advanced Rules' WHEN T0.TransType='1470000060' THEN 'Credit Memo' WHEN T0.TransType='1470000062' THEN 'Bar Code Master Data' WHEN T0.TransType='1470000065' THEN 'Inventory Counting' WHEN T0.TransType='1470000077' THEN 'Discount Groups' WHEN T0.TransType='1470000092' THEN 'Cycle Count Determination' WHEN T0.TransType='1470000113' THEN 'Purchase Request' WHEN T0.TransType='1620000000' THEN 'Workflow – Task Details'  ELSE 'Addons'  END AS 'Document Type',T0.[BASE_REF], CONVERT (varchar,T0.DocDate+365,112) as [ExpDate], CONVERT (varchar,T0.DocDate,112) as [MnfDate] ,CONVERT (varchar,T0.DocDate,112) as [InDate] ,  T0.[InQty],  SUM (T0.InQty) OVER (partition BY T0.ItemCode order by t0.transnum desc) AS RunningTotal, T0.[OutQty], T0.[Price], T0.[Currency], T0.[CardCode], T0.[CardName], T0.[Warehouse], T0.[TransNum], T0.[TransType],   T0.[CreatedBy], T0.[DocLineNum] FROM OINM T0  WHERE T0.[ItemCode] =[%0] AND T0.TransType NOT IN ('67','10000071', '13','14','15','202','60','18','19') order by T0.[DocDate] desc
SELECT DISTINCT T0.DOCENTRY,T0.DocNum,T0.CreateDate, T0.ItemCode, T0.CmpltQty as 'Total Prod', T1.ItemCode, T1.PlannedQty,  T1.IssuedQty , MAX (T1.Linenum) OVER (PARTITION BY T1.DocEntry, T0.ItemCode)+1 AS 'Prod Entry Items', MAX (T2.ChildNum) OVER (PARTITION BY T2.FATHER,T2.CODE )+1 AS 'BOM Items Count' , MAX (T1.Linenum) OVER (PARTITION BY T1.DocEntry) - MAX (T2.ChildNum) OVER (PARTITION BY T2.FATHER) AS 'Diff' FROM OWOR T0 INNER JOIN WOR1 T1 ON T1.DocEntry = T0.DocEntry INNER JOIN (SELECT DISTINCT FATHER,CODE ,ChildNum, Quantity from ITT1) T2 ON T2.Father = T0.ItemCode WHERE T0.CreateDate >='20230401' and T0.Type ='S'
SELECT Distinct OPOR.DocEntry, DocNum, OPOR.DocDate,OPOR.ObjType, CardCode, CardName, Itemcode,Dscription,Quantity as 'ORDER QTY',OpenQty as 'OPEN QTY' , OPOR.DocStatus FROM POR1  INNER JOIN OPOR ON OPOR.DocEntry = POR1.DocEntry WHERE LineStatus='O' AND WhsCode IN ( '1','ASM1','ASM2','DWH1','FGW1','HLD1','IPQC','IQC1','JKW10','JKW11','JKW12','JKW13','JKW14','JKW44','JKW9', 'JWK','JWK1','JWK15','JWK16','JWK17','JWK18','JWK19','JWK2','JWK20','JWK21','JWK22','JWK23','JWK24','JWK25', 'JWK26','JWK27','JWK28','JWK29','JWK3','JWK30','JWK31','JWK32','JWK33','JWK34','JWK35','JWK36','JWK37','JWK38', 'JWK39','JWK40','JWK41','JWK42','JWK43','JWK44','JWK45','JWK47','jwk48','JWK49','JWK5','JWK50','JWK6','JWK7','JWK8', 'JWWH','MST1','MST2','MST3','PKG1','PTS1','R&D','REJ1','RWK1','SCP1','SRT1','WLD1','WLD2')  UNION ALL  SELECT Distinct ORDR.DocEntry, DocNum, ORDR.DocDate,ORDR.ObjType,CardCode, CardName, Itemcode,Dscription,Quantity as 'ORDER QTY',OpenQty as 'OPEN QTY' , ORDR.DocStatus FROM RDR1  INNER JOIN ORDR ON ORDR.DocEntry = RDR1.DocEntry WHERE LineStatus='O' AND WhsCode IN ( '1','ASM1','ASM2','DWH1','FGW1','HLD1','IPQC','IQC1','JKW10','JKW11','JKW12','JKW13','JKW14','JKW44','JKW9', 'JWK','JWK1','JWK15','JWK16','JWK17','JWK18','JWK19','JWK2','JWK20','JWK21','JWK22','JWK23','JWK24','JWK25', 'JWK26','JWK27','JWK28','JWK29','JWK3','JWK30','JWK31','JWK32','JWK33','JWK34','JWK35','JWK36','JWK37','JWK38', 'JWK39','JWK40','JWK41','JWK42','JWK43','JWK44','JWK45','JWK47','jwk48','JWK49','JWK5','JWK50','JWK6','JWK7','JWK8', 'JWWH','MST1','MST2','MST3','PKG1','PTS1','R&D','REJ1','RWK1','SCP1','SRT1','WLD1','WLD2')
SELECT DISTINCT T0.ItemCode, T0.Dscription, T0.InQty,  T0.OutQty, T0.Price, T0.Warehouse, T0.TransType,T0.JrnlMemo, T0.BASE_REF,T0.DocLineNum+1 AS 'Line Num', T0.DocDate,T0.CardCode, T0.CardName, CASE WHEN T0.TransType ='20' THEN CONCAT('MRR',T0.BASE_REF) WHEN T0.TransType ='59' THEN  CONCAT('GR',T0.BASE_REF)   ELSE CONCAT('ST',T0.BASE_REF,REPLACE(CONVERT(CHAR(10),T0.DocDate, 103),'/','')) END AS [BatchNumber],  CONVERT(varchar(8),DATEADD(MONTH, 36, T0.DocDate), 112) AS [ExpiryDate],     CONVERT(varchar(8), T0.DocDate, 112) AS [ManufacturingDate],     CONVERT(varchar(8), T0.DocDate, 112) AS [AdmissionDate]  FROM OINM T0 INNER JOIN OITM T1 ON T1.ItemCode =T0.ItemCode WHERE T0.TransType IN ('20','59','10000071')  AND T0.Warehouse NOT IN ('1','ASM1','ASM2','DWH1','FGW1','HLD1','IPQC','IQC1', 'JKW10','JKW11','JKW12','JKW13','JKW14','JKW44','JKW9','JWK','JWK1','JWK15','JWK16','JWK17','JWK18','JWK19', 'JWK2','JWK20','JWK21','JWK22','JWK23','JWK24','JWK25','JWK26','JWK27','JWK28','JWK29','JWK3','JWK30','JWK31', 'JWK32','JWK33','JWK34','JWK35','JWK36','JWK37','JWK38','JWK39','JWK40','JWK41','JWK42','JWK43','JWK44','JWK45', 'JWK47','jwk48','JWK49','JWK5','JWK50','JWK6','JWK7','JWK8','JWWH','MST1','MST2','MST3','PKG1','PTS1','R&D','REJ1', 'RWK1','SCP1','SRT1','WLD1','WLD2') and T0.CardCode <>'V000339' AND T0.InQty >0  AND T1.ItmsGrpCod IN (100,105,106,112,114,115,116,138,139)   ORDER BY T0.ItemCode,T0.TransType asc ,T0.DocDate DESC
SELECT T1.DocEntry as 'Link', T1.[DocNum] as 'SO No.', T1.[DocDate] as 'SO Date', T1.DocStatus as ' SO Status',  T1.[CardName] as 'Customer Name',  T0.[Dscription] as 'Part Name', T0.[Quantity] as 'SO Qty',T0.[Price] as 'Sales Price', T0.[OpenQty],  T0.[OpenSum], T3.DocNum as 'Delivery Doc Num', T2.[Quantity] as 'Deliverd Quantity', T13.BatchNum 'Batch Number', T13.Quantity 'Batch Quantity', T12.DocNum AS 'Return No', T12.DocDate as 'Return Date', T11.Quantity as 'Retuen Qty' , T5.DocNum as 'Invoice No', T5.DocDate as 'Invoice Date', T5.DocStatus as 'Invoice Status' , T4.Quantity as 'Invoice Qty', T5.DocTotal,T5.PaidToDate as 'Applied Amt', T7.DocNum as 'Credit Note No.', T7.DocDate as 'Credit Note date',T6.Quantity as 'Credit Note Qty'  FROM RDR1 T0 INNER JOIN ORDR T1 ON T0.DocEntry = T1.DocEntry left outer join DLN1 T2 on T2.BaseEntry = T0.DocEntry and T2.BaseLine = T0.Linenum left outer join ODLN T3 on T2.DocEntry = T3.DocEntry left Outer join INV1 T4 on T4.BaseEntry = T3.DocEntry and T4.BaseLine = T2.Linenum and T4.BaseType = 15 OR (T4.Basetype=17 and T4.BaseEntry=T0.DocEntry and T4.BaseLine=T0.LineNum) LEFT outer join RDN1 T11 on T11.BaseEntry = T2.DocEntry and T11.BaseLine = T2.LineNum LEFT outer join ORDN T12 on T11.DocEntry = T12.DocEntry  left outer join OINV T5 on T5.DocEntry = T4.DocEntry left Outer join RIN1 T6 on T6.BaseEntry = T5.DocEntry and T6.BaseLine = T4.Linenum left outer join ORIN T7 on T6.DocEntry = T7.DocEntry left outer join OITM T8 on T0.ItemCode = T8.ItemCode left outer join OSLP T9 on T9.SlpCode = T1.SlpCode left outer join OHEM T10 on T10.empID = T1.OwnerCode left outer join IBT1 T13 on T2.DocEntry = T13.BaseEntry and T13.BaseType = 15 and  T2.ItemCode = T13.ItemCode and T2.LineNum = T13.BaseLinNum  WHERE T1.[DocDate] >= [%0] and T1.[DocDate] <=[%1] Group by T1.DocEntry, T1.DocNum,T1.DocDate,T1.DocStatus,T1.CardName,  T9.SlpName,T10.firstName,T8.FrgnName,T0.[Dscription] , T0.[Quantity] ,T0.[Price], T0.[OpenQty], T0.[OpenSum], T3.DocNum , T2.[Quantity] , T5.DocNum , T5.DocDate, T5.DocStatus , T4.Quantity, T5.DocTotal,T5.PaidToDate , T7.DocNum , T7.DocDate ,T6.Quantity,T12.DocNum,T12.DocDate,T11.Quantity,T13.BatchNum,T13.Quantity
SELECT T1.ItemCode, T1.Dscription,SUM(T1.OpenQty) as 'Open Qty' FROM  ORDR T0 INNER JOIN RDR1 T1 ON T1.DOCENTRY = T0.DOCENTRY WHERE T1.LINESTATUS = 'O' AND T1.ShipDate <= [%0] GROUP BY T1.ItemCode, T1.Dscription
SELECT T1.ItemCode, T1.Dscription,SUM(T1.OpenQty) as 'Open Qty' FROM  OPOR T0 INNER JOIN POR1 T1 ON T1.DOCENTRY = T0.DOCENTRY WHERE T1.LINESTATUS = 'O' AND T0.DocType ='i' GROUP BY T1.ItemCode, T1.Dscription
SELECT T1.ItemCode, T1.Dscription,SUM(T1.OpenQty) as 'Open Qty', 'PO' as 'DocType' FROM  OPOR T0 INNER JOIN POR1 T1 ON T1.DOCENTRY = T0.DOCENTRY WHERE T1.LINESTATUS = 'O' AND T0.DocType ='i' AND T0.Canceled <> 'Y'  GROUP BY T1.ItemCode, T1.Dscription  UNION ALL  SELECT T1.ItemCode, T1.Dscription,SUM(T1.OpenQty) as 'Open Qty', 'PR' as 'DocType' FROM OPRQ T0 INNER JOIN PRQ1 T1 ON T1.DOCENTRY = T0.DOCENTRY WHERE T1.LINESTATUS = 'O' AND T0.U_PRLEVEL0='Y' GROUP BY T1.ItemCode, T1.Dscription
Select DISTINCT T2.Itemcode ,T2.Price as 'CurrentPrice',  T1.Price as 'Old Price', T0.UpdateDate from AITM T0  Inner Join AIT1 T1 on T0.Itemcode =T1.Itemcode and T1.Loginstanc =T0.loginstanc  inner Join ITM1 t2 on T2.ItemCode= T0.ItemCode  where T0.UpdateDate >= getdate()-90 and T2.Price >0 AND T1.Price >0
SELECT OIGN.DOCENTRY,oign.ObjType,ign1.BaseType ,DOCNUM, OIGN.DOCDATE,ITEMCODE, Dscription, Quantity,  Price , Quantity* Price AS 'Value' , OIGN.Comments, 'GR' FROM OIGN  INNER JOIN IGN1 ON IGN1.DOCENTRY = OIGN.DocEntry  WHERE USERSIGN =1 and oign.DocDate > = '20230601' and IGN1.BaseType <> '202'  AND OIGN.DocEntry NOT IN (72503,72359,72083,72082,71951,71947,71448,71414,71148,71119,70774,70241,70231,68672,68847)  UNION ALL  SELECT OIGE.DOCENTRY,OIGE.ObjType,IGE1.BaseType ,DOCNUM, OIGE.DOCDATE,ITEMCODE, Dscription, Quantity,  Price , Quantity* Price AS 'Value' , OIGE.Comments ,'GI' FROM OIGE  INNER JOIN IGE1 ON IGE1.DOCENTRY = OIGE.DocEntry  WHERE usersign =1 and OIGE.DocDate > = '20230601' and IGE1.BaseType <> '202' AND OIGE.DOCENTRY NOT IN (89598,89781,90525,91814,92244,91101,91887,92050,93136,94040,94041)
SELECT T0.QCategory,T1.CatName, T0.QName, T0.QString FROM     OUQR T0     INNER JOIN OQCN t1 ON t0.QCategory = t1.CategoryID  WHERE     (T1.CatName NOT LIKE 'KPI_%' ) AND     (T1.CatName NOT LIKE 'SAP_%')   ORDER BY T1.CatName
SELECT T0.DocNum AS "Order No.",T0.Type, T0.ItemCode, T1.ItemName , T0.DueDate,T0.PostDate,T0.Status,T0.PlannedQty, T0.CmpltQty , T0.RjctQty , T0.PlannedQty - T0.CmpltQty - T0.RjctQty AS "Open Qty",T0.project, T4.ItmsGrpNam, T2.U_NAME AS "User Name", T3.CardName , T0.OriginNum AS "Sales Order" FROM OWOR T0 FULL OUTER JOIN OCRD T3 ON (T0.CardCode = T3.CardCode) JOIN OITM T1 ON T0.ItemCode = T1.ItemCode LEFT JOIN OITB T4 ON (T1.ItmsGrpCod = T4.ItmsGrpCod) JOIN OUSR T2 ON T0.UserSign = T2.userId WHERE ((T0.DueDate >= '[%0]' AND T0.DueDate <= '[%1]') OR ('[%0]' = '' AND '[%1]' = '')) AND (T0.Type = '[%2]' OR '[%2]' = '') AND (T0.status = '[%3]' OR '[%3]' = '') AND (T0.OriginType = '[%4]' OR '[%4]' = '') AND (T0.warehouse = '[%5]' OR '[%5]' = '') AND (T4.ItmsGrpNam = '[%6]' OR '[%6]' = '') AND (T0.ItemCode = '[%7]' OR '[%7]' = '') AND (T2.U_NAME = '[%8]' OR '[%8]' = '') AND (T3.CardName = '[%9]' OR '[%9]' = '')
SELECT DISTINCT T0.DocEntry,T0.docnum 'Doc',T0.PostDate,T0.SysCloseDt AS 'Close Dt.', Case When T0.Type ='S' THEN 'Std' else 'Special' end as 'Prod Type', T0.ItemCode,T0.ProdName,T0.Project, T0.PlannedQty 'Planned Qty.',T0.CmpltQty as 'CmpltQty',T0.RjctQty, T0.PlannedQty-(T0.CmpltQty + T0.RjctQty) as 'Var Qty', A.value [Reciept Value], ABS(B.value) [Issue Value], (ISNULL(A.value,0) + ISNULL(B.value,0) + ISNULL(c.value,0)) AS 'Variance Amt',  Case When T0.Status='L' THEN 'Closed' When T0.Status='R' THEN 'Released'  ELSE 'Open' end as 'Prod Status'  FROM OWOR T0 LEFT JOIN (SELECT AppObjAbs, SUM(transvalue) AS value FROM oinm WHERE applobj = '202' AND transtype = 59 GROUP BY AppObjAbs) A ON T0.DOCENTRY = A.AppObjAbs LEFT JOIN (SELECT AppObjAbs, SUM(transvalue) AS value FROM oinm WHERE applobj = '202' AND transtype = 60 GROUP BY AppObjAbs) B ON T0.DOCENTRY = B.appobjabs LEFT JOIN (SELECT createdby, SUM(transvalue) AS value FROM oinm WHERE transtype = 202 GROUP BY Createdby) c ON T0.DOCENTRY = c.Createdby  LEFT JOIN (SELECT Distinct TransId,BaseRef,TransType,Ref1 FROM OJDT WHERE TransType ='202')T5 ON  T5.BaseRef = T0.DocNum and T0.ObjType =T5.TransType  LEFT JOIN (SELECT DISTINCT TransId FROM JDT1 WHERE ACCOUNT='515001003' GROUP BY TransId )T6 ON T6.TransId = T5.TransId   WHERE T0.PostDate >='[%0]' AND T0.PostDate <='[%1]' AND T0.Status in ('L','R','P') AND  (ISNULL(A.value,0) + ISNULL(B.value,0) + ISNULL(c.value,0)) <> 0  AND T0.Type ='S'
SELECT DISTINCT T1.DOCENTRY AS 'DocEnt',T0.DOCNUM AS 'Prod No.',   CONVERT (DATE,T0.PostDate,103) AS 'Prod Date', CASE    WHEN T0.PostDate >='2018-04-01' AND T0.PostDate <= '2019-03-31' THEN 'FY 2018-19'   WHEN T0.PostDate >='2019-04-01' AND T0.PostDate <= '2020-03-31' THEN 'FY 2019-20'           WHEN T0.PostDate >='2020-04-01' AND T0.PostDate <= '2021-03-31' THEN 'FY 2020-21'   WHEN T0.PostDate >= '2021-04-01' AND T0.PostDate <= '2022-03-31' THEN 'FY 2021-22'   WHEN T0.PostDate >= '2022-04-01' AND T0.PostDate <= '2023-03-31' THEN 'FY 2022-23'   WHEN T0.PostDate >= '2023-04-01' AND T0.PostDate <= '2024-03-31' THEN 'FY 2023-24'  END AS 'PD FY',                                   T0.ItemCode AS 'FG/SFG Code',T0.ProdName as 'FG/SFG Name', CONVERT (DATE,T0.CloseDate,103) AS 'CloseDate' , CASE    WHEN T0.CloseDate >='2018-04-01' AND T0.CloseDate <= '2019-03-31' THEN 'FY 2018-19'   WHEN T0.CloseDate >='2019-04-01' AND T0.CloseDate <= '2020-03-31' THEN 'FY 2019-20'           WHEN T0.CloseDate >='2020-04-01' AND T0.CloseDate <= '2021-03-31' THEN 'FY 2020-21'   WHEN T0.CloseDate >= '2021-04-01' AND T0.CloseDate <= '2022-03-31' THEN 'FY 2021-22'   WHEN T0.CloseDate >= '2022-04-01' AND T0.CloseDate <= '2023-03-31' THEN 'FY 2022-23'   WHEN T0.CloseDate >= '2023-04-01' AND T0.CloseDate <= '2024-03-31' THEN 'FY 2023-24'  END AS 'CL FY',  CONVERT (DATE ,T0.SysCloseDt, 103) AS SysCloseDt, CASE    WHEN T0.SysCloseDt >='2018-04-01' AND T0.SysCloseDt <= '2019-03-31' THEN 'FY 2018-19'   WHEN T0.SysCloseDt >='2019-04-01' AND T0.SysCloseDt <= '2020-03-31' THEN 'FY 2019-20'           WHEN T0.SysCloseDt >='2020-04-01' AND T0.SysCloseDt <= '2021-03-31' THEN 'FY 2020-21'   WHEN T0.SysCloseDt >= '2021-04-01' AND T0.SysCloseDt <= '2022-03-31' THEN 'FY 2021-22'   WHEN T0.SysCloseDt >= '2022-04-01' AND T0.SysCloseDt <= '2023-03-31' THEN 'FY 2022-23'   WHEN T0.SysCloseDt >= '2023-04-01' AND T0.SysCloseDt <= '2024-03-31' THEN 'FY 2023-24'  END AS 'SysCL FY',  T1.LineNum, T1.ItemCode, T1.ItemName, T1.BaseQty,  T1.[PlannedQty], T1.[IssuedQty], T0.CmpltQty, T1.PlannedQty-T1.IssuedQty as [Plan-Issue],  CASE WHEN T0.CmpltQty <> 0 THEN T1.BaseQty*T0.CmpltQty  END 'Issuance Req', T1.IssueType, T0.[Status], T0.Project  FROM WOR1 T1 INNER JOIN OWOR T0 ON T0.DocEntry = T1.DocEntry    WHERE T0.[Status]<>'P'   ORDER BY T1.DOCENTRY DESC
SELECT H1.DocNum as 'Recpt No.', CONVERT (Date,T0.DocDate,103) AS 'Recpt Date' ,T0.[ItemCode],T0.[Dscription],T0.WhsCode, T0.BaseRef as 'Prod Order No', T0.[Quantity],DATEDIFF(DD,T0.DOCDATE,GETDATE()) as 'Due From Day'              FROM [IGN1] T0   INNER JOIN OIGN H1 ON H1.DocEntry= T0.DocEntry   INNER JOIN OITW T1 ON T1.WhsCode=T0.WhsCode AND T1.ItemCode=T0.ItemCode   WHERE T0.BaseType='202' AND T1.OnHand >=T0.[Quantity] and T0.[ItemCode]    not in ('99900010000') and T0.WhsCode ='[%0]' AND T0.DocDate >= GETDATE() - 30    ORDER BY T0.[DocDate] desc
SELECT T0.DocEntry,T0.[DocNum] as 'Issue Doc' ,CONVERT (DATE,T0.[DocDate],103) as 'Issue Dt.', T1.BaseRef as 'Prod Ord', T1.[ItemCode],  T1.[Dscription],T3.ItmsGrpNam, T1.[Quantity],T1.WhsCode, T1.[Price],T1.[StockPrice] as 'Item Cost', T0.Comments FROM OIGE T0   INNER JOIN IGE1 T1 ON T0.[DocEntry] = T1.[DocEntry]  INNER JOIN OITM T2 ON T2.ItemCode = T1.ItemCode INNER JOIN OITB T3 ON T3.ItmsGrpCod = T2.ItmsGrpCod WHERE T0.[DocDate] >=[%0] AND  T0.[DocDate] <= [%1] AND T0.[CANCELED] = 'N' AND T1.BaseType='202' AND  T1.ItemCode not IN ( 'P100100','P100200','P100300','P100400','P100500','P100600','P100700','P100800','P100900','P101000', 'P101100','P101200','P101300','P101400','P101500','P101600','P101700','P101800','P101900','P102000', 'P102100','P102200','P102300','P102400','P102500','P102600','99900100000','SI0002','SI0003') ORDER BY T0.DocDate
select (select x.cardname from OPOR x where x.DocNum=t0.DocNum),t0.DocNum, sum(t1.Quantity) as 'Order Qty', (select isnull(sum(a.quantity),0) from PDN1 a  inner join OPDN b on a.DocEntry=b.DocEntry  where b.CANCELED <> 'Y' and b.CANCELED <> 'c' and t0.docnum=a.BaseDocNum ) as 'Received Qty'   from OPOR T0 inner join por1 t1 on t0.DocEntry=t1.DocEntry Where t0.DocDueDate >= '20221201' and t0.DocDueDate<='20221231'  and u_poty='schedule' group by t0.DocNum
SELECT t0.cardname,T1.[ItemCode], T1.[Dscription], T1.[Quantity], t1.quantity- T1.[OpenQty] as 'Received Qty',T1.[OpenQty] FROM OPOR T0  INNER JOIN POR1 T1 ON T0.[DocEntry] = T1.[DocEntry]  where t0.docduedate >=[%0] and t0.docduedate<=[%1] and t1.openqty <>'0'
SELECT T0.[NumAtCard], T0.[TaxDate], T1.[ItemCode], T1.[Dscription], T1.[Quantity], T1.[Price] FROM ORPC T0  INNER JOIN RPC1 T1 ON T0.[DocEntry] = T1.[DocEntry] WHERE T0.[CardName]  =[%0] AND  T0.[TaxDate] >=[%1] AND  T0.[TaxDate] <=[%2]
select t0.number,t0.BpName,t1.ItemCode,t1.ItemName,t1.UnitPrice  from OOAT T0  inner join OAT1 T1 on T0.AbsID=t1.AgrNo  where LineStatus<>'c' order by t1.itemcode
declare @fromdate DATE, @todate DATE , @itemcode NVARCHAR(40), @cardcode NVARCHAR(200) , @whscode NVARCHAR(20)  ,  @ItmGrp nvarchar(200) , @username nvarchar(100), @PRstatus nvarchar(20) set @fromdate =(select min(T0.docdate) from OPDN T0 where T0.docdate >='[%0]') set  @todate = (select max(T1.docdate) from OPDN T1 where T1.docdate <='[%1]') set  @itemcode =(select max(T2.itemcode) from oitm T2 where T2.itemcode='[%2]') set  @ItmGrp =(select max(T5.ItmsgrpNam) from OITB T5 where T5.ItmsgrpNam='[%5]') set  @username=(select max(T6.ReqName) from Oprq T6 where T6.ReqName='[%6]') if(@fromdate ='' or @fromdate='')    set @fromdate =null if( @todate ='' or @TOdate='')    set @todate =null if (@itemcode ='ALL' or @itemcode = '')            set @itemcode = null if (@cardcode ='ALL' or @cardcode = '')            set @cardcode = null if (@whscode ='ALL' or @whscode = '')            set @whscode = null if (@ItmGrp ='ALL' or @ItmGrp = '')            set @ItmGrp = null if (@username ='ALL' or @username = '')            set @username = null  SELECT O.DOCNUM'PR NO.', O.DOCDATE 'PR DATE', O.REQNAME 'REQUESTED BY', P.ITEMCODE 'ITEM CODE', P.DSCRIPTION 'ITEM DESC.',  P.QUANTITY , p.OpenQty, P.PQTReqDate 'REQ. DATE',  P.docentry, P.LineNum, P.LineStatus as 'PRstatus', convert(nvarchar(200),'')   [Item Group], CONVERT(nvarchar(200),'')   [PO No], CONVERT(nvarchar(200),'')   [PO DocEntry],  CONVERT(nvarchar(200),'')   [PO LineNum], CONVERT(date,Null)          [PO Date], CONVERT(nvarchar(200),'')   [PO Party Code],  CONVERT(nvarchar(200),'')   [PO Party Name], CONVERT(nvarchar(200),'')   [PO Item Code],  CONVERT(nvarchar(200),'')   [PO Item Name], CONVERT(numeric(19,2),0)    [PO Quantity],  CONVERT(numeric(19,2),0)    [PO Open Qty], CONVERT(numeric(19,2),0)    [PO Price], CONVERT(numeric(19,2),0)    [PO VatSum],  CONVERT(numeric(19,2),0)    [PO Total], CONVERT(nvarchar(400),'')   [PO Vendor Ref No.],  CONVERT(nvarchar(400),'')   [PO Remark], convert(nvarchar(200),'')   [GRPO DOCENTRY], convert(nvarchar(200),'')   [GRPO No], CONVERT(nvarchar(200),'')   [GRPO LineNum], convert(DAte,Null)          [GRPO Date],  convert(nvarchar(200),'')   [GRPO CardCode], convert(nvarchar(300),'')   [GRPO CARDNAME],  convert(nvarchar(200),'')   [GRPO ITEM CODE], convert(nvarchar(200),'')   [GRPO Item Name],  CONVERT(numeric(19,2),0)    [GRPO QUANTITY], CONVERT(numeric(19,2),0)    [GRPO Price],  CONVERT(numeric(19,2),0)    [GRPO VatSum], CONVERT(numeric(19,2),0)    [GRPO Total],  CONVERT(Nvarchar(400),'')   [GRPO Vendor Ref No.], CONVERT(Nvarchar(400),'')   [GRPO Remarks],  convert(nvarchar(200),'')   [AP DocENTRY], convert(nvarchar(200),'')   [AP No], convert(DAte,Null)          [AP Date],  convert(nvarchar(200),'')   [AP CARDCODE], convert(nvarchar(200),'')   [AP CARDNAME],  convert(nvarchar(200),'')   [AP ITEM CODE], convert(nvarchar(200),'')   [AP Item Name],  CONVERT(numeric(19,2),0)    [AP QUANTITY], CONVERT(numeric(19,2),0)    [AP Price], CONVERT(numeric(19,2),0)    [AP VatSum],  CONVERT(numeric(19,2),0)    [AP Total], CONVERT(Nvarchar(400),'')   [AP Vendor Ref No.],  CONVERT(Nvarchar(400),'')   [AP Remarks] into  #Temp from OPRQ O , PRQ1 P where  O.DocEntry=P.DocEntry and O.DocDate between isnull(@fromdate,O.DocDate) and Isnull(@todate,o.docdate)  AND p.ITEMCODE = isnull(@itemcode,p.ITEMCODE) and P.WhsCode = ISNULL(@whscode ,P.WhsCode) and O.ReqName=ISNULL(@username, O.ReqName) update  t   set                [PO Quantity] = A.Quantity  ,       [PO Open Qty] = A.OpenQty    ,      [PO No]  =h.docnum              from #Temp t , OPOR H, (select SUM(B.Quantity) Quantity, SUM(B.OpenQty) OpenQty, B.BaseEntry, B.BaseLine, B.DocEntry     from POR1 B     group by B.BaseEntry,B.BaseLine,B.DocEntry) A   where  t.docentry=A.BaseEntry   and t.LineNum =A.BaseLine and H.DocEntry = A.DocEntry and H.canceled='N' update  t   set                [GRPO QUANTITY] = A.Quantity                       from #Temp t , OPDN H, POR1 D ,  (select SUM(B.Quantity) Quantity, B.BaseEntry, B.BaseLine, B.DocEntry     from PDN1 B     group by B.BaseEntry,B.BaseLine,B.DocEntry) A   where  D.docentry=A.BaseEntry and D.LineNum =A.BaseLine   and H.DocEntry = A.DocEntry and t.docentry=D.BaseEntry and t.LineNum =D.BaseLine and H.canceled='N'   and H.CardName = ISNULl( @cardcode,H.CardName ) Update  t   set     [Item Group]=B.ItmsGrpNam   from #Temp t , OITM A, OITB B   where   t.[ITEM CODE] = A.ItemCode  and A.ItmsGrpCod = B.ItmsGrpCod and B.ItmsGrpNam = isnull(@ItmGrp,B.ItmsGrpNam) update  t   set                [AP QUANTITY] = A.Quantity                       from #Temp t , OPCH H, POR1 D , PDN1 E,  (select SUM(B.Quantity) Quantity, B.BaseEntry, B.BaseLine, B.DocEntry     from PCH1 B     group by B.BaseEntry,B.BaseLine,B.DocEntry) A     where  E.docentry=A.BaseEntry and E.LineNum =A.BaseLine and H.DocEntry = A.DocEntry   and D.docentry=e.BaseEntry and D.LineNum =E.BaseLine and t.DocEntry=D.BaseEntry and t.LineNum=D.BaseLine and H.canceled='N' select [PR NO.], DocEntry, [PR Date], [REQUESTED BY], [Item Code], [Item Desc.], [Item Group], Quantity, OpenQty, [REQ. DATE],  [PO No], [PO Quantity], [PO Open Qty], [GRPO QUANTITY], [AP QUANTITY], [PRStatus] from #temp order by [pr no.]
SELECT CardCode,CardName, [FY] , [4] AS April,[5] AS May,     [6] AS June,[7] AS July,[8] AS August,[9] AS September,[10] AS October,[11] AS November,[12] AS December,  [1] AS January,[2] AS February,[3] AS March,     ISNULL([4], 0) +ISNULL([5], 0) + ISNULL([6], 0) + ISNULL([7], 0) + ISNULL([8], 0) +     ISNULL([9], 0) + ISNULL([10], 0) + ISNULL([11], 0) + ISNULL([12], 0)+ ISNULL([1], 0) +   ISNULL([2], 0) + ISNULL([3], 0) AS Total FROM (SELECT T0.CardCode, T0.CardName, CASE WHEN T1.DocDate >= '2019-04-01' AND T1.DocDate <= '2020-03-31' THEN 'FY 2019-20'     WHEN T1.DocDate >= '2020-04-01' AND T1.DocDate <= '2021-03-31' THEN 'FY 2020-21'     WHEN T1.DocDate >= '2021-04-01' AND T1.DocDate <= '2022-03-31' THEN 'FY 2021-22'     WHEN T1.DocDate >= '2022-04-01' AND T1.DocDate <= '2023-03-31' THEN 'FY 2022-23'   WHEN T1.DocDate >= '2023-04-01' AND T1.DocDate <= '2024-03-31' THEN 'FY 2023-24'   END AS [FY] ,MONTH(T1.DocDate) AS Month, T2.LineTotal AS BasicValue FROM OCRD T0      INNER JOIN OPCH T1 ON T0.CardCode = T1.CardCode   LEFT JOIN PCH1 T2 ON T2.DocEntry = T1.DocEntry  WHERE T1.DocDate >='20190401' AND T1.CANCELED <>'Y'  ) AS PivotData PIVOT (SUM(BasicValue)      FOR Month IN ( [4], [5], [6], [7], [8], [9], [10], [11], [12],[1], [2], [3])) AS PivotTable
SELECT distinct T0.DocEntry as 'Doc Entry',T0.DocNum as 'PO No.',T0.U_POTY,  T0.[DocDate],T0.DocDueDate as 'Delivery Dt.', YEAR(T0.DocDueDate) as 'Year', CASE WHEN DATEDIFF(DAY,T1.ShipDate,GETDATE())>0 THEN 'Delv Failed' ELSE 'Balance Delv' end as 'Delivery Status', T1.ShipDate,T0.[CardCode], T0.[CardName], T1.[ItemCode] ,  T1.[Dscription], T1.[Quantity], (T1.[Quantity] -  T1.[OpenQty]) as 'Received Qty', T1.[OpenQty], T1.[PriceBefDi], T1.[LineTotal] , T4.frozenFor as 'Vendor Inactive'  FROM OPOR T0    LEFT JOIN POR1 T1 ON T0.DocEntry = T1.DocEntry    LEFT JOIN OWDD T2 ON T0.DocEntry = T2.DocEntry   LEFT JOIN WDD1 T3 ON T2.WddCode = T3.WddCode  INNER JOIN OCRD T4 ON T4.CardCode = T0.CardCode  LEFT JOIN ( SELECT [GroupNum],PymntGroup FROM OCTG)T9 ON T0.GroupNum = T9.[GroupNum]   WHERE T0.Docstatus = 'O' AND T0.Canceled <> 'Y'  and T1.LineStatus='O'  and T0.DocType <> 'S'  ORDER BY T0.[DocDate]
SELECT DISTINCT T1.[DocEntry] AS 'SAP Entry', T0.[DocNum] as 'PR No.', T0.[DocDate] as 'PR Date',  T1.[ItemCode], T1.[Dscription], T1.[Quantity], T1.[OpenQty], T1.[PQTReqDate], T3.OnHand as 'MST Stock', T4.LastPurDat, T2.[U_NAME] as 'User ID',  Case When T0.U_PRLEVEL0='Y' THEN 'OK' When T0.U_PRLEVEL0='R' THEN 'Rej' ELSE 'Pending' END AS 'Approval L2' FROM OPRQ T0   INNER JOIN PRQ1 T1 ON T0.[DocEntry] = T1.[DocEntry]  INNER JOIN OUSR T2 ON T0.[UserSign] = T2.[USERID]  LEFT JOIN OITW T3 ON T3.ItemCode = T1.ItemCode LEFT JOIN OITM T4 ON T4.ItemCode= T1.ItemCode WHERE T1.[LineStatus] ='[%0]' and T0.[DocDate] >getdate()-60 AND T3.WhsCode='MST'
SELECT T0.[DocNum], T0.[ObjType], CASE  WHEN OBJECTCODE='1' THEN 'G/L Accounts' WHEN OBJECTCODE='2' THEN 'Business Partner' WHEN OBJECTCODE='3' THEN 'Bank Codes' WHEN OBJECTCODE='4' THEN 'Items' WHEN OBJECTCODE='5' THEN 'Tax Definition' WHEN OBJECTCODE='6' THEN 'Price Lists' WHEN OBJECTCODE='7' THEN 'Special Prices' WHEN OBJECTCODE='8' THEN 'Item Properties' WHEN OBJECTCODE='9' THEN 'Rate Differences' WHEN OBJECTCODE='10' THEN 'Card Groups' WHEN OBJECTCODE='11' THEN 'Contact Persons' WHEN OBJECTCODE='12' THEN 'Users' WHEN OBJECTCODE='13' THEN 'A/R Invoice' WHEN OBJECTCODE='14' THEN 'A/R Credit Memo' WHEN OBJECTCODE='15' THEN 'Delivery' WHEN OBJECTCODE='16' THEN 'Returns' WHEN OBJECTCODE='17' THEN 'Sales Order' WHEN OBJECTCODE='18' THEN 'A/P Invoice' WHEN OBJECTCODE='19' THEN 'A/P Credit Memo' WHEN OBJECTCODE='20' THEN 'Goods Receipt PO' WHEN OBJECTCODE='21' THEN 'Goods Return' WHEN OBJECTCODE='22' THEN 'Purchase Order' WHEN OBJECTCODE='23' THEN 'Sales Quotation' WHEN OBJECTCODE='24' THEN 'Incoming Payment' WHEN OBJECTCODE='25' THEN 'Deposit' WHEN OBJECTCODE='26' THEN 'Reconciliation History' WHEN OBJECTCODE='27' THEN 'Check Register' WHEN OBJECTCODE='28' THEN 'Journal Voucher Entry' WHEN OBJECTCODE='29' THEN 'Journal Vouchers List' WHEN OBJECTCODE='30' THEN 'Journal Entry' WHEN OBJECTCODE='31' THEN 'Items – Warehouse' WHEN OBJECTCODE='32' THEN 'Print Preferences' WHEN OBJECTCODE='33' THEN 'Activities' WHEN OBJECTCODE='34' THEN 'Recurring Postings' WHEN OBJECTCODE='35' THEN 'Document Numbering' WHEN OBJECTCODE='36' THEN 'Credit Cards' WHEN OBJECTCODE='37' THEN 'Currency Codes' WHEN OBJECTCODE='38' THEN 'CPI Codes' WHEN OBJECTCODE='39' THEN 'Administration' WHEN OBJECTCODE='40' THEN 'Payment Terms' WHEN OBJECTCODE='41' THEN 'Preferences' WHEN OBJECTCODE='42' THEN 'External Bank Statement Received' WHEN OBJECTCODE='43' THEN 'Manufacturers' WHEN OBJECTCODE='44' THEN 'Card Properties' WHEN OBJECTCODE='45' THEN 'Journal Entry Codes' WHEN OBJECTCODE='46' THEN 'Outgoing Payments' WHEN OBJECTCODE='47' THEN 'Serial Numbers' WHEN OBJECTCODE='48' THEN 'Loading Expenses' WHEN OBJECTCODE='49' THEN 'Delivery Types' WHEN OBJECTCODE='50' THEN 'Length Units' WHEN OBJECTCODE='51' THEN 'Weight Units' WHEN OBJECTCODE='52' THEN 'Item Groups' WHEN OBJECTCODE='53' THEN 'Sales Employee' WHEN OBJECTCODE='54' THEN 'Report – Selection Criteria' WHEN OBJECTCODE='55' THEN 'Posting Templates' WHEN OBJECTCODE='56' THEN 'Customs Groups' WHEN OBJECTCODE='57' THEN 'Checks for Payment' WHEN OBJECTCODE='58' THEN 'Whse Journal' WHEN OBJECTCODE='59' THEN 'Goods Receipt' WHEN OBJECTCODE='60' THEN 'Goods Issue' WHEN OBJECTCODE='61' THEN 'Cost Center' WHEN OBJECTCODE='62' THEN 'Cost Rate' WHEN OBJECTCODE='63' THEN 'Project Codes' WHEN OBJECTCODE='64' THEN 'Warehouses' WHEN OBJECTCODE='65' THEN 'Commission Groups' WHEN OBJECTCODE='66' THEN 'Product Tree' WHEN OBJECTCODE='67' THEN 'Inventory Transfer' WHEN OBJECTCODE='68' THEN 'Production Instructions' WHEN OBJECTCODE='69' THEN 'Landed Costs' WHEN OBJECTCODE='70' THEN 'Payment Methods' WHEN OBJECTCODE='71' THEN 'Credit Card Payment' WHEN OBJECTCODE='72' THEN 'Credit Card Management' WHEN OBJECTCODE='73' THEN 'Customer/Vendor Cat. No.' WHEN OBJECTCODE='74' THEN 'Credit Payments' WHEN OBJECTCODE='75' THEN 'CPI and FC Rates' WHEN OBJECTCODE='76' THEN 'Postdated Deposit' WHEN OBJECTCODE='77' THEN 'Budget' WHEN OBJECTCODE='78' THEN 'Budget Cost Assess. Mthd' WHEN OBJECTCODE='79' THEN 'Retail Chains' WHEN OBJECTCODE='80' THEN 'Alerts Template' WHEN OBJECTCODE='81' THEN 'Alerts' WHEN OBJECTCODE='82' THEN 'Received Alerts' WHEN OBJECTCODE='83' THEN 'Message Sent' WHEN OBJECTCODE='84' THEN 'Activity Subjects' WHEN OBJECTCODE='85' THEN 'Special Prices for Groups' WHEN OBJECTCODE='86' THEN 'Application Start' WHEN OBJECTCODE='87' THEN 'Distribution List' WHEN OBJECTCODE='88' THEN 'Shipping Types' WHEN OBJECTCODE='89' THEN 'Outgoing' WHEN OBJECTCODE='90' THEN 'Transition' WHEN OBJECTCODE='91' THEN 'Budget Scenario' WHEN OBJECTCODE='92' THEN 'Interest Prices' WHEN OBJECTCODE='93' THEN 'User Defaults' WHEN OBJECTCODE='94' THEN 'Serial Numbers for Items' WHEN OBJECTCODE='95' THEN 'Financial Report Templates' WHEN OBJECTCODE='96' THEN 'Financial Report Categories' WHEN OBJECTCODE='97' THEN 'Opportunity' WHEN OBJECTCODE='98' THEN 'Interest' WHEN OBJECTCODE='99' THEN 'Interest Level' WHEN OBJECTCODE='100' THEN 'Information Source' WHEN OBJECTCODE='101' THEN 'Opportunity Stage' WHEN OBJECTCODE='102' THEN 'Defect Cause' WHEN OBJECTCODE='103' THEN 'Activity Types' WHEN OBJECTCODE='104' THEN 'Meetings Location' WHEN OBJECTCODE='105' THEN 'Service Calls' WHEN OBJECTCODE='106' THEN 'Batch No. for Item' WHEN OBJECTCODE='107' THEN 'Alternative Items 2' WHEN OBJECTCODE='108' THEN 'Partners' WHEN OBJECTCODE='109' THEN 'Competitors' WHEN OBJECTCODE='110' THEN 'User Validations' WHEN OBJECTCODE='111' THEN 'Posting Period' WHEN OBJECTCODE='112' THEN 'Drafts' WHEN OBJECTCODE='113' THEN 'Batches and Serial Numbers' WHEN OBJECTCODE='114' THEN 'User Display Cat.' WHEN OBJECTCODE='115' THEN 'Lender – Pelecard' WHEN OBJECTCODE='116' THEN 'Withholding Tax Deduction Hierarchy' WHEN OBJECTCODE='117' THEN 'Withholding Tax Deduction Groups' WHEN OBJECTCODE='118' THEN 'Branches' WHEN OBJECTCODE='119' THEN 'Departments' WHEN OBJECTCODE='120' THEN 'Confirmation Level' WHEN OBJECTCODE='121' THEN 'Approval Templates' WHEN OBJECTCODE='122' THEN 'Docs. for Confirmation' WHEN OBJECTCODE='123' THEN 'Checks for Payment Drafts' WHEN OBJECTCODE='124' THEN 'Company Info' WHEN OBJECTCODE='125' THEN 'Freight Setup' WHEN OBJECTCODE='126' THEN 'Sales Tax Authorities' WHEN OBJECTCODE='127' THEN 'Sales Tax Authorities Type' WHEN OBJECTCODE='128' THEN 'Sales Tax Codes' WHEN OBJECTCODE='129' THEN 'Countries' WHEN OBJECTCODE='130' THEN 'States' WHEN OBJECTCODE='131' THEN 'Address Formats' WHEN OBJECTCODE='132' THEN 'A/R Correction Invoice' WHEN OBJECTCODE='133' THEN 'Cash Discount' WHEN OBJECTCODE='134' THEN 'Query Catagories' WHEN OBJECTCODE='135' THEN 'Triangular Deal' WHEN OBJECTCODE='136' THEN 'Data Migration' WHEN OBJECTCODE='137' THEN 'Workstation ID' WHEN OBJECTCODE='138' THEN 'Indicator' WHEN OBJECTCODE='139' THEN 'Goods Shipment' WHEN OBJECTCODE='140' THEN 'Payment Draft' WHEN OBJECTCODE='141' THEN 'Query Wizard' WHEN OBJECTCODE='142' THEN 'Account Segmentation' WHEN OBJECTCODE='143' THEN 'Account Segmentation Categories' WHEN OBJECTCODE='144' THEN 'Location' WHEN OBJECTCODE='145' THEN '1099 Forms' WHEN OBJECTCODE='146' THEN 'Cycle' WHEN OBJECTCODE='147' THEN 'Payment Methods for Payment Wizard' WHEN OBJECTCODE='148' THEN '1099 Opening Balance' WHEN OBJECTCODE='149' THEN 'Dunning Interest Rate' WHEN OBJECTCODE='150' THEN 'BP Priorities' WHEN OBJECTCODE='151' THEN 'Dunning Letters' WHEN OBJECTCODE='152' THEN 'User Fields – Description' WHEN OBJECTCODE='153' THEN 'User Tables' WHEN OBJECTCODE='154' THEN 'My Menu Items' WHEN OBJECTCODE='155' THEN 'Payment Run' WHEN OBJECTCODE='156' THEN 'Pick List' WHEN OBJECTCODE='157' THEN 'Payment Wizard' WHEN OBJECTCODE='158' THEN 'Payment Results Table' WHEN OBJECTCODE='159' THEN 'Payment Block' WHEN OBJECTCODE='160' THEN 'Queries' WHEN OBJECTCODE='161' THEN 'Central Bank Ind.' WHEN OBJECTCODE='162' THEN 'Inventory Revaluation' WHEN OBJECTCODE='163' THEN 'A/P Correction Invoice' WHEN OBJECTCODE='164' THEN 'A/P Correction Invoice Reversal' WHEN OBJECTCODE='165' THEN 'A/R Correction Invoice' WHEN OBJECTCODE='166' THEN 'A/R Correction Invoice Reversal' WHEN OBJECTCODE='167' THEN 'Service Call Statuses' WHEN OBJECTCODE='168' THEN 'Service Call Types' WHEN OBJECTCODE='169' THEN 'Service Call Problem Types' WHEN OBJECTCODE='170' THEN 'Contract Template' WHEN OBJECTCODE='171' THEN 'Employees' WHEN OBJECTCODE='172' THEN 'Employee Types' WHEN OBJECTCODE='173' THEN 'Employee Status' WHEN OBJECTCODE='174' THEN 'Termination Reason' WHEN OBJECTCODE='175' THEN 'Education Types' WHEN OBJECTCODE='176' THEN 'Customer Equipment Card' WHEN OBJECTCODE='177' THEN 'Agent Name' WHEN OBJECTCODE='178' THEN 'Withholding Tax' WHEN OBJECTCODE='179' THEN 'Already Displayed 347, 349 and WTax Reports' WHEN OBJECTCODE='180' THEN 'Tax Report' WHEN OBJECTCODE='181' THEN 'Bill of Exchange for Payment' WHEN OBJECTCODE='182' THEN 'Bill Of Exchang Transaction' WHEN OBJECTCODE='183' THEN 'File Format' WHEN OBJECTCODE='184' THEN 'Period Indicator' WHEN OBJECTCODE='185' THEN 'Doubtful Debts' WHEN OBJECTCODE='186' THEN 'Holiday Table' WHEN OBJECTCODE='187' THEN 'BP – Bank Account' WHEN OBJECTCODE='188' THEN 'Service Call Solution Statuses' WHEN OBJECTCODE='189' THEN 'Service Call Solutions' WHEN OBJECTCODE='190' THEN 'Service Contracts' WHEN OBJECTCODE='191' THEN 'Service Calls' WHEN OBJECTCODE='192' THEN 'Service Call Origins' WHEN OBJECTCODE='193' THEN 'User Key Description' WHEN OBJECTCODE='194' THEN 'Queue' WHEN OBJECTCODE='195' THEN 'Inflation Wizard' WHEN OBJECTCODE='196' THEN 'Dunning Terms' WHEN OBJECTCODE='197' THEN 'Dunning Wizard' WHEN OBJECTCODE='198' THEN 'Sales Forecast' WHEN OBJECTCODE='199' THEN 'MRP Scenarios' WHEN OBJECTCODE='200' THEN 'Territories' WHEN OBJECTCODE='201' THEN 'Industries' WHEN OBJECTCODE='202' THEN 'Production Order' WHEN OBJECTCODE='203' THEN 'A/R Down Payment' WHEN OBJECTCODE='204' THEN 'A/P Down Payment' WHEN OBJECTCODE='205' THEN 'Package Types' WHEN OBJECTCODE='206' THEN 'User-Defined Object' WHEN OBJECTCODE='207' THEN 'Data Ownership – Objects' WHEN OBJECTCODE='208' THEN 'Data Ownership – Exceptions' WHEN OBJECTCODE='209' THEN '' WHEN OBJECTCODE='210' THEN 'Employee Position' WHEN OBJECTCODE='211' THEN 'Employee Teams' WHEN OBJECTCODE='212' THEN 'Relationships' WHEN OBJECTCODE='213' THEN 'Recommendation Data' WHEN OBJECTCODE='214' THEN 'User Autorization Tree' WHEN OBJECTCODE='215' THEN 'Predefined Text' WHEN OBJECTCODE='216' THEN 'Box Definition' WHEN OBJECTCODE='217' THEN 'Activity Status' WHEN OBJECTCODE='218' THEN '312' WHEN OBJECTCODE='219' THEN 'User-Defined Values' WHEN OBJECTCODE='220' THEN 'Periods Category' WHEN OBJECTCODE='221' THEN 'Attachments' WHEN OBJECTCODE='222' THEN 'Grid Filter' WHEN OBJECTCODE='223' THEN 'User Language Table' WHEN OBJECTCODE='224' THEN 'Multi-Language Translation' WHEN OBJECTCODE='225' THEN '' WHEN OBJECTCODE='226' THEN '' WHEN OBJECTCODE='227' THEN '' WHEN OBJECTCODE='229' THEN 'Dynamic Interface (Strings)' WHEN OBJECTCODE='230' THEN 'Saved Reconciliations' WHEN OBJECTCODE='231' THEN 'House Bank Accounts' WHEN OBJECTCODE='232' THEN 'Document' WHEN OBJECTCODE='233' THEN 'Document Generation Parameter Sets' WHEN OBJECTCODE='234' THEN '#740' WHEN OBJECTCODE='238' THEN 'Account Category' WHEN OBJECTCODE='239' THEN 'Bank Charges Allocation Codes' WHEN OBJECTCODE='241' THEN 'Cash Flow Transactions – Rows' WHEN OBJECTCODE='242' THEN 'Cash Flow Line Item' WHEN OBJECTCODE='247' THEN 'Business Place' WHEN OBJECTCODE='250' THEN 'Local Era Calendar' WHEN OBJECTCODE='251' THEN 'Cost Accounting Dimension' WHEN OBJECTCODE='254' THEN 'Service Code Table' WHEN OBJECTCODE='255' THEN 'Service Group for Brazil' WHEN OBJECTCODE='256' THEN 'Material Group' WHEN OBJECTCODE='257' THEN 'NCM Code' WHEN OBJECTCODE='258' THEN 'CFOP for Nota Fiscal' WHEN OBJECTCODE='259' THEN 'CST Code for Nota Fiscal' WHEN OBJECTCODE='260' THEN 'Usage of Nota Fiscal' WHEN OBJECTCODE='261' THEN 'Closing Date Procedure' WHEN OBJECTCODE='263' THEN 'Nota Fiscal Numbering' WHEN OBJECTCODE='264' THEN 'Nota Fiscal Tax Category (Brazil)' WHEN OBJECTCODE='265' THEN 'Counties' WHEN OBJECTCODE='266' THEN 'Tax Code Determination' WHEN OBJECTCODE='267' THEN 'BoE Document Type' WHEN OBJECTCODE='268' THEN 'BoE Portfolio' WHEN OBJECTCODE='269' THEN 'BoE Instruction' WHEN OBJECTCODE='271' THEN 'Tax Parameter' WHEN OBJECTCODE='275' THEN 'Tax Type Combination' WHEN OBJECTCODE='276' THEN 'Tax Formula Master Table' WHEN OBJECTCODE='278' THEN 'CNAE Code' WHEN OBJECTCODE='280' THEN 'Sales Tax Invoice' WHEN OBJECTCODE='281' THEN 'Purchase Tax Invoice' WHEN OBJECTCODE='283' THEN 'Cargo Customs Declaration Numbers' WHEN OBJECTCODE='290' THEN 'Resources' WHEN OBJECTCODE='291' THEN 'Resource Properties' WHEN OBJECTCODE='292' THEN 'ResGrpCod' WHEN OBJECTCODE='300' THEN 'RecordSet' WHEN OBJECTCODE='305' THEN 'Bridge' WHEN OBJECTCODE='321' THEN 'Internal Reconciliation' WHEN OBJECTCODE='541' THEN 'POS Master Data' WHEN OBJECTCODE='1179' THEN 'Stock Transfer Draft' WHEN OBJECTCODE='10000105' THEN 'Messaging Service Settings' WHEN OBJECTCODE='10000044' THEN 'Batch Numbers Master Data' WHEN OBJECTCODE='10000045' THEN 'Serial Numbers Master Data' WHEN OBJECTCODE='10000062' THEN 'IVL Vs OINM Keys' WHEN OBJECTCODE='10000071' THEN 'Inventory Posting' WHEN OBJECTCODE='10000073' THEN 'Financial Year Master' WHEN OBJECTCODE='10000074' THEN 'Sections' WHEN OBJECTCODE='10000075' THEN 'Certificate Series' WHEN OBJECTCODE='10000077' THEN 'Nature of Assessee' WHEN OBJECTCODE='10000196' THEN 'Document Type List' WHEN OBJECTCODE='10000197' THEN 'UoM Group' WHEN OBJECTCODE='10000199' THEN 'UoM Master Data' WHEN OBJECTCODE='10000203' THEN 'Bin Field Configuration' WHEN OBJECTCODE='10000204' THEN 'Bin Location Attribute' WHEN OBJECTCODE='10000205' THEN 'Warehouse Sublevel' WHEN OBJECTCODE='10000206' THEN 'Bin Location' WHEN OBJECTCODE='140000041' THEN 'DNF Code' WHEN OBJECTCODE='231000000' THEN 'Authorization Group' WHEN OBJECTCODE='234000004' THEN 'E-Mail Group' WHEN OBJECTCODE='243000001' THEN 'Government Payment Code' WHEN OBJECTCODE='310000001' THEN 'Inventory Opening Balance' WHEN OBJECTCODE='310000008' THEN 'Batch Attributes in Location' WHEN OBJECTCODE='410000005' THEN 'Legal List Format' WHEN OBJECTCODE='480000001' THEN 'Object: HR Employee Transfer' WHEN OBJECTCODE='540000005' THEN 'Tax Code Determination' WHEN OBJECTCODE='540000006' THEN 'Purchase Quotation' WHEN OBJECTCODE='540000040' THEN 'Recurring Transaction Template' WHEN OBJECTCODE='540000042' THEN 'Cost Center Type' WHEN OBJECTCODE='540000048' THEN 'Accrual Type' WHEN OBJECTCODE='540000056' THEN 'Nota Fiscal Model' WHEN OBJECTCODE='540000067' THEN 'Brazil Fuel Indexer' WHEN OBJECTCODE='540000068' THEN 'Brazil Beverage Indexer' WHEN OBJECTCODE='1210000000' THEN 'Cockpit Main Table' WHEN OBJECTCODE='1250000001' THEN 'Inventory Transfer Request' WHEN OBJECTCODE='1250000025' THEN 'Blanket Agreement' WHEN OBJECTCODE='1320000000' THEN 'Key Performance Indicator Package' WHEN OBJECTCODE='1320000002' THEN 'Target Group' WHEN OBJECTCODE='1320000012' THEN 'Campaign' WHEN OBJECTCODE='1320000028' THEN 'Retorno Operation Codes' WHEN OBJECTCODE='1320000039' THEN 'Product Source Code' WHEN OBJECTCODE='1470000000' THEN 'Fixed Assets Depreciation Types' WHEN OBJECTCODE='1470000002' THEN 'Fixed Assets Account Determination' WHEN OBJECTCODE='1470000003' THEN 'Fixed Asset Depreciation Areas' WHEN OBJECTCODE='1470000004' THEN 'Depreciation Type Pools' WHEN OBJECTCODE='1470000032' THEN 'Asset Classes' WHEN OBJECTCODE='1470000046' THEN 'Asset Groups' WHEN OBJECTCODE='1470000048' THEN 'G/L Account Determination Criteria – Inventory' WHEN OBJECTCODE='1470000049' THEN 'Capitalization' WHEN OBJECTCODE='1470000057' THEN 'G/L Account Advanced Rules' WHEN OBJECTCODE='1470000060' THEN 'Credit Memo' WHEN OBJECTCODE='1470000062' THEN 'Bar Code Master Data' WHEN OBJECTCODE='1470000065' THEN 'Inventory Counting' WHEN OBJECTCODE='1470000077' THEN 'Discount Groups' WHEN OBJECTCODE='1470000092' THEN 'Cycle Count Determination' WHEN OBJECTCODE='1470000113' THEN 'Purchase Request' WHEN OBJECTCODE='1620000000' THEN 'Workflow – Task Details'  ELSE 'Addons'  END AS 'Document Type',  T0.[DocDate], T0.[CardCode], T0.[CardName], T2.[ItemCode], T2.[Dscription], T2.[Quantity], T2.[OpenQty],  T0.[ReqName], T1.[U_NAME]   FROM ODRF T0   INNER JOIN OUSR T1 ON T0.[UserSign] = T1.[USERID]  INNER JOIN DRF1 T2 ON T0.[DocEntry] = T2.[DocEntry] INNER JOIN NNM1 T3 ON T3.ObjectCode=T0.[ObjType]  WHERE T0.[DocDate] > GETDATE()-15 AND T0.ObjType='1470000113'
SELECT T0.[DocNum], T0.[DocStatus], T0.[CardCode], T0.[CardName], T0.[DocDate], T0.[DocDueDate], T1.[ItemCode], T1.[Dscription], T1.[Quantity], T1.[Price], T1.[LineTotal] ,t1.openqty  FROM OPOR T0  INNER JOIN POR1 T1 ON T0.[DocEntry] = T1.[DocEntry]  where T1.ITEMCODE = [%0]
SELECT DISTINCT T0.DocEntry, T0.DocNum,T0.DocDate,  T1.ItemCode, T1.Dscription, T1.Quantity, T2.U_NAME AS 'Requested By',  --CASE WHEN T3.BFType='A' THEN 'Added' WHEN T3.BFType='U' THEN 'Modified' END AS 'Doc Log',  CASE WHEN T3.ProcesStat = 'A' THEN 'Generated by Authorizer'       WHEN T3.ProcesStat = 'P' THEN 'Generated' END AS 'PR Added By', CASE WHEN T3.[Status]='Y' THEN 'Approved' WHEN T3.[Status]='W' THEN 'Pending' WHEN T3.[Status]='N' THEN 'Rejected' END AS 'PR STATUS', T3.CreateTime, T5.U_NAME AS 'Approved By',  T4.UpdateDate as 'Approved Dt.',T4.UpdateTime as 'Approved Time', DATEDIFF(Day,T0.DocDate,T4.UpdateDate) AS DateDifference  FROM ODRF T0 INNER JOIN DRF1 T1 ON T0.DocEntry=T1.DocEntry LEFT JOIN OUSR T2 ON T2.USERID=T0.UserSign LEFT JOIN OWDD T3 ON T3.DraftEntry=T0.DocEntry AND T0.ObjType=T3.ObjType LEFT JOIN WDD1 T4 ON T4.WddCode = T3.WddCode LEFT JOIN OUSR T5 ON T4.USERID = T5.USERID  WHERE T0.DOCDATE> GETDATE()-30 AND T0.ObjType='1470000113' and T0.CANCELED<>'Y'
declare @Fdate varchar(100) declare   @Tdate varchar(100)          declare   @Location varchar(100) SET @Fdate = /* SELECT FROM dbo.OINV T0 WHERE T0.DocDate >= */ '[%0]' SET @Tdate = /* SELECT FROM dbo.OINV T0 WHERE T0.DocDate <= */ '[%1]' SET @Location=(select s2.location from DBO.OLCT s2 where s2.location=[%2]) Exec UNEE_SALE_TAX_REGISTER_DOCWISE @Fdate,@Tdate,@Location
declare @Fdate varchar(100) declare   @Tdate varchar(100)          declare   @Location varchar(100)  SET @Fdate = /* SELECT FROM dbo.OINV T0 WHERE T0.DocDate >= */ '[%0]' SET @Tdate = /* SELECT FROM dbo.OINV T0 WHERE T0.DocDate <= */ '[%1]'  SET @Location=(select s2.location from DBO.OLCT s2 where s2.location=[%2])  Exec UNEE_SALE_TAX_REGISTER @Fdate,@Tdate,@Location
declare @Fdate varchar(100) declare   @Tdate varchar(100)          declare   @Location varchar(100) SET @Fdate = /* SELECT FROM dbo.OINV T0 WHERE T0.DocDate >= */ '[%0]' SET @Tdate = /* SELECT FROM dbo.OINV T0 WHERE T0.DocDate <= */ '[%1]' SET @Location=(select s2.location from DBO.OLCT s2 where s2.location=[%2]) Exec UNEE_PURCHASE_TAX_REGISTER_DOCWISE @Fdate,@Tdate,@Location
declare @Fdate varchar(100) declare   @Tdate varchar(100)          declare   @Location varchar(100) SET @Fdate = /* SELECT FROM dbo.OINV T0 WHERE T0.DocDate >= */ '[%0]' SET @Tdate = /* SELECT FROM dbo.OINV T0 WHERE T0.DocDate <= */ '[%1]' SET @Location=(select s2.location from DBO.OLCT s2 where s2.location=[%2]) Exec UNEE_PURCHASE_TAX_REGISTER_DOCWISE_Service @Fdate,@Tdate,@Location
declare @Fdate varchar(100) declare   @Tdate varchar(100)          declare   @Location varchar(100) SET @Fdate = /* SELECT FROM dbo.OINV T0 WHERE T0.DocDate >= */ '[%0]' SET @Tdate = /* SELECT FROM dbo.OINV T0 WHERE T0.DocDate <= */ '[%1]' SET @Location=(select s2.location from DBO.OLCT s2 where s2.location=[%2]) Exec UNEE_PURCHASE_TAX_REGISTER_ITEM @Fdate,@Tdate,@Location
Select T0.itemcode,T0.Dscription,T0.ShipDate,Sum(T0.Quantity) as 'Total QTY',Sum(T0.OpenQty) as 'Open QTY',  Sum(T0.Quantity) -Sum(T0.OpenQty) as Dispatched    from RDR1 T0 Group By T0.itemcode,T0.Dscription,T0.ShipDate
SELECT T0.[CardCode], T0.[CardName], T0.[DocDate], T0.[DocDueDate], T0.[NumAtCard],T1.[ItemCode], T1.[Dscription], T1.[Quantity], T1.[WhsCode],T1.ShipDate  FROM OINV T0  INNER JOIN INV1 T1 ON T0.[DocEntry] = T1.[DocEntry]
SELECT  Distinct T0.[DocNum],T0.[PostDate], T0.[ItemCode], T2.[ItemName], T0.[PlannedQty], T0.[CmpltQty] , (T0.[PlannedQty]- T0.[CmpltQty]) as 'Balance Qty' FROM OWOR T0   INNER JOIN OITT T1 ON T0.ItemCode = T1.Code  INNER JOIN OITM T2 ON T1.Code = T2.ItemCode  INNER JOIN WOR1 T3 ON T0.DocEntry = T3.DocEntry Order By T0.DocNum
SELECT t0.docentry,T0.CardName, T0.CardCode, T0.DocNum, t0.numatcard as 'Party PO No', T0.DocDate,   T1.ShipDate,T1.ItemCode, T1.Dscription,  T1.Price,T1.Quantity, T1.DelivrdQty ,T1.OpenQty   FROM  ORDR T0 INNER JOIN RDR1 T1 ON T1.DOCENTRY = T0.DOCENTRY WHERE T1.LINESTATUS = 'O' and T1.ShipDate >= [%1] and T1.ShipDate <= [%2]  ORDER BY T1.ShipDate
SELECT T1.Father, t2.ItemName, T1.QUANTITY   FROM ITT1 T1  inner join OITM T2 on t1.father = t2.ItemCode  WHERE T1.Code = '[%0]'
Declare @FromDate Datetime Declare @ToDate Datetime Declare @Whse nvarchar(10) select @FromDate = min(S0.Docdate) from dbo.OINM S0 where S0.Docdate >='[%0]' select @ToDate = max(S1.Docdate) from dbo.OINM s1 where S1.Docdate <='[%1]' select @Whse = Max(s2.Warehouse) from dbo.OINM S2 Where S2.Warehouse = '[%2]' Select @Whse as 'Warehouse', a.Itemcode, max(a.Dscription) as ItemName, sum(a.OpeningBalance) as OpeningBalance, sum(a.INq) as 'IN', sum(a.OUT) as OUT, ((sum(a.OpeningBalance) + sum(a.INq)) - Sum(a.OUT)) as Closing , (Select i.InvntryUom from OITM i where i.ItemCode=a.Itemcode) as UOM from( Select N1.Warehouse, N1.Itemcode, N1.Dscription, (sum(N1.inqty)-sum(n1.outqty)) as OpeningBalance, 0 as INq, 0 as OUT From dbo.OINM N1 Where N1.DocDate < @FromDate and N1.Warehouse = @Whse Group By N1.Warehouse,N1.ItemCode, N1.Dscription Union All select N1.Warehouse, N1.Itemcode, N1.Dscription, 0 as OpeningBalance, sum(N1.inqty) , 0 as OUT From dbo.OINM N1 Where N1.DocDate >= @FromDate and N1.DocDate <= @ToDate and N1.Inqty >0 and N1.Warehouse = @Whse Group By N1.Warehouse,N1.ItemCode,N1.Dscription Union All select N1.Warehouse, N1.Itemcode, N1.Dscription, 0 as OpeningBalance, 0 , sum(N1.outqty) as OUT From dbo.OINM N1 Where N1.DocDate >= @FromDate and N1.DocDate <=@ToDate and N1.OutQty > 0 and N1.Warehouse = @Whse Group By N1.Warehouse,N1.ItemCode,N1.Dscription) a, dbo.OITM I1 where a.ItemCode=I1.ItemCode Group By a.Itemcode Having sum(a.OpeningBalance) + sum(a.INq) + sum(a.OUT) > 0 Order By a.Itemcode
/* select from [dbo].[@JWHD] T0 */  Declare @DocDateFrom varchar(50);  SET @DocDateFrom = /* T0."U_ORDT" */ '[%0]';  /* select from [dbo].[@JWHD] T1 */  Declare @DocDateTo varchar(50);  SET @DocDateTo = /* T1."U_ORDT" */ '[%1]';   CREATE TABLE #TEMP(RowNumber int ,DocEntry INT,[Ref No ] nvarchar(20),RefDate nvarchar(50),[Party Name] nvarchar(100),[Material Code] nvarchar(50),[Material Name] nvarchar(100), [Uom(ISSUED)] nvarchar(20),Issued Decimal(10,4),[Uom(Received)] nvarchar(20),Received Decimal(10,4),[Uom(BAL)]  nvarchar(20),[Bal Qty] Decimal(10,4),[Bill No.] nvarchar(30),[Bill Date] dateTime, [Item Code] nvarchar(100),[Item Name] nvarchar(100),[Bop(UOM)] nvarchar(20),[Bop(QTY)] Decimal(10,4),TempBalQty Decimal(10,4))  INSERT #TEMP(RowNumber, DocEntry, [Ref No ],RefDate,[Party Name],[Material Code],[Material Name],[Uom(ISSUED)],Issued,[Uom(Received)],Received,[Uom(BAL)],[Bal Qty],[Bill No.], [Bill Date] ,[Item Code],[Item Name],[Bop(UOM)],[Bop(QTY)],TempBalQty)     select Row_Number() OVER(Partition By [@JWHD].DocEntry ORDER BY [@JWHD].DocEntry ASC) 'RowNumber', [@JWHD].DocEntry , Cast(OWTR.Docnum As Nvarchar(50)) +'201816' 'Ref No',OWTR.DocDate as 'RefDate',OWTR.CardName 'Party Name', wtr1.ItemCode 'Material Code',wtr1.Dscription 'Material Name',Isnull(OITM.InvntryUom,'')'Uom(ISSUED)', wtr1.Quantity 'Issued',Isnull(IGE1.unitMsr,'') 'Uom(Received)' ,Isnull(IGE1.Quantity,0)  'Received',Isnull(OITM.InvntryUom,'')'Uom(BAL)',(Isnull(wtr1.Quantity,0)-Isnull(IGE1.Quantity,0))'Bal Qty' ,Isnull(OIGN.Ref2,'') 'Bill No.',Isnull(OIGN.DocDate,GETDATE()) 'Bill Date' ,Isnull(IGN1.ItemCode,'') 'Item Code',Isnull(IGN1.Dscription,'') 'Item Name',Isnull(IGN1.unitMsr,'') 'Bop(UOM)', Isnull(IGN1.Quantity,0) 'Bop(QTY)',0 AS TempBalQty from [@JWHD]  Inner Join [@JWDET] on  [@JWDET]  .DocEntry =[@JWHD].DocEntry  Inner Join [@JWDETCHILD] on [@JWDETCHILD] .DocEntry =[@JWHD].DocEntry  INNER Join OWTR ON [@JWDETCHILD].U_INVE = OWTR.DocEntry  Inner Join WTR1 On Wtr1.docentry = Owtr.docentry Inner Join OITM ON OITM.ItemCode=WTR1.ItemCode Left JOIN oign on  OIGN.U_JBNO = [@JWHD].DocEntry  left Join Ign1 on OIGN.docentry = Ign1.docentry Left JOIN OIGE on  OIGE.U_JBNO = [@JWHD].DocEntry  left Join IGE1 on OIGE.docentry = IGE1.docentry  where [@JWHD].U_ORDT between @DocDateFrom and @DocDateTo  AND  OIGE.U_RFPN=OIGN.DocNum and IGE1.VisOrder = IGN1.VisOrder  group by [@JWHD].DocEntry , OWTR.Docnum, OWTR.DocDate ,OWTR.CardName,wtr1.ItemCode ,wtr1.Dscription,OITM.InvntryUom,wtr1.Quantity ,IGE1.unitMsr,IGE1.Quantity ,OIGN.Ref2,OIGN.DocDate ,IGN1.ItemCode,IGN1.Dscription,IGN1.unitMsr,Isnull(IGN1.Quantity,0) ORDER BY DocEntry; DECLARE @i int ,@rt Decimal(10,4), @RowNo INT,@PreviousDocEntry INT,@NextDocEntry INT, @DocEntry INT, @Issued Decimal(10,4),@Received Decimal(10,4),@TempBalQty Decimal(10,4); SET @rt = 0; DECLARE c CURSOR LOCAL STATIC READ_ONLY FORWARD_ONLY   FOR SELECT RowNumber,DocEntry,Issued,Received FROM #TEMP ORDER BY DocEntry,RowNumber; OPEN c; FETCH c INTO @RowNo,@DocEntry, @Issued,@Received; Select @TempBalQty= IsNull(TempBalQty,0) From #TEMP Where RowNumber=@RowNo - 1 And DocEntry= @DocEntry ORDER BY DocEntry,RowNumber SET @PreviousDocEntry=@DocEntry SET @NextDocEntry=0 WHILE @@FETCH_STATUS = 0 BEGIN IF @PreviousDocEntry!=@NextDocEntry BEGIN   SET @rt = @Issued - @Received;   SET @i=0;   END   ELSE IF @PreviousDocEntry=@NextDocEntry   BEGIN   SET @rt = @TempBalQty - @Received;   END   UPDATE #TEMP SET [Bal Qty] = @rt WHERE RowNumber = @RowNo And DocEntry= @DocEntry;   UPDATE #TEMP SET TempBalQty = @rt WHERE RowNumber = @RowNo And DocEntry= @DocEntry;   SET @TempBalQty=0   SET @rt=0   SET @PreviousDocEntry=@DocEntry   FETCH c INTO @RowNo,@DocEntry, @Issued,@Received;   Select @TempBalQty= IsNull(TempBalQty,0) From #TEMP Where RowNumber=@RowNo - 1 And DocEntry= @DocEntry ORDER BY DocEntry,RowNumber   SET @NextDocEntry=@DocEntry END CLOSE c; DEALLOCATE c; Select DocEntry, [Ref No ],RefDate,[Party Name],[Material Code],[Material Name],[Uom(ISSUED)],Issued,[Uom(Received)],Received,[Uom(BAL)],[Bal Qty],[Bill No.], [Bill Date] ,[Item Code],[Item Name],[Bop(UOM)],[Bop(QTY)] From #TEMP DROP TABLE  #TEMP
/* select from [dbo].[@JWHD] T0 */  Declare @DocDateFrom varchar(50);  SET @DocDateFrom = /* T0."U_ORDT" */ '[%0]';  /* select from [dbo].[@JWHD] T1 */  Declare @DocDateTo varchar(50);  SET @DocDateTo = /* T1."U_ORDT" */ '[%1]';   CREATE TABLE #TEMP(RowNumber int ,DocEntry INT,[Ref No ] nvarchar(20),RefDate nvarchar(50),[Party Name] nvarchar(100),[Material Code] nvarchar(50),[Material Name] nvarchar(100), [Uom(ISSUED)] nvarchar(20),Issued Decimal(10,4),[Uom(Received)] nvarchar(20),Received Decimal(10,4),[Uom(BAL)]  nvarchar(20),[Bal Qty] Decimal(10,4),[Bill No.] nvarchar(30),[Bill Date] dateTime, [Item Code] nvarchar(100),[Item Name] nvarchar(100),[Bop(UOM)] nvarchar(20),[Bop(QTY)] Decimal(10,4),TempBalQty Decimal(10,4))  INSERT #TEMP(RowNumber, DocEntry, [Ref No ],RefDate,[Party Name],[Material Code],[Material Name],[Uom(ISSUED)],Issued,[Uom(Received)],Received,[Uom(BAL)],[Bal Qty],[Bill No.], [Bill Date] ,[Item Code],[Item Name],[Bop(UOM)],[Bop(QTY)],TempBalQty)   SELECT  Row_Number() OVER(Partition By JWIR.DocEntry ORDER BY JWIR.DocEntry ASC) 'RowNumber',*     FROM ( SELECT  [@JWHD].DocEntry , Cast(OWTR.Docnum As Nvarchar(50)) +'201816' 'Ref No',OWTR.DocDate as 'RefDate',OWTR.CardName 'Party Name',                            wtr1.ItemCode 'Material Code',wtr1.Dscription 'Material Name',Isnull(OITM.InvntryUom,'')'Uom(ISSUED)',                            wtr1.Quantity 'Issued',Isnull(IGE1.unitMsr,'') 'Uom(Received)'                            ,Isnull(IGE1.Quantity,0)  'Received',Isnull(OITM.InvntryUom,'')'Uom(BAL)',(Isnull(wtr1.Quantity,0)-Isnull(IGE1.Quantity,0))'Bal Qty'                            ,Isnull(IGN1.Ref2,'') 'Bill No.',Isnull(IGN1.DocDate,GETDATE()) 'Bill Date'                            ,Isnull(IGN1.ItemCode,'') 'Item Code',Isnull(IGN1.Dscription,'') 'Item Name',Isnull(IGN1.unitMsr,'') 'Bop(UOM)', Isnull(IGN1.Quantity,0) 'Bop(QTY)',0 AS TempBalQty                                    FROM [@JWHD]                             Inner Join [@JWDET] on  [@JWDET].DocEntry =[@JWHD].DocEntry                             Inner Join [@JWDETCHILD] on [@JWDETCHILD] .DocEntry =[@JWHD].DocEntry                             INNER Join OWTR ON [@JWDETCHILD].U_INVE = OWTR.DocEntry                             Inner Join WTR1 On Wtr1.docentry = Owtr.docentry                            Inner Join OITM ON OITM.ItemCode=WTR1.ItemCode                            LEFT JOIN (                                      SELECT T0.DocEntry , T0.U_JBNO ,T3.U_POEN ,T3.U_POIT ,T3.U_POLN  ,T3.U_JWFLN ,T1.unitMsr,T1.Quantity                                                  FROM OIGE T0 INNER JOIN IGE1 T1 ON T0.DocEntry = T1.DocEntry                                                  INNER JOIN [@DD_FGSELECTION] T2 ON T2.DocEntry = T0.U_FGEN                                                   INNER JOIN [@DR_FGSELECTION]  T3 ON T3.DocEntry = T2.DocEntry  AND T3.LineId = T1.U_FGLNO                                                 WHERE  ISNULL(T0.U_JWTR,'NO') ='NO' AND ISNULL(T3.U_CHK,'N')='Y'                                         ) IGE1  ON IGE1.U_JBNO = [@JWDET].DocEntry AND  IGE1.U_POEN =[@JWDET].U_POEN   AND IGE1.U_POIT =[@JWDET].U_ITCD                                         AND IGE1.U_POLN =[@JWDET].U_POLN  AND IGE1.U_JWFLN = [@JWDET].LineId                             LEFT JOIN (                                    SELECT T0.U_JBNO ,T0.U_GISE ,T1.ItemCode ,T1.U_CHLN,T0.Ref2,T0.DocDate ,T1.unitMsr,T1.Dscription,T1.Quantity                                           FROM OIGN T0 INNER JOIN IGN1 T1 ON T0.DocEntry = T1.DocEntry                                           WHERE ISNULL(T0.U_JWTR,'NO') ='NO'                                      )  IGN1 ON  IGN1.U_GISE =IGE1.DocEntry  AND  IGN1.U_JBNO = IGE1.U_JBNO  AND IGN1.ItemCode = IGE1.U_POIT  AND IGN1.U_CHLN = IGE1.U_JWFLN                              WHERE  ([@JWHD].U_ORDT BETWEEN @DocDateFrom  and @DocDateTo  )                               AND  ISNULL([@JWDETCHILD].U_CHCD,'') !=''  AND ISNULL([@JWDET].U_ITCD,'') !=''            UNION                  SELECT   [@JWHD].DocEntry , Cast(OWTR.Docnum As Nvarchar(50)) +'201816' 'Ref No',OWTR.DocDate as 'RefDate',OWTR.CardName 'Party Name',                            wtr1.ItemCode 'Material Code',wtr1.Dscription 'Material Name',Isnull(OITM.InvntryUom,'')'Uom(ISSUED)',                            wtr1.Quantity 'Issued',Isnull(IGE1.unitMsr,'') 'Uom(Received)'                            ,Isnull(IGE1.Quantity,0)  'Received',Isnull(OITM.InvntryUom,'')'Uom(BAL)',(Isnull(wtr1.Quantity,0)-Isnull(IGE1.Quantity,0))'Bal Qty'                            ,Isnull(IGN1.Ref2,'') 'Bill No.',Isnull(IGN1.DocDate,GETDATE()) 'Bill Date'                            ,Isnull(IGN1.ItemCode,'') 'Item Code',Isnull(IGN1.Dscription,'') 'Item Name',Isnull(IGN1.unitMsr,'') 'Bop(UOM)', Isnull(IGN1.Quantity,0) 'Bop(QTY)',0 AS TempBalQty                                    FROM [@JWHD]                             Inner Join [@JWDETCHILD] on [@JWDETCHILD] .DocEntry =[@JWHD].DocEntry                             INNER Join OWTR ON [@JWDETCHILD].U_INVE = OWTR.DocEntry                             Inner Join WTR1 On Wtr1.docentry = Owtr.docentry                            Inner Join OITM ON OITM.ItemCode=WTR1.ItemCode                            LEFT JOIN (                                    SELECT T0.DocEntry , T0.U_JBNO ,T1.unitMsr,T1.Quantity                                    FROM OIGE T0 INNER JOIN IGE1 T1 ON T0.DocEntry = T1.DocEntry                                    INNER JOIN [@DD_SCPSELECTION] T2 ON T2.DocEntry = T0.U_SCPEN                                     INNER JOIN [@DR_SCPSELECTION]  T3 ON T3.DocEntry = T2.DocEntry  AND T3.LineId = T1.U_FGLNO                                   WHERE  ISNULL(T0.U_JWTR,'NO') ='NO' AND ISNULL(T3.U_CHK,'N')='Y'                                      ) IGE1  ON IGE1.U_JBNO = [@JWHD].DocEntry                             LEFT JOIN (                                     SELECT T0.U_JBNO ,T0.U_GISE ,T1.ItemCode ,T1.U_CHLN,T0.Ref2,T0.DocDate ,T1.unitMsr,T1.Dscription,T1.Quantity                                     FROM OIGN T0 INNER JOIN IGN1 T1 ON T0.DocEntry = T1.DocEntry                                     WHERE ISNULL(T0.U_JWTR,'NO') ='NO'                                     )  IGN1 ON  IGN1.U_GISE =IGE1.DocEntry  AND  IGN1.U_JBNO = IGE1.U_JBNO                                     WHERE  ([@JWHD].U_ORDT BETWEEN @DocDateFrom  and @DocDateTo )                                     AND  ISNULL([@JWDETCHILD].U_CHCD,'') !=''                    ) AS JWIR WHERE ( ISNULL(JWIR.Received,0) +ISNULL(JWIR.[Bop(QTY)],0))>0   DECLARE @i int ,@rt Decimal(10,4), @RowNo INT,@PreviousDocEntry INT,@NextDocEntry INT, @DocEntry INT, @Issued Decimal(10,4),@Received Decimal(10,4),@TempBalQty Decimal(10,4); SET @rt = 0; DECLARE c CURSOR LOCAL STATIC READ_ONLY FORWARD_ONLY FOR SELECT RowNumber,DocEntry,Issued,Received FROM #TEMP ORDER BY DocEntry,RowNumber; OPEN c; FETCH c INTO @RowNo,@DocEntry, @Issued,@Received; Select @TempBalQty= IsNull(TempBalQty,0) From #TEMP Where RowNumber=@RowNo - 1 And DocEntry= @DocEntry ORDER BY DocEntry,RowNumber SET @PreviousDocEntry=@DocEntry SET @NextDocEntry=0 WHILE @@FETCH_STATUS = 0 BEGIN IF @PreviousDocEntry!=@NextDocEntry BEGIN SET @rt = @Issued - @Received; SET @i=0; END ELSE IF @PreviousDocEntry=@NextDocEntry BEGIN SET @rt = @TempBalQty - @Received; END UPDATE #TEMP SET [Bal Qty] = @rt WHERE RowNumber = @RowNo And DocEntry= @DocEntry; UPDATE #TEMP SET TempBalQty = @rt WHERE RowNumber = @RowNo And DocEntry= @DocEntry; SET @TempBalQty=0 SET @rt=0 SET @PreviousDocEntry=@DocEntry FETCH c INTO @RowNo,@DocEntry, @Issued,@Received; Select @TempBalQty= IsNull(TempBalQty,0) From #TEMP Where RowNumber=@RowNo - 1 And DocEntry= @DocEntry ORDER BY DocEntry,RowNumber SET @NextDocEntry=@DocEntry END CLOSE c; DEALLOCATE c; Select DocEntry, [Ref No ],RefDate,[Party Name],[Material Code],[Material Name],[Uom(ISSUED)],Issued,[Uom(Received)],Received,[Uom(BAL)],[Bal Qty],[Bill No.], [Bill Date] ,[Item Code],[Item Name],[Bop(UOM)],[Bop(QTY)] From #TEMP DROP TABLE  #TEMP
SELECT T0.[DocNum], T0.[DocStatus], T0.[DocType], T0.[CardCode], T0.[CardName], T0.[DocDate], T0.[DocDueDate], T1.[ItemCode], T1.[Dscription], T1.[Quantity], T1.[Price], T1.[LineTotal] FROM OPOR T0  INNER JOIN POR1 T1 ON T0.[DocEntry] = T1.[DocEntry]  where t0.u_poty = [%0] and T0.DocDate >= [%1] and T0.DocDate <= [%2] and T0.DocType = 'I'
SELECT T0.[DocNum] as 'QC Doc No', T0.[U_UTL_PODT], T0.[U_UTL_MODE],T0.[U_UTL_GRDN] as 'MRR NO.',T1.DOCDATE AS 'MRR DATE', T0.[U_UTL_SPCD], T0.[U_UTL_SPNM], T1.NUMATCARD AS 'BILL NO.',T1.TAXDATE AS 'BILL DATE', T0.[U_UTL_QCPIN], T0.[U_UTL_GINM],  T0.[U_UTL_ITCD], T0.[U_UTL_ITNM], T0.[U_UTL_BTSZ], T0.[U_UTL_APPQ], T0.[U_UTL_AINO],  T0.[U_UTL_REJQ], T0.[U_UTL_RINO]   FROM [dbo].[@UTL_OQCHK]  T0  JOIN OPDN T1 ON T1.DOCENTRY = T0.U_UTL_GRDE  where T0.[U_UTL_MODE] = [%0] and T0.[U_UTL_PODT] >= [%1] and T0.[U_UTL_PODT] <= [%2]
SELECT T0.[DocNum], T0.[postDate], T0.[ItemCode]as 'To Item code', T0.[ProdName], T1.ItemCode As [From Item Code], T2.ITEMNAME, T0.[PlannedQty], T0.[CMPLTQTY],T0.[Project] FROM OWOR T0  INNER JOIN WOR1 T1 ON T0.[DocEntry] = T1.[DocEntry]  INNER JOIN OITM T2 ON T1.ITEMCODE = T2.ITEMCODE  WHERE T0.PROJECT = [%0] and T0.postdate >=[%1] and T0.postdate <= [%2]  order by T0.[postDate]
SELECT T0.[CardCode], T0.[CardName], T0.NUMATCARD, T0.[DocDate], T1.[ItemCode], T1.[Dscription], T1.[Quantity], T0.[DocType] FROM ORPC T0  INNER JOIN RPC1 T1 ON T0.[DocEntry] = T1.[DocEntry]  WHERE T0.DocType = 'i' and T0.DocDate >= [%0] and T0.DocDate <=[%1] and T1.whscode = 'REJ1'
SELECT T0.[DocNum], T0.[DocStatus], T0.[CardCode], T0.[CardName], T0.[DocDate], T0.[DocDueDate], T1.[ItemCode], T1.[Dscription], T1.[Quantity], T1.[Price], T1.[LineTotal] FROM OPOR T0  INNER JOIN POR1 T1 ON T0.[DocEntry] = T1.[DocEntry]  where t0.CardName = [%0] and T0.DocDate >= [%1] and T0.DocDate <= [%2] and T0.DocType = 'I'
SELECT T0.[DocNum], T0.U_JB, T0.[CardCode], T0.[CardName], T0.[DocDate], T0.[DocDueDate], T1.[U_ITCD], T1.[U_ITNM], T1.[U_QTY], T1.[U_UPRC] FROM OPOR T0  INNER JOIN POR1 T1 ON T0.[DocEntry] = T1.[DocEntry]  where T0.CARDNAME = [%0]  and T0.DocDate >= [%1] and T0.DocDate <= [%2] and T0.DocType = 'S'
SELECT T0.[DocNum], T0.U_JB, T0.[CardCode], T0.[CardName], T0.[DocDate], T0.[DocDueDate], T1.[U_ITCD], T1.[U_ITNM], T1.[U_QTY], T1.[U_UPRC] FROM OPOR T0  INNER JOIN POR1 T1 ON T0.[DocEntry] = T1.[DocEntry]  where T0.DocDate >= [%1] and T0.DocDate <= [%2] and T0.DocType = 'S'
SELECT DISTINCT T0.[U_INVN] as 'RGP No', T1.DOCENTRY as 'Job Work No', T1.U_ORDT, T1.U_VDNM, T0.[U_CHCD] as 'Item Code', T0.[U_CHNM] as 'Item Name', T0.[U_PLQT], T0.[U_ISQT], T0.[U_BLQT], T1.U_HSTUS FROM [dbo].[@JWDETCHILD]  T0 INNER JOIN [dbo].[@JWHD] T1 ON T0.DOCENTRY=T1.DOCENTRY  WHERE  t0.u_chcd = [%0]
Declare @S Date Declare @E Date Declare @location int Set @S = (Select min(T0.Refdate) from OJDT T0 where T0.refdate >=[%0]) Set @E = (Select max(T1.Refdate) from OJDT T1 where T1.refdate <=[%1]) Set @location = (Select code from OLCT T2 where T2.location ='[%2]')  EXEC utl_HSN @S, @E,@location
SELECT t0.docentry,T0.CardName, T0.CardCode, T0.DocNum, t0.numatcard as 'Party PO No', T0.DocDate, T1.ShipDate , T1.ItemCode, T1.Dscription, T1.Quantity, T1.Price, T1.DelivrdQty, T1.OpenQty   FROM  ORDR T0 INNER JOIN RDR1 T1 ON T1.DOCENTRY = T0.DOCENTRY WHERE T1.LINESTATUS = 'O' and T0.cardname=[%0] and T1.ShipDate >= [%1] and  T1.ShipDate <= [%2]
SELECT T0.[DocNum], T1.[baseref], T0.[DocDate],T1.[ItemCode], T1.[Dscription], T1.[Quantity] FROM OIGN T0  INNER JOIN IGN1 T1 ON T0.[DocEntry] = T1.[DocEntry]  WHERE T1.[baseref] >0 AND T0.DOCDATE >=[%0] AND T0.DOCDATE <=[%1]
SELECT T0.[DocNum],T0.[DocDate], T0.[CardCode], T0.[CardName], T1.[ItemCode], T1.[Dscription], T1.[Quantity], T1.[Price] FROM OPDN T0  INNER JOIN PDN1 T1 ON T0.[DocEntry] = T1.[DocEntry]  where t0.[DocDate] >=[%0] and t0.[DocDate] <=[%1]
SELECT T0.[DocNum]'Invoice No.',T0.[DocDate] 'Invoice Date',t2.BaseRef as 'Sales Order No.', t0.NumAtCard as 'PO no.', t0.TaxDate as 'PO Date.', T0.[CardCode], T0.[CardName], T1.[ItemCode], T1.[Dscription], T1.[Quantity], T1.[Price], T1.[LineTotal]    FROM OINV T0  INNER JOIN INV1 T1 ON T0.[DocEntry] = T1.[DocEntry] inner join DLN1 T2 on  T1.BaseEntry=t2.DocEntry and t1.LineNum=t2.LineNum  where t0.docdate >= [%0] and t0.docdate <= [%1] AND T0.Canceled <> 'Y'
SELECT T0.PostDate as 'Date', t0.ItemCode,T1.ItemName , T0.PlannedQty as 'Planed Quantity', T0.CmpltQty , T0.PlannedQty-T0.CmpltQty as 'Balance Qty', CASE WHEN T0.UserSign='14' THEN 'PLANED' ELSE 'UNPLANED' END AS 'STATUS'  FROM OWOR T0  INNER JOIN OITM T1 ON T0.ITEMCODE = T1.ITEMCODE inner join OUSR T2 on T0.UserSign = T2.USERID   WHERE  T0.PostDate = CONVERT(date,GETDATE()-1) AND T0.Type = 'S' --and    --AND      -- T1.ItmsGrpCod in ('103','100','112')   ---t1.U_SubGroup in ('ELEMENT ASSY' , 'UNPAINTED DAMPER ASSY', 'CAB DAMPER','hcv','STRUT ASSY', 'STRUT DAMPER','DICKY LIFTER','STEERING DAMPER','AIR BELLOW','TOP MOUNTING BUSH KIT','BOTTOM MOUNTING BUSH KIT','COIL SPRING','LCV SHOX','SPARE PARTS','RAILWAY S.A.','MONO TUBE','Finished Goods SubAssy')   order by t0.ItemCode
SELECT  ISNULL(CD.GSTRegnNo,'') AS GSTIN, CONVERT(VARCHAR,ST.eCode) +'-'+IsNull(ST.Name,'') AS [State of Job Worker],Cast(T0.Docnum As Nvarchar(50)) AS 'RGP NO', T0.DocDate  AS [RGP Date], T1.ItemCode AS [Item Code],T1.Dscription AS [Description of Goods], ISNULL(T1.unitMsr,'') AS UoMName , T1.Quantity ,   ISNULL((CASE WHEN T1.PRICE = 0 THEN ISNULL(T1.STOCKPRICE * T1.QUANTITY,0) ELSE ISNULL(T1.PRICE * T1.QUANTITY,0)END),0) AS [Taxable Value],  T2.U_ITTYPE AS [Type of Goods], ISNULL((CASE WHEN ST.Code ='HR' THEN ISNULL(TM.U_RATE,0) END),0) AS [CGST %] ,ISNULL((CASE WHEN ST.Code ='HR' THEN ISNULL(TM.U_RATE,0) END) ,0) AS [SGST %] , ISNULL((CASE WHEN ST.Code !='HR' THEN ISNULL(TM.U_RATE,0) END),0) AS [IGST %] ,ISNULL((CASE WHEN ST.Code !='HR' THEN ISNULL(TM.U_RATE,0) END),0) AS [Cess %]  --ISNULL(T0.U_JVCD,'') AS VendorCode,Isnull(T0.CardCode,'') CardCode ,Isnull(ST.Code,'') Code,Isnull(ST.eCode,0)eCode ,ISnull(ST.Name,'') Name FROM OWTR T0  INNER JOIN WTR1 T1 ON T0.DocEntry =T1.DocEntry   INNER JOIN OITM T2 ON T1.ITEMCODE = T2.ITEMCODE  LEFT JOIN CRD1 CD ON CD.CardCode =  T0.U_JVCD  AND  CD.Address = T0.ShipToCode AND CD.AdresType='S' LEFT JOIN OCRY C ON C.Code = CD.Country  LEFT JOIN OCST ST ON ST.Code = CD.State AND ST.Country = C.Code  INNER JOIN OITM TM ON  TM.ItemCode = T1.ItemCode  WHERE  ISNULL(T0.U_JBNO,'') !=''  AND T0.DOCDATE >= [%0] AND T0.DOCDATE<=[%1]
SELECT T0.[DocNum], T1.[baseref], T0.[DocDate],T1.[ItemCode], T1.[Dscription], T1.[Quantity] FROM OIGN T0  INNER JOIN IGN1 T1 ON T0.[DocEntry] = T1.[DocEntry]  WHERE T1.[baseref] >0 AND T0.DOCDATE >=[%0] AND T0.DOCDATE <=[%1] and t1.itemcode = [%2]
SELECT DISTINCT T0.[DocNum] AS 'PROD ORDER NUM', T0.startdate AS 'START DATE', T0.[ItemCode] AS 'PRODUCTION CODE', T0.PRODNAME AS 'PRODUCTION NAME',  T0.PLANNEDQTY AS 'PLAN QTY', T0.CmpltQty AS 'COMP QTY', T2.Code,T3.ItemName, T1.[BaseQty] AS 'PROD BASE QTY', T2.QUANTITY AS 'STD BOM QTY', (T0.CmpltQty*T2.Quantity) AS 'BOM QTY' ,T1.[IssuedQty] AS 'ACTUAL CONS', (T0.CmpltQty*T2.Quantity)- T1.ISSUEDQTY AS 'DIFF'   FROM OWOR T0  INNER JOIN WOR1 T1 ON T0.[DocEntry] = T1.[DocEntry] JOIN ITT1 T2 ON T0.ITEMCODE = T2.FATHER and T1.ItemCode = t2.Code join OITM t3 on t1.ItemCode = t3.ItemCode and t2.code=t3.ItemCode  where t0.docnum >='1900001' AND T0.CmpltQty<> '0' and t0.startdate >=[%0] and t0.startdate <=[%1]
SELECT T0.[DocNum], T0.U_JB, T0.[CardCode], T0.[CardName], T0.[DocDate], T0.[DocDueDate], T1.[U_ITCD], T1.[U_ITNM], T1.[U_QTY], T1.[U_UPRC] FROM OPOR T0  INNER JOIN POR1 T1 ON T0.[DocEntry] = T1.[DocEntry]  where t0.doctype='s' and t0.u_jb='y'  and t0.docstatus !='c' and T1.[U_ITCD]=[%0]
SELECT T0.[DocNum], T0.[DocDate], T0.[CardCode], T0.[CardName], T3.GROUPNAME, t1.acctcode, t4.acctname,T1.[ItemCode], T1.[Dscription], T1.[Quantity], (T1.[LineTotal]) / T1.quantity AS         [UNIT PRICE], T1.[LineTotal] As 'Total', T0.[DiscPrcnt] FROM OINV T0    INNER JOIN INV1 T1 ON T0.[DocEntry] = T1.[DocEntry]  inner join ocrd t2 on t0.cardcode = t2.cardcode  INNER JOIN OCRG T3 ON T2.GROUPCODE=T3.GROUPCODE  inner join oact t4 on t1.acctcode = t4.acctcode  WHERE T0.DOCDATE >= [%0] AND T0.DOCDATE <= [%1] and t0.DocType = 'i'
Declare @FromDate Datetime Declare @ToDate Datetime Declare @Whse nvarchar(10) select @FromDate = min(S0.Docdate) from dbo.OINM S0 where S0.Docdate >='[%0]' select @ToDate = max(S1.Docdate) from dbo.OINM s1 where S1.Docdate <='[%1]' select @Whse = Max(s2.Warehouse) from dbo.OINM S2 Where S2.Warehouse = '[%2]' Select @Whse as 'Warehouse', a.Itemcode, max(a.Dscription) as ItemName,   (Select j.ItmsGrpNam from OITM i inner join oitb j on i.ItmsGrpCod=j.ItmsGrpCod where i.ItemCode=a.Itemcode) as ItemGroup, sum(a.OpeningBalance) as OpeningBalance, sum(a.INq) as 'IN', sum(a.OUT) as OUT, ((sum(a.OpeningBalance) + sum(a.INq)) - Sum(a.OUT)) as Closing , (Select i.InvntryUom from OITM i where i.ItemCode=a.Itemcode) as UOM, (Select i.lastpurprc from OITM i where i.ItemCode=a.Itemcode) as Price, ((Select i.lastpurprc from OITM i where i.ItemCode=a.Itemcode) *((sum(a.OpeningBalance) + sum(a.INq)) - Sum(a.OUT))) as 'Total' from( Select N1.Warehouse, N1.Itemcode, N1.Dscription, (sum(N1.inqty)-sum(n1.outqty)) as OpeningBalance, 0 as INq, 0 as OUT From dbo.OINM N1 Where N1.DocDate < @FromDate and N1.Warehouse = @Whse Group By N1.Warehouse,N1.ItemCode, N1.Dscription Union All select N1.Warehouse, N1.Itemcode, N1.Dscription, 0 as OpeningBalance, sum(N1.inqty) , 0 as OUT From dbo.OINM N1 Where N1.DocDate >= @FromDate and N1.DocDate <= @ToDate and N1.Inqty >0 and N1.Warehouse = @Whse Group By N1.Warehouse,N1.ItemCode,N1.Dscription Union All select N1.Warehouse, N1.Itemcode, N1.Dscription, 0 as OpeningBalance, 0 , sum(N1.outqty) as OUT From dbo.OINM N1 Where N1.DocDate >= @FromDate and N1.DocDate <=@ToDate and N1.OutQty > 0 and N1.Warehouse = @Whse Group By N1.Warehouse,N1.ItemCode,N1.Dscription) a, dbo.OITM I1 where a.ItemCode=I1.ItemCode Group By a.Itemcode Having sum(a.OpeningBalance) + sum(a.INq) + sum(a.OUT) > 0 Order By a.Itemcode
SELECT T0.[DocNum], T0.[U_UTL_PODT], T0.[U_UTL_MODE], T0.[U_UTL_GRDN], T1.CARDCODE, T1.CARDNAME, T0.[U_UTL_ITCD], T0.[U_UTL_ITNM], T0.[U_UTL_BTSZ], T0.[U_UTL_APPQ], T0.[U_UTL_AINO], T0.[U_UTL_REJQ], T0.[U_UTL_RINO] FROM [dbo].[@UTL_OQCHK]  T0   INNER JOIN OPDN T1 ON T0.[U_UTL_GRDN]=T1.DOCNUM  Where T0.[U_UTL_mode] = 'grpo' AND T0.[U_UTL_PODT] >= [%0] AND T0.[U_UTL_PODT] <= [%1]  ORDER BY T0.[U_UTL_GRDN]
SELECT T4.DOCNUM AS 'MRR NO', T4.DOCDATE AS 'MRR DATE', T0.[DocNum] AS 'A/P INV No', T0.[DocDate] AS 'A/P INV Date', T0.[CardName] as 'Supplier Name', T3.[GSTRegnNo] AS 'GST NO',T0.[NumAtCard] As 'Invoice No',T0.[TaxDate] as 'Invoice Date',  T1.[ItemCode], T1.[Dscription], T1.[unitMsr] as 'UOM', T2.CHAPTER AS 'HSN', T5.U_ITTYPE AS 'ITEM TYPE', T1.[Quantity], T1.[Price] AS 'Unit Price',T1.[LineTotal] as 'Taxble Amount', CASE WHEN T1.[TaxCode] Like '%%CSGST%%'  THEN T1.[VatPrcnt]/2  END AS 'CGST Rate', CASE WHEN T1.[TaxCode] Like '%%CSGST%%'  THEN T1.[VatPrcnt]/2  END AS 'SGST Rate',  CASE WHEN T1.[TaxCode] Like '%%CSGST%%'  THEN T1.[VatSum]/2  END AS 'CGST Amount', CASE WHEN T1.[TaxCode] Like '%%CSGST%%'  THEN T1.[Vatsum]/2  END AS 'SGST Amount', CASE WHEN T1.[TaxCode] Like '%%IGST%%'  THEN T1.[VatPrcnt] END AS 'IGST Rate', CASE WHEN T1.[TaxCode] Like '%%IGST%%'  THEN T1.[Vatsum] END AS 'IGST Amount', (t1.linetotal + t1.vatsum) as 'Total Amount' , T7.ACCTNAME AS 'G/L Account'  FROM OPCH T0    INNER JOIN PCH1 T1 ON T0.[DocEntry] = T1.[DocEntry] INNER JOIN OCHP T2 ON T1.HSNENTRY = T2.ABSENTRY INNER JOIN CRD1 T3 ON T0.CARDCODE = T3.CARDCODE INNER JOIN OPDN T4 ON T1.[BaseDocNum] = T4.DOCNUM INNER JOIN PDN1 T6 ON T4.DOCENTRY = T6.DOCENTRY INNER JOIN OITM T5 ON T1.[ItemCode] = T5.ITEMCODE inner join oact t7 on t6.acctcode = t7.acctcode  where T0.DOCTYPE = 'I' and t0.docdate >= [%0] and t0.docdate<=[%1]  ORDER BY T0.DOCDATE
SELECT DISTINCT T0.[U_INVN] as 'RGP No', T1.DOCENTRY as 'Job Work No', T1.U_ORDT, T1.U_VDNM, T0.[U_CHCD] as 'Item Code', T0.[U_CHNM] as 'Item Name', T0.[U_PLQT], T0.[U_ISQT], T0.[U_BLQT], T1.U_HSTUS FROM [dbo].[@JWDETCHILD], T1.U_ORDT - GETDATE()) T0 INNER JOIN [dbo].[@JWHD] T1 ON T0.DOCENTRY=T1.DOCENTRY  WHERE T1.U_HSTUS='o' and t1.u_vdnm = [%1] and t0.docentry >=499 AND T0.u_INVN != ''
SELECT DISTINCT T0.[U_INVN] as 'RGP No', T1.DOCENTRY as 'Job Work No', T1.U_ORDT, T1.U_VDNM, T0.[U_CHCD] as 'Item Code', T0.[U_CHNM] as 'Item Name', T0.[U_PLQT], T0.[U_ISQT], T0.[U_BLQT], T1.U_HSTUS FROM [dbo].[@JWDETCHILD] T0 INNER JOIN [dbo].[@JWHD] T1 ON T0.DOCENTRY=T1.DOCENTRY  WHERE  --T1.U_HSTUS='o' and   t1.u_vdnm = [%1] and T0.u_INVN != '' and t1.u_ordt >=[%2] and t1.u_ordt <=[%3]  order by t1.u_ordt
SELECT T0.[DocNum], T0.[DocStatus], T0.[CardCode], T0.[CardName], T0.[DocDate], T0.[DocDueDate], T1.[ItemCode], T1.[Dscription], T1.[Quantity], T1.[Price], T1.[LineTotal] FROM OPOR T0  INNER JOIN POR1 T1 ON T0.[DocEntry] = T1.[DocEntry]  where T0.[DocStatus] = 'o' and U_poty = 'SCHEDULE' AND T0.[DocDate] <= [%0]  ORDER BY T0.DOCDATE
SELECT T0.[DocNum], T0.[DocDate], t3.acctname as 'G/L Account', T0.[CardName] as 'Supplier Name', T0.[NumAtCard] As 'Invoice No',T0.[TaxDate] as 'Invoice Date', T1.[u_ITCD], CASE WHEN T1.U_ITNM IS NULL THEN T1.[Dscription] ELSE T1.u_ITNM END AS 'ITEM/SERVICE DESCRIPTION', T1.[u_qty], T1.[u_uprc] AS 'Unit Price',T1.[LineTotal] as 'Taxble Amount',T1.[TaxCode], T2.[ServCode], CASE WHEN T1.[TaxCode] Like '%%CSGST%%'  THEN T1.[VatPrcnt]/2  END AS 'CGST Rate', CASE WHEN T1.[TaxCode] Like '%%CSGST%%'  THEN T1.[VatPrcnt]/2  END AS 'SGST Rate',  CASE WHEN T1.[TaxCode] Like '%%CSGST%%'  THEN T1.[VatSum]/2  END AS 'CGST Amount', CASE WHEN T1.[TaxCode] Like '%%CSGST%%'  THEN T1.[Vatsum]/2  END AS 'SGST Amount', CASE WHEN T1.[TaxCode] Like '%%IGST%%'  THEN T1.[VatPrcnt] END AS 'IGST Rate', CASE WHEN T1.[TaxCode] Like '%%IGST%%'  THEN T1.[Vatsum] END AS 'IGST Amount', (t1.linetotal + t1.vatsum) as 'Total Amount' FROM OPCH T0    INNER JOIN PCH1 T1 ON T0.[DocEntry] = T1.[DocEntry] INNER JOIN OSAC T2 on t1.sacentry = t2.absentry inner join oact t3 on t1.acctcode = t3.acctcode  where T0.DOCTYPE = 'S' AND T0.DOCDATE >= [%1] AND T0.DOCDATE <= [%2] ORDER BY T0.DOCDATE
SELECT T0.[DocNum], T0.[DocDate], T0.[CardCode], T0.[CardName], T3.GROUPNAME, t1.acctcode, t4.acctname,T1.[ItemCode], T1.[Dscription], T1.[Quantity], (T1.[LineTotal]) / T1.quantity AS         [UNIT PRICE], T1.[LineTotal] As 'Total', T0.[DiscPrcnt] FROM OINV T0    INNER JOIN INV1 T1 ON T0.[DocEntry] = T1.[DocEntry]  inner join ocrd t2 on t0.cardcode = t2.cardcode  INNER JOIN OCRG T3 ON T2.GROUPCODE=T3.GROUPCODE  inner join oact t4 on t1.acctcode = t4.acctcode  WHERE T0.DOCDATE >= [%0] AND T0.DOCDATE <= [%1]
Declare @FromDate Datetime Declare @ToDate Datetime  select @FromDate = min(S0.Docdate) from dbo.OINM S0 where S0.Docdate >='[%0]' select @ToDate = max(S1.Docdate) from dbo.OINM s1 where S1.Docdate <='[%1]' Select  a.Itemcode, max(a.Dscription) as ItemName, (Select i.[ItmsGrpCod] from OITM i where i.ItemCode=a.Itemcode) as ItemGroup, sum(a.OpeningBalance) as OpeningBalance, sum(a.INq) as 'IN', sum(a.OUT) as OUT, ((sum(a.OpeningBalance) + sum(a.INq)) - Sum(a.OUT)) as Closing , (Select i.InvntryUom from OITM i where i.ItemCode=a.Itemcode) as UOM , (Select J.Dscription from OCHP j where j.AbsEntry=a.ChapterID) as HSN   from ( Select N1.Warehouse, N1.Itemcode, N1.Dscription, (sum(N1.inqty)-sum(n1.outqty)) as OpeningBalance, 0 as INq, 0 as OUT,OITM.ChapterID       From dbo.OINM N1 inner join oitm on OITM.itemcode=N1.ItemCode inner join OITB on oitb.ItmsGrpCod=oitm.ItmsGrpCod     inner join OCHP on oCHP.AbsEntry=oitm.ChapterID    Where N1.DocDate < @FromDate and N1.Warehouse = 'FGW1'  And oitb.ItmsGrpCod=103 Group By N1.Warehouse,N1.ItemCode, N1.Dscription ,OITM.ChapterID Union All  select N1.Warehouse, N1.Itemcode, N1.Dscription, 0 as OpeningBalance, sum(N1.inqty) , 0 as OUT,OITM.ChapterID From dbo.OINM N1     inner join oitm on OITM.itemcode=N1.ItemCode inner join OITB on oitb.ItmsGrpCod=oitm.ItmsGrpCod   inner join OCHP on oCHP.AbsEntry=oitm.ChapterID  Where N1.DocDate >= @FromDate and N1.DocDate <= @ToDate and N1.Inqty >0 and N1.Warehouse = 'FGW1' And oitb.ItmsGrpCod=103 Group By N1.Warehouse,N1.ItemCode,N1.Dscription,OITM.ChapterID Union All   select N1.Warehouse, N1.Itemcode, N1.Dscription, 0 as OpeningBalance, 0 , sum(N1.outqty) as OUT,OITM.ChapterID   From dbo.OINM N1  inner join oitm on OITM.itemcode=N1.ItemCode inner join OITB on oitb.ItmsGrpCod=oitm.ItmsGrpCod    inner join OCHP on oCHP.AbsEntry=oitm.ChapterID  Where N1.DocDate >= @FromDate and N1.DocDate <=@ToDate and N1.OutQty > 0 and N1.Warehouse = 'FGW1' And oitb.ItmsGrpCod=103 Group By N1.Warehouse,N1.ItemCode,N1.Dscription,OITM.ChapterID ) a, dbo.OITM I1 where a.ItemCode=I1.ItemCode Group By a.Itemcode,a.ChapterID Having sum(a.OpeningBalance) + sum(a.INq) + sum(a.OUT) > 0 Order By a.Itemcode
Declare @FromDT Varchar(20) Declare @ToDT Varchar(20) Select @FromDT = T0.DocDate from OINV T0 where T0.DocDate = '[%0]' Select @ToDT =  T0.DocDate from OINV T0 where T0.DocDate = '[%1]'     SELECT T0.[DocNum], T0.[DocDate], T0.[CardCode], T0.[CardName],INV.BpGSTN, T3.GROUPNAME, t1.acctcode, t5.acctname,T1.[ItemCode], T1.[Dscription], OI.SalUnitMsr AS 'UOM',OC.chapter as 'HSN',T1.[Quantity], (T1.[LineTotal]) / T1.quantity AS         [UNIT PRICE], T1.[LineTotal] As 'Total', T0.[DiscPrcnt], ISNULL((SELECT TOP 1 ISNULL(TAXRATE,0) FROM INV4 WHERE  INV4.DOCENTRY = T1.DocEntry         AND INV4.STATYPE   IN ('-100') AND INV4.RELATETYPE = 1 and INV4.LINENUM=T1.LineNum) ,0) AS CGSTRATE,  ISNULL((SELECT CASE WHEN SUM(INV4.RvsChrgPrc)!=0                             THEN ((Case When T0.DocCur = 'INR' Then  SUM(INV4.TaxSum) Else Sum(INV4.TaxSumFrgn) End) - (Case When T0.DocCur = 'INR' Then SUM(INV4.RvsChrgTax) Else Sum(INV4.RvsChrgFC) End))                                   ELSE (Case When T0.DocCur ='INR' Then  SUM(INV4.TaxSum) Else Sum(INV4.TaxSumFrgn) End) END  FROM INV4 WHERE INV4.DOCENTRY = T1.DOCENTRY AND   INV4.STATYPE = '-110' AND INV4.LINENUM=T1.LINENUM AND INV4.RELATETYPE = 1),0)   AS CGSTAMNT, ISNULL((SELECT TOP 1 ISNULL(TAXRATE,0) FROM INV4 WHERE  INV4.DOCENTRY =  t1.DOCENTRY AND INV4.STATYPE   IN ('-110','-150') AND INV4.RELATETYPE = 1 and INV4.LINENUM=T1.LINENUM) ,0) AS SGSTRATE,   ISNULL((SELECT CASE WHEN SUM(INV4.RvsChrgPrc)!=0                             THEN ((Case When T0.DocCur = 'INR' Then  SUM(INV4.TaxSum) Else Sum(INV4.TaxSumFrgn) End) - (Case When T0.DocCur = 'INR' Then SUM(INV4.RvsChrgTax) Else Sum(INV4.RvsChrgFC) End))                                   ELSE (Case When T0.DocCur ='INR' Then  SUM(INV4.TaxSum) Else Sum(INV4.TaxSumFrgn) End) END  FROM INV4 WHERE INV4.DOCENTRY = T1.DOCENTRY AND   INV4.STATYPE IN ('-110','-150') AND INV4.LINENUM=T1.LINENUM AND INV4.RELATETYPE = 1),0)   AS SGSTAMNT, ISNULL((SELECT TOP 1 ISNULL(TAXRATE,0) FROM INV4 WHERE  INV4.DOCENTRY =  T1.DOCENTRY AND INV4.STATYPE   IN ('-120') AND INV4.RELATETYPE = 1 AND INV4.LineNum = T1.LineNum) ,0) AS IGSTRATE,    ISNULL((SELECT CASE WHEN SUM(INV4.RvsChrgPrc)!=0 THEN         ((Case When T0.DocCur = 'INR' Then  SUM(INV4.TaxSum) Else Sum(INV4.TaxSumFrgn) End) - (Case When T0.DocCur = 'INR' Then SUM(INV4.RvsChrgTax) Else Sum(INV4.RvsChrgFC) End)) ELSE (Case When T0.DocCur = 'INR' Then  SUM(INV4.TaxSum) Else Sum(INV4.TaxSumFrgn) End) END            FROM INV4 WHERE INV4.DOCENTRY = T1.DOCENTRY AND   INV4.STATYPE = '-120'AND INV4.LINENUM=T1.LINENUM AND  INV4.RELATETYPE = 1),0) AS IGSTAMNT,  ISNULL((SELECT TOP 1 ISNULL(TAXRATE,0) FROM INV4 WHERE  INV4.DOCENTRY = T1.DocEntry         AND INV4.STATYPE   IN ('8') AND INV4.RELATETYPE = 1 and INV4.LINENUM=T1.LineNum) ,0) AS TCSRATE,  ISNULL((SELECT CASE WHEN SUM(INV4.RvsChrgPrc)!=0                             THEN ((Case When T0.DocCur = 'INR' Then  SUM(INV4.TaxSum) Else Sum(INV4.TaxSumFrgn) End) - (Case When T0.DocCur = 'INR' Then SUM(INV4.RvsChrgTax) Else Sum(INV4.RvsChrgFC) End))                                   ELSE (Case When T0.DocCur ='INR' Then  SUM(INV4.TaxSum) Else Sum(INV4.TaxSumFrgn) End) END  FROM INV4 WHERE INV4.DOCENTRY = T1.DOCENTRY AND   INV4.STATYPE = '8' AND INV4.LINENUM=T1.LINENUM AND INV4.RELATETYPE = 1),0)   AS TCSAMNT                        FROM OINV T0    INNER JOIN INV1 T1 ON T0.[DocEntry] = T1.[DocEntry] LEFT join INV12 INV on inv.docentry=T1.DocEntry LEFT join OCHp OC on OC.AbsEntry=T1.HsnEntry LEFT join OITM OI on OI.itemcode=T1.itemcode inner join ocrd t2 on t0.cardcode = t2.cardcode INNER JOIN OCRG T3 ON T2.GROUPCODE=T3.GROUPCODE inner join oact t5 on t1.acctcode = t5.acctcode WHERE T0.canceled <> 'Y' AND T0.CANCELED <> 'C' AND T0.DOCDATE   Between '[%0]' and '[%1]' and t0.doctype='i'
Declare @FromDT Varchar(20) Declare @ToDT Varchar(20) Select @FromDT = T0.DocDate from ORPC T0 where T0.DocDate = '[%0]' Select @ToDT =  T0.DocDate from ORPC T0 where T0.DocDate = '[%1]'     SELECT T0.[DocNum], T0.[DocDate], T0.[CardCode], T0.[CardName], T3.GROUPNAME,T0.NumAtCard As 'Bill No',T8.BpGSTN 'GST no',T0.TaxDate As 'Party Bill Date', t5.acctname 'G/L account ',T1.[ItemCode], T1.[Dscription], T1.[Quantity],T4.Dscription 'HSN',t6.InvntryUom 'UOM',CASE WHEN t0.dOCTYPE='i' THEN T6.U_ITTYPE ELSE 'SERVICE' end 'TYPE of Goods' , (T1.[PRICE]) AS         [UNIT PRICE], T1.[LineTotal] As 'Total', ISNULL((SELECT TOP 1 ISNULL(TAXRATE,0) FROM RPC4 WHERE  RPC4.DOCENTRY = T1.DocEntry         AND RPC4.STATYPE   IN ('-100') AND RPC4.RELATETYPE = 1 and RPC4.LINENUM=T1.LineNum) ,0) AS CGSTRATE,  ISNULL((SELECT CASE WHEN SUM(RPC4.RvsChrgPrc)!=0                             THEN ((Case When T0.DocCur = 'INR' Then  SUM(RPC4.TaxSum) Else Sum(RPC4.TaxSumFrgn) End) - (Case When T0.DocCur = 'INR' Then SUM(RPC4.RvsChrgTax) Else Sum(RPC4.RvsChrgFC) End))                                   ELSE (Case When T0.DocCur ='INR' Then  SUM(RPC4.TaxSum) Else Sum(RPC4.TaxSumFrgn) End) END  FROM RPC4 WHERE RPC4.DOCENTRY = T1.DOCENTRY AND   RPC4.STATYPE = '-110' AND RPC4.LINENUM=T1.LINENUM AND RPC4.RELATETYPE = 1),0)   AS CGSTAMNT, ISNULL((SELECT TOP 1 ISNULL(TAXRATE,0) FROM RPC4 WHERE  RPC4.DOCENTRY =  t1.DOCENTRY AND RPC4.STATYPE   IN ('-110','-150') AND RPC4.RELATETYPE = 1 and RPC4.LINENUM=T1.LINENUM) ,0) AS SGSTRATE,   ISNULL((SELECT CASE WHEN SUM(RPC4.RvsChrgPrc)!=0                             THEN ((Case When T0.DocCur = 'INR' Then  SUM(RPC4.TaxSum) Else Sum(RPC4.TaxSumFrgn) End) - (Case When T0.DocCur = 'INR' Then SUM(RPC4.RvsChrgTax) Else Sum(RPC4.RvsChrgFC) End))                                   ELSE (Case When T0.DocCur ='INR' Then  SUM(RPC4.TaxSum) Else Sum(RPC4.TaxSumFrgn) End) END  FROM RPC4 WHERE RPC4.DOCENTRY = T1.DOCENTRY AND   RPC4.STATYPE IN ('-110','-150') AND RPC4.LINENUM=T1.LINENUM AND RPC4.RELATETYPE = 1),0)   AS SGSTAMNT, ISNULL((SELECT TOP 1 ISNULL(TAXRATE,0) FROM RPC4 WHERE  RPC4.DOCENTRY =  T1.DOCENTRY AND RPC4.STATYPE   IN ('-120') AND RPC4.RELATETYPE = 1 AND RPC4.LineNum = T1.LineNum) ,0) AS IGSTRATE,    ISNULL((SELECT CASE WHEN SUM(RPC4.RvsChrgPrc)!=0 THEN         ((Case When T0.DocCur = 'INR' Then  SUM(RPC4.TaxSum) Else Sum(RPC4.TaxSumFrgn) End) - (Case When T0.DocCur = 'INR' Then SUM(RPC4.RvsChrgTax) Else Sum(RPC4.RvsChrgFC) End)) ELSE (Case When T0.DocCur = 'INR' Then  SUM(RPC4.TaxSum) Else Sum(RPC4.TaxSumFrgn) End) END            FROM RPC4 WHERE RPC4.DOCENTRY = T1.DOCENTRY AND   RPC4.STATYPE = '-120'AND RPC4.LINENUM=T1.LINENUM AND  RPC4.RELATETYPE = 1),0) AS IGSTAMNT,T0.Comments, T0.[CANCELED] as 'CANCELED',T1.NoInvtryMv                       FROM ORPC T0    INNER JOIN RPC1 T1 ON T0.[DocEntry] = T1.[DocEntry] INNER JOIN RPC12 T8 ON T8.[DocEntry] = T0.[DocEntry] LEFT JOIN OCHP T4 ON T4.AbsEntry = T1.HsnEntry LEFT JOIN OITM T6 ON T6.ITEMcode = T1.ITEMCODE inner join ocrd t2 on t0.cardcode = t2.cardcode INNER JOIN OCRG T3 ON T2.GROUPCODE=T3.GROUPCODE inner join oact t5 on t1.acctcode = t5.acctcode WHERE T0.DOCDATE   Between '[%0]' and '[%1]'
Declare @FromDT Varchar(20) Declare @ToDT Varchar(20) Select @FromDT = T0.DocDate from OINV T0 where T0.DocDate = '[%0]' Select @ToDT =  T0.DocDate from OINV T0 where T0.DocDate = '[%1]'   Select A.DocNum,A.DocDate,A.Cardcode,A.CardName,A.BpGSTN,A.GROUPNAME, A.RevRefNo as 'Ref. Invoice No.',A.RevRefDate AS 'Ref. Invoice date', SUM(A.[Quantity])[Quantity], SUM(A.Total) Total,A.DiscSum DiscSum, Sum(A.CGSTAMNT) CGSTAMNT, SUM(A.SGSTAMNT)SGSTAMNT, SUM(A.IGSTAMNT) IGSTAMNT, SUM(A.TCSAMNT) TCSAMNT, Sum(A.TotalExpns) As 'Freight',A.[Total Value] 'Total Value'   From ( SELECT T0.[DocNum], T0.[DocDate], T0.[CardCode], T0.[CardName],INV.BpGSTN, T3.GROUPNAME,  --T0.[RevRefNo],T0.[RevRefDate], T1.[Quantity], T1.[LineTotal] As 'Total',T0.DiscSum [DiscSum], ISNULL((SELECT CASE WHEN SUM(RIN4.RvsChrgPrc)!=0 THEN ((Case When T0.DocCur = 'INR' Then  SUM(RIN4.TaxSum) Else Sum(RIN4.TaxSumFrgn) End) - (Case When T0.DocCur = 'INR' Then SUM(RIN4.RvsChrgTax) Else Sum(RIN4.RvsChrgFC) End)) ELSE (Case When T0.DocCur ='INR' Then  SUM(RIN4.TaxSum) Else Sum(RIN4.TaxSumFrgn) End) END  FROM RIN4 WHERE RIN4.DOCENTRY = T1.DOCENTRY AND   RIN4.STATYPE = '-110' AND RIN4.LINENUM=T1.LINENUM AND RIN4.RELATETYPE = 1),0) + ISNULL((SELECT CASE WHEN SUM(RIN4.RvsChrgPrc)!=0 THEN ((Case When T0.DocCur = 'INR' Then  SUM(RIN4.TaxSum) Else Sum(RIN4.TaxSumFrgn) End) - (Case When T0.DocCur = 'INR' Then SUM(RIN4.RvsChrgTax) Else Sum(RIN4.RvsChrgFC) End)) ELSE (Case When T0.DocCur ='INR' Then  SUM(RIN4.TaxSum) Else Sum(RIN4.TaxSumFrgn) End) END  FROM RIN4 WHERE RIN4.DOCENTRY = T1.DOCENTRY AND   RIN4.STATYPE = '-110' AND RIN4.LINENUM=T6.LINENUM AND RIN4.RELATETYPE = 3),0) AS CGSTAMNT,  ISNULL((SELECT CASE WHEN SUM(RIN4.RvsChrgPrc)!=0 THEN ((Case When T0.DocCur = 'INR' Then  SUM(RIN4.TaxSum) Else Sum(RIN4.TaxSumFrgn) End) - (Case When T0.DocCur = 'INR' Then SUM(RIN4.RvsChrgTax) Else Sum(RIN4.RvsChrgFC) End)) ELSE (Case When T0.DocCur ='INR' Then  SUM(RIN4.TaxSum) Else Sum(RIN4.TaxSumFrgn) End) END  FROM RIN4 WHERE RIN4.DOCENTRY = T1.DOCENTRY AND   RIN4.STATYPE IN ('-110','-150') AND RIN4.LINENUM=T1.LINENUM AND RIN4.RELATETYPE = 1),0) +  ISNULL((SELECT CASE WHEN SUM(RIN4.RvsChrgPrc)!=0 THEN ((Case When T0.DocCur = 'INR' Then  SUM(RIN4.TaxSum) Else Sum(RIN4.TaxSumFrgn) End) - (Case When T0.DocCur = 'INR' Then SUM(RIN4.RvsChrgTax) Else Sum(RIN4.RvsChrgFC) End)) ELSE (Case When T0.DocCur ='INR' Then  SUM(RIN4.TaxSum) Else Sum(RIN4.TaxSumFrgn) End) END  FROM RIN4 WHERE RIN4.DOCENTRY = T1.DOCENTRY AND   RIN4.STATYPE IN ('-110','-150') AND RIN4.LINENUM=T6.LINENUM AND RIN4.RELATETYPE = 3),0) AS SGSTAMNT,   --------------------------  ISNULL((SELECT CASE WHEN SUM(RIN4.RvsChrgPrc)!=0 THEN ((Case When T0.DocCur = 'INR' Then  SUM(RIN4.TaxSum) Else Sum(RIN4.TaxSumFrgn) End) -  (Case When T0.DocCur = 'INR' Then SUM(RIN4.RvsChrgTax) Else Sum(RIN4.RvsChrgFC) End))  ELSE (Case When T0.DocCur = 'INR' Then  SUM(RIN4.TaxSum) Else Sum(RIN4.TaxSum) End) END FROM RIN4 WHERE RIN4.DOCENTRY = T1.DOCENTRY AND   RIN4.STATYPE = '-120'AND RIN4.LINENUM=T1.LINENUM AND RIN4.RELATETYPE = 1),0)+  ISNULL((SELECT CASE WHEN SUM(RIN4.RvsChrgPrc)!=0 THEN ((Case When T0.DocCur = 'INR' Then  SUM(RIN4.TaxSum) Else Sum(RIN4.TaxSumFrgn) End) - (Case When T0.DocCur = 'INR' Then SUM(RIN4.RvsChrgTax) Else Sum(RIN4.RvsChrgFC) End)) ELSE (Case When T0.DocCur = 'INR' Then  SUM(RIN4.TaxSum) Else Sum(RIN4.TaxSum) End) END FROM RIN4 WHERE RIN4.DOCENTRY = T1.DOCENTRY AND    RIN4.STATYPE = '-120' AND RIN4.RELATETYPE = 3),0) AS IGSTAMNT,  --------------------  ISNULL((SELECT CASE WHEN SUM(RIN4.RvsChrgPrc)!=0 THEN ((Case When T0.DocCur = 'INR' Then  SUM(RIN4.TaxSum) Else Sum(RIN4.TaxSumFrgn) End) - (Case When T0.DocCur = 'INR' Then SUM(RIN4.RvsChrgTax) Else Sum(RIN4.RvsChrgFC) End)) ELSE (Case When T0.DocCur ='INR' Then  SUM(RIN4.TaxSum) Else Sum(RIN4.TaxSumFrgn) End) END  FROM RIN4 WHERE RIN4.DOCENTRY = T1.DOCENTRY AND RIN4.LINENUM=T1.LINENUM AND    RIN4.STATYPE = '8' AND RIN4.RELATETYPE = 1),0) --+  --ISNULL((SELECT CASE WHEN SUM(RIN4.RvsChrgPrc)!=0 --THEN ((Case When T0.DocCur = 'INR' Then  SUM(RIN4.TaxSum) Else Sum(RIN4.TaxSumFrgn) End) - (Case When T0.DocCur = 'INR' Then SUM(RIN4.RvsChrgTax) Else Sum(RIN4.RvsChrgFC) End)) --ELSE (Case When T0.DocCur ='INR' Then  SUM(RIN4.TaxSum) Else Sum(RIN4.TaxSumFrgn) End) END  FROM RIN4 --WHERE RIN4.DOCENTRY = T1.DOCENTRY AND RIN4.LINENUM=T1.LINENUM AND    RIN4.STATYPE = '8' AND RIN4.RELATETYPE = 1),0)  AS TCSAMNT, T0.TotalExpns,T0.DocTotal As 'Total Value', T0.RevRefNo, T0.RevRefDate FROM ORIN T0  INNER JOIN RIN1 T1 ON T0.[DocEntry] = T1.[DocEntry] LEFT JOIN RIN3 T6 ON T0.DocEntry=T6.DocEntry LEFT join RIN12 INV on inv.docentry=T1.DocEntry LEFT join OCHp OC on OC.AbsEntry=T1.HsnEntry LEFT join OITM OI on OI.itemcode=T1.itemcode inner join ocrd t2 on t0.cardcode = t2.cardcode INNER JOIN OCRG T3 ON T2.GROUPCODE=T3.GROUPCODE inner join oact t5 on t1.acctcode = t5.acctcode  WHERE T0.canceled <> 'Y' AND T0.CANCELED <> 'C' AND T0.DOCDATE   Between '[%0]' and '[%1]') A GROUP BY A.DocNum,A.DocDate,A.Cardcode,A.CardName,A.BpGSTN,A.GROUPNAME,A.DiscSum,A.[Total Value],A.RevRefNo,A.RevRefDate
Declare @FromDT Varchar(20) Declare @ToDT Varchar(20) Select @FromDT = T0.DocDate from oPCH T0 where T0.DocDate = '[%0]' Select @ToDT =  T0.DocDate from oPCH T0 where T0.DocDate = '[%1]'     SELECT T0.[DocNum] As 'A/P Invoice No', T0.[DocDate] as 'A/P Invoice Date', Case When T0.Doctype='I'  THEN  T1.BaseDocNum ELSE ' '  END  'MRR NO' ,OPDN.DocDate As 'MRR Date', T0.NUMATCARD as 'Bill No', T0.TAXDATE AS 'Bill Date', T0.[CardCode], T0.[CardName], T12.BPGSTN AS 'GSTIN No.',T1.[ItemCode], T1.[Dscription], Case When T0.Doctype='I' Then OCHP.Dscription else OSAC.ServCode END 'HSN/SAC',T1.unitMsr As 'UOM', T1.[Quantity], (T1.[Price])  AS         [UNIT PRICE],  T1.[LineTotal] As 'Taxable Value', ISNULL((SELECT TOP 1 ISNULL(TAXRATE,0) FROM PCH4 WHERE  PCH4.DOCENTRY = T1.DocEntry         AND PCH4.STATYPE   IN ('-100') AND PCH4.RELATETYPE = 1 and PCH4.LINENUM=T1.LineNum) ,0) AS CGSTRATE,  ISNULL((SELECT CASE WHEN SUM(PCH4.RvsChrgPrc)!=0                             THEN ((Case When T0.DocCur = 'INR' Then  SUM(PCH4.TaxSum) Else Sum(PCH4.TaxSumFrgn) End) - (Case When T0.DocCur = 'INR' Then SUM(PCH4.RvsChrgTax) Else Sum(PCH4.RvsChrgFC) End))                                   ELSE (Case When T0.DocCur ='INR' Then  SUM(PCH4.TaxSum) Else Sum(PCH4.TaxSumFrgn) End) END  FROM PCH4 WHERE PCH4.DOCENTRY = T1.DOCENTRY AND   PCH4.STATYPE = '-110' AND PCH4.LINENUM=T1.LINENUM AND PCH4.RELATETYPE = 1),0)   AS CGSTAMNT, ISNULL((SELECT TOP 1 ISNULL(TAXRATE,0) FROM PCH4 WHERE  PCH4.DOCENTRY =  t1.DOCENTRY AND PCH4.STATYPE   IN ('-110','-150') AND PCH4.RELATETYPE = 1 and PCH4.LINENUM=T1.LINENUM) ,0) AS SGSTRATE,   ISNULL((SELECT CASE WHEN SUM(PCH4.RvsChrgPrc)!=0                             THEN ((Case When T0.DocCur = 'INR' Then  SUM(PCH4.TaxSum) Else Sum(PCH4.TaxSumFrgn) End) - (Case When T0.DocCur = 'INR' Then SUM(PCH4.RvsChrgTax) Else Sum(PCH4.RvsChrgFC) End))                                   ELSE (Case When T0.DocCur ='INR' Then  SUM(PCH4.TaxSum) Else Sum(PCH4.TaxSumFrgn) End) END  FROM PCH4 WHERE PCH4.DOCENTRY = T1.DOCENTRY AND   PCH4.STATYPE IN ('-110','-150') AND PCH4.LINENUM=T1.LINENUM AND PCH4.RELATETYPE = 1),0)   AS SGSTAMNT, ISNULL((SELECT TOP 1 ISNULL(TAXRATE,0) FROM PCH4 WHERE  PCH4.DOCENTRY =  T1.DOCENTRY AND PCH4.STATYPE   IN ('-120') AND PCH4.RELATETYPE = 1 AND PCH4.LineNum = T1.LineNum) ,0) AS IGSTRATE,    ISNULL((SELECT CASE WHEN SUM(PCH4.RvsChrgPrc)!=0 THEN         ((Case When T0.DocCur = 'INR' Then  SUM(PCH4.TaxSum) Else Sum(PCH4.TaxSumFrgn) End) - (Case When T0.DocCur = 'INR' Then SUM(PCH4.RvsChrgTax) Else Sum(PCH4.RvsChrgFC) End)) ELSE (Case When T0.DocCur = 'INR' Then  SUM(PCH4.TaxSum) Else Sum(PCH4.TaxSumFrgn) End) END            FROM PCH4 WHERE PCH4.DOCENTRY = T1.DOCENTRY AND   PCH4.STATYPE = '-120'AND PCH4.LINENUM=T1.LINENUM AND  PCH4.RELATETYPE = 1),0) AS IGSTAMNT,T1.[LineTotal]+T1.VatSum As 'Line Total',T3.GROUPNAME ,Case When T0.Doctype='I' Then 'Item' else 'Service' END 'Document Type' , CASE WHEN T0.DOCTYPE='I' THEN OITM.U_ITTYPE ELSE 'SERVICE' END As 'Types of Goods ',T5.acctname AS 'ACCOUNT NAME'                           FROM oPCH T0    INNER JOIN PCH1 T1 ON T0.[DocEntry] = T1.[DocEntry] INNER JOIN PCH12 T12 ON T0.[DocEntry] = T12.[DocEntry] inner join ocrd t2 on t0.cardcode = t2.cardcode INNER JOIN OCRG T3 ON T2.GROUPCODE=T3.GROUPCODE inner join oact t5 on t1.acctcode = t5.acctcode Left join opdn on  opdn.Docnum=T1.BaseDocNum LEFT join OITM on T1.itemcode=OITM.ITEMcode  LEFT join OSAC on OSAC.AbsEntry=t1.SacEntry LEFT join OCHP on OCHP.AbsEntry=T1.HsnEntry LEFT JOIN PCH4  D_IGST ON T1.DocEntry = D_IGST.DocEntry AND T1.LineNum = D_IGST.LineNum AND D_IGST.staType = -120 AND D_IGST.RelateType = 1          LEFT JOIN PCH4  D_CGST ON T1.DocEntry = D_CGST.DocEntry AND T1.LineNum = D_CGST.LineNum AND D_CGST.staType = -100 AND D_CGST.RelateType = 1          LEFT JOIN PCH4  D_SGST ON T1.DocEntry = D_SGST.DocEntry AND T1.LineNum = D_SGST.LineNum AND D_SGST.staType = -110 AND D_SGST.RelateType = 1  WHERE  ( D_IGST.NonDdctPrc=0 OR D_CGST.NonDdctPrc=0 OR D_SGST.NonDdctPrc=0) AND ( D_IGST.TaxRate>0 OR D_CGST.TaxRate>0 OR D_SGST.TaxRate>0) and T0.DOCDATE   Between '[%0]' and '[%1]'
Declare @FromDate Datetime Declare @ToDate Datetime  select @FromDate = min(S0.Docdate) from dbo.OINM S0 where S0.Docdate >='[%0]' select @ToDate = max(S1.Docdate) from dbo.OINM s1 where S1.Docdate <='[%1]' Select  a.Itemcode, max(a.Dscription) as ItemName, sum(a.OpeningBalance) as OpeningBalance, sum(a.INq) as 'IN', sum(a.OUT) as OUT, ((sum(a.OpeningBalance) + sum(a.INq)) - Sum(a.OUT)) as Closing , (Select i.InvntryUom from OITM i where i.ItemCode=a.Itemcode) as UOM from( Select  N1.Itemcode, N1.Dscription, (sum(N1.inqty)-sum(n1.outqty)) as OpeningBalance, 0 as INq, 0 as OUT From dbo.OINM N1 Where N1.DocDate < @FromDate  Group By N1.ItemCode, N1.Dscription Union All select  N1.Itemcode, N1.Dscription, 0 as OpeningBalance, sum(N1.inqty) , 0 as OUT From dbo.OINM N1 Where N1.DocDate >= @FromDate and N1.DocDate <= @ToDate and N1.Inqty >0  Group By N1.ItemCode,N1.Dscription Union All select  N1.Itemcode, N1.Dscription, 0 as OpeningBalance, 0 , sum(N1.outqty) as OUT From dbo.OINM N1 Where N1.DocDate >= @FromDate and N1.DocDate <=@ToDate and N1.OutQty > 0  Group By N1.ItemCode,N1.Dscription) a, dbo.OITM I1 where a.ItemCode=I1.ItemCode Group By a.Itemcode Having sum(a.OpeningBalance) + sum(a.INq) + sum(a.OUT) > 0 Order By a.Itemcode
SELECT DISTINCT T0.[U_INVN] as 'RGP No', T1.DOCENTRY as 'Job Work No',  T1.U_ORDT, T1.U_VDNM, T0.[U_CHCD] as 'Item Code', T0.[U_CHNM] as 'Item Name',  T0.[U_PLQT], T0.[U_ISQT], T0.[U_BLQT], case when T0.[U_BLQT]=0 THEN 'CLOSED' ELSE 'OPEN' END  AS 'STATUS',DATEDIFF(dd,T2.DocDate,GETDATE())AS 'DUE FROM DAY' FROM [dbo].[@JWDETCHILD]  T0   INNER JOIN [dbo].[@JWHD] T1 ON T0.DOCENTRY=T1.DOCENTRY   INNER JOIN OWTR T2 ON T0.U_INVE = T2.DocEntry   WHERE  T0.[U_INVN] is not null     and T1.DOCENTRY >=508 AND T0.[U_BLQT]<>0
SELECT DISTINCT T0.[U_INVN] as 'RGP No', T1.DOCENTRY as 'Job Work No',  T1.U_ORDT, T1.U_VDNM, T0.[U_CHCD] as 'Item Code', T0.[U_CHNM] as 'Item Name',T3.InvntryUom,  T0.[U_PLQT], ISNULL(T0.[U_ISQT],0) Issued ,((ISnull(T0.[U_PLQT],0))-(Isnull(T0.[U_ISQT],0))) As 'balance'  ,  T1.U_HSTUS  AS 'STATUS'  ,DATEDIFF(dd,T2.DocDate,GETDATE())AS 'DUE FROM DAY' FROM [dbo].[@JWDETCHILD]  T0   INNER JOIN [dbo].[@JWHD] T1 ON T0.DOCENTRY=T1.DOCENTRY   INNER JOIN OWTR T2 ON T0.U_INVE = T2.DocEntry   Inner join oitm T3 on T0.[U_CHCD]=T3.ItemCode    WHERE  T0.[U_INVN] is not null  and T1.U_ORDT>=[%0] and T1.U_ORDT<=[%1]    and T1.DOCENTRY >=508---- and case when T0.[U_BLQT]=0 and  THEN 'CLOSED' ELSE 'OPEN' END = 'open' order by  T1.U_ORDT
Declare @S Date  Declare @E Date  Set @S = (Select min(T0.DocDate) from OPDN T0 where T0.DocDate >=[%0])  Set @E = (Select max(T1.DocDate) from OPDN T1 where T1.DocDate <=[%1])   EXEC [GetQcList]  @S, @E
Declare @S Date Declare @E Date Set @S = (Select min(CONVERT(date,T0.U_UNE_CLMDT,105)) from [@UNE_MH_GSTR2] T0 where T0.U_UNE_CLMDT>=[%0]) Set @E = (Select MAX(CONVERT(date,T0.U_UNE_CLMDT,105)) from [@UNE_MH_GSTR2] T0 where T0.U_UNE_CLMDT<=[%1])  EXEC [CLAIM]  @S, @E
Select T0.DocNum 'Bill No',T0.DocDate 'Bill Date',DocCur ,ISNULL(T0.DocTotalFC,0) AS 'FC Currency', T0.DocRate 'Exchange Rate',T0.DocTotal AS 'INR',  T2.DocNum 'Payment No.',T2.DocDate AS 'Payment Date',  T1.AppliedFC AS 'Payment ',T1.DocRate AS 'Payment Exchange Rate',  T1.SumApplied 'Payment INR',T0.DocTotalFC - T1.AppliedFC AS 'USD Difference',T0.DocTotal - T1.SumApplied AS 'INR Difference',  (T0.DocRate-T1.DocRate)*T0.DocTotalFC AS 'Foreign Exchange Fluctuation',  (CAST(T0.DocTotalFC AS decimal(10,4)) - CAST(T1.AppliedFC AS decimal(10,4)))*CAST(T1.DocRate AS decimal(10,4))  'Bank Charges',  (T0.DocTotal - T1.SumApplied)-((T0.DocRate-T1.DocRate)*T0.DocTotalFC)-  (CAST(T0.DocTotalFC AS decimal(10,4)) - CAST(T1.AppliedFC AS decimal(10,4)))*CAST(T1.DocRate AS decimal(10,4)) AS 'Net Difference'  From OINV T0  LEFT JOIN RCT2 T1 ON T0.DocEntry=T1.DocEntry AND T0.ObjType=T1.InvType    LEFT JOIN ORCT T2 ON T2.DocEntry=T1.DocNum where  T0.DocCur <>'INR' and t0.docdate >= [%0] and t0.docdate <= [%1]
DECLARE @FROMDATE DateTime DECLARE @TODATE  DateTime  SET @FROMDATE=(SELECT MIN(S0.RefDate) FROM DBO.OJDT S0 WHERE S0.RefDate >='[%0]') SET @TODATE=(SELECT MAX(S1.RefDate) FROM DBO.OJDT S1 WHERE S1.RefDate <='[%1]')   SELECT T0.[DocNum], T0.[DocDate], T0.[CardCode], T0.[CardName], T0.[NumAtCard] as 'Invoice No', T0.[TaxDate] as 'Invoice Date',T0.[BaseAmnt],T0.[Branch], T0.[DocTotal],T0.[WTSum], T0.[WTDetails], T1.[WTCode], T2.[OffclCode], T1.[Rate], T1.[TaxbleAmnt], T1.[Account], T1.[Type] ,Isnull((Select Top 1 TaxId0 From CRD7 Where T0.CardCode=CRD7.CardCode And Isnull(TaxId0,'')<>''),'') As 'PAN No' FROM OPCH T0  INNER JOIN PCH5 T1 ON T0.[DocEntry] = T1.[AbsEntry] inner join owht t2 on t1.wtcode=t2.wtcode Where T0.DocDate Between @Fromdate And @ToDate and t0.Canceled<>'y' and t0.canceled<>'c'
Declare @FromDT Varchar(20) Declare @ToDT Varchar(20) Select @FromDT = T0.DocDate from OINV T0 where T0.DocDate = '[%0]' Select @ToDT =  T0.DocDate from OINV T0 where T0.DocDate = '[%1]'     Select A.DocNum,A.DocDate,A.Cardcode,A.CardName,A.BpGSTN,A.GROUPNAME,SUM(A.[Quantity])[Quantity],SUM(A.Total) Total,A.DiscSum DiscSum, Sum(A.CGSTAMNT) CGSTAMNT,SUM(A.SGSTAMNT)SGSTAMNT,SUM(A.IGSTAMNT) IGSTAMNT,SUM(A.TCSAMNT) TCSAMNT, (select case when A.TotalExpns >= 0 then (Select A.TotalExpns ) else '0'  end) As 'Freight', (select case when A.TotalExpns < 0 then (Select A.TotalExpns )  else '0' end) As 'Sample Discount',  A.[Total Value] 'Total Value' From ( SELECT T0.[DocNum], T0.[DocDate], T0.[CardCode], T0.[CardName],INV.BpGSTN, T3.GROUPNAME, T1.[Quantity], T1.[LineTotal] As 'Total',T0.DiscSum [DiscSum], ISNULL((SELECT CASE WHEN SUM(INV4.RvsChrgPrc)!=0 THEN ((Case When T0.DocCur = 'INR' Then  SUM(INV4.TaxSum) Else Sum(INV4.TaxSumFrgn) End) - (Case When T0.DocCur = 'INR' Then SUM(INV4.RvsChrgTax) Else Sum(INV4.RvsChrgFC) End)) ELSE (Case When T0.DocCur ='INR' Then  SUM(INV4.TaxSum) Else Sum(INV4.TaxSumFrgn) End) END  FROM INV4 WHERE INV4.DOCENTRY = T1.DOCENTRY AND   INV4.STATYPE = '-110' AND INV4.LINENUM=T1.LINENUM AND INV4.RELATETYPE = 1),0) + ISNULL((SELECT CASE WHEN SUM(INV4.RvsChrgPrc)!=0 THEN ((Case When T0.DocCur = 'INR' Then  SUM(INV4.TaxSum) Else Sum(INV4.TaxSumFrgn) End) - (Case When T0.DocCur = 'INR' Then SUM(INV4.RvsChrgTax) Else Sum(INV4.RvsChrgFC) End)) ELSE (Case When T0.DocCur ='INR' Then  SUM(INV4.TaxSum) Else Sum(INV4.TaxSumFrgn) End) END  FROM INV4 WHERE INV4.DOCENTRY = T1.DOCENTRY AND   INV4.STATYPE = '-110' AND INV4.LINENUM=T6.LINENUM AND INV4.RELATETYPE = 3),0) AS CGSTAMNT,  ISNULL((SELECT CASE WHEN SUM(INV4.RvsChrgPrc)!=0 THEN ((Case When T0.DocCur = 'INR' Then  SUM(INV4.TaxSum) Else Sum(INV4.TaxSumFrgn) End) - (Case When T0.DocCur = 'INR' Then SUM(INV4.RvsChrgTax) Else Sum(INV4.RvsChrgFC) End)) ELSE (Case When T0.DocCur ='INR' Then  SUM(INV4.TaxSum) Else Sum(INV4.TaxSumFrgn) End) END  FROM INV4 WHERE INV4.DOCENTRY = T1.DOCENTRY AND   INV4.STATYPE IN ('-110','-150') AND INV4.LINENUM=T1.LINENUM AND INV4.RELATETYPE = 1),0) +  ISNULL((SELECT CASE WHEN SUM(INV4.RvsChrgPrc)!=0 THEN ((Case When T0.DocCur = 'INR' Then  SUM(INV4.TaxSum) Else Sum(INV4.TaxSumFrgn) End) - (Case When T0.DocCur = 'INR' Then SUM(INV4.RvsChrgTax) Else Sum(INV4.RvsChrgFC) End)) ELSE (Case When T0.DocCur ='INR' Then  SUM(INV4.TaxSum) Else Sum(INV4.TaxSumFrgn) End) END  FROM INV4 WHERE INV4.DOCENTRY = T1.DOCENTRY AND   INV4.STATYPE IN ('-110','-150') AND INV4.LINENUM=T6.LINENUM AND INV4.RELATETYPE = 3),0) AS SGSTAMNT,     ISNULL((SELECT CASE WHEN SUM(INV4.RvsChrgPrc)!=0 THEN (Case When T0.DocCur = 'INR' Then  SUM(INV4.TaxSum) Else Sum(INV4.TaxSum) End)  ELSE (Case When T0.DocCur = 'INR' Then  SUM(INV4.TaxSum) Else Sum(INV4.TaxSum) End) END FROM INV4 WHERE INV4.DOCENTRY = T1.DOCENTRY AND   INV4.STATYPE = '-120'AND INV4.LINENUM=T1.LINENUM AND INV4.RELATETYPE = 1),0)+  ISNULL((SELECT CASE WHEN SUM(INV4.RvsChrgPrc)!=0 THEN (Case When T0.DocCur = 'INR' Then  SUM(INV4.TaxSum) End)  ELSE (Case When T0.DocCur = 'INR' Then  SUM(INV4.TaxSum) End) END FROM INV4 WHERE INV4.DOCENTRY = T1.DOCENTRY AND    INV4.STATYPE = '-120' AND INV4.RELATETYPE = 3),0) AS IGSTAMNT,   ISNULL((SELECT CASE WHEN SUM(INV4.RvsChrgPrc)!=0 THEN ((Case When T0.DocCur = 'INR' Then  SUM(INV4.TaxSum) Else Sum(INV4.TaxSumFrgn) End) - (Case When T0.DocCur = 'INR' Then SUM(INV4.RvsChrgTax) Else Sum(INV4.RvsChrgFC) End)) ELSE (Case When T0.DocCur ='INR' Then  SUM(INV4.TaxSum) Else Sum(INV4.TaxSumFrgn) End) END  FROM INV4 WHERE INV4.DOCENTRY = T1.DOCENTRY AND INV4.LINENUM=T1.LINENUM AND    INV4.STATYPE = '8' AND INV4.RELATETYPE = 1),0) --+  --ISNULL((SELECT CASE WHEN SUM(INV4.RvsChrgPrc)!=0 --THEN ((Case When T0.DocCur = 'INR' Then  SUM(INV4.TaxSum) Else Sum(INV4.TaxSumFrgn) End) - (Case When T0.DocCur = 'INR' Then SUM(INV4.RvsChrgTax) Else Sum(INV4.RvsChrgFC) End)) --ELSE (Case When T0.DocCur ='INR' Then  SUM(INV4.TaxSum) Else Sum(INV4.TaxSumFrgn) End) END  FROM INV4 --WHERE INV4.DOCENTRY = T1.DOCENTRY AND INV4.LINENUM=T1.LINENUM AND    INV4.STATYPE = '8' AND INV4.RELATETYPE = 1),0)  AS TCSAMNT, T0.TotalExpns,T0.DocTotal As 'Total Value' FROM OINV T0  INNER JOIN INV1 T1 ON T0.[DocEntry] = T1.[DocEntry] LEFT JOIN INV3 T6 ON T0.DocEntry=T6.DocEntry LEFT join INV12 INV on inv.docentry=T1.DocEntry LEFT join OCHp OC on OC.AbsEntry=T1.HsnEntry LEFT join OITM OI on OI.itemcode=T1.itemcode inner join ocrd t2 on t0.cardcode = t2.cardcode INNER JOIN OCRG T3 ON T2.GROUPCODE=T3.GROUPCODE inner join oact t5 on t1.acctcode = t5.acctcode  WHERE T0.canceled <> 'Y' AND T0.CANCELED <> 'C' AND T0.DOCDATE   Between '[%0]' and '[%1]') A GROUP BY A.DocNum,A.DocDate,A.Cardcode,A.CardName,A.BpGSTN,A.GROUPNAME,A.DiscSum,A.TotalExpns,A.[Total Value]
Declare @S Date  Declare @E Date  Set @S = (Select min(T0.DocDate) from OPDN T0 where T0.DocDate >=[%0])  Set @E = (Select max(T1.DocDate) from OPDN T1 where T1.DocDate <=[%1])   EXEC [GetQcList_1]  @S, @E
SELECT  T0.[CardCode], T0.[CardName], T1.[ItemCode], T1.[Dscription], T1.[Rate], T1.[Price] FROM ORDR T0  INNER JOIN RDR1 T1 ON T0.[DocEntry] = T1.[DocEntry]   WHERE T1.[ItemCode] = [%1]
/* SELECT FROM [dbo].[OITT] T0 */  Declare @BOM nvarchar(max)  /* WHERE */  Set @BOM=/* T0.Code */ [%0]  select B.Assembly [Product No.],B.Component,(select ItemName from OITM where ItemCode=B.Component)[Component Name],B.[BOM Quantity],  B.[BOM warehouse],  (Select max (unitprice) from OAT1 where ItemCode=B.Component and OAT1.LineStatus<> 'c' )[Max Unit Price], B.[BOM Quantity]*(Select max (unitprice) from OAT1 where ItemCode=B.Component and OAT1.LineStatus<> 'c' ) As 'Max Price',  (Select min (unitprice) from OAT1 where ItemCode=B.Component and OAT1.LineStatus<> 'c' )[Min Unit Price], B.[BOM Quantity]*(Select min (unitprice) from OAT1 where ItemCode=B.Component and OAT1.LineStatus<> 'c' ) as 'Min Price'  from (select A.Assembly,CASE when isnull(A.Component6,'')='' then  (case when isnull(A.Component5,'')='' then  (case when isnull(A.Component4,'')='' then  (case when isnull(A.Component3,'')='' then  (case when isnull(A.Component2,'')='' then  A.Component1 else A.Component2 end)else A.Component3 end)  else A.Component4 end) else A.Component5 end ) else A.Component6 end Component  ,CASE when isnull(A.Qty6,0)=0 then  (case when isnull(A.Qty5,0)=0 then  (case when isnull(A.Qty4,0)=0 then  (case when isnull(A.Qty3,0)=0 then  (case when isnull(A.Qty2,0)=0 then  A.Qty1 else A.Qty2 end)else A.Qty3 end)  else A.Qty4 end) else A.Qty5 end ) else A.Qty6 end [BOM Quantity]  ,CASE when isnull(A.whs6,'')='' then  (case when isnull(A.whs5,'')='' then  (case when isnull(A.whs4,'')='' then  (case when isnull(A.whs3,'')='' then  (case when isnull(A.whs2,'')='' then  A.whs1 else A.whs2 end)else A.whs3 end)  else A.whs4 end) else A.whs5 end ) else A.whs6 end [BOM warehouse]  from (SELECT T0.[Father] as 'Assembly',T0.[code] as 'Component1', T0.Quantity as 'Qty1', T0.warehouse as 'whs1',  t10.[ItemName] 'Description1',T1.[Code] as 'Component2', T1.Quantity as 'Qty2', T1.warehouse as 'whs2',  t11.[ItemName] 'Description2', T2.[Code] as 'Component3', T2.Quantity as 'Qty3', T2.warehouse as 'whs3',  t12.[ItemName] 'Description3', T3.[Code] as 'Component4', T3.Quantity as 'Qty4', T3.warehouse as 'whs4',  t13.[ItemName] 'Description4',T4.[Code] as 'Component5', T4.Quantity as 'Qty5', T4.warehouse as 'whs5',  t14.[ItemName] 'Description5', T5.[Code] as 'Component6', T5.Quantity as 'Qty6', T5.warehouse as 'whs6',  t15.[ItemName] 'Description6'    FROM ITT1 T0   LEFT OUTER JOIN ITT1 T1 on T0.Code = T1.Father  LEFT OUTER JOIN ITT1 T2 on T2.Father =T1.Code  LEFT OUTER JOIN ITT1 T3 on T2.Code = T3.Father LEFT OUTER JOIN ITT1 T4 on T3.Code = T4.Father  LEFT OUTER JOIN ITT1 T5 on T4.Code = T5.Father  LEFT OUTER JOIN ITT1 T6 on T5.Code = T6.Father  left outer join oitm t20 on t0.father = t20.itemcode left outer join oitm t10 on t0.code = t10.itemcode  left outer join oitm t11 on t1.code = t11.itemcode  left outer join oitm t12 on t2.code = t12.itemcode left outer join oitm t13 on t3.code = t13.itemcode  left outer join oitm t14 on t4.code = t14.itemcode  left outer join oitm t15 on t5.code = t15.itemcode  where T0.Father=@BOM)A)B
SELECT T2.DOCNUM, T2.DOCDATE, T2.CardCode,T2.CardName, (T2.DocTotal-VatSum)AS 'SALE AMOUNT', t1.Account, t1.Credit, (T1.Credit/(T2.DocTotal-VatSum))*100 AS 'COGS'   FROM JDT1 T1  INNER JOIN oJDT T0 on t0.TransId=t1.TransId INNER JOIN ODLN T2 ON T0.BaseRef = T2.DocNum AND T0.TransType=T2.ObjType   WHERE  T2.DOCDATE >=[%1] AND T2.DOCDATE<=[%2] AND T0.TransType='15' and t1.Account = '131401004'
SELECT T0.[DocNum] as 'QC Doc No', T0.[U_UTL_PODT], T0.[U_UTL_MODE], T0.[U_UTL_GRDN], T0.[U_UTL_QCPIN], T0.[U_UTL_GINM], T0.[U_UTL_SPCD], T0.[U_UTL_SPNM], T0.[U_UTL_ITCD], T0.[U_UTL_ITNM], T0.[U_UTL_BTSZ], T0.[U_UTL_APPQ], T0.[U_UTL_AINO], T0.[U_UTL_REJQ], T0.[U_UTL_RINO] FROM [dbo].[@UTL_OQCHK]  T0   where T0.[U_UTL_MODE] = [%0] and T0.[U_UTL_SPNM]=[%3] and T0.[U_UTL_PODT] >= [%1] and T0.[U_UTL_PODT] <= [%2]
Declare @FromDT Varchar(20) Declare @ToDT Varchar(20) Select @FromDT = T0.DocDate from oPCH T0 where T0.DocDate = '[%0]' Select @ToDT =  T0.DocDate from oPCH T0 where T0.DocDate = '[%1]'     SELECT T0.[DocNum] As 'A/P Invoice No', T0.[DocDate] as 'A/P Invoice Date', Case When T0.Doctype='I'  THEN  T1.BaseDocNum ELSE ' '  END  'MRR NO' ,OPDN.DocDate As 'MRR Date', T0.NUMATCARD as 'Bill No', T0.TAXDATE AS 'Bill Date', T0.[CardCode], T0.[CardName], T12.BPGSTN AS 'GSTIN No.',T1.[ItemCode], T1.[Dscription], Case When T0.Doctype='I' Then OCHP.Dscription else OSAC.ServCode END 'HSN/SAC',T1.unitMsr As 'UOM', T1.[Quantity], (T1.[Price])  AS         [UNIT PRICE],  T1.[LineTotal] As 'Taxable Value', ISNULL((SELECT TOP 1 ISNULL(TAXRATE,0) FROM PCH4 WHERE  PCH4.DOCENTRY = T1.DocEntry         AND PCH4.STATYPE   IN ('-100') AND PCH4.RELATETYPE = 1 and PCH4.LINENUM=T1.LineNum) ,0) AS CGSTRATE,  ISNULL((SELECT CASE WHEN SUM(PCH4.RvsChrgPrc)!=0                             THEN ((Case When T0.DocCur = 'INR' Then  SUM(PCH4.TaxSum) Else Sum(PCH4.TaxSumFrgn) End) - (Case When T0.DocCur = 'INR' Then SUM(PCH4.RvsChrgTax) Else Sum(PCH4.RvsChrgFC) End))                                   ELSE (Case When T0.DocCur ='INR' Then  SUM(PCH4.TaxSum) Else Sum(PCH4.TaxSumFrgn) End) END  FROM PCH4 WHERE PCH4.DOCENTRY = T1.DOCENTRY AND   PCH4.STATYPE = '-110' AND PCH4.LINENUM=T1.LINENUM AND PCH4.RELATETYPE = 1),0)   AS CGSTAMNT, ISNULL((SELECT TOP 1 ISNULL(TAXRATE,0) FROM PCH4 WHERE  PCH4.DOCENTRY =  t1.DOCENTRY AND PCH4.STATYPE   IN ('-110','-150') AND PCH4.RELATETYPE = 1 and PCH4.LINENUM=T1.LINENUM) ,0) AS SGSTRATE,   ISNULL((SELECT CASE WHEN SUM(PCH4.RvsChrgPrc)!=0                             THEN ((Case When T0.DocCur = 'INR' Then  SUM(PCH4.TaxSum) Else Sum(PCH4.TaxSumFrgn) End) - (Case When T0.DocCur = 'INR' Then SUM(PCH4.RvsChrgTax) Else Sum(PCH4.RvsChrgFC) End))                                   ELSE (Case When T0.DocCur ='INR' Then  SUM(PCH4.TaxSum) Else Sum(PCH4.TaxSumFrgn) End) END  FROM PCH4 WHERE PCH4.DOCENTRY = T1.DOCENTRY AND   PCH4.STATYPE IN ('-110','-150') AND PCH4.LINENUM=T1.LINENUM AND PCH4.RELATETYPE = 1),0)   AS SGSTAMNT, ISNULL((SELECT TOP 1 ISNULL(TAXRATE,0) FROM PCH4 WHERE  PCH4.DOCENTRY =  T1.DOCENTRY AND PCH4.STATYPE   IN ('-120') AND PCH4.RELATETYPE = 1 AND PCH4.LineNum = T1.LineNum) ,0) AS IGSTRATE,    ISNULL((SELECT CASE WHEN SUM(PCH4.RvsChrgPrc)!=0 THEN         ((Case When T0.DocCur = 'INR' Then  SUM(PCH4.TaxSum) Else Sum(PCH4.TaxSumFrgn) End) - (Case When T0.DocCur = 'INR' Then SUM(PCH4.RvsChrgTax) Else Sum(PCH4.RvsChrgFC) End)) ELSE (Case When T0.DocCur = 'INR' Then  SUM(PCH4.TaxSum) Else Sum(PCH4.TaxSumFrgn) End) END            FROM PCH4 WHERE PCH4.DOCENTRY = T1.DOCENTRY AND   PCH4.STATYPE = '-120'AND PCH4.LINENUM=T1.LINENUM AND  PCH4.RELATETYPE = 1),0) AS IGSTAMNT,T1.[LineTotal]+T1.VatSum As 'Line Total',T3.GROUPNAME ,Case When T0.Doctype='I' Then 'Item' else 'Service' END 'Document Type' , CASE WHEN T0.DOCTYPE='I' THEN OITM.U_ITTYPE ELSE 'SERVICE' END As 'Types of Goods ',T5.acctname AS 'ACCOUNT NAME' , OITM.[ItmsGrpCod], OITB.[ItmsGrpNam]                          FROM oPCH T0    INNER JOIN PCH1 T1 ON T0.[DocEntry] = T1.[DocEntry] INNER JOIN PCH12 T12 ON T0.[DocEntry] = T12.[DocEntry] inner join ocrd t2 on t0.cardcode = t2.cardcode INNER JOIN OCRG T3 ON T2.GROUPCODE=T3.GROUPCODE inner join oact t5 on t1.acctcode = t5.acctcode Left join opdn on  opdn.Docnum=T1.BaseDocNum LEFT join OITM on T1.itemcode=OITM.ITEMcode  LEFT JOIN OITB ON OITM.[ItmsGrpCod] = OITB.[ItmsGrpCod]  LEFT join OSAC on OSAC.AbsEntry=t1.SacEntry LEFT join OCHP on OCHP.AbsEntry=T1.HsnEntry LEFT JOIN PCH4  D_IGST ON T1.DocEntry = D_IGST.DocEntry AND T1.LineNum = D_IGST.LineNum AND D_IGST.staType = -120 AND D_IGST.RelateType = 1          LEFT JOIN PCH4  D_CGST ON T1.DocEntry = D_CGST.DocEntry AND T1.LineNum = D_CGST.LineNum AND D_CGST.staType = -100 AND D_CGST.RelateType = 1          LEFT JOIN PCH4  D_SGST ON T1.DocEntry = D_SGST.DocEntry AND T1.LineNum = D_SGST.LineNum AND D_SGST.staType = -110 AND D_SGST.RelateType = 1  WHERE  T0.CANCELED <> 'Y'  AND T0.CANCELED <> 'C' AND T0.DOCDATE   Between '[%0]' and '[%1]'
Declare @S Date Declare @E Date Set @S = (Select min(CONVERT(date,T0.U_UNE_CLMDT,105)) from [@UNE_MH_GSTR2] T0 where T0.U_UNE_CLMDT>=[%0]) Set @E = (Select MAX(CONVERT(date,T0.U_UNE_CLMDT,105)) from [@UNE_MH_GSTR2] T0 where T0.U_UNE_CLMDT<=[%1])  EXEC [CLAIM_09.08]  @S, @E
select t0.ItemCode , t0.itemname,t0.invntryuom, LastPurPrc as 'Last Purchse Price', t0.LastPurCur as 'Last Purchase Currency',  (select min(A.UnitPrice)from OAT1 A where T0.ItemCode = A.ItemCode and A.LineStatus <> 'c') as 'Min Price (Open PO)',  (select max(A.UnitPrice)from OAT1 A where T0.ItemCode = A.ItemCode and A.LineStatus <> 'c') as 'Max Price (Open PO)' ,(select max(B.price) from por1 B inner join opor on b.docentry=opor.docentry where t0.itemcode = B.Itemcode and B.linestatus<>'c'and opor.u_poty='close')  as 'Max Price (Close Purchase Order)'  FROM OITM t0  where t0.ItmsGrpCod in ('105','114','115','116') order by t0.itemcode asc
select  t0.CardCode as 'Customer Code', t0.CardName as 'Customer Name',T0.DocNum as 'Invoice No.', t0.docdate AS 'Invoice Date',(t0.DocTotalfc + t0.DiscSumFC) as 'Total Value(USD)',(t0.DocTotal+ t0.DiscSum) as 'Total Value(INR)', t0.DiscSumFC as 'Discount Value (USD/EURO)',t0.DocTotalfc as 'Total Amount (USD/EURO)',t0.DocTotal as 'Total Amount'  from ODLN t0     where T0.DocCur <> 'INR' and t0.DocDate >= [%0] and t0.DocDate <= [%1]
select t0.Number,t0.RefDate, t1.Account,t2.AcctName,t1.Debit,t1.Credit,t1.ref1,t1.Ref2,t1.Ref3Line, t0.Series from OJDT t0  inner join JDT1 t1 on t0.TransId = t1.TransId inner join OACT t2 on t1.Account=t2.AcctCode  where t0.Series in ('481','500')  order by t0.Number
select t0.Number,t0.RefDate, t1.Account ,t2.AcctName,t1.Debit,t1.Credit,t1.ref1,t1.Ref2,t1.Ref3Line from OJDT t0  inner join JDT1 t1 on t0.TransId = t1.TransId inner join OACT t2 on t1.Account=t2.AcctCode  where t0.TransType = [%0]  order by t0.Number
SELECT T0.[DocNum], T0.[DocDate], T1.[BaseRef], T1.[BaseType], T1.[ItemCode], T1.[Dscription], T1.[Quantity], T1.[Price]  FROM OIGE T0  INNER JOIN IGE1 T1 ON T0.[DocEntry] = T1.[DocEntry]  where t0.docdate >= [%0] and t0.docdate <=[%1] and t1.baseref <>''  order by t0.docdate
select t1.docnum, t0.DocDate,t1.itemcode,t1.ProdName, t0.Quantity   from ige1 t0 inner join owor t1 on t0.BaseRef=t1.DocNum where t0.ItemCode=[%0] and t1.postdate >= [%1] and t1.postdate <=[%2]
SELECT distinct  T0.[U_UTL_GRDN] as 'GRPO NO',  T1.CARDCODE, T1.CARDNAME, T0.[U_UTL_ITCD] AS 'ITEM CODE', T0.[U_UTL_ITNM] AS 'ITEM NAME',  T0.[U_UTL_BTSZ] AS 'RECEIVED QTY', T0.[U_UTL_REJQ] AS 'REJECT QTY',  T0.U_UTL_PODT AS 'QC DATE' ,  t3.DocNum as 'AP INVOICE NO',  T5.DocNum AS 'DEBIT NOTE NO', T5.DocDate as 'DEBIT NOTE DATE',  t7.DocNum As 'DELIVERY NO' , t7.docdate as 'DELIVERY DATE'  FROM [dbo].[@UTL_OQCHK]  T0  INNER JOIN OPDN T1 ON T0.[U_UTL_GRDN]=T1.DOCNUM left join pch1 T2 on t0.U_UTL_GRDN = t2.BaseRef left join opch t3 on t2.DocEntry = t3.DocEntry left join rpc1 t4 on t3.docnum = t4.baseref left JOIN ORPC T5 ON T4.DocEntry = T5.DOCENTRY left join PRR1 T6 on t4.DocEntry = t6.U_UTL_APCRMDocEntry left join oprr t7 on t6.docentry = t7.docentry  Where T0.[U_UTL_mode] = 'grpo'  AND T0.[U_UTL_GRDN] >='1900001' and t5.series = '298' --AND T3.DOCDATE >= '20190401' and T0.[U_UTL_REJQ]<>'0' ORDER BY T0.U_UTL_GRDN
/* SELECT FROM [dbo].[OITT] T0 */  Declare @BOM nvarchar(max), @QTY nvarchar(max)  /* WHERE */  Set @BOM=/* T0.Code */ '[%0]'  SET @QTY = '[%1]'  select B.Assembly [Product No.],B.Component,(select ItemName from OITM where ItemCode=B.Component)[Component Name],B.[BOM Quantity],   B.[BOM Quantity]* @QTY As 'Requirment',  (select OnHand from OITW where itemcode=b.component and WhsCode = 'mst') as 'Stock In MST',   (select OnHand from OITW where itemcode=b.component and WhsCode = 'mst') - (B.[BOM Quantity]* @QTY)  as 'Balance Qty'   from (select A.Assembly,CASE when isnull(A.Component6,'')='' then  (case when isnull(A.Component5,'')='' then  (case when isnull(A.Component4,'')='' then  (case when isnull(A.Component3,'')='' then  (case when isnull(A.Component2,'')='' then  A.Component1 else A.Component2 end)else A.Component3 end)  else A.Component4 end) else A.Component5 end ) else A.Component6 end Component  ,CASE when isnull(A.Qty6,0)=0 then  (case when isnull(A.Qty5,0)=0 then  (case when isnull(A.Qty4,0)=0 then  (case when isnull(A.Qty3,0)=0 then  (case when isnull(A.Qty2,0)=0 then  A.Qty1 else A.Qty2 end)else A.Qty3 end)  else A.Qty4 end) else A.Qty5 end ) else A.Qty6 end [BOM Quantity]  ,CASE when isnull(A.whs6,'')='' then  (case when isnull(A.whs5,'')='' then  (case when isnull(A.whs4,'')='' then  (case when isnull(A.whs3,'')='' then  (case when isnull(A.whs2,'')='' then  A.whs1 else A.whs2 end)else A.whs3 end)  else A.whs4 end) else A.whs5 end ) else A.whs6 end [BOM warehouse]  from (SELECT T0.[Father] as 'Assembly',T0.[code] as 'Component1', T0.Quantity as 'Qty1', T0.warehouse as 'whs1',  t10.[ItemName] 'Description1',T1.[Code] as 'Component2', T1.Quantity as 'Qty2', T1.warehouse as 'whs2',  t11.[ItemName] 'Description2', T2.[Code] as 'Component3', T2.Quantity as 'Qty3', T2.warehouse as 'whs3',  t12.[ItemName] 'Description3', T3.[Code] as 'Component4', T3.Quantity as 'Qty4', T3.warehouse as 'whs4',  t13.[ItemName] 'Description4',T4.[Code] as 'Component5', T4.Quantity as 'Qty5', T4.warehouse as 'whs5',  t14.[ItemName] 'Description5', T5.[Code] as 'Component6', T5.Quantity as 'Qty6', T5.warehouse as 'whs6',  t15.[ItemName] 'Description6'    FROM ITT1 T0   LEFT OUTER JOIN ITT1 T1 on T0.Code = T1.Father  LEFT OUTER JOIN ITT1 T2 on T2.Father =T1.Code  LEFT OUTER JOIN ITT1 T3 on T2.Code = T3.Father LEFT OUTER JOIN ITT1 T4 on T3.Code = T4.Father  LEFT OUTER JOIN ITT1 T5 on T4.Code = T5.Father  LEFT OUTER JOIN ITT1 T6 on T5.Code = T6.Father  left outer join oitm t20 on t0.father = t20.itemcode left outer join oitm t10 on t0.code = t10.itemcode  left outer join oitm t11 on t1.code = t11.itemcode  left outer join oitm t12 on t2.code = t12.itemcode left outer join oitm t13 on t3.code = t13.itemcode  left outer join oitm t14 on t4.code = t14.itemcode  left outer join oitm t15 on t5.code = t15.itemcode  where T0.Father=@BOM)A)B
select distinct T0.U_JBNO,t0.docnum, T0.docdate, T1.ItemCode, t1.Dscription, t1.Quantity, t1.unitmsr from OIGN T0  inner join ign1 T1 on t0.DocEntry = t1.DocEntry LEFT join IGE1 T2 on T0.U_GISE = T2.DocEntry  where t0.u_jbno <> '' AND T2.ItemCode = [%0] and t0.docdate>=[%1] and T0.docdate<=[%2]
select DISTINCT cardname, DocNum as 'Invoice No', T0.DocDate as 'Invoice Date', DocDueDate as 'Due Date',  DocTotal as 'Amount in INR',[PaidToDate] as 'Received Amount', (DocTotal -[PaidToDate]) as 'Balance Amount',   DATEDIFF(DD,DocDueDate,GETDATE()) as 'Due From Day'   from OINV T0 INNER JOIN INV1 T1 ON T0.DocEntry = T1.DocEntry where DocStatus= 'o' and DocDueDate < GETDATE() and  DATEDIFF(DD,DocDueDate,GETDATE()) <> '0'   order by [Due From Day] DESC
Declare @S Date Declare @E Date Set @S = (Select min(CONVERT(date,T0.U_UNE_CLMDT,105)) from [@UNE_MH_GSTR2] T0 where T0.U_UNE_CLMDT>=[%0]) Set @E = (Select MAX(CONVERT(date,T0.U_UNE_CLMDT,105)) from [@UNE_MH_GSTR2] T0 where T0.U_UNE_CLMDT<=[%1])  EXEC [CLAIM_Debit_Register]  @S, @E
Select t1.ItemCode,(SELECT B.ITEMNAME FROM OITM B WHERE T1.ITEMCODE=B.ITEMCODE) as 'ITEM NAME',SUM(t1.Quantity) AS 'QTY',SUM(T1.LineTotal) AS 'SALE VALUE'   ,(SELECT A.LastPurPrc FROM OITM A WHERE A.ITEMCODE = T1.ItemCode) AS 'BOM UNIT VALUE'   from ODLN T0  inner join DLN1 T1 on t0.DocEntry=T1.DocEntry inner join OITM T2 on t1.itemcode=t2.itemcode  where t0.DOCDATE >=[%0] AND T0.DOCDATE<=[%1] GROUP BY T1.ItemCode
SELECT T0.[DocNum], T0.[DocDate],  T1.ItemCode,t1.dscription,T1.Quantity,(ISNULL(T1.Price,0)-ISNULL(U_UPRC,0)) AS 'RM Cost/Unit',U_UPRC AS 'Jobwork Cost/Unit',(ISNULL(T1.Price,0)-ISNULL(U_UPRC,0))*ISNULL(T1.Quantity,0)as 'Total RM Cost',(ISNULL(T1.U_UPRC,0)*ISNULL(T1.Quantity,0))'Total Jobwork Cost'  FROM OIGN T0    INNER JOIN IGN1 T1 ON T0.[DocEntry] = T1.[DocEntry] --inner join OITM T3 ON T1.ItemCode = T3.ItemCode ---Inner join oact t2 on t1.acctcode = t2.acctcode  where T0.DocDate >= [%0] and T0.DocDate <= [%1] AND T0.U_JBNO<>''
SELECT T0.[DocNum], T0.[DocDate], T1.[ItemCode], T1.[Dscription], T1.[Quantity] FROM OIGN T0  INNER JOIN IGN1 T1 ON T0.[DocEntry] = T1.[DocEntry] WHERE T1.[ItemCode] =[%0]
SELECT T0.[ItemCode], T0.[ItemName], T0.[ItmsGrpCod], T0.[PlaningSys] FROM OITM T0  where T0.[ItmsGrpCod] in ('103','112','100','138','106','105','115','116') and T0.[PlaningSys] = 'N'
SELECT T0.[DocNum] as 'QC Doc No', T0.[U_UTL_PODT], T0.[U_UTL_MODE],T0.[U_UTL_GRDN] as 'MRR NO.', T0.[U_UTL_SPCD], T0.[U_UTL_SPNM],  T0.[U_UTL_QCPIN], T0.[U_UTL_GINM],  T0.[U_UTL_ITCD], T0.[U_UTL_ITNM], T0.[U_UTL_BTSZ], T0.[U_UTL_APPQ], T0.[U_UTL_AINO],  T0.[U_UTL_REJQ], T0.[U_UTL_RINO]   FROM [dbo].[@UTL_OQCHK]  T0   where T0.[U_UTL_MODE] = [%0] and T0.[U_UTL_PODT] >= [%1] and T0.[U_UTL_PODT] <= [%2]
SELECT T0.[DocNum] as 'QC Doc No', T0.[U_UTL_PODT], T0.[U_UTL_MODE], T0.[U_UTL_QCPIN],  T0.[U_UTL_ITCD], T0.[U_UTL_ITNM], T0.[U_UTL_BTSZ], T0.[U_UTL_APPQ], T0.[U_UTL_AINO],  T0.[U_UTL_REJQ], T0.[U_UTL_RINO]   FROM [dbo].[@UTL_OQCHK]  T0    where T0.[U_UTL_MODE] = 'Receipt From Production' and T0.[U_UTL_PODT] >= [%1] and T0.[U_UTL_PODT] <= [%2]
SELECT T0.[ItemCode], T0.[ItemName], T0.[U_Weight] FROM OITM T0
SELECT T0.[U_USERCD], T0.[U_USERNM], T0.[U_UNE_ITCD], T0.[U_UNE_ITNM], T0.[U_UNE_FLG], T0.[DocEntry] FROM [dbo].[@UNE_MD_ITCDGEN]  T0 WHERE T0.[U_UNE_FLG] ='n'
SELECT T0.cardcode, T0.cardname, T0.DOCNUM as 'Debit Note No', T0.DOCDATE as 'Debit Note Date', T0.NumAtCard as 'Invoice No', T0.TaxDate as 'Invoice Date', (T0.[DocTotal]-T0.[WTSum]-T0.[VatSumSy])as 'Taxable Value',T0.[VatSumSy],T0.[WTSum], T0.[DocTotal]   FROM ORPC T0  WHERE T0.[DocDate]  >=[%0] and T0.[DocDate] <=[%1]
Select A.DOCDATE,ITEMCODE, Dscription, Quantity,B.FromWhsCod,B.WhsCode from OWTR A  INNER JOIN WTR1 B ON A.DocEntry=B.DocEntry  WHERE B.FromWhsCod = 'MST' AND ItemCode LIKE '38%%' AND B.WhsCode<>'MST' and a.docdate>=[%0] and a.docdate<=[%1]
SELECT T0.[ItemCode], T0.[ItemName], T0.[ItmsGrpCod],t1.ItmsGrpNam, t1.BalInvntAc, t2.AcctName, t1.VarianceAc, t3.AcctName, T0.[EvalSystem] , T0.LastPurPrc  FROM OITM T0 inner join OITB T1 on T0.ItmsGrpCod=t1.ItmsGrpCod  inner join OACT T2 on T1.BalInvntAc = t2.AcctCode Left join OACT t3 on t1. VarianceAc = t3.AcctCode  where T0.[ItmsGrpCod]<>'136' order by t0.itemcode
SELECT T0.CardName, T0.DocNum,T0.DocDueDate,T0.DocTotalFC,T0.DocTotal,T0.DocCurr, T0.TrsfrAcct,T0.TrsfrRef  FROM OVPM T0  WHERE T0.DocType=[%0] AND T0.DocDate>=[%1] AND T0.DocDate<=[%2] and T0.Canceled='N'
/* SELECT FROM [dbo].[OITT] T0 */  Declare @BOM nvarchar(max)  /* WHERE */  Set @BOM=/* T0.Code */ [%0] select B.Assembly [Product No.],B.Component,(select ItemName  from OITM where ItemCode=B.Component)[Component Name],B.[BOM Quantity],  B.[BOM warehouse],   (Select max (unitprice) from OAT1 where ItemCode=B.Component and OAT1.LineStatus<> 'c' ) [Unit Price], B.[BOM Quantity]*(Select max (unitprice) from OAT1 where ItemCode=B.Component and OAT1.LineStatus<> 'c' )  As 'RM Cost'  from  (select A.Assembly,CASE when isnull(A.Component6,'')='' then  (case when isnull(A.Component5,'')='' then  (case when isnull(A.Component4,'')='' then  (case when isnull(A.Component3,'')='' then   (case when isnull(A.Component2,'')='' then  A.Component1 else A.Component2 end)else A.Component3 end)   else A.Component4 end) else A.Component5 end ) else A.Component6 end Component  ,CASE when isnull(A.Qty6,0)=0 then   (case when isnull(A.Qty5,0)=0 then  (case when isnull(A.Qty4,0)=0 then  (case when isnull(A.Qty3,0)=0 then  (case when isnull(A.Qty2,0)=0 then  A.Qty1 else A.Qty2 end)else A.Qty3 end)  else A.Qty4 end) else A.Qty5 end ) else A.Qty6 end [BOM Quantity]  ,CASE when isnull(A.whs6,'')='' then  (case when isnull(A.whs5,'')='' then   (case when isnull(A.whs4,'')='' then  (case when isnull(A.whs3,'')='' then  (case when isnull(A.whs2,'')='' then  A.whs1 else A.whs2 end)else A.whs3 end)  else A.whs4 end) else A.whs5 end ) else A.whs6 end [BOM warehouse]  from (SELECT T0.[Father] as 'Assembly',T0.[code] as 'Component1', T0.Quantity as 'Qty1', T0.warehouse as 'whs1',  t10.[ItemName] 'Description1',T1.[Code] as 'Component2', T1.Quantity as 'Qty2', T1.warehouse as 'whs2',  t11.[ItemName] 'Description2', T2.[Code] as 'Component3', T2.Quantity as 'Qty3', T2.warehouse as 'whs3',  t12.[ItemName] 'Description3', T3.[Code] as 'Component4', T3.Quantity as 'Qty4', T3.warehouse as 'whs4', t13.[ItemName] 'Description4',T4.[Code] as 'Component5', T4.Quantity as 'Qty5', T4.warehouse as 'whs5',  t14.[ItemName] 'Description5', T5.[Code] as 'Component6', T5.Quantity as 'Qty6', T5.warehouse as 'whs6',   t15.[ItemName] 'Description6'    FROM ITT1 T0    LEFT OUTER JOIN ITT1 T1 on T0.Code = T1.Father  LEFT OUTER JOIN ITT1 T2 on T2.Father =T1.Code   LEFT OUTER JOIN ITT1 T3 on T2.Code = T3.Father  LEFT OUTER JOIN ITT1 T4 on T3.Code = T4.Father   LEFT OUTER JOIN ITT1 T5 on T4.Code = T5.Father   LEFT OUTER JOIN ITT1 T6 on T5.Code = T6.Father   left outer join oitm t20 on t0.father = t20.itemcode  left outer join oitm t10 on t0.code = t10.itemcode   left outer join oitm t11 on t1.code = t11.itemcode   left outer join oitm t12 on t2.code = t12.itemcode  left outer join oitm t13 on t3.code = t13.itemcode   left outer join oitm t14 on t4.code = t14.itemcode   left outer join oitm t15 on t5.code = t15.itemcode   where T0.Father=@BOM)A)B
SELECT      T0.DocNum AS "Order No.",     T0.ItemCode,     T1.ItemName AS "Description",     T0.DueDate,     T0.PostDate AS "Date of Update - Sent",     T0.Status,     T0.OriginType,      T0.PlannedQty,     T0.CmpltQty AS "Completed Qty",     T0.RjctQty AS "Rejected Qty",     T0.PlannedQty - T0.CmpltQty - T0.RjctQty AS "Open Qty",     T4.ItmsGrpNam,     T2.U_NAME AS "User Name",     T3.CardName AS "Customer Name",     T0.OriginNum AS "Sales Order"  FROM OWOR T0  LEFT JOIN OCRD T3 ON T0.CardCode = T3.CardCode LEFT JOIN OITM T1 ON T0.ItemCode = T1.ItemCode LEFT JOIN OITB T4 ON T1.ItmsGrpCod = T4.ItmsGrpCod LEFT JOIN OUSR T2 ON T0.UserSign = T2.userId WHERE      (T0.DueDate >= '[%0]' OR '[%0]' = '')     AND (T0.DueDate <= '[%1]' OR '[%1]' = '')     AND (T0.Type = '[%2]' OR '[%2]' = '')     AND (T0.status = '[%3]' OR '[%3]' = '')     AND (T0.OriginType = '[%4]' OR '[%4]' = '')     AND (T0.warehouse = '[%5]' OR '[%5]' = '')     AND (T4.ItmsGrpNam = '[%6]' OR '[%6]' = '')     AND (T0.ItemCode = '[%7]' OR '[%7]' = '')     AND (T2.U_NAME = '[%8]' OR '[%8]' = '')     AND (T3.CardName = '[%9]' OR '[%9]' = '');
Declare @FD DateTime,  @TD DateTime    set @FD = (Select MIN(T0.DocDate) From oinm T0 where T0.DocDate >='[%0]')  set @TD = (Select Max(T1.DocDate) From oinm T1 where T1.DocDate <='[%1]')     exec Stock_Ledger @FD,@TD
SELECT      T0.WhsCode, T4.[Location] as 'Whs Location',     T0.ItemCode,      T1.ItemName,      SUM(T0.OnHand) AS 'TotalQty',          SUM(T0.OnHand * T0.AvgPrice) AS 'TotalValue',     SUM(CASE WHEN DATEDIFF(day, T1.LastPurDat, GETDATE()) <= 30 THEN T0.OnHand END) '<=30 Days',      SUM(CASE WHEN DATEDIFF(day, T1.LastPurDat, GETDATE()) <= 30 THEN T0.OnHand * T0.AvgPrice END) '<=30 Days Value',     SUM(CASE WHEN DATEDIFF(day, T1.LastPurDat, GETDATE()) BETWEEN 31 AND 60 THEN T0.OnHand * T0.AvgPrice END) '>31 <=60 days Value',      SUM(CASE WHEN DATEDIFF(day, T1.LastPurDat, GETDATE()) BETWEEN 31 AND 60 THEN T0.OnHand END) '>31 <=60 days',      SUM(CASE WHEN DATEDIFF(day, T1.LastPurDat, GETDATE()) BETWEEN 61 AND 90 THEN T0.OnHand * T0.AvgPrice END) '>61 <=90 days Value',      SUM(CASE WHEN DATEDIFF(day, T1.LastPurDat, GETDATE()) BETWEEN 61 AND 90 THEN T0.OnHand END) '>61 <=90 days',      SUM(CASE WHEN DATEDIFF(day, T1.LastPurDat, GETDATE()) BETWEEN 91 AND 180 THEN T0.OnHand * T0.AvgPrice END) '>91 <=180 days Value',      SUM(CASE WHEN DATEDIFF(day, T1.LastPurDat, GETDATE()) BETWEEN 91 AND 180 THEN T0.OnHand END) '>91 <=180 days',      SUM(CASE WHEN DATEDIFF(day, T1.LastPurDat, GETDATE()) BETWEEN 181 AND 270 THEN T0.OnHand * T0.AvgPrice END) '>181 <=270 days Value',      SUM(CASE WHEN DATEDIFF(day, T1.LastPurDat, GETDATE()) BETWEEN 181 AND 270 THEN T0.OnHand END) '>181 <=270 days',      SUM(CASE WHEN DATEDIFF(day, T1.LastPurDat, GETDATE()) BETWEEN 271 AND 365 THEN T0.OnHand * T0.AvgPrice END) '>271 days <= 365 days Value',      SUM(CASE WHEN DATEDIFF(day, T1.LastPurDat, GETDATE()) BETWEEN 271 AND 365 THEN T0.OnHand END) '>271 days <= 365 days',      SUM(CASE WHEN DATEDIFF(day, T1.LastPurDat, GETDATE()) > 366 THEN T0.OnHand END) '>365 Days',     SUM(CASE WHEN DATEDIFF(day, T1.LastPurDat, GETDATE()) > 366 THEN T0.OnHand * T0.AvgPrice END) '>365 Days Value'    FROM      OITW T0       INNER JOIN OITM T1 ON T0.ItemCode = T1.ItemCode      INNER JOIN OITB T2 ON T1.ItmsGrpCod = T2.ItmsGrpCod    LEFT JOIN OWHS T3 ON T3.WhsCode = T0.WhsCode     LEFT JOIN OLCT T4 ON T4.Code = T3.Location   WHERE      T0.OnHand > 0  GROUP BY      T0.WhsCode,      T0.ItemCode,      T1.ItemName,     T0.AvgPrice,      T1.LastPurDat,T4.[Location]
WITH BOM (Code, NAME, UOM, Level, TreeType, Quantity, Father, Fname, LastPrice, Currency, TotalValue, TotalCost) AS (     SELECT          T0.Code,          T2.ItemName,          T2.InvntryUom,          0 AS Level,          T2.TreeType,         T0.Qauntity,          T0.Code,         T2.ItemName,         T2.LastPurPrc,         T2.LastPurCur,         T0.Qauntity * T2.LastPurPrc AS TotalValue ,     CASE WHEN T2.TreeType like 'N' THEN T0.Qauntity * T2.LastPurPrc END AS TotalCost     FROM dbo.OITT T0      LEFT JOIN OITM T2 ON T0.Code = T2.ItemCode  WHERE T0.Code ='[%0]'     UNION ALL      SELECT           T1.Code,         T2.ItemName,          T2.InvntryUom,          Level + 1,          T2.TreeType,          T1.Quantity,          T1.Father,         T3.ItemName,         T2.LastPurPrc,         T2.LastPurCur,         T1.Quantity * T2.LastPurPrc AS TotalValue ,     CASE WHEN T2.TreeType ='N' THEN T1.Quantity * T2.LastPurPrc END AS TotalCost     FROM         dbo.ITT1 AS T1          INNER JOIN OITM T2 ON T1.Code = T2.ItemCode           INNER JOIN OITM T3 ON T1.Father = T3.ItemCode         JOIN BOM ON T1.Father = BOM.Code  )  SELECT      BOM.Code,      BOM.NAME,      BOM.UOM,      BOM.Level,      BOM.TreeType,      BOM.Quantity,      BOM.Father,      BOM.Fname,      BOM.LastPrice,      BOM.Currency,      BOM.TotalValue,      OINM.MinPrice * BOM.Quantity AS MinValue,     OINM.MaxPrice * BOM.Quantity AS MaxValue,     OINM.AvgPrice * BOM.Quantity AS AvgValue,     OITM.OnHand FROM      BOM     LEFT JOIN (         SELECT              ItemCode,             MIN(Price) AS MinPrice,             MAX(Price) AS MaxPrice,             AVG(Price) AS AvgPrice         FROM              OINM          WHERE              TransType IN (20, 59)         GROUP BY              ItemCode     ) AS OINM ON BOM.Code = OINM.ItemCode     LEFT JOIN OITM ON BOM.Code = OITM.ItemCode OPTION (MAXRECURSION 99);
SELECT T0.[DocEntry],T1.DocNum,T1.[DocDate], T0.[LineNum], T0.[Dscription], T0.[Price], T0.[LineTotal],T1.DocTotal, T0.[AcctCode], T1.[DocType], T1.[CANCELED], T1.[CardCode], T1.[CardName], T3.[Debit], T3.[Credit], T3.[Account], (SELECT AcctName FROM OACT WHERE AcctCode = T3.Account) as 'G/L Account Name' FROM PCH1 T0 INNER JOIN OPCH T1 ON T0.[DocEntry] = T1.[DocEntry] INNER JOIN OJDT T2 ON T1.[TransId] = T2.[TransId] INNER JOIN JDT1 T3 ON T2.[TransId] = T3.[TransId] WHERE T0.[DocDate] >='[%0]' AND T0.[DocDate]<='[%1]'  AND T1.DOCTYPE <>'I' AND T1.CardCode='V000339' AND T1.[CANCELED]<>'Y'
SELECT        H.DocEntry,H.DocNum,H.DocDate,h.NumAtCard as InvNo ,H.taxdate InvDate, o.TransId,H.docDate 'Posting Date', d.shortname as  Account,    (SELECT AcctName FROM OACT WHERE acctcode=d.shortname )AccountName,d.Debit,d.Credit       into #temp       FROM OPCH H   LEFT OUTER JOIN OJDT O on H.DocEntry=O.CreatedBy  INNER JOIN JDt1 D on O.TransID=D.TransID and H.objtype=O.transtype       WHERE  h.[DocDate] >='[%0]' AND h.[DocDate]<='[%1]'AND  h.CardCode='V000339'             update T    set AccountName= (case when AccountName is null  then (select cardName from ocrd where cardcode=t.Account)   else accountname end)    from #temp T      Select * from #temp   order by Debit-credit  desc
SELECT DISTINCT T1.[U_ITCD], ---T1.[U_ITNM],T3.ItmsGrpNam, T2.LastPurPrc, MIN(T1.[U_UPRC]) OVER (PARTITION BY T1.[U_ITCD]ORDER BY T0.DocDate ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS MinPrice, MAX(T1.[U_UPRC]) OVER (PARTITION BY T1.[U_ITCD] ORDER BY T0.DocDate ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS MaxPrice, lAST_VALUE(T1.[U_UPRC]) OVER (PARTITION BY T1.[U_ITCD] ORDER BY T0.DocDate ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS LastPrice, AVG(T1.[U_UPRC]) OVER (PARTITION BY T1.[U_ITCD] ORDER BY T0.DocDate ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS AvgPrice FROM OPOR T0   INNER JOIN POR1 T1 ON T0.[DocEntry] = T1.[DocEntry] LEFT JOIN OITM T2 ON T2.ItemCode = T1.U_ITCD LEFT JOIN OITB T3 ON T3.ItmsGrpCod = T2.ItmsGrpCod WHERE T0.DocType='S' AND T0.u_jb='Y'  AND T0.DocStatus !='C'  and  T0.CardCode <> 'V000081' AND T1.[U_ITcd] IS NOT NULL
SELECT DISTINCT D1.[TransId],D1.Number,D0.[RefDate],D0.[Line_ID]+1 AS 'Line Num',D0.[Account],T1.AcctName, D0.[Debit],D0.[Credit],D0.[ShortName],D0.[ContraAct],ISNULL(T2.CardName,T3.AcctName) as 'Contra Account Name', D0.[LineMemo],D0.[Ref1],D0.[Ref2],D0.[BaseRef],D0.[TransType], CASE  WHEN D0.TransType='1' THEN 'G/L Accounts' WHEN D0.TransType='2' THEN 'Business Partner' WHEN D0.TransType='3' THEN 'Bank Codes' WHEN D0.TransType='4' THEN 'Items' WHEN D0.TransType='5' THEN 'Tax Definition' WHEN D0.TransType='6' THEN 'Price Lists' WHEN D0.TransType='7' THEN 'Special Prices' WHEN D0.TransType='8' THEN 'Item Properties' WHEN D0.TransType='9' THEN 'Rate Differences' WHEN D0.TransType='10' THEN 'Card Groups' WHEN D0.TransType='11' THEN 'Contact Persons' WHEN D0.TransType='12' THEN 'Users' WHEN D0.TransType='13' THEN 'A/R Invoice' WHEN D0.TransType='14' THEN 'A/R Credit Memo' WHEN D0.TransType='15' THEN 'Delivery' WHEN D0.TransType='16' THEN 'Returns' WHEN D0.TransType='17' THEN 'Sales Order' WHEN D0.TransType='18' THEN 'A/P Invoice' WHEN D0.TransType='19' THEN 'A/P Credit Memo' WHEN D0.TransType='20' THEN 'Goods Receipt PO' WHEN D0.TransType='21' THEN 'Goods Return' WHEN D0.TransType='22' THEN 'Purchase Order' WHEN D0.TransType='23' THEN 'Sales Quotation' WHEN D0.TransType='24' THEN 'Incoming Payment' WHEN D0.TransType='25' THEN 'Deposit' WHEN D0.TransType='26' THEN 'Reconciliation History' WHEN D0.TransType='27' THEN 'Check Register' WHEN D0.TransType='28' THEN 'Journal Voucher Entry' WHEN D0.TransType='29' THEN 'Journal Vouchers List' WHEN D0.TransType='30' THEN 'Journal Entry' WHEN D0.TransType='31' THEN 'Items – Warehouse' WHEN D0.TransType='32' THEN 'Print Preferences' WHEN D0.TransType='33' THEN 'Activities' WHEN D0.TransType='34' THEN 'Recurring Postings' WHEN D0.TransType='35' THEN 'Document Numbering' WHEN D0.TransType='36' THEN 'Credit Cards' WHEN D0.TransType='37' THEN 'Currency Codes' WHEN D0.TransType='38' THEN 'CPI Codes' WHEN D0.TransType='39' THEN 'Administration' WHEN D0.TransType='40' THEN 'Payment Terms' WHEN D0.TransType='41' THEN 'Preferences' WHEN D0.TransType='42' THEN 'External Bank Statement Received' WHEN D0.TransType='43' THEN 'Manufacturers' WHEN D0.TransType='44' THEN 'Card Properties' WHEN D0.TransType='45' THEN 'Journal Entry Codes' WHEN D0.TransType='46' THEN 'Outgoing Payments' WHEN D0.TransType='47' THEN 'Serial Numbers' WHEN D0.TransType='48' THEN 'Loading Expenses' WHEN D0.TransType='49' THEN 'Delivery Types' WHEN D0.TransType='50' THEN 'Length Units' WHEN D0.TransType='51' THEN 'Weight Units' WHEN D0.TransType='52' THEN 'Item Groups' WHEN D0.TransType='53' THEN 'Sales Employee' WHEN D0.TransType='54' THEN 'Report – Selection Criteria' WHEN D0.TransType='55' THEN 'Posting Templates' WHEN D0.TransType='56' THEN 'Customs Groups' WHEN D0.TransType='57' THEN 'Checks for Payment' WHEN D0.TransType='58' THEN 'Whse Journal' WHEN D0.TransType='59' THEN 'Goods Receipt' WHEN D0.TransType='60' THEN 'Goods Issue' WHEN D0.TransType='61' THEN 'Cost Center' WHEN D0.TransType='62' THEN 'Cost Rate' WHEN D0.TransType='63' THEN 'Project Codes' WHEN D0.TransType='64' THEN 'Warehouses' WHEN D0.TransType='65' THEN 'Commission Groups' WHEN D0.TransType='66' THEN 'Product Tree' WHEN D0.TransType='67' THEN 'Inventory Transfer' WHEN D0.TransType='68' THEN 'Production Instructions' WHEN D0.TransType='69' THEN 'Landed Costs' WHEN D0.TransType='70' THEN 'Payment Methods' WHEN D0.TransType='71' THEN 'Credit Card Payment' WHEN D0.TransType='72' THEN 'Credit Card Management' WHEN D0.TransType='73' THEN 'Customer/Vendor Cat. No.' WHEN D0.TransType='74' THEN 'Credit Payments' WHEN D0.TransType='75' THEN 'CPI and FC Rates' WHEN D0.TransType='76' THEN 'Postdated Deposit' WHEN D0.TransType='77' THEN 'Budget' WHEN D0.TransType='78' THEN 'Budget Cost Assess. Mthd' WHEN D0.TransType='79' THEN 'Retail Chains' WHEN D0.TransType='80' THEN 'Alerts Template' WHEN D0.TransType='81' THEN 'Alerts' WHEN D0.TransType='82' THEN 'Received Alerts' WHEN D0.TransType='83' THEN 'Message Sent' WHEN D0.TransType='84' THEN 'Activity Subjects' WHEN D0.TransType='85' THEN 'Special Prices for Groups' WHEN D0.TransType='86' THEN 'Application Start' WHEN D0.TransType='87' THEN 'Distribution List' WHEN D0.TransType='88' THEN 'Shipping Types' WHEN D0.TransType='89' THEN 'Outgoing' WHEN D0.TransType='90' THEN 'Transition' WHEN D0.TransType='91' THEN 'Budget Scenario' WHEN D0.TransType='92' THEN 'Interest Prices' WHEN D0.TransType='93' THEN 'User Defaults' WHEN D0.TransType='94' THEN 'Serial Numbers for Items' WHEN D0.TransType='95' THEN 'Financial Report Templates' WHEN D0.TransType='96' THEN 'Financial Report Categories' WHEN D0.TransType='97' THEN 'Opportunity' WHEN D0.TransType='98' THEN 'Interest' WHEN D0.TransType='99' THEN 'Interest Level' WHEN D0.TransType='100' THEN 'Information Source' WHEN D0.TransType='101' THEN 'Opportunity Stage' WHEN D0.TransType='102' THEN 'Defect Cause' WHEN D0.TransType='103' THEN 'Activity Types' WHEN D0.TransType='104' THEN 'Meetings Location' WHEN D0.TransType='105' THEN 'Service Calls' WHEN D0.TransType='106' THEN 'Batch No. for Item' WHEN D0.TransType='107' THEN 'Alternative Items 2' WHEN D0.TransType='108' THEN 'Partners' WHEN D0.TransType='109' THEN 'Competitors' WHEN D0.TransType='110' THEN 'User Validations' WHEN D0.TransType='111' THEN 'Posting Period' WHEN D0.TransType='112' THEN 'Drafts' WHEN D0.TransType='113' THEN 'Batches and Serial Numbers' WHEN D0.TransType='114' THEN 'User Display Cat.' WHEN D0.TransType='115' THEN 'Lender – Pelecard' WHEN D0.TransType='116' THEN 'Withholding Tax Deduction Hierarchy' WHEN D0.TransType='117' THEN 'Withholding Tax Deduction Groups' WHEN D0.TransType='118' THEN 'Branches' WHEN D0.TransType='119' THEN 'Departments' WHEN D0.TransType='120' THEN 'Confirmation Level' WHEN D0.TransType='121' THEN 'Approval Templates' WHEN D0.TransType='122' THEN 'Docs. for Confirmation' WHEN D0.TransType='123' THEN 'Checks for Payment Drafts' WHEN D0.TransType='124' THEN 'Company Info' WHEN D0.TransType='125' THEN 'Freight Setup' WHEN D0.TransType='126' THEN 'Sales Tax Authorities' WHEN D0.TransType='127' THEN 'Sales Tax Authorities Type' WHEN D0.TransType='128' THEN 'Sales Tax Codes' WHEN D0.TransType='129' THEN 'Countries' WHEN D0.TransType='130' THEN 'States' WHEN D0.TransType='131' THEN 'Address Formats' WHEN D0.TransType='132' THEN 'A/R Correction Invoice' WHEN D0.TransType='133' THEN 'Cash Discount' WHEN D0.TransType='134' THEN 'Query Catagories' WHEN D0.TransType='135' THEN 'Triangular Deal' WHEN D0.TransType='136' THEN 'Data Migration' WHEN D0.TransType='137' THEN 'Workstation ID' WHEN D0.TransType='138' THEN 'Indicator' WHEN D0.TransType='139' THEN 'Goods Shipment' WHEN D0.TransType='140' THEN 'Payment Draft' WHEN D0.TransType='141' THEN 'Query Wizard' WHEN D0.TransType='142' THEN 'Account Segmentation' WHEN D0.TransType='143' THEN 'Account Segmentation Categories' WHEN D0.TransType='144' THEN 'Location' WHEN D0.TransType='145' THEN '1099 Forms' WHEN D0.TransType='146' THEN 'Cycle' WHEN D0.TransType='147' THEN 'Payment Methods for Payment Wizard' WHEN D0.TransType='148' THEN '1099 Opening Balance' WHEN D0.TransType='149' THEN 'Dunning Interest Rate' WHEN D0.TransType='150' THEN 'BP Priorities' WHEN D0.TransType='151' THEN 'Dunning Letters' WHEN D0.TransType='152' THEN 'User Fields – Description' WHEN D0.TransType='153' THEN 'User Tables' WHEN D0.TransType='154' THEN 'My Menu Items' WHEN D0.TransType='155' THEN 'Payment Run' WHEN D0.TransType='156' THEN 'Pick List' WHEN D0.TransType='157' THEN 'Payment Wizard' WHEN D0.TransType='158' THEN 'Payment Results Table' WHEN D0.TransType='159' THEN 'Payment Block' WHEN D0.TransType='160' THEN 'Queries' WHEN D0.TransType='161' THEN 'Central Bank Ind.' WHEN D0.TransType='162' THEN 'Inventory Revaluation' WHEN D0.TransType='163' THEN 'A/P Correction Invoice' WHEN D0.TransType='164' THEN 'A/P Correction Invoice Reversal' WHEN D0.TransType='165' THEN 'A/R Correction Invoice' WHEN D0.TransType='166' THEN 'A/R Correction Invoice Reversal' WHEN D0.TransType='167' THEN 'Service Call Statuses' WHEN D0.TransType='168' THEN 'Service Call Types' WHEN D0.TransType='169' THEN 'Service Call Problem Types' WHEN D0.TransType='170' THEN 'Contract Template' WHEN D0.TransType='171' THEN 'Employees' WHEN D0.TransType='172' THEN 'Employee Types' WHEN D0.TransType='173' THEN 'Employee Status' WHEN D0.TransType='174' THEN 'Termination Reason' WHEN D0.TransType='175' THEN 'Education Types' WHEN D0.TransType='176' THEN 'Customer Equipment Card' WHEN D0.TransType='177' THEN 'Agent Name' WHEN D0.TransType='178' THEN 'Withholding Tax' WHEN D0.TransType='179' THEN 'Already Displayed 347, 349 and WTax Reports' WHEN D0.TransType='180' THEN 'Tax Report' WHEN D0.TransType='181' THEN 'Bill of Exchange for Payment' WHEN D0.TransType='182' THEN 'Bill Of Exchang Transaction' WHEN D0.TransType='183' THEN 'File Format' WHEN D0.TransType='184' THEN 'Period Indicator' WHEN D0.TransType='185' THEN 'Doubtful Debts' WHEN D0.TransType='186' THEN 'Holiday Table' WHEN D0.TransType='187' THEN 'BP – Bank Account' WHEN D0.TransType='188' THEN 'Service Call Solution Statuses' WHEN D0.TransType='189' THEN 'Service Call Solutions' WHEN D0.TransType='190' THEN 'Service Contracts' WHEN D0.TransType='191' THEN 'Service Calls' WHEN D0.TransType='192' THEN 'Service Call Origins' WHEN D0.TransType='193' THEN 'User Key Description' WHEN D0.TransType='194' THEN 'Queue' WHEN D0.TransType='195' THEN 'Inflation Wizard' WHEN D0.TransType='196' THEN 'Dunning Terms' WHEN D0.TransType='197' THEN 'Dunning Wizard' WHEN D0.TransType='198' THEN 'Sales Forecast' WHEN D0.TransType='199' THEN 'MRP Scenarios' WHEN D0.TransType='200' THEN 'Territories' WHEN D0.TransType='201' THEN 'Industries' WHEN D0.TransType='202' THEN 'Production Order' WHEN D0.TransType='203' THEN 'A/R Down Payment' WHEN D0.TransType='204' THEN 'A/P Down Payment' WHEN D0.TransType='205' THEN 'Package Types' WHEN D0.TransType='206' THEN 'User-Defined Object' WHEN D0.TransType='207' THEN 'Data Ownership – Objects' WHEN D0.TransType='208' THEN 'Data Ownership – Exceptions' WHEN D0.TransType='209' THEN '' WHEN D0.TransType='210' THEN 'Employee Position' WHEN D0.TransType='211' THEN 'Employee Teams' WHEN D0.TransType='212' THEN 'Relationships' WHEN D0.TransType='213' THEN 'Recommendation Data' WHEN D0.TransType='214' THEN 'User Autorization Tree' WHEN D0.TransType='215' THEN 'Predefined Text' WHEN D0.TransType='216' THEN 'Box Definition' WHEN D0.TransType='217' THEN 'Activity Status' WHEN D0.TransType='218' THEN '312' WHEN D0.TransType='219' THEN 'User-Defined Values' WHEN D0.TransType='220' THEN 'Periods Category' WHEN D0.TransType='221' THEN 'Attachments' WHEN D0.TransType='222' THEN 'Grid Filter' WHEN D0.TransType='223' THEN 'User Language Table' WHEN D0.TransType='224' THEN 'Multi-Language Translation' WHEN D0.TransType='225' THEN '' WHEN D0.TransType='226' THEN '' WHEN D0.TransType='227' THEN '' WHEN D0.TransType='229' THEN 'Dynamic Interface (Strings)' WHEN D0.TransType='230' THEN 'Saved Reconciliations' WHEN D0.TransType='231' THEN 'House Bank Accounts' WHEN D0.TransType='232' THEN 'Document' WHEN D0.TransType='233' THEN 'Document Generation Parameter Sets' WHEN D0.TransType='234' THEN '#740' WHEN D0.TransType='238' THEN 'Account Category' WHEN D0.TransType='239' THEN 'Bank Charges Allocation Codes' WHEN D0.TransType='241' THEN 'Cash Flow Transactions – Rows' WHEN D0.TransType='242' THEN 'Cash Flow Line Item' WHEN D0.TransType='247' THEN 'Business Place' WHEN D0.TransType='250' THEN 'Local Era Calendar' WHEN D0.TransType='251' THEN 'Cost Accounting Dimension' WHEN D0.TransType='254' THEN 'Service Code Table' WHEN D0.TransType='255' THEN 'Service Group for Brazil' WHEN D0.TransType='256' THEN 'Material Group' WHEN D0.TransType='257' THEN 'NCM Code' WHEN D0.TransType='258' THEN 'CFOP for Nota Fiscal' WHEN D0.TransType='259' THEN 'CST Code for Nota Fiscal' WHEN D0.TransType='260' THEN 'Usage of Nota Fiscal' WHEN D0.TransType='261' THEN 'Closing Date Procedure' WHEN D0.TransType='263' THEN 'Nota Fiscal Numbering' WHEN D0.TransType='264' THEN 'Nota Fiscal Tax Category (Brazil)' WHEN D0.TransType='265' THEN 'Counties' WHEN D0.TransType='266' THEN 'Tax Code Determination' WHEN D0.TransType='267' THEN 'BoE Document Type' WHEN D0.TransType='268' THEN 'BoE Portfolio' WHEN D0.TransType='269' THEN 'BoE Instruction' WHEN D0.TransType='271' THEN 'Tax Parameter' WHEN D0.TransType='275' THEN 'Tax Type Combination' WHEN D0.TransType='276' THEN 'Tax Formula Master Table' WHEN D0.TransType='278' THEN 'CNAE Code' WHEN D0.TransType='280' THEN 'Sales Tax Invoice' WHEN D0.TransType='281' THEN 'Purchase Tax Invoice' WHEN D0.TransType='283' THEN 'Cargo Customs Declaration Numbers' WHEN D0.TransType='290' THEN 'Resources' WHEN D0.TransType='291' THEN 'Resource Properties' WHEN D0.TransType='292' THEN 'ResGrpCod' WHEN D0.TransType='300' THEN 'RecordSet' WHEN D0.TransType='305' THEN 'Bridge' WHEN D0.TransType='321' THEN 'Internal Reconciliation' WHEN D0.TransType='541' THEN 'POS Master Data' WHEN D0.TransType='1179' THEN 'Stock Transfer Draft' WHEN D0.TransType='10000105' THEN 'Messaging Service Settings' WHEN D0.TransType='10000044' THEN 'Batch Numbers Master Data' WHEN D0.TransType='10000045' THEN 'Serial Numbers Master Data' WHEN D0.TransType='10000062' THEN 'IVL Vs OINM Keys' WHEN D0.TransType='10000071' THEN 'Inventory Posting' WHEN D0.TransType='10000073' THEN 'Financial Year Master' WHEN D0.TransType='10000074' THEN 'Sections' WHEN D0.TransType='10000075' THEN 'Certificate Series' WHEN D0.TransType='10000077' THEN 'Nature of Assessee' WHEN D0.TransType='10000196' THEN 'Document Type List' WHEN D0.TransType='10000197' THEN 'UoM Group' WHEN D0.TransType='10000199' THEN 'UoM Master Data' WHEN D0.TransType='10000203' THEN 'Bin Field Configuration' WHEN D0.TransType='10000204' THEN 'Bin Location Attribute' WHEN D0.TransType='10000205' THEN 'Warehouse Sublevel' WHEN D0.TransType='10000206' THEN 'Bin Location' WHEN D0.TransType='140000041' THEN 'DNF Code' WHEN D0.TransType='231000000' THEN 'Authorization Group' WHEN D0.TransType='234000004' THEN 'E-Mail Group' WHEN D0.TransType='243000001' THEN 'Government Payment Code' WHEN D0.TransType='310000001' THEN 'Inventory Opening Balance' WHEN D0.TransType='310000008' THEN 'Batch Attributes in Location' WHEN D0.TransType='410000005' THEN 'Legal List Format' WHEN D0.TransType='480000001' THEN 'Object: HR Employee Transfer' WHEN D0.TransType='540000005' THEN 'Tax Code Determination' WHEN D0.TransType='540000006' THEN 'Purchase Quotation' WHEN D0.TransType='540000040' THEN 'Recurring Transaction Template' WHEN D0.TransType='540000042' THEN 'Cost Center Type' WHEN D0.TransType='540000048' THEN 'Accrual Type' WHEN D0.TransType='540000056' THEN 'Nota Fiscal Model' WHEN D0.TransType='540000067' THEN 'Brazil Fuel Indexer' WHEN D0.TransType='540000068' THEN 'Brazil Beverage Indexer' WHEN D0.TransType='1210000000' THEN 'Cockpit Main Table' WHEN D0.TransType='1250000001' THEN 'Inventory Transfer Request' WHEN D0.TransType='1250000025' THEN 'Blanket Agreement' WHEN D0.TransType='1320000000' THEN 'Key Performance Indicator Package' WHEN D0.TransType='1320000002' THEN 'Target Group' WHEN D0.TransType='1320000012' THEN 'Campaign' WHEN D0.TransType='1320000028' THEN 'Retorno Operation Codes' WHEN D0.TransType='1320000039' THEN 'Product Source Code' WHEN D0.TransType='1470000000' THEN 'Fixed Assets Depreciation Types' WHEN D0.TransType='1470000002' THEN 'Fixed Assets Account Determination' WHEN D0.TransType='1470000003' THEN 'Fixed Asset Depreciation Areas' WHEN D0.TransType='1470000004' THEN 'Depreciation Type Pools' WHEN D0.TransType='1470000032' THEN 'Asset Classes' WHEN D0.TransType='1470000046' THEN 'Asset Groups' WHEN D0.TransType='1470000048' THEN 'G/L Account Determination Criteria – Inventory' WHEN D0.TransType='1470000049' THEN 'Capitalization' WHEN D0.TransType='1470000057' THEN 'G/L Account Advanced Rules' WHEN D0.TransType='1470000060' THEN 'Credit Memo' WHEN D0.TransType='1470000062' THEN 'Bar Code Master Data' WHEN D0.TransType='1470000065' THEN 'Inventory Counting' WHEN D0.TransType='1470000077' THEN 'Discount Groups' WHEN D0.TransType='1470000092' THEN 'Cycle Count Determination' WHEN D0.TransType='1470000113' THEN 'Purchase Request' WHEN D0.TransType='1620000000' THEN 'Workflow – Task Details' ELSE 'Addons' END AS 'Document Type'  FROM [dbo].[JDT1] D0  INNER JOIN OJDT D1 ON D1.TransId = D0.TransId LEFT JOIN OACT T1 ON T1.AcctCode = D0.Account LEFT JOIN OCRD T2 ON T2.CardCode = D0.ContraAct LEFT JOIN OACT T3 ON T3.AcctCode = D0.ContraAct  WHERE D0.[RefDate] >= [%0] AND  D0.[RefDate] <= [%1]        ORDER BY D0.refdate DESC
SELECT T0.[DocNum] AS 'SO NO.', T0.[DocDate] AS 'SO DATE', T0.[CardName] AS 'CUSTOMER NAME', T0.[NumAtCard] AS 'PO NO.', T0.TAXDATE AS 'PO DATE',T1.[ItemCode], T1.[Dscription], T1.Currency,T1.Price AS'UNIT PRICE',T1.[Quantity] AS 'ORDER QTY',  T1.[Quantity]-T1.[OpenQty] AS 'DISPATCH QTY', T1.OPENQTY, T1.[ShipDate] FROM ORDR T0  INNER JOIN RDR1 T1 ON T0.[DocEntry] = T1.[DocEntry]  WHERE T1.[ShipDate]>=[%0] AND T1.[ShipDate]<=[%1]  ORDER BY T0.DOCDATE
select t0.ItemCode as 'ITEM CODE',(select a.itemname from oitm a where a.itemcode=t0.ItemCode)AS'ITEM NAME', max(t0.price)*72 AS 'SALE PRICE(INR)',(select b.LastPurPrc from oitm b where b.itemcode=t0.ItemCode) AS 'RMC COST', (max(t0.price)*72)*10/100 AS 'PROCESS COST',(max(t0.price)*72)*15/100 AS 'OVER HEAD COST'  ,(max(t0.price)*72-((select b.LastPurPrc from oitm b where b.itemcode=t0.ItemCode)+(max(t0.price)*72)*10/100+(max(t0.price)*72)*15/100))/(max(t0.price)*72)*100 AS 'MARGIN %'   from INV1 t0 INNER JOIN OINV T1 ON T1.DocEntry=T0.DocEntry  where itemcode like '1%%' and Currency='usd' and T0.DocDate = (select (max(DocDate)) from inv1 where inv1.ItemCode=t0.itemcode) AND CardCode='C000069'  Group by t0.itemcode
select t0.ItemCode as 'ITEM CODE',(select a.itemname from oitm a where a.itemcode=t0.ItemCode)AS'ITEM NAME', max(t0.price)*72 AS 'SALE PRICE(INR)',(select b.LastPurPrc from oitm b where b.itemcode=t0.ItemCode) AS 'RMC COST', (max(t0.price)*72)*10/100 AS 'PROCESS COST',(max(t0.price)*72)*15/100 AS 'OVER HEAD COST'  ,(max(t0.price)*72-((select b.LastPurPrc from oitm b where b.itemcode=t0.ItemCode)+(max(t0.price)*72)*10/100+(max(t0.price)*72)*15/100))/(max(t0.price)*72)*100 AS 'MARGIN %'   from INV1 t0 INNER JOIN OINV T1 ON T1.DocEntry=T0.DocEntry  where itemcode like '1%%' and ItemCode not like '112%%' and Currency='usd' and T0.DocDate = (select (max(DocDate)) from inv1 where inv1.ItemCode=t0.itemcode) AND CardCode='C000069'  Group by t0.itemcode ORDER BY T0.ITEMCODE
select t0.ItemCode as 'ITEM CODE',(select a.itemname from oitm a where a.itemcode=t0.ItemCode)AS'ITEM NAME', max(t0.price)*72 AS 'SALE PRICE(INR)',(select b.LastPurPrc from oitm b where b.itemcode=t0.ItemCode) AS 'RMC COST', (max(t0.price)*72)*10/100 AS 'PROCESS COST',(max(t0.price)*72)*15/100 AS 'OVER HEAD COST'  ,(max(t0.price)*72-((select b.LastPurPrc from oitm b where b.itemcode=t0.ItemCode)+(max(t0.price)*72)*10/100+(max(t0.price)*72)*15/100))/(max(t0.price)*72)*100 AS 'MARGIN %'   from INV1 t0 INNER JOIN OINV T1 ON T1.DocEntry=T0.DocEntry  where itemcode like '1%%' and ItemCode not like '112%%' and Currency='usd' and T0.DocDate = (select (max(DocDate)) from inv1 where inv1.ItemCode=t0.itemcode) AND CardCode='C000071'  Group by t0.itemcode ORDER BY T0.ITEMCODE
SELECT CardCode,CardName, [FY] , [4] AS April,[5] AS May,     [6] AS June,[7] AS July,[8] AS August,[9] AS September,[10] AS October,[11] AS November,[12] AS December,  [1] AS January,[2] AS February,[3] AS March,     ISNULL([4], 0) +ISNULL([5], 0) + ISNULL([6], 0) + ISNULL([7], 0) + ISNULL([8], 0) +     ISNULL([9], 0) + ISNULL([10], 0) + ISNULL([11], 0) + ISNULL([12], 0)+ ISNULL([1], 0) +   ISNULL([2], 0) + ISNULL([3], 0) AS Total FROM (SELECT T0.CardCode, T0.CardName, CASE WHEN T1.DocDate >= '2019-04-01' AND T1.DocDate <= '2020-03-31' THEN 'FY 2019-20'     WHEN T1.DocDate >= '2020-04-01' AND T1.DocDate <= '2021-03-31' THEN 'FY 2020-21'     WHEN T1.DocDate >= '2021-04-01' AND T1.DocDate <= '2022-03-31' THEN 'FY 2021-22'     WHEN T1.DocDate >= '2022-04-01' AND T1.DocDate <= '2023-03-31' THEN 'FY 2022-23'   WHEN T1.DocDate >= '2023-04-01' AND T1.DocDate <= '2024-03-31' THEN 'FY 2023-24'   END AS [FY] ,MONTH(T1.DocDate) AS Month, T2.LineTotal AS BasicValue FROM OCRD T0      INNER JOIN ordr T1 ON T0.CardCode = T1.CardCode   LEFT JOIN rdr1 T2 ON T2.DocEntry = T1.DocEntry  WHERE T1.DocDate >='20190401' AND T1.CANCELED <>'Y'  ) AS PivotData PIVOT (SUM(BasicValue)      FOR Month IN ( [4], [5], [6], [7], [8], [9], [10], [11], [12],[1], [2], [3])) AS PivotTable
SELECT CardCode,CardName, [FY] , [4] AS April,[5] AS May,     [6] AS June,[7] AS July,[8] AS August,[9] AS September,[10] AS October,[11] AS November,[12] AS December,  [1] AS January,[2] AS February,[3] AS March,     ISNULL([4], 0) +ISNULL([5], 0) + ISNULL([6], 0) + ISNULL([7], 0) + ISNULL([8], 0) +     ISNULL([9], 0) + ISNULL([10], 0) + ISNULL([11], 0) + ISNULL([12], 0)+ ISNULL([1], 0) +   ISNULL([2], 0) + ISNULL([3], 0) AS Total FROM (SELECT T0.CardCode, T0.CardName, CASE WHEN T1.DocDate >= '2019-04-01' AND T1.DocDate <= '2020-03-31' THEN 'FY 2019-20'     WHEN T1.DocDate >= '2020-04-01' AND T1.DocDate <= '2021-03-31' THEN 'FY 2020-21'     WHEN T1.DocDate >= '2021-04-01' AND T1.DocDate <= '2022-03-31' THEN 'FY 2021-22'     WHEN T1.DocDate >= '2022-04-01' AND T1.DocDate <= '2023-03-31' THEN 'FY 2022-23'   WHEN T1.DocDate >= '2023-04-01' AND T1.DocDate <= '2024-03-31' THEN 'FY 2023-24'   END AS [FY] ,MONTH(T1.DocDate) AS Month, T2.LineTotal AS BasicValue FROM OCRD T0      INNER JOIN OINV T1 ON T0.CardCode = T1.CardCode   LEFT JOIN INV1 T2 ON T2.DocEntry = T1.DocEntry  WHERE T1.DocDate >='20190401' AND T1.CANCELED <>'Y'  ) AS PivotData PIVOT (SUM(BasicValue)      FOR Month IN ( [4], [5], [6], [7], [8], [9], [10], [11], [12],[1], [2], [3])) AS PivotTable
SELECT DOCNUM ,NUMATCARD FROM ORDR WHERE DOCNUM IN ( 2200054, 2200226, 23240049, 23240068, 2200202, 23240004, 23240087, 2200060, 2200077, 2200129, 2200180, 2200237, 2200136, 23240005  )
SELECT  T0.DocEntry AS 'Inv Entry',T0.DocNum  AS 'Inv No.'        ,T0.[DocDate] AS 'Inv Dt.',D3.DocEntry  AS 'Dlv Entry'        ,D3.DocNum  AS 'Dlv No.',D3.DocDate AS 'Dlv Dt.'        ,ISNULL (D4.DocEntry,T1.BaseEntry) AS 'SO Entry'        ,ISNULL(D5.DocNum,T1.BaseRef)   AS [SO No]        ,ISNULL(D5.DocDate,T0.DocDate)  AS [SO Date] ,CASE WHEN T0.DocDate >= '2019-04-01' AND T0.DocDate <= '2020-03-31' THEN 'FY 2019-20'       WHEN T0.DocDate >= '2020-04-01' AND T0.DocDate <= '2021-03-31' THEN 'FY 2020-21'       WHEN T0.DocDate >= '2021-04-01' AND T0.DocDate <= '2022-03-31' THEN 'FY 2021-22'       WHEN T0.DocDate >= '2022-04-01' AND T0.DocDate <= '2023-03-31' THEN 'FY 2022-23'        WHEN T0.DocDate >= '2023-04-01' AND T0.DocDate <= '2024-03-31' THEN 'FY 2023-24' END                       AS 'FINANCIAL YEAR'         ,UPPER(T4.GroupName)                              AS "CUSTOMER TYPE"        ,CASE                                      WHEN T0.Series IN ('159','210','343','407','607','806','151','4','863')  THEN 'BILL OF SUPPLY'             WHEN T0.Series IN ('557','539','242','371','5','155','354','865') THEN 'EXPORT INVOICE'    WHEN T0.Series IN ('523','536','652','692','693','558','653','163','209','864') THEN 'TAX INVOICE'    WHEN T0.Series IN ('6','211','373','556','679','695','867') THEN  'DEBIT NOTE' ELSE 'TAX INVOICE' END AS 'INVOICE SERIES'            ,UPPER(CAST(DATENAME(month, T0.DocDate) AS CHAR(3))) AS 'MONTH'        ,DATEPART(YEAR,T0.DocDate)                            AS "YEAR"        ,T0.[CardCode],UPPER (T0.[CardName]) AS 'CUSTOMER NAME'        ,T1.[ItemCode],UPPER (T1.[Dscription]) AS 'Item Name' ,T14. [ItmsGrpNam] ,T1.[TreeType] ,T1.[Quantity]        ,T1. [Price] * T0.DocRate AS "Unit Price after Discount",T1.[LineTotal] AS "Row Total",T1.[DedVatSum] AS "Tax"        ,(T1.[LineTotal]+T1. [DedVatSum])                                                                                AS "Total after tax", T0.ExepAmnt AS 'Withholding Tax',      T0.TotalExpns AS 'Doc Freight', CASE WHEN T0.TotalExpns <> 0 THEN TRY_CONVERT(NUMERIC (10,2) ,ABS(T0.TotalExpns)/T1.Quantity) ELSE 0 END AS 'ItemWiseFreight', CASE WHEN ExpnsName IS NULL THEN 'SALE' ELSE UPPER(ExpnsName) END AS 'EXPENSES TYPE', acct.AcctName AS "Account Name",T1.GrssProfit, CASE WHEN ISNULL(T1.LineTotal, 0) = 0 THEN 0 ELSE TRY_CONVERT (NUMERIC (10,2) ,(ISNULL(T1.GrssProfit, 0)/ ISNULL(T1.LineTotal, 0)* 100)) END 'Gross Profit %' , CONVERT(NUMERIC (10,0),D4.[OPENQTY]) AS 'Remaining Qty',CONVERT(NUMERIC (10,0),(D4.OpenQty * D4.Price)) AS 'Remaining Value' ,CONVERT(NUMERIC (10,0),(D4.[QUANTITY]-D4.[OPENQTY] )) AS 'Delivered Qty'        ,CASE WHEN D4.LineStatus = 'C' THEN 'Closed'  ELSE 'Open'END                                                     AS 'SO Line Status'        ,CASE WHEN T3.Balance <= 0 THEN 0  ELSE T3.Balance END                                                           AS 'Total Dues',ROUND (T0.DocTotal,0) AS 'DocTotal',T3.Balance,T3.OrdersBal        ,T1.[WhsCode]as"Warehouse",UPPER (T3.[City]) AS 'City'        ,CASE WHEN st_name.name IS NULL THEN UPPER(st_name1.name)  ELSE UPPER (st_name.name) END AS "Ship to State"        ,UPPER(st_name1.name)                                                                                                    AS "Bill to State",UPPER (country_name.name) AS 'Ship to Country'              FROM OINV T0 LEFT JOIN(SELECT  docentry,[BaseRef],[ItemCode],[Dscription],[Quantity],[PriceBefDi],ShipToDesc,[AcctCode],[Price]       ,[DedVatSum],[LineTotal],[WhsCode],[PickIdNo],[TaxCode],GrssProfit,[TreeType],BaseEntry,BaseLine,BaseType FROM INV1)T1 ON T0.DocEntry = T1.DocEntry LEFT JOIN DLN1 D2 ON T1.BaseEntry = D2.DocEntry AND T1.BaseLine = D2.LineNum AND T1.BaseType = D2.ObjType LEFT JOIN ODLN D3 ON D2.DocEntry = D3.DocEntry LEFT JOIN RDR1 D4 ON D2.BaseEntry = D4.DocEntry AND D2.BaseLine = D4.LineNum AND D2.BaseType = D4.ObjType LEFT JOIN ORDR D5 ON D5.DocEntry = D4.DocEntry LEFT JOIN (SELECT [AcctCode],AcctName FROM OACT)acct ON T1.[AcctCode] = acct.AcctCode LEFT JOIN (SELECT Docentry,[TaxId0] FROM INV12)T5 ON T0.DocEntry = T5.DocEntry LEFT JOIN (SELECT CardCode,GroupCode,city,SlpCode,Balance,OrdersBal FROM OCRD)T3 ON T0.CardCode = T3.CardCode LEFT JOIN (SELECT DocEntry,[StateS],StateB,CountryS,CountryB FROM INV12)T12 ON T0.DocEntry = T12.DocEntry LEFT JOIN (SELECT GroupCode,GroupName FROM OCRG)T4 ON T3.GroupCode = T4.GroupCode LEFT JOIN (SELECT Itemcode,ItmsGrpCod,ChapterID FROM OITM)T13 ON T1.[ItemCode] = T13.[ItemCode] LEFT JOIN (SELECT ItmsGrpCod,ItmsGrpNam FROM OITB)T14 ON T13.[ItmsGrpCod] = T14. [ItmsGrpCod] LEFT JOIN (SELECT Absentry,ChapterID FROM OCHP)T15 ON T13. [ChapterID] = T15.AbsEntry LEFT JOIN (SELECT Series,SeriesName,BeginStr,EndStr FROM NNM1)T6 ON T0.Series = T6.Series LEFT JOIN (SELECT Code,name,Country FROM OCST)st_name1 ON T12.StateB = st_name1.code AND T12.CountryB = st_name1.country LEFT JOIN (SELECT Code,name,Country FROM OCST)st_name ON T12.StateS = st_name.code AND T12.CountryS = st_name.country LEFT JOIN (SELECT [ItemCode],[ItemName],[FrgnName] FROM OITM)frng_name ON T1.itemcode = frng_name.itemcode LEFT JOIN (SELECT code,name FROM OCRY)country_name ON T12.CountryS = country_name.code LEFT JOIN (SELECT DISTINCT U_UTL_BaseEntry,U_UTL_IRN,U_UTL_IST from [@UTL_MDEXTH] where U_UTL_IST ='S'            AND  Isnull(U_UTL_QRPT,'')<>'' )IRN ON T0.DocEntry = IRN.U_UTL_BaseEntry LEFT JOIN (SELECT DISTINCT DocEntry ,ExpnsName, LineTotal ,ABS(LineTotal) 'ABSExpVal'  FROM INV3             INNER JOIN OEXD ON OEXD.ExpnsCode = INV3.ExpnsCode)F1 ON F1.DocEntry = T0.DocEntry   WHERE T0.[DOCDate] >= [%0] AND T0.[DOCDate] <=  [%1] AND T0.CANCELED ='N' AND T14.ItmsGrpCod <> 107 AND T0.DocTotal >0  ORDER BY T0.DocDate, T0.DocEntry
SELECT T1.DocNum, T1.CardCode, T1.DocDate, T1.DocTotal, T1.DiscPrcnt FROM OINV T1 WHERE T1.DiscPrcnt   >= [%0]
SELECT T1.TransId, T0.DueDate, T0.LineMemo, T0.Debit, T0.Credit, T0.ExtrMatch, T0.IntrnMatch FROM JDT1 T0  INNER JOIN OJDT T1 ON T0.TransId = T1.TransId WHERE T0.ShortName   = N'[%0]' AND T0.DueDate  >= '[%1]' AND T0.DueDate  <= '[%2]'
SELECT T1.TransId, T0.DueDate, T0.LineMemo, T0.Debit, T0.Credit, T0.ExtrMatch, T0.IntrnMatch FROM JDT1 T0  INNER JOIN OJDT T1 ON T0.TransId = T1.TransId WHERE T0.ShortName  = N'[%0]' AND (T0.Debit   = [%1] OR T0.Credit  = [%1])
SELECT T1.TransId, T0.DueDate, T0.LineMemo, T0.Debit, T0.Credit, T0.FCDebit, T0.FCCredit, T0.ExtrMatch, T0.IntrnMatch FROM JDT1 T0  INNER JOIN OJDT T1 ON T0.TransId = T1.TransId WHERE T0.ShortName  = N'[%0]' AND (T0.FCDebit   = [%1] OR T0.FCCredit   = [%1])
SELECT T1.TransId, T0.DueDate, T0.LineMemo, T0.Debit, T0.Credit, T0.FCDebit, T0.FCCredit, T0.ExtrMatch, T0.IntrnMatch FROM JDT1 T0  INNER JOIN OJDT T1 ON T0.TransId = T1.TransId WHERE T0.ShortName  = N'[%0]' AND T1.TransId  = [%1]
SELECT T0.VisOrder, T0.AcctCode, T0.DueDate, T0.Memo, T0.DebAmount, T0.CredAmnt, T0.BankMatch FROM OBNK T0 WHERE T0.VisOrder  =  [%0] AND T0.AcctCode  = N'[%1]'
SELECT T0.Sequence, T0.AcctCode, T0.DueDate, T0.Memo, T0.DebAmount, T0.CredAmnt, T0.BankMatch FROM OBNK T0 WHERE T0.AcctCode  = N'[%0]' AND ( T0.DebAmount  = [%1] OR T0.CredAmnt  = [%1])
SELECT T0.ShortName, T1.TransId, T0.DueDate, T0.LineMemo, T0.Debit, T0.Credit FROM JDT1 T0  INNER JOIN OJDT T1 ON T0.TransId = T1.TransId WHERE (T0.Debit >= [%0] AND T0.Debit <= [%1]) OR (T0.Credit >=[%0] AND T0.Credit  <= [%1])
SELECT T0.ShortName, T1.TransId, T0.DueDate, T0.LineMemo, T0.FCDebit,T0.FCCredit,T0.Debit, T0.Credit FROM JDT1 T0  INNER JOIN OJDT T1 ON T0.TransId = T1.TransId WHERE (T0.FCDebit >= [%0] AND T0.FCDebit  <= [%1]) OR (T0.FCCredit >= [%0] AND T0.FCCredit <= [%1])
SELECT T0.CheckNum, T0.Branch, T0.BankNum, T0.CheckDate, T0.CheckSum, T0.VendorCode, T0.VendorName FROM OCHO T0 WHERE T0.CheckDate >= '[%0]' AND T0.CheckDate <= '[%1]'
SELECT T0.DocNum, T0.DocType, T0.DocTotal, ( T0.DocTotal - T0.VatSum) As "#[948.1]"  , T1.SlpName, T1.Commission, ( ( T0.DocTotal - T0.VatSum)*( T1.Commission/100)) As "#[948.2]" FROM OINV T0  INNER JOIN OSLP T1 ON T0.SlpCode = T1.SlpCode WHERE T1.SlpName  = N'[%0]' AND T0.DocDate >= '[%1]' AND  T0.DocDate <= '[%2]'
SELECT T1.TransId, T1.BatchNum, T0.DueDate, T0.LineMemo, T0.Debit, T0.Credit, T0.FCDebit, T0.FCCredit FROM JDT1 T0  INNER JOIN OJDT T1 ON T0.TransId = T1.TransId WHERE T1.BatchNum  = [%0]
SELECT T0.CardCode, T0.CardName, T0.Phone1, T0.Balance, T0.ChecksBal, T0.DebtLine, ( T0.Balance- T0.ChecksBal) As "#[948.3]" FROM OCRD T0 WHERE T0.Balance < 0 AND T0.CardCode = N'[%0]' AND T0.CardType  = 'C' 
DECLARE @Factor as numeric(1,0) SELECT @Factor = CASE (SELECT TOP 1 DispPosDeb FROM OADM) WHEN 'N' THEN 1 ELSE -1  END SELECT T0.CardCode, T0.CardName, T0.Balance, T0.CreditLine,(T0.CreditLine + @Factor*T0.Balance) "#[948.4]" FROM OCRD T0 WHERE (select T0.CreditLine + @Factor*T0.Balance)  < 0 AND T0.CardType  = 'C' 
SELECT T0.MsnCode, T1.ItemCode, T1.Quantity, T1.StockType, T1.StartDate, T1.EndDate, T1.BaseObj,T1.BaseDocNum,T1.BaseDue,T1.ParentCode FROM OMSN T0 INNER JOIN MSN3 T1 ON (T0.AbsEntry = T1.AbsEntry) WHERE (T0.MsnCode = N'[%0]' OR '[%0]' = '') AND (T1.ItemCode = N'[%1]' OR '[%1]' = '') AND (T1.StartDate = CONVERT(DATETIME, '[%2]', 112) OR '[%2]' = '')
Select T0.DocNum As "#[948.87]",T0.ItemCode,T1.ItemName As "#[948.88]",T0.DueDate,T0.PostDate As "#[948.50]",T0.Status,T0.OriginType, T0.PlannedQty,T0.CmpltQty As "#[948.89]",T0.RjctQty As "#[948.90]",T0.PlannedQty - T0.CmpltQty - t0.RjctQty As "#[948.91]",T4.ItmsGrpNam,T2.U_NAME As "#[948.92]",T3.CardName As "#[948.93]",T0.OriginNum As "#[948.94]" from OWOR T0 full outer join OCRD T3 on (T0.CardCode = T3.CardCode), OITM T1 full outer join OITB T4 on (T1.ItmsGrpCod = T4.ItmsGrpCod), OUSR T2 where T0.ItemCode = T1.ItemCode and T0.UserSign = T2.userId and ((T0.DueDate >= '[%0]' and T0.DueDate <= '[%1]') or ('[%0]' = '' and '[%1]' = '')) and (T0.Type = '[%2]' or '[%2]' = '') and (T0.status = '[%3]' or '[%3]' = '') and (T0.OriginType = '[%4]' or '[%4]' = '') and (T0.warehouse  = '[%5]' or '[%5]' = '') and (T4.ItmsGrpNam = '[%6]' or '[%6]' = '') and (T0.ItemCode ='[%7]' or '[%7]' = '') and (T2.U_NAME = '[%8]' or '[%8]' = '') and (T3.CardName= '[%9]' or '[%9]' = '')
SELECT t0.DocEntry, t0.DocStatus, t0.Excised, t0.ObjType FROM ODLN t0 WHERE t0.DocStatus='O' or t0.Excised = 'O' and t0.DocEntry in ( SELECT DocEntry FROM DLN4 WHERE staType in ( SELECT t0.AbsId FROM OSTT t0 INNER JOIN ONFT t1 on t0.NfTaxId = t1.AbsId WHERE t1.AbsId=-50))
SELECT t0.DocEntry, t0.DocStatus, t0.Excised, t0.ObjType FROM OPDN t0 WHERE t0.DocStatus='O' or t0.Excised = 'O' and t0.DocEntry in ( SELECT DocEntry FROM PDN4 WHERE staType in ( SELECT t0.AbsId FROM OSTT t0 INNER JOIN ONFT t1 on t0.NfTaxId = t1.AbsId WHERE t1.AbsId=-50))
SELECT t0.DocEntry, t0.DocStatus, t0.Excised, t0.ObjType FROM ORPD t0 WHERE t0.DocStatus='O' or t0.Excised = 'O' and t0.DocEntry in ( SELECT DocEntry FROM RPD4 WHERE staType in ( SELECT t0.AbsId FROM OSTT t0 INNER JOIN ONFT t1 on t0.NfTaxId = t1.AbsId WHERE t1.AbsId=-50))
SELECT t0.DocEntry, t0.DocStatus, t0.Excised, t0.ObjType FROM ORDN t0 WHERE t0.DocStatus='O' or t0.Excised = 'O' and t0.DocEntry in ( SELECT DocEntry FROM RDN4 WHERE staType in ( SELECT t0.AbsId FROM OSTT t0 INNER JOIN ONFT t1 on t0.NfTaxId = t1.AbsId WHERE t1.AbsId=-50))
SELECT T1.DocDate AS 'Date', T1.[DocNum] AS 'Document No.', T0.Quantity, T0.Price AS 'Price', T0.LineTotal AS 'Total', T0.[WhsCode] AS 'To WH', T1.[Filler] AS 'From WH', T0.[LnExcised] AS 'Line Excised Status' FROM [dbo].[WTR1] T0 INNER JOIN [dbo].[OWTR] T1 ON T1.[DocEntry] = T0.[DocEntry] WHERE T0.Excisable = 'Y' AND T0.LnExcised <> 'C' AND T1.Canceled <> 'Y' AND T0.BaseType = -1 ORDER by T1.DocDate, T1.DocNum, T0.LineNum
SELECT DISTINCT T1.DocDate AS 'Date', T1.[DocNum] AS 'Document No.', T0.[WhsCode] AS 'To WH', T1.[Filler] AS 'From WH', T1.DocStatus FROM [dbo].[OEI1] T0 INNER JOIN [dbo].[OOEI] T1 ON T1.[DocEntry] = T0.[DocEntry] WHERE T0.BaseType = 67 AND T1.DocStatus = 'O' ORDER BY T1.DocDate, T1.DocNum
Select t3.CardName, t3.CardCode, t1.Country AS "#[948.140]", t1.BankCode, t2.BankName, t1.Branch, t1.Account AS "#[948.139]", t1.IBAN, t1.SwiftNum from OCRB t1 join ODSC t2 on t1.BankKey = t2.AbsEntry inner join OCRD t3 on t1.CardCode=t3.CardCode order by t1.CardCode, t1.Country, t1.BankCode
Select t1.Country AS "#[948.140]", t1.BankCode, t2.BankName, t1.Branch, t1.Account AS "#[948.139]", t1.IBAN, t1.SwiftNum from DSC1 t1 join ODSC t2 on t1.BankKey = t2.AbsEntry order by t1."Country", t1."BankCode", t1."AbsEntry"
select T0.DocNum, T0.CardCode, T0.CardName, T0.DocDate, T0.VatSum from opch T0 where T0.docEntry in (select distinct T1.DocEntry from pch4 T1 inner join OSTT T2 ON T1.staType = T2.AbsId AND T2.NfTaxId = -3) and T0.DocDate < DATEADD (m, -3, DateAdd(DD,DateDiff(DD,0,GetDate()),0)) and T0.DocStatus = 'O' and T0.PaidToDate <> T0.DocTotal
select T0.DocNum, T0.CardCode, T0.CardName, T0.DocDate, T0.VatSum from orpc T0 where T0.docEntry in (select distinct T1.DocEntry from rpc4 T1 inner join OSTT T2 ON T1.staType = T2.AbsId AND T2.NfTaxId = -3) and T0.DocDate < DATEADD (m, -3, DateAdd(DD,DateDiff(DD,0,GetDate()),0)) and T0.DocStatus = 'O' and T0.PaidToDate <> T0.DocTotal
Declare @Domestic nvarchar(100) set @Domestic=isnull($[OINV.DocCur],0)  IF(@Domestic='INR') Begin IF Convert(numeric(19,3),isnull($[OINV.U_UDF1],0))<=5000000 And (($[OINV.DocTotal]+Convert(numeric(19,3),isnull($[OINV.U_UDF1],0))) - 5000000 )<0 Begin Select 0 END  ELSE IF Convert(numeric(19,3),isnull($[OINV.U_UDF1],0)) >5000000  Begin Select ($[OINV.DocTotal] ) END  ELSE Select (($[OINV.DocTotal]+Convert(numeric(19,3),isnull($[OINV.U_UDF1],0))) - 5000000 ) END  ELSE BEGIN SELECT 0 END
Declare @PANNo nvarchar(50) set @PANNo=isnull((Select Distinct TaxId0 From CRD7  where cardcode=$[OINV.CardCode] and AddrType='S'  and (taxid0 is not null or taxid0<>'') ),'')  If(@PANNo<>'') Begin Select Distinct CardCode into #Temp From CRD7 where CRD7.TaxId0=@PANNo   select isnull((select sum(a.vv) from (Select (isnull((Select (Case when DocCur='INR' then sum(INV1.Linetotal) else sum(inv1.TotalFrgn) END )  From INV1,OITM  where INV1.DocEntry=OINV.DocEntry and OITM.ItemCode=INV1.ItemCode and (OITM.InvntItem='Y' AND OITM.ItmsGrpCod not in (107,132))) ,0) +  isnull((Select sum(INV4.TaxSum) From INV4 where OINV.DocEntry=INV4.docentry  AND (INV4.statype <> 8 AND INV4.Taxrate not in( 0.075))),0.0) +  isnull((Select sum(inv3.LineTotal) From INV3 where OINV.DocEntry=Inv3.docentry),0.0) -  isnull((Case when DocCur='INR' then OINV.DiscSum else OINV.DiscSumFC END ),0.0))'VV' From OINV,#Temp T ,OCRD where OINV.DocType='I' and OINV.Docdate between '2020-04-01' and (Cast((Right(Convert(nvarchar(10),Replace($[OINV.Docdate],'/',''),106) ,2)+substring(Convert(nvarchar(10),Replace($[OINV.Docdate],'/',''),106) ,3,2)+                                                  Left(Convert(nvarchar(10),Replace($[OINV.Docdate],'/',''),106) ,2)) as date))  and OINV.CardCode=T.CardCode AND OINV.DocCur='INR' AND OCRD.CardCode=OINV.CardCode  --and OCRD.GroupCode not in (121,107) group by DocCur,DiscSum,DiscSumFC,OINV.DocEntry)a),0) --------------------------------------------------------------------- - isnull((Select sum(DocTotal) VV From ORIN ,#Temp T,OCRD where ORIN.Docdate between '2020-04-01' and (Cast((Right(Convert(nvarchar(10),Replace($[OINV.Docdate],'/',''),106) ,2)+substring(Convert(nvarchar(10),Replace($[OINV.Docdate],'/',''),106) ,3,2)+                                                  Left(Convert(nvarchar(10),Replace($[OINV.Docdate],'/',''),106) ,2)) as date)) and ORIN.CardCode=T.CardCode AND ORIN.DocCur='INR' AND OCRD.CardCode=ORIN.CardCode  --and OCRD.GroupCode not in (121,107) ),0) END Else Begin select isnull((select sum(a.vv) from (Select (isnull((Select (Case when DocCur='INR' then sum(INV1.Linetotal) else sum(inv1.TotalFrgn) END )  From INV1,OITM  where INV1.DocEntry=OINV.DocEntry and OITM.ItemCode=INV1.ItemCode and (OITM.InvntItem='Y' and OITM.ItmsGrpCod not in (107,132)) ),0) +  isnull((Select sum(INV4.TaxSum) From INV4 where OINV.DocEntry=INV4.docentry  AND (INV4.statype <> 8 AND INV4.Taxrate not in( 0.075))),0.0) +  isnull((Select sum(inv3.LineTotal) From INV3 where OINV.DocEntry=Inv3.docentry),0.0) -  isnull((Case when DocCur='INR' then OINV.DiscSum else OINV.DiscSumFC END ),0.0))'VV' From OINV,OCRD where OINV.DocType='I'  and OINV.Docdate between '2020-04-01' and (Cast((Right(Convert(nvarchar(10),Replace($[OINV.Docdate],'/',''),106) ,2)+substring(Convert(nvarchar(10),Replace($[OINV.Docdate],'/',''),106) ,3,2)+                                                  Left(Convert(nvarchar(10),Replace($[OINV.Docdate],'/',''),106) ,2)) as date))  and OINV.CardCode=$[OINV.CardCode] AND OINV.DocCur='INR'  AND OCRD.CardCode=OINV.CardCode  --and OCRD.GroupCode not in (121,107) group by DocCur,DiscSum,DiscSumFC,OINV.DocEntry)a),0) --------------------------------------------------------------------- - isnull((Select sum(DocTotal) VV From ORIN ,OCRD where ORIN.Docdate between '2020-04-01' and (Cast((Right(Convert(nvarchar(10),Replace($[OINV.Docdate],'/',''),106) ,2)+substring(Convert(nvarchar(10),Replace($[OINV.Docdate],'/',''),106) ,3,2)+                                                  Left(Convert(nvarchar(10),Replace($[OINV.Docdate],'/',''),106) ,2)) as date)) and ORIN.CardCode=$[OINV.CardCode] AND ORIN.DocCur='INR' AND OCRD.CardCode=ORIN.CardCode -- and OCRD.GroupCode not in (121,107) ),0)  END